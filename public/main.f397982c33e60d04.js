"use strict";(self.webpackChunkopac=self.webpackChunkopac||[]).push([[179],{2011:(mt,De,P)=>{P.d(De,{Dh:()=>ge,GT:()=>ne,Ot:()=>de,cc:()=>ve,hO:()=>ke,on:()=>G,pX:()=>ae,xv:()=>ue});var _=P(4650),X=P(9260),V=P(462);mt=P.hmd(mt);const te=["ngOnDestroy"],ae=(be,Ne,Ue,Ae={})=>new Proxy(be,{get:(Ie,Re)=>Ue.runOutsideAngular(()=>{var Ge;if(be[Re])return!(null===(Ge=Ae?.spy)||void 0===Ge)&&Ge.get&&Ae.spy.get(Re,be[Re]),be[Re];if(te.indexOf(Re)>-1)return()=>{};const Se=Ne.toPromise().then(j=>{const we=j&&j[Re];return"function"==typeof we?we.bind(j):we&&we.then?we.then(We=>Ue.run(()=>We)):Ue.run(()=>we)});return new Proxy(()=>{},{get:(j,we)=>Se[we],apply:(j,we,We)=>Se.then(Ye=>{var gt;const Je=Ye&&Ye(...We);return!(null===(gt=Ae?.spy)||void 0===gt)&&gt.apply&&Ae.spy.apply(Re,We,Je),Je})})})}),ne=(be,Ne)=>{Ne.forEach(Ue=>{Object.getOwnPropertyNames(Ue.prototype||Ue).forEach(Ae=>{Object.defineProperty(be.prototype,Ae,Object.getOwnPropertyDescriptor(Ue.prototype||Ue,Ae))})})};class de{constructor(Ne){return Ne}}const ge=new _.OlP("angularfire2.app.options"),ue=new _.OlP("angularfire2.app.name");function G(be,Ne,Ue){const Ie="object"==typeof Ue&&Ue||{};Ie.name=Ie.name||"string"==typeof Ue&&Ue||"[DEFAULT]";const Ge=X.Z.apps.filter(Se=>Se&&Se.name===Ie.name)[0]||Ne.runOutsideAngular(()=>X.Z.initializeApp(be,Ie));try{JSON.stringify(be)!==JSON.stringify(Ge.options)&&W("error",`${Ge.name} Firebase App already initialized with different options${mt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new de(Ge)}const W=(be,...Ne)=>{(0,_.X6Q)()&&typeof console<"u"&&console[be](...Ne)},Y={provide:de,useFactory:G,deps:[ge,_.R0b,[new _.FiY,ue]]};let ke=(()=>{class be{constructor(Ue){X.Z.registerVersion("angularfire",V.q4.full,"core"),X.Z.registerVersion("angularfire",V.q4.full,"app-compat"),X.Z.registerVersion("angular",_.q4F.full,Ue.toString())}static initializeApp(Ue,Ae){return{ngModule:be,providers:[{provide:ge,useValue:Ue},{provide:ue,useValue:Ae}]}}}return be.\u0275fac=function(Ue){return new(Ue||be)(_.LFG(_.Lbi))},be.\u0275mod=_.oAB({type:be}),be.\u0275inj=_.cJS({providers:[Y]}),be})();function ve(be,Ne,Ue,Ae,Ie){const[,Re,Ge]=globalThis.\u0275AngularfireInstanceCache.find(Se=>Se[0]===be)||[];if(Re)return function Ze(be,Ne){try{return be.toString()===Ne.toString()}catch{return be===Ne}}(Ie,Ge)||(pe("error",`${Ne} was already initialized on the ${Ue} Firebase App with different settings.${rt?" You may need to reload as Firebase is not HMR aware.":""}`),pe("warn",{is:Ie,was:Ge})),Re;{const Se=Ae();return globalThis.\u0275AngularfireInstanceCache.push([be,Se,Ie]),Se}}const rt=!!mt.hot,pe=(be,...Ne)=>{(0,_.X6Q)()&&typeof console<"u"&&console[be](...Ne)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},462:(mt,De,P)=>{P.d(De,{q4:()=>Wd,iC:()=>Bu,fc:()=>Vu,HU:()=>aa,vb:()=>sa,JM:()=>el,nk:()=>Jc});var _=P(4650),X=P(259),V=P(5861),te=P(9681),ae=P(2090),ne=P(4859),de=P(1877);P(2833);const ue="@firebase/remote-config",G="0.4.4",ve=new ae.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class _e{constructor(k,z,oe,Oe){this.client=k,this.storage=z,this.storageCache=oe,this.logger=Oe}isCachedDataFresh(k,z){if(!z)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const oe=Date.now()-z,Oe=oe<=k;return this.logger.debug(`Config fetch cache check. Cache age millis: ${oe}. Cache max age millis (minimumFetchIntervalMillis setting): ${k}. Is cache hit: ${Oe}.`),Oe}fetch(k){var z=this;return(0,V.Z)(function*(){const[oe,Oe]=yield Promise.all([z.storage.getLastSuccessfulFetchTimestampMillis(),z.storage.getLastSuccessfulFetchResponse()]);if(Oe&&z.isCachedDataFresh(k.cacheMaxAgeMillis,oe))return Oe;k.eTag=Oe&&Oe.eTag;const Be=yield z.client.fetch(k),xt=[z.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Be.status&&xt.push(z.storage.setLastSuccessfulFetchResponse(Be)),yield Promise.all(xt),Be})()}}function xe(O=navigator){return O.languages&&O.languages[0]||O.language}class Fe{constructor(k,z,oe,Oe,Be,xt){this.firebaseInstallations=k,this.sdkVersion=z,this.namespace=oe,this.projectId=Oe,this.apiKey=Be,this.appId=xt}fetch(k){var z=this;return(0,V.Z)(function*(){const[oe,Oe]=yield Promise.all([z.firebaseInstallations.getId(),z.firebaseInstallations.getToken()]),xt=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${z.projectId}/namespaces/${z.namespace}:fetch?key=${z.apiKey}`,jn={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":k.eTag||"*"},Cn={sdk_version:z.sdkVersion,app_instance_id:oe,app_instance_id_token:Oe,app_id:z.appId,language_code:xe()},sn={method:"POST",headers:jn,body:JSON.stringify(Cn)},Rn=fetch(xt,sn),Gt=new Promise((oi,Ns)=>{k.signal.addEventListener(()=>{const qa=new Error("The operation was aborted.");qa.name="AbortError",Ns(qa)})});let To;try{yield Promise.race([Rn,Gt]),To=yield Rn}catch(oi){let Ns="fetch-client-network";throw"AbortError"===oi?.name&&(Ns="fetch-timeout"),ve.create(Ns,{originalErrorMessage:oi?.message})}let Cr=To.status;const ua=To.headers.get("ETag")||void 0;let qs,Ft;if(200===To.status){let oi;try{oi=yield To.json()}catch(Ns){throw ve.create("fetch-client-parse",{originalErrorMessage:Ns?.message})}qs=oi.entries,Ft=oi.state}if("INSTANCE_STATE_UNSPECIFIED"===Ft?Cr=500:"NO_CHANGE"===Ft?Cr=304:("NO_TEMPLATE"===Ft||"EMPTY_CONFIG"===Ft)&&(qs={}),304!==Cr&&200!==Cr)throw ve.create("fetch-status",{httpStatus:Cr});return{status:Cr,eTag:ua,config:qs}})()}}class st{constructor(k,z){this.client=k,this.storage=z}fetch(k){var z=this;return(0,V.Z)(function*(){const oe=(yield z.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return z.attemptFetch(k,oe)})()}attemptFetch(k,{throttleEndTimeMillis:z,backoffCount:oe}){var Oe=this;return(0,V.Z)(function*(){yield function $e(O,k){return new Promise((z,oe)=>{const Oe=Math.max(k-Date.now(),0),Be=setTimeout(z,Oe);O.addEventListener(()=>{clearTimeout(Be),oe(ve.create("fetch-throttle",{throttleEndTimeMillis:k}))})})}(k.signal,z);try{const Be=yield Oe.client.fetch(k);return yield Oe.storage.deleteThrottleMetadata(),Be}catch(Be){if(!function et(O){if(!(O instanceof ae.ZR&&O.customData))return!1;const k=Number(O.customData.httpStatus);return 429===k||500===k||503===k||504===k}(Be))throw Be;const xt={throttleEndTimeMillis:Date.now()+(0,ae.$s)(oe),backoffCount:oe+1};return yield Oe.storage.setThrottleMetadata(xt),Oe.attemptFetch(k,xt)}})()}}class rn{constructor(k,z,oe,Oe,Be){this.app=k,this._client=z,this._storageCache=oe,this._storage=Oe,this._logger=Be,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Qe(O,k){const z=O.target.error||void 0;return ve.create(k,{originalErrorMessage:z&&z?.message})}const wt="app_namespace_store";class hn{constructor(k,z,oe,Oe=function Sn(){return new Promise((O,k)=>{try{const z=indexedDB.open("firebase_remote_config",1);z.onerror=oe=>{k(Qe(oe,"storage-open"))},z.onsuccess=oe=>{O(oe.target.result)},z.onupgradeneeded=oe=>{0===oe.oldVersion&&oe.target.result.createObjectStore(wt,{keyPath:"compositeKey"})}}catch(z){k(ve.create("storage-open",{originalErrorMessage:z?.message}))}})}()){this.appId=k,this.appName=z,this.namespace=oe,this.openDbPromise=Oe}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(k){return this.set("last_fetch_status",k)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(k){return this.set("last_successful_fetch_timestamp_millis",k)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(k){return this.set("last_successful_fetch_response",k)}getActiveConfig(){return this.get("active_config")}setActiveConfig(k){return this.set("active_config",k)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(k){return this.set("active_config_etag",k)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(k){return this.set("throttle_metadata",k)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(k){var z=this;return(0,V.Z)(function*(){const oe=yield z.openDbPromise;return new Promise((Oe,Be)=>{const jn=oe.transaction([wt],"readonly").objectStore(wt),Cn=z.createCompositeKey(k);try{const sn=jn.get(Cn);sn.onerror=Rn=>{Be(Qe(Rn,"storage-get"))},sn.onsuccess=Rn=>{const Gt=Rn.target.result;Oe(Gt?Gt.value:void 0)}}catch(sn){Be(ve.create("storage-get",{originalErrorMessage:sn?.message}))}})})()}set(k,z){var oe=this;return(0,V.Z)(function*(){const Oe=yield oe.openDbPromise;return new Promise((Be,xt)=>{const Cn=Oe.transaction([wt],"readwrite").objectStore(wt),sn=oe.createCompositeKey(k);try{const Rn=Cn.put({compositeKey:sn,value:z});Rn.onerror=Gt=>{xt(Qe(Gt,"storage-set"))},Rn.onsuccess=()=>{Be()}}catch(Rn){xt(ve.create("storage-set",{originalErrorMessage:Rn?.message}))}})})()}delete(k){var z=this;return(0,V.Z)(function*(){const oe=yield z.openDbPromise;return new Promise((Oe,Be)=>{const jn=oe.transaction([wt],"readwrite").objectStore(wt),Cn=z.createCompositeKey(k);try{const sn=jn.delete(Cn);sn.onerror=Rn=>{Be(Qe(Rn,"storage-delete"))},sn.onsuccess=()=>{Oe()}}catch(sn){Be(ve.create("storage-delete",{originalErrorMessage:sn?.message}))}})})()}createCompositeKey(k){return[this.appId,this.appName,this.namespace,k].join()}}class sr{constructor(k){this.storage=k}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var k=this;return(0,V.Z)(function*(){const z=k.storage.getLastFetchStatus(),oe=k.storage.getLastSuccessfulFetchTimestampMillis(),Oe=k.storage.getActiveConfig(),Be=yield z;Be&&(k.lastFetchStatus=Be);const xt=yield oe;xt&&(k.lastSuccessfulFetchTimestampMillis=xt);const jn=yield Oe;jn&&(k.activeConfig=jn)})()}setLastFetchStatus(k){return this.lastFetchStatus=k,this.storage.setLastFetchStatus(k)}setLastSuccessfulFetchTimestampMillis(k){return this.lastSuccessfulFetchTimestampMillis=k,this.storage.setLastSuccessfulFetchTimestampMillis(k)}setActiveConfig(k){return this.activeConfig=k,this.storage.setActiveConfig(k)}}function ii(){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,V.Z)(function*(){if(!(0,ae.hl)())return!1;try{return yield(0,ae.eu)()}catch{return!1}})).apply(this,arguments)}!function Nr(){(0,te._registerComponent)(new ne.wA("remote-config",function O(k,{instanceIdentifier:z}){const oe=k.getProvider("app").getImmediate(),Oe=k.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw ve.create("registration-window");if(!(0,ae.hl)())throw ve.create("indexed-db-unavailable");const{projectId:Be,apiKey:xt,appId:jn}=oe.options;if(!Be)throw ve.create("registration-project-id");if(!xt)throw ve.create("registration-api-key");if(!jn)throw ve.create("registration-app-id");const Cn=new hn(jn,oe.name,z=z||"firebase"),sn=new sr(Cn),Rn=new de.Yd(ue);Rn.logLevel=de.in.ERROR;const Gt=new Fe(Oe,te.SDK_VERSION,z,Be,xt,jn),To=new st(Gt,Cn),Cr=new _e(To,Cn,sn,Rn),ua=new rn(oe,Cr,sn,Cn,Rn);return function Ge(O){const k=(0,ae.m9)(O);k._initializePromise||(k._initializePromise=k._storageCache.loadFromStorage().then(()=>{k._isInitializationComplete=!0}))}(ua),ua},"PUBLIC").setMultipleInstances(!0)),(0,te.registerVersion)(ue,G),(0,te.registerVersion)(ue,G,"esm2017")}();var On=P(8766);const _t="/firebase-messaging-sw.js",Qr="/firebase-cloud-messaging-push-scope",Xr="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",_n="https://fcmregistrations.googleapis.com/v1",or="google.c.a.c_id",Ni="google.c.a.c_l",Rt="google.c.a.ts",yt="google.c.a.e";var Bn=(()=>{return(O=Bn||(Bn={})).PUSH_RECEIVED="push-received",O.NOTIFICATION_CLICKED="notification-clicked",Bn;var O})();function tn(O){const k=new Uint8Array(O);return btoa(String.fromCharCode(...k)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Hn(O){const z=(O+"=".repeat((4-O.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),oe=atob(z),Oe=new Uint8Array(oe.length);for(let Be=0;Be<oe.length;++Be)Oe[Be]=oe.charCodeAt(Be);return Oe}const Jn="fcm_token_details_db",er=5,Wi="fcm_token_object_Store";function Pr(){return Pr=(0,V.Z)(function*(O){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Be=>Be.name).includes(Jn))return null;let k=null;return(yield(0,On.X3)(Jn,er,{upgrade:(oe=(0,V.Z)(function*(Oe,Be,xt,jn){var Cn;if(Be<2||!Oe.objectStoreNames.contains(Wi))return;const sn=jn.objectStore(Wi),Rn=yield sn.index("fcmSenderId").get(O);if(yield sn.clear(),Rn)if(2===Be){const Gt=Rn;if(!Gt.auth||!Gt.p256dh||!Gt.endpoint)return;k={token:Gt.fcmToken,createTime:null!==(Cn=Gt.createTime)&&void 0!==Cn?Cn:Date.now(),subscriptionOptions:{auth:Gt.auth,p256dh:Gt.p256dh,endpoint:Gt.endpoint,swScope:Gt.swScope,vapidKey:"string"==typeof Gt.vapidKey?Gt.vapidKey:tn(Gt.vapidKey)}}}else if(3===Be){const Gt=Rn;k={token:Gt.fcmToken,createTime:Gt.createTime,subscriptionOptions:{auth:tn(Gt.auth),p256dh:tn(Gt.p256dh),endpoint:Gt.endpoint,swScope:Gt.swScope,vapidKey:tn(Gt.vapidKey)}}}else if(4===Be){const Gt=Rn;k={token:Gt.fcmToken,createTime:Gt.createTime,subscriptionOptions:{auth:tn(Gt.auth),p256dh:tn(Gt.p256dh),endpoint:Gt.endpoint,swScope:Gt.swScope,vapidKey:tn(Gt.vapidKey)}}}}),function(Be,xt,jn,Cn){return oe.apply(this,arguments)})})).close(),yield(0,On.Lj)(Jn),yield(0,On.Lj)("fcm_vapid_details_db"),yield(0,On.Lj)("undefined"),function Yt(O){if(!O||!O.subscriptionOptions)return!1;const{subscriptionOptions:k}=O;return"number"==typeof O.createTime&&O.createTime>0&&"string"==typeof O.token&&O.token.length>0&&"string"==typeof k.auth&&k.auth.length>0&&"string"==typeof k.p256dh&&k.p256dh.length>0&&"string"==typeof k.endpoint&&k.endpoint.length>0&&"string"==typeof k.swScope&&k.swScope.length>0&&"string"==typeof k.vapidKey&&k.vapidKey.length>0}(k)?k:null;var oe}),Pr.apply(this,arguments)}const yr="firebase-messaging-database",si=1,He="firebase-messaging-store";let Ce=null;function at(){return Ce||(Ce=(0,On.X3)(yr,si,{upgrade:(O,k)=>{0===k&&O.createObjectStore(He)}})),Ce}function Dt(O){return Lt.apply(this,arguments)}function Lt(){return Lt=(0,V.Z)(function*(O){const k=L(O),oe=yield(yield at()).transaction(He).objectStore(He).get(k);if(oe)return oe;{const Oe=yield function ln(O){return Pr.apply(this,arguments)}(O.appConfig.senderId);if(Oe)return yield Bt(O,Oe),Oe}}),Lt.apply(this,arguments)}function Bt(O,k){return Gn.apply(this,arguments)}function Gn(){return(Gn=(0,V.Z)(function*(O,k){const z=L(O),Oe=(yield at()).transaction(He,"readwrite");return yield Oe.objectStore(He).put(k,z),yield Oe.done,k})).apply(this,arguments)}function A(){return(A=(0,V.Z)(function*(O){const k=L(O),oe=(yield at()).transaction(He,"readwrite");yield oe.objectStore(He).delete(k),yield oe.done})).apply(this,arguments)}function L({appConfig:O}){return O.appId}const B=new ae.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function le(O,k){return Te.apply(this,arguments)}function Te(){return(Te=(0,V.Z)(function*(O,k){const z=yield An(O),oe=ar(k),Oe={method:"POST",headers:z,body:JSON.stringify(oe)};let Be;try{Be=yield(yield fetch(bt(O.appConfig),Oe)).json()}catch(xt){throw B.create("token-subscribe-failed",{errorInfo:xt?.toString()})}if(Be.error)throw B.create("token-subscribe-failed",{errorInfo:Be.error.message});if(!Be.token)throw B.create("token-subscribe-no-token");return Be.token})).apply(this,arguments)}function Pt(){return(Pt=(0,V.Z)(function*(O,k){const z=yield An(O),oe=ar(k.subscriptionOptions),Oe={method:"PATCH",headers:z,body:JSON.stringify(oe)};let Be;try{Be=yield(yield fetch(`${bt(O.appConfig)}/${k.token}`,Oe)).json()}catch(xt){throw B.create("token-update-failed",{errorInfo:xt?.toString()})}if(Be.error)throw B.create("token-update-failed",{errorInfo:Be.error.message});if(!Be.token)throw B.create("token-update-no-token");return Be.token})).apply(this,arguments)}function kt(O,k){return nn.apply(this,arguments)}function nn(){return(nn=(0,V.Z)(function*(O,k){const oe={method:"DELETE",headers:yield An(O)};try{const Be=yield(yield fetch(`${bt(O.appConfig)}/${k}`,oe)).json();if(Be.error)throw B.create("token-unsubscribe-failed",{errorInfo:Be.error.message})}catch(Oe){throw B.create("token-unsubscribe-failed",{errorInfo:Oe?.toString()})}})).apply(this,arguments)}function bt({projectId:O}){return`${_n}/projects/${O}/registrations`}function An(O){return Tr.apply(this,arguments)}function Tr(){return(Tr=(0,V.Z)(function*({appConfig:O,installations:k}){const z=yield k.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":O.apiKey,"x-goog-firebase-installations-auth":`FIS ${z}`})})).apply(this,arguments)}function ar({p256dh:O,auth:k,endpoint:z,vapidKey:oe}){const Oe={web:{endpoint:z,auth:k,p256dh:O}};return oe!==Xr&&(Oe.web.applicationPubKey=oe),Oe}const Yo=6048e5;function go(){return go=(0,V.Z)(function*(O){const k=yield function Qt(O,k){return $t.apply(this,arguments)}(O.swRegistration,O.vapidKey),z={vapidKey:O.vapidKey,swScope:O.swRegistration.scope,endpoint:k.endpoint,auth:tn(k.getKey("auth")),p256dh:tn(k.getKey("p256dh"))},oe=yield Dt(O.firebaseDependencies);if(oe){if(function Zn(O,k){return k.vapidKey===O.vapidKey&&k.endpoint===O.endpoint&&k.auth===O.auth&&k.p256dh===O.p256dh}(oe.subscriptionOptions,z))return Date.now()>=oe.createTime+Yo?function Z(O,k){return ye.apply(this,arguments)}(O,{token:oe.token,createTime:Date.now(),subscriptionOptions:z}):oe.token;try{yield kt(O.firebaseDependencies,oe.token)}catch(Oe){console.warn(Oe)}return Ve(O.firebaseDependencies,z)}return Ve(O.firebaseDependencies,z)}),go.apply(this,arguments)}function Xo(){return Xo=(0,V.Z)(function*(O){const k=yield Dt(O.firebaseDependencies);k&&(yield kt(O.firebaseDependencies,k.token),yield function H(O){return A.apply(this,arguments)}(O.firebaseDependencies));const z=yield O.swRegistration.pushManager.getSubscription();return!z||z.unsubscribe()}),Xo.apply(this,arguments)}function ye(){return ye=(0,V.Z)(function*(O,k){try{const z=yield function lt(O,k){return Pt.apply(this,arguments)}(O.firebaseDependencies,k),oe=Object.assign(Object.assign({},k),{token:z,createTime:Date.now()});return yield Bt(O.firebaseDependencies,oe),z}catch(z){throw yield function mo(O){return Xo.apply(this,arguments)}(O),z}}),ye.apply(this,arguments)}function Ve(O,k){return qe.apply(this,arguments)}function qe(){return(qe=(0,V.Z)(function*(O,k){const oe={token:yield le(O,k),createTime:Date.now(),subscriptionOptions:k};return yield Bt(O,oe),oe.token})).apply(this,arguments)}function $t(){return($t=(0,V.Z)(function*(O,k){return(yield O.pushManager.getSubscription())||O.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Hn(k)})})).apply(this,arguments)}function fn(O){const k={from:O.from,collapseKey:O.collapse_key,messageId:O.fcmMessageId};return function qi(O,k){if(!k.notification)return;O.notification={};const z=k.notification.title;z&&(O.notification.title=z);const oe=k.notification.body;oe&&(O.notification.body=oe);const Oe=k.notification.image;Oe&&(O.notification.image=Oe);const Be=k.notification.icon;Be&&(O.notification.icon=Be)}(k,O),function kr(O,k){k.data&&(O.data=k.data)}(k,O),function cs(O,k){var z,oe,Oe,Be,xt;if(!(k.fcmOptions||null!==(z=k.notification)&&void 0!==z&&z.click_action))return;O.fcmOptions={};const jn=null!==(Oe=null===(oe=k.fcmOptions)||void 0===oe?void 0:oe.link)&&void 0!==Oe?Oe:null===(Be=k.notification)||void 0===Be?void 0:Be.click_action;jn&&(O.fcmOptions.link=jn);const Cn=null===(xt=k.fcmOptions)||void 0===xt?void 0:xt.analytics_label;Cn&&(O.fcmOptions.analyticsLabel=Cn)}(k,O),k}function ct(O,k){const z=[];for(let oe=0;oe<O.length;oe++)z.push(O.charAt(oe)),oe<k.length&&z.push(k.charAt(oe));return z.join("")}function Ln(O){return B.create("missing-app-config-values",{valueName:O})}ct("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),ct("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Jr{constructor(k,z,oe){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Oe=function Ht(O){if(!O||!O.options)throw Ln("App Configuration Object");if(!O.name)throw Ln("App Name");const k=["projectId","apiKey","appId","messagingSenderId"],{options:z}=O;for(const oe of k)if(!z[oe])throw Ln(oe);return{appName:O.name,projectId:z.projectId,apiKey:z.apiKey,appId:z.appId,senderId:z.messagingSenderId}}(k);this.firebaseDependencies={app:k,appConfig:Oe,installations:z,analyticsProvider:oe}}_delete(){return Promise.resolve()}}function Pi(O){return tr.apply(this,arguments)}function tr(){return(tr=(0,V.Z)(function*(O){try{O.swRegistration=yield navigator.serviceWorker.register(_t,{scope:Qr}),O.swRegistration.update().catch(()=>{})}catch(k){throw B.create("failed-service-worker-registration",{browserErrorMessage:k?.message})}})).apply(this,arguments)}function Fn(){return(Fn=(0,V.Z)(function*(O,k){if(!k&&!O.swRegistration&&(yield Pi(O)),k||!O.swRegistration){if(!(k instanceof ServiceWorkerRegistration))throw B.create("invalid-sw-registration");O.swRegistration=k}})).apply(this,arguments)}function Ss(){return(Ss=(0,V.Z)(function*(O,k){k?O.vapidKey=k:O.vapidKey||(O.vapidKey=Xr)})).apply(this,arguments)}function ls(){return ls=(0,V.Z)(function*(O,k){if(!navigator)throw B.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw B.create("permission-blocked");return yield function Jo(O,k){return Ss.apply(this,arguments)}(O,k?.vapidKey),yield function zs(O,k){return Fn.apply(this,arguments)}(O,k?.serviceWorkerRegistration),function Qo(O){return go.apply(this,arguments)}(O)}),ls.apply(this,arguments)}function _o(){return(_o=(0,V.Z)(function*(O,k,z){const oe=function yo(O){switch(O){case Bn.NOTIFICATION_CLICKED:return"notification_open";case Bn.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(k);(yield O.firebaseDependencies.analyticsProvider.get()).logEvent(oe,{message_id:z[or],message_name:z[Ni],message_time:z[Rt],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function As(){return As=(0,V.Z)(function*(O,k){const z=k.data;if(!z.isFirebaseMessaging)return;O.onMessageHandler&&z.messageType===Bn.PUSH_RECEIVED&&("function"==typeof O.onMessageHandler?O.onMessageHandler(fn(z)):O.onMessageHandler.next(fn(z)));const oe=z.data;(function pi(O){return"object"==typeof O&&!!O&&or in O})(oe)&&"1"===oe[yt]&&(yield function Ws(O,k,z){return _o.apply(this,arguments)}(O,z.messageType,oe))}),As.apply(this,arguments)}const Rs="@firebase/messaging",gi=O=>{const k=new Jr(O.getProvider("app").getImmediate(),O.getProvider("installations-internal").getImmediate(),O.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",z=>function br(O,k){return As.apply(this,arguments)}(k,z)),k},Lu=O=>{const k=O.getProvider("messaging").getImmediate();return{getToken:oe=>function Kt(O,k){return ls.apply(this,arguments)}(k,oe)}};function Ki(){return ea.apply(this,arguments)}function ea(){return(ea=(0,V.Z)(function*(){try{yield(0,ae.eu)()}catch{return!1}return typeof window<"u"&&(0,ae.hl)()&&(0,ae.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function dn(){(0,te._registerComponent)(new ne.wA("messaging",gi,"PUBLIC")),(0,te._registerComponent)(new ne.wA("messaging-internal",Lu,"PRIVATE")),(0,te.registerVersion)(Rs,"0.12.4"),(0,te.registerVersion)(Rs,"0.12.4","esm2017")}();var ds=P(5132),na=P(4408),Hr=P(7565);const Zc=new class vp extends Hr.v{}(class Ha extends na.o{constructor(k,z){super(k,z),this.scheduler=k,this.work=z}schedule(k,z=0){return z>0?super.schedule(k,z):(this.delay=z,this.state=k,this.scheduler.flush(this),this)}execute(k,z){return z>0||this.closed?super.execute(k,z):this._execute(k,z)}requestAsyncId(k,z,oe=0){return null!=oe&&oe>0||null==oe&&this.delay>0?super.requestAsyncId(k,z,oe):(k.flush(this),0)}});var Eo=P(4986),ra=P(8505),Fu=P(5363),zd=P(9468);const Wd=new _.GfV("7.5.0"),Yc="__angularfire_symbol__analyticsIsSupportedValue",hs="__angularfire_symbol__analyticsIsSupported",Ga="__angularfire_symbol__remoteConfigIsSupportedValue",za="__angularfire_symbol__remoteConfigIsSupported",Qc="__angularfire_symbol__messagingIsSupportedValue",Uu="__angularfire_symbol__messagingIsSupported";globalThis[hs]||(globalThis[hs]=(0,ds.Gb)().then(O=>globalThis[Yc]=O).catch(()=>globalThis[Yc]=!1)),globalThis[Uu]||(globalThis[Uu]=Ki().then(O=>globalThis[Qc]=O).catch(()=>globalThis[Qc]=!1)),globalThis[za]||(globalThis[za]=ii().then(O=>globalThis[Ga]=O).catch(()=>globalThis[Ga]=!1));const Jc={async:()=>globalThis[hs],sync:()=>{const O=globalThis[Yc];if(void 0===O)throw new Error((O=>`The APP_INITIALIZER that is "making" isSupported() sync for the sake of convenient DI has not resolved in this\ncontext. Rather than injecting ${O} in the constructor, first ensure that ${O} is supported by calling\n\`await isSupported()\`, then retrieve the instance from the injector manually \`injector.get(${O})\`.`)("Analytics"));return O}};function el(O,k,z){if(k){if(1===k.length)return k[0];const Be=k.filter(xt=>xt.app===z);if(1===Be.length)return Be[0]}return z.container.getProvider(O).getImmediate({optional:!0})}const sa=(O,k)=>{const z=k?[k]:(0,X.C6)(),oe=[];return z.forEach(Oe=>{Oe.container.getProvider(O).instances.forEach(xt=>{oe.includes(xt)||oe.push(xt)})}),oe};function oa(){}class Ms{constructor(k,z=Zc){this.zone=k,this.delegate=z}now(){return this.delegate.now()}schedule(k,z,oe){const Oe=this.zone;return this.delegate.schedule(function(xt){Oe.runGuarded(()=>{k.apply(this,[xt])})},z,oe)}}class wp{constructor(k){this.zone=k,this.task=null}call(k,z){const oe=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",oa,{},oa,oa)),z.pipe((0,ra.b)({next:oe,complete:oe,error:oe})).subscribe(k).add(oe)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let aa=(()=>{class O{constructor(z){this.ngZone=z,this.outsideAngular=z.runOutsideAngular(()=>new Ms(Zone.current)),this.insideAngular=z.run(()=>new Ms(Zone.current,Eo.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return O.\u0275fac=function(z){return new(z||O)(_.LFG(_.R0b))},O.\u0275prov=_.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})();function Yi(){const O=globalThis.\u0275AngularFireScheduler;if(!O)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return O}function Vu(O){return O.pipe((0,Fu.Q)(Yi().outsideAngular))}function Bu(O){return Yi(),function Io(O){return function(z){return(z=z.lift(new wp(O.ngZone))).pipe((0,zd.R)(O.outsideAngular),(0,Fu.Q)(O.insideAngular))}}(Yi())(O)}},2090:(mt,De,P)=>{P.d(De,{$s:()=>Dt,BH:()=>Re,DV:()=>Kn,Dv:()=>Hn,G6:()=>xe,GJ:()=>Nr,L:()=>ue,LL:()=>Tt,Pz:()=>Ie,Sg:()=>Ge,UG:()=>we,UI:()=>Tn,US:()=>ne,Wj:()=>Wi,Wl:()=>kn,Yr:()=>_e,ZB:()=>Y,ZR:()=>vn,aH:()=>Ae,b$:()=>gt,cI:()=>wt,dS:()=>Pr,eu:()=>$e,g5:()=>V,gK:()=>Jn,gQ:()=>Ni,h$:()=>ge,hl:()=>Fe,hu:()=>X,jU:()=>We,lb:()=>ln,m9:()=>Gn,ne:()=>Rt,p$:()=>W,pd:()=>or,r3:()=>Yr,ru:()=>Ye,tV:()=>G,uI:()=>j,ug:()=>Yt,vZ:()=>On,w1:()=>re,w9:()=>sr,xO:()=>Xr,xb:()=>ii,z$:()=>Se,zI:()=>et,zd:()=>_n});const _={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},X=function(H,A){if(!H)throw V(A)},V=function(H){return new Error("Firebase Database ("+_.SDK_VERSION+") INTERNAL ASSERT FAILED: "+H)},te=function(H){const A=[];let L=0;for(let q=0;q<H.length;q++){let B=H.charCodeAt(q);B<128?A[L++]=B:B<2048?(A[L++]=B>>6|192,A[L++]=63&B|128):55296==(64512&B)&&q+1<H.length&&56320==(64512&H.charCodeAt(q+1))?(B=65536+((1023&B)<<10)+(1023&H.charCodeAt(++q)),A[L++]=B>>18|240,A[L++]=B>>12&63|128,A[L++]=B>>6&63|128,A[L++]=63&B|128):(A[L++]=B>>12|224,A[L++]=B>>6&63|128,A[L++]=63&B|128)}return A},ne={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(H,A){if(!Array.isArray(H))throw Error("encodeByteArray takes an array as a parameter");this.init_();const L=A?this.byteToCharMapWebSafe_:this.byteToCharMap_,q=[];for(let B=0;B<H.length;B+=3){const le=H[B],Te=B+1<H.length,lt=Te?H[B+1]:0,Pt=B+2<H.length,kt=Pt?H[B+2]:0;let An=(15&lt)<<2|kt>>6,Tr=63&kt;Pt||(Tr=64,Te||(An=64)),q.push(L[le>>2],L[(3&le)<<4|lt>>4],L[An],L[Tr])}return q.join("")},encodeString(H,A){return this.HAS_NATIVE_SUPPORT&&!A?btoa(H):this.encodeByteArray(te(H),A)},decodeString(H,A){return this.HAS_NATIVE_SUPPORT&&!A?atob(H):function(H){const A=[];let L=0,q=0;for(;L<H.length;){const B=H[L++];if(B<128)A[q++]=String.fromCharCode(B);else if(B>191&&B<224){const le=H[L++];A[q++]=String.fromCharCode((31&B)<<6|63&le)}else if(B>239&&B<365){const Pt=((7&B)<<18|(63&H[L++])<<12|(63&H[L++])<<6|63&H[L++])-65536;A[q++]=String.fromCharCode(55296+(Pt>>10)),A[q++]=String.fromCharCode(56320+(1023&Pt))}else{const le=H[L++],Te=H[L++];A[q++]=String.fromCharCode((15&B)<<12|(63&le)<<6|63&Te)}}return A.join("")}(this.decodeStringToByteArray(H,A))},decodeStringToByteArray(H,A){this.init_();const L=A?this.charToByteMapWebSafe_:this.charToByteMap_,q=[];for(let B=0;B<H.length;){const le=L[H.charAt(B++)],lt=B<H.length?L[H.charAt(B)]:0;++B;const kt=B<H.length?L[H.charAt(B)]:64;++B;const bt=B<H.length?L[H.charAt(B)]:64;if(++B,null==le||null==lt||null==kt||null==bt)throw new de;q.push(le<<2|lt>>4),64!==kt&&(q.push(lt<<4&240|kt>>2),64!==bt&&q.push(kt<<6&192|bt))}return q},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let H=0;H<this.ENCODED_VALS.length;H++)this.byteToCharMap_[H]=this.ENCODED_VALS.charAt(H),this.charToByteMap_[this.byteToCharMap_[H]]=H,this.byteToCharMapWebSafe_[H]=this.ENCODED_VALS_WEBSAFE.charAt(H),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[H]]=H,H>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(H)]=H,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(H)]=H)}}};class de extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ge=function(H){const A=te(H);return ne.encodeByteArray(A,!0)},ue=function(H){return ge(H).replace(/\./g,"")},G=function(H){try{return ne.decodeString(H,!0)}catch(A){console.error("base64Decode failed: ",A)}return null};function W(H){return Y(void 0,H)}function Y(H,A){if(!(A instanceof Object))return A;switch(A.constructor){case Date:return new Date(A.getTime());case Object:void 0===H&&(H={});break;case Array:H=[];break;default:return A}for(const L in A)!A.hasOwnProperty(L)||!ke(L)||(H[L]=Y(H[L],A[L]));return H}function ke(H){return"__proto__"!==H}const be=()=>{try{return function ve(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const H=process.env.__FIREBASE_DEFAULTS__;return H?JSON.parse(H):void 0})()||(()=>{if(typeof document>"u")return;let H;try{H=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const A=H&&G(H[1]);return A&&JSON.parse(A)})()}catch(H){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${H}`)}},Ae=()=>{var H;return null===(H=be())||void 0===H?void 0:H.config},Ie=H=>{var A;return null===(A=be())||void 0===A?void 0:A[`_${H}`]};class Re{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((A,L)=>{this.resolve=A,this.reject=L})}wrapCallback(A){return(L,q)=>{L?this.reject(L):this.resolve(q),"function"==typeof A&&(this.promise.catch(()=>{}),1===A.length?A(L):A(L,q))}}}function Ge(H,A){if(H.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const q=A||"demo-project",B=H.iat||0,le=H.sub||H.user_id;if(!le)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Te=Object.assign({iss:`https://securetoken.google.com/${q}`,aud:q,iat:B,exp:B+3600,auth_time:B,sub:le,user_id:le,firebase:{sign_in_provider:"custom",identities:{}}},H);return[ue(JSON.stringify({alg:"none",type:"JWT"})),ue(JSON.stringify(Te)),""].join(".")}function Se(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function j(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Se())}function we(){var H;const A=null===(H=be())||void 0===H?void 0:H.forceEnvironment;if("node"===A)return!0;if("browser"===A)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function We(){return"object"==typeof self&&self.self===self}function Ye(){const H="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof H&&void 0!==H.id}function gt(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function re(){const H=Se();return H.indexOf("MSIE ")>=0||H.indexOf("Trident/")>=0}function _e(){return!0===_.NODE_CLIENT||!0===_.NODE_ADMIN}function xe(){return!we()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fe(){try{return"object"==typeof indexedDB}catch{return!1}}function $e(){return new Promise((H,A)=>{try{let L=!0;const q="validate-browser-context-for-indexeddb-analytics-module",B=self.indexedDB.open(q);B.onsuccess=()=>{B.result.close(),L||self.indexedDB.deleteDatabase(q),H(!0)},B.onupgradeneeded=()=>{L=!1},B.onerror=()=>{var le;A((null===(le=B.error)||void 0===le?void 0:le.message)||"")}}catch(L){A(L)}})}function et(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class vn extends Error{constructor(A,L,q){super(L),this.code=A,this.customData=q,this.name="FirebaseError",Object.setPrototypeOf(this,vn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tt.prototype.create)}}class Tt{constructor(A,L,q){this.service=A,this.serviceName=L,this.errors=q}create(A,...L){const q=L[0]||{},B=`${this.service}/${A}`,le=this.errors[A],Te=le?function rn(H,A){return H.replace(Qe,(L,q)=>{const B=A[q];return null!=B?String(B):`<${q}?>`})}(le,q):"Error";return new vn(B,`${this.serviceName}: ${Te} (${B}).`,q)}}const Qe=/\{\$([^}]+)}/g;function wt(H){return JSON.parse(H)}function kn(H){return JSON.stringify(H)}const Dn=function(H){let A={},L={},q={},B="";try{const le=H.split(".");A=wt(G(le[0])||""),L=wt(G(le[1])||""),B=le[2],q=L.d||{},delete L.d}catch{}return{header:A,claims:L,data:q,signature:B}},sr=function(H){const L=Dn(H).claims;return!!L&&"object"==typeof L&&L.hasOwnProperty("iat")},Nr=function(H){const A=Dn(H).claims;return"object"==typeof A&&!0===A.admin};function Yr(H,A){return Object.prototype.hasOwnProperty.call(H,A)}function Kn(H,A){if(Object.prototype.hasOwnProperty.call(H,A))return H[A]}function ii(H){for(const A in H)if(Object.prototype.hasOwnProperty.call(H,A))return!1;return!0}function Tn(H,A,L){const q={};for(const B in H)Object.prototype.hasOwnProperty.call(H,B)&&(q[B]=A.call(L,H[B],B,H));return q}function On(H,A){if(H===A)return!0;const L=Object.keys(H),q=Object.keys(A);for(const B of L){if(!q.includes(B))return!1;const le=H[B],Te=A[B];if(_t(le)&&_t(Te)){if(!On(le,Te))return!1}else if(le!==Te)return!1}for(const B of q)if(!L.includes(B))return!1;return!0}function _t(H){return null!==H&&"object"==typeof H}function Xr(H){const A=[];for(const[L,q]of Object.entries(H))Array.isArray(q)?q.forEach(B=>{A.push(encodeURIComponent(L)+"="+encodeURIComponent(B))}):A.push(encodeURIComponent(L)+"="+encodeURIComponent(q));return A.length?"&"+A.join("&"):""}function _n(H){const A={};return H.replace(/^\?/,"").split("&").forEach(q=>{if(q){const[B,le]=q.split("=");A[decodeURIComponent(B)]=decodeURIComponent(le)}}),A}function or(H){const A=H.indexOf("?");if(!A)return"";const L=H.indexOf("#",A);return H.substring(A,L>0?L:void 0)}class Ni{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let A=1;A<this.blockSize;++A)this.pad_[A]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(A,L){L||(L=0);const q=this.W_;if("string"==typeof A)for(let bt=0;bt<16;bt++)q[bt]=A.charCodeAt(L)<<24|A.charCodeAt(L+1)<<16|A.charCodeAt(L+2)<<8|A.charCodeAt(L+3),L+=4;else for(let bt=0;bt<16;bt++)q[bt]=A[L]<<24|A[L+1]<<16|A[L+2]<<8|A[L+3],L+=4;for(let bt=16;bt<80;bt++){const An=q[bt-3]^q[bt-8]^q[bt-14]^q[bt-16];q[bt]=4294967295&(An<<1|An>>>31)}let kt,nn,B=this.chain_[0],le=this.chain_[1],Te=this.chain_[2],lt=this.chain_[3],Pt=this.chain_[4];for(let bt=0;bt<80;bt++){bt<40?bt<20?(kt=lt^le&(Te^lt),nn=1518500249):(kt=le^Te^lt,nn=1859775393):bt<60?(kt=le&Te|lt&(le|Te),nn=2400959708):(kt=le^Te^lt,nn=3395469782);const An=(B<<5|B>>>27)+kt+Pt+nn+q[bt]&4294967295;Pt=lt,lt=Te,Te=4294967295&(le<<30|le>>>2),le=B,B=An}this.chain_[0]=this.chain_[0]+B&4294967295,this.chain_[1]=this.chain_[1]+le&4294967295,this.chain_[2]=this.chain_[2]+Te&4294967295,this.chain_[3]=this.chain_[3]+lt&4294967295,this.chain_[4]=this.chain_[4]+Pt&4294967295}update(A,L){if(null==A)return;void 0===L&&(L=A.length);const q=L-this.blockSize;let B=0;const le=this.buf_;let Te=this.inbuf_;for(;B<L;){if(0===Te)for(;B<=q;)this.compress_(A,B),B+=this.blockSize;if("string"==typeof A){for(;B<L;)if(le[Te]=A.charCodeAt(B),++Te,++B,Te===this.blockSize){this.compress_(le),Te=0;break}}else for(;B<L;)if(le[Te]=A[B],++Te,++B,Te===this.blockSize){this.compress_(le),Te=0;break}}this.inbuf_=Te,this.total_+=L}digest(){const A=[];let L=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let B=this.blockSize-1;B>=56;B--)this.buf_[B]=255&L,L/=256;this.compress_(this.buf_);let q=0;for(let B=0;B<5;B++)for(let le=24;le>=0;le-=8)A[q]=this.chain_[B]>>le&255,++q;return A}}function Rt(H,A){const L=new yt(H,A);return L.subscribe.bind(L)}class yt{constructor(A,L){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=L,this.task.then(()=>{A(this)}).catch(q=>{this.error(q)})}next(A){this.forEachObserver(L=>{L.next(A)})}error(A){this.forEachObserver(L=>{L.error(A)}),this.close(A)}complete(){this.forEachObserver(A=>{A.complete()}),this.close()}subscribe(A,L,q){let B;if(void 0===A&&void 0===L&&void 0===q)throw new Error("Missing Observer.");B=function Bn(H,A){if("object"!=typeof H||null===H)return!1;for(const L of A)if(L in H&&"function"==typeof H[L])return!0;return!1}(A,["next","error","complete"])?A:{next:A,error:L,complete:q},void 0===B.next&&(B.next=tn),void 0===B.error&&(B.error=tn),void 0===B.complete&&(B.complete=tn);const le=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?B.error(this.finalError):B.complete()}catch{}}),this.observers.push(B),le}unsubscribeOne(A){void 0===this.observers||void 0===this.observers[A]||(delete this.observers[A],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(A){if(!this.finalized)for(let L=0;L<this.observers.length;L++)this.sendOne(L,A)}sendOne(A,L){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[A])try{L(this.observers[A])}catch(q){typeof console<"u"&&console.error&&console.error(q)}})}close(A){this.finalized||(this.finalized=!0,void 0!==A&&(this.finalError=A),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tn(){}const Hn=function(H,A,L,q){let B;if(q<A?B="at least "+A:q>L&&(B=0===L?"none":"no more than "+L),B)throw new Error(H+" failed: Was called with "+q+(1===q?" argument.":" arguments.")+" Expects "+B+".")};function Jn(H,A){return`${H} failed: ${A} argument `}function Wi(H,A,L,q){if((!q||L)&&"function"!=typeof L)throw new Error(Jn(H,A)+"must be a valid function.")}function ln(H,A,L,q){if((!q||L)&&("object"!=typeof L||null===L))throw new Error(Jn(H,A)+"must be a valid context object.")}const Pr=function(H){const A=[];let L=0;for(let q=0;q<H.length;q++){let B=H.charCodeAt(q);if(B>=55296&&B<=56319){const le=B-55296;q++,X(q<H.length,"Surrogate pair missing trail surrogate."),B=65536+(le<<10)+(H.charCodeAt(q)-56320)}B<128?A[L++]=B:B<2048?(A[L++]=B>>6|192,A[L++]=63&B|128):B<65536?(A[L++]=B>>12|224,A[L++]=B>>6&63|128,A[L++]=63&B|128):(A[L++]=B>>18|240,A[L++]=B>>12&63|128,A[L++]=B>>6&63|128,A[L++]=63&B|128)}return A},Yt=function(H){let A=0;for(let L=0;L<H.length;L++){const q=H.charCodeAt(L);q<128?A++:q<2048?A+=2:q>=55296&&q<=56319?(A+=4,L++):A+=3}return A},si=1e3,He=2,Ce=144e5,at=.5;function Dt(H,A=si,L=He){const q=A*Math.pow(L,H),B=Math.round(at*q*(Math.random()-.5)*2);return Math.min(Ce,q+B)}function Gn(H){return H&&H._delegate?H._delegate:H}},2218:(mt,De,P)=>{var _=P(4650);let X=null;function V(){return X}class ae{}const ne=new _.OlP("DocumentToken");let de=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return function ge(){return(0,_.LFG)(G)}()},providedIn:"platform"}),n})();const ue=new _.OlP("Location Initialized");let G=(()=>{class n extends de{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return V().getBaseHref(this._doc)}onPopState(t){const r=V().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=V().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){W()?this._history.pushState(t,r,i):this._location.hash=i}replaceState(t,r,i){W()?this._history.replaceState(t,r,i):this._location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ne))},n.\u0275prov=_.Yz7({token:n,factory:function(){return function Y(){return new G((0,_.LFG)(ne))}()},providedIn:"platform"}),n})();function W(){return!!window.history.pushState}function ke(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function ve(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Ze(n){return n&&"?"!==n[0]?"?"+n:n}let rt=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(be)},providedIn:"root"}),n})();const pe=new _.OlP("appBaseHref");let be=(()=>{class n extends rt{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??(0,_.f3M)(ne).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ke(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Ze(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const c=this.prepareExternalUrl(i+Ze(a));this._platformLocation.pushState(t,r,c)}replaceState(t,r,i,a){const c=this.prepareExternalUrl(i+Ze(a));this._platformLocation.replaceState(t,r,c)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(de),_.LFG(pe,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ne=(()=>{class n extends rt{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=ke(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let c=this.prepareExternalUrl(i+Ze(a));0==c.length&&(c=this._platformLocation.pathname),this._platformLocation.pushState(t,r,c)}replaceState(t,r,i,a){let c=this.prepareExternalUrl(i+Ze(a));0==c.length&&(c=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,c)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(de),_.LFG(pe,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Ue=(()=>{class n{constructor(t){this._subject=new _.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function Ge(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(ve(Re(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Ze(r))}normalize(t){return n.stripTrailingSlash(function Ie(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,Re(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ze(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ze(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=Ze,n.joinWithSlash=ke,n.stripTrailingSlash=ve,n.\u0275fac=function(t){return new(t||n)(_.LFG(rt))},n.\u0275prov=_.Yz7({token:n,factory:function(){return function Ae(){return new Ue((0,_.LFG)(rt))}()},providedIn:"root"}),n})();function Re(n){return n.replace(/\/index.html$/,"")}let Jo=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new Ss,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Kt("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Kt("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.s_b),_.Y36(_.Rgc))},n.\u0275dir=_.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class Ss{constructor(){this.$implicit=null,this.ngIf=null}}function Kt(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,_.AaK)(e)}'.`)}let Uu=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})();const ia="browser",Zi="server";function sa(n){return n===Zi}let aa=(()=>{class n{}return n.\u0275prov=(0,_.Yz7)({token:n,providedIn:"root",factory:()=>new Yi((0,_.LFG)(ne),window)}),n})();class Yi{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Qi(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const c=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(c)return c}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Wa(this.window.history)||Wa(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Wa(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class da extends ae{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ka extends da{static makeCurrent(){!function te(n){X||(X=n)}(new Ka)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function O_(){return Za=Za||document.querySelector("base"),Za?Za.getAttribute("href"):null}();return null==t?null:function ol(n){Ys=Ys||document.createElement("a"),Ys.setAttribute("href",n);const e=Ys.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Za=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function kr(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Ys,Za=null;const $u=new _.OlP("TRANSITION_ID"),ks=[{provide:_.ip1,useFactory:function ZC(n,e,t){return()=>{t.get(_.CZH).donePromise.then(()=>{const r=V(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[$u,ne,_.zs3],multi:!0}];let L_=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const Co=new _.OlP("EventManagerPlugins");let Qd=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const c=i[a];if(c.supports(t))return this._eventNameToPlugin.set(t,c),c}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Co),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class Dr{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=V().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let al=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)0===this.changeUsageCount(r,-1)&&this.onStyleRemoved(r)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,r){const i=this.usageCount;let a=i.get(t)??0;return a+=r,a>0?i.set(t,a):i.delete(t),a}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Do=(()=>{class n extends al{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.forEach(a=>a.remove()),r.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,r){const i=this.doc.createElement("style");i.textContent=r,t.appendChild(i);const a=this.styleRef.get(r);a?a.push(i):this.styleRef.set(r,[i])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ne))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const ul={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Qs=/%COMP%/g,Gu=new _.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function th(n,e){return e.flat(100).map(t=>t.replace(Qs,n))}function zu(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let cl=(()=>{class n{constructor(t,r,i,a){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestory=a,this.rendererByCompId=new Map,this.defaultRenderer=new vi(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;const i=this.getOrCreateRenderer(t,r);return i instanceof nh?i.applyToHost(t):i instanceof qu&&i.applyStyles(),i}getOrCreateRenderer(t,r){const i=this.rendererByCompId;let a=i.get(r.id);if(!a){const c=this.eventManager,h=this.sharedStylesHost,m=this.removeStylesOnCompDestory;switch(r.encapsulation){case _.ifc.Emulated:a=new nh(c,h,r,this.appId,m);break;case _.ifc.ShadowDom:return new xp(c,h,t,r);default:a=new qu(c,h,r,m)}a.onDestroy=()=>i.delete(r.id),i.set(r.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Qd),_.LFG(Do),_.LFG(_.AFp),_.LFG(Gu))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class vi{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(ul[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(Wu(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Wu(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=ul[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=ul[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(_.JOm.DashCase|_.JOm.Important)?e.style.setProperty(t,r,i&_.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&_.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,zu(r)):this.eventManager.addEventListener(e,t,zu(r))}}function Wu(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class xp extends vi{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=th(i.id,i.styles);for(const c of a){const h=document.createElement("style");h.textContent=c,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class qu extends vi{constructor(e,t,r,i,a=r.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=i,this.rendererUsageCount=0,this.styles=th(a,r.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class nh extends qu{constructor(e,t,r,i,a){const c=i+"-"+r.id;super(e,t,r,a,c),this.contentAttr=function So(n){return"_ngcontent-%COMP%".replace(Qs,n)}(c),this.hostAttr=function eh(n){return"_nghost-%COMP%".replace(Qs,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}let Ya=(()=>{class n extends Dr{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ne))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const rh=["alt","control","meta","shift"],Mp={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Np={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let ll=(()=>{class n extends Dr{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),c=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>V().onAndCancel(t,a.domEventName,c))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let c="",h=r.indexOf("code");if(h>-1&&(r.splice(h,1),c="code."),rh.forEach(w=>{const T=r.indexOf(w);T>-1&&(r.splice(T,1),c+=w+".")}),c+=a,0!=r.length||0===a.length)return null;const m={};return m.domEventName=i,m.fullKey=c,m}static matchEventFullKeyCode(t,r){let i=Mp[t.key]||t.key,a="";return r.indexOf("code.")>-1&&(i=t.code,a="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),rh.forEach(c=>{c!==i&&(0,Np[c])(t)&&(a+=c+".")}),a+=i,a===r)}static eventCallback(t,r,i){return a=>{n.matchEventFullKeyCode(a,t)&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ne))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const Zu=(0,_.eFA)(_._c5,"browser",[{provide:_.Lbi,useValue:ia},{provide:_.g9A,useValue:function Ku(){Ka.makeCurrent()},multi:!0},{provide:ne,useFactory:function B_(){return(0,_.RDi)(document),document},deps:[]}]),kp=new _.OlP(""),oh=[{provide:_.rWj,useClass:class Y0{addToWindow(e){_.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},_.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),_.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),_.dqk.frameworkStabilizers||(_.dqk.frameworkStabilizers=[]),_.dqk.frameworkStabilizers.push(r=>{const i=_.dqk.getAllAngularTestabilities();let a=i.length,c=!1;const h=function(m){c=c||m,a--,0==a&&r(c)};i.forEach(function(m){m.whenStable(h)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?V().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:_.lri,useClass:_.dDg,deps:[_.R0b,_.eoX,_.rWj]},{provide:_.dDg,useClass:_.dDg,deps:[_.R0b,_.eoX,_.rWj]}],hl=[{provide:_.zSh,useValue:"root"},{provide:_.qLn,useFactory:function Qa(){return new _.qLn},deps:[]},{provide:Co,useClass:Ya,multi:!0,deps:[ne,_.R0b,_.Lbi]},{provide:Co,useClass:ll,multi:!0,deps:[ne]},{provide:cl,useClass:cl,deps:[Qd,Do,_.AFp,Gu]},{provide:_.FYo,useExisting:cl},{provide:al,useExisting:Do},{provide:Do,useClass:Do,deps:[ne]},{provide:Qd,useClass:Qd,deps:[Co,_.R0b]},{provide:class tl{},useClass:L_,deps:[]},[]];let Xa=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:_.AFp,useValue:t.appId},{provide:$u,useExisting:_.AFp},ks]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(kp,12))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[...hl,...oh],imports:[Uu,_.hGG]}),n})(),Ao=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ne))},n.\u0275prov=_.Yz7({token:n,factory:function(t){let r=null;return r=t?new t:function ah(){return new Ao((0,_.LFG)(ne))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;var Xt=P(8996),xo=P(7669);function ot(...n){const e=(0,xo.yG)(n);return(0,Xt.D)(n,e)}var Mo=P(7579);class Xi extends Mo.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const tu=(0,P(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var Oi=P(9751);const{isArray:Z_}=Array,{getPrototypeOf:hh,prototype:Fp,keys:pl}=Object;var Ji=P(4671),Ct=P(4004);const{isArray:Ju}=Array;var Un=P(5403),Vp=P(9672);function ml(...n){const e=(0,xo.yG)(n),t=(0,xo.jO)(n),{args:r,keys:i}=function gl(n){if(1===n.length){const e=n[0];if(Z_(e))return{args:e,keys:null};if(function fh(n){return n&&"object"==typeof n&&hh(n)===Fp}(e)){const t=pl(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n);if(0===r.length)return(0,Xt.D)([],e);const a=new Oi.y(function _l(n,e,t=Ji.y){return r=>{Xs(e,()=>{const{length:i}=n,a=new Array(i);let c=i,h=i;for(let m=0;m<i;m++)Xs(e,()=>{const w=(0,Xt.D)(n[m],e);let T=!1;w.subscribe((0,Un.x)(r,D=>{a[m]=D,T||(T=!0,h--),h||r.next(t(a.slice()))},()=>{--c||r.complete()}))},r)},r)}}(r,e,i?c=>function ec(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}(i,c):Ji.y));return t?a.pipe(function Up(n){return(0,Ct.U)(e=>function ph(n,e){return Ju(e)?n(...e):n(e)}(n,e))}(t)):a}function Xs(n,e,t){n?(0,Vp.f)(t,n,e):e()}var Os=P(8189);function Bp(...n){return function gh(){return(0,Os.J)(1)}()((0,Xt.D)(n,(0,xo.yG)(n)))}var _a=P(8421);function mh(n){return new Oi.y(e=>{(0,_a.Xf)(n()).subscribe(e)})}var Y_=P(9635),_h=P(576);function nu(n,e){const t=(0,_h.m)(n)?n:()=>n,r=i=>i.error(t());return new Oi.y(e?i=>e.schedule(r,0,i):r)}var fs=P(515),tc=P(727),wr=P(4482);function yh(){return(0,wr.e)((n,e)=>{let t=null;n._refCount++;const r=(0,Un.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class nc extends Oi.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,wr.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new tc.w0;const t=this.getSubject();e.add(this.source.subscribe((0,Un.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=tc.w0.EMPTY)}return e}refCount(){return yh()(this)}}function zn(n,e){return(0,wr.e)((t,r)=>{let i=null,a=0,c=!1;const h=()=>c&&!i&&r.complete();t.subscribe((0,Un.x)(r,m=>{i?.unsubscribe();let w=0;const T=a++;(0,_a.Xf)(n(m,T)).subscribe(i=(0,Un.x)(r,D=>r.next(e?e(m,D,T,w++):D),()=>{i=null,h()}))},()=>{c=!0,h()}))})}function ru(n){return n<=0?()=>fs.E:(0,wr.e)((e,t)=>{let r=0;e.subscribe((0,Un.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function rc(...n){const e=(0,xo.yG)(n);return(0,wr.e)((t,r)=>{(e?Bp(n,t,e):Bp(n,t)).subscribe(r)})}function Li(n,e){return(0,wr.e)((t,r)=>{let i=0;t.subscribe((0,Un.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}var Sr=P(5577);function iu(n){return(0,wr.e)((e,t)=>{let r=!1;e.subscribe((0,Un.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Q_(n=tE){return(0,wr.e)((e,t)=>{let r=!1;e.subscribe((0,Un.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function tE(){return new tu}function ps(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Li((i,a)=>n(i,a,r)):Ji.y,ru(1),t?iu(e):Q_(()=>new tu))}function su(n,e){return(0,_h.m)(e)?(0,Sr.z)(n,e,1):(0,Sr.z)(n,1)}var ui=P(8505);function ya(n){return(0,wr.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,Un.x)(t,void 0,void 0,c=>{a=(0,_a.Xf)(n(c,ya(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}function No(n,e){return(0,wr.e)(function nE(n,e,t,r,i){return(a,c)=>{let h=t,m=e,w=0;a.subscribe((0,Un.x)(c,T=>{const D=w++;m=h?n(m,T,D):(h=!0,T),r&&c.next(m)},i&&(()=>{h&&c.next(m),c.complete()})))}}(n,e,arguments.length>=2,!0))}function vh(n){return n<=0?()=>fs.E:(0,wr.e)((e,t)=>{let r=[];e.subscribe((0,Un.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function wh(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Li((i,a)=>n(i,a,r)):Ji.y,vh(1),t?iu(e):Q_(()=>new tu))}function yl(n){return(0,wr.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const zt="primary",wi=Symbol("RouteTitle");class X_{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ou(n){return new X_(n)}function J_(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const c=r[a],h=n[a];if(c.startsWith(":"))i[c.substring(1)]=h;else if(c!==h.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function es(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!wl(n[i],e[i]))return!1;return!0}function wl(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function $p(n){return Array.prototype.concat.apply([],n)}function Ih(n){return n.length>0?n[n.length-1]:null}function Ar(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Po(n){return(0,_.CqO)(n)?n:(0,_.QGY)(n)?(0,Xt.D)(Promise.resolve(n)):ot(n)}const Fr=!1,El={exact:function au(n,e,t){if(!va(n.segments,e.segments)||!bl(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!au(n.children[r],e.children[r],t))return!1;return!0},subset:Tl},Th={exact:function ni(n,e){return es(n,e)},subset:function Hp(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>wl(n[t],e[t]))},ignored:()=>!0};function Il(n,e,t){return El[t.paths](n.root,e.root,t.matrixParams)&&Th[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function Tl(n,e,t){return Gp(n,e,e.segments,t)}function Gp(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!va(i,t)||e.hasChildren()||!bl(i,t,r))}if(n.segments.length===t.length){if(!va(n.segments,t)||!bl(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!Tl(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(va(n.segments,i)&&bl(n.segments,i,r)&&n.children[zt])&&Gp(n.children[zt],e,a,r)}}function bl(n,e,t){return e.every((r,i)=>Th[t](n[i].parameters,r.parameters))}class Ei{constructor(e=new on([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ou(this.queryParams)),this._queryParamMap}toString(){return Ch.serialize(this)}}class on{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Ar(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ko(this)}}class ic{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ou(this.parameters)),this._parameterMap}toString(){return Rl(this)}}function va(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let wa=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return new sc},providedIn:"root"}),n})();class sc{parse(e){const t=new zp(e);return new Ei(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${oc(e.root,!0)}`,r=function Ah(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${uu(t)}=${uu(i)}`).join("&"):`${uu(t)}=${uu(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Dh(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Ch=new sc;function ko(n){return n.segments.map(e=>Rl(e)).join("/")}function oc(n,e){if(!n.hasChildren())return ko(n);if(e){const t=n.children[zt]?oc(n.children[zt],!1):"",r=[];return Ar(n.children,(i,a)=>{a!==zt&&r.push(`${a}:${oc(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function bh(n,e){let t=[];return Ar(n.children,(r,i)=>{i===zt&&(t=t.concat(e(r,i)))}),Ar(n.children,(r,i)=>{i!==zt&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===zt?[oc(n.children[zt],!1)]:[`${i}:${oc(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[zt]?`${ko(n)}/${t[0]}`:`${ko(n)}/(${t.join("//")})`}}function Dl(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function uu(n){return Dl(n).replace(/%3B/gi,";")}function Sl(n){return Dl(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Js(n){return decodeURIComponent(n)}function Al(n){return Js(n.replace(/\+/g,"%20"))}function Rl(n){return`${Sl(n.path)}${function Sh(n){return Object.keys(n).map(e=>`;${Sl(e)}=${Sl(n[e])}`).join("")}(n.parameters)}`}const ty=/^[^\/()?;=#]+/;function cu(n){const e=n.match(ty);return e?e[0]:""}const Rh=/^[^=?&#]+/,ry=/^[^&#]+/;class zp{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new on([],{}):new on([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[zt]=new on(e,t)),r}parseSegment(){const e=cu(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new _.vHH(4009,Fr);return this.capture(e),new ic(Js(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=cu(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=cu(this.remaining);i&&(r=i,this.capture(r))}e[Js(t)]=Js(r)}parseQueryParam(e){const t=function ny(n){const e=n.match(Rh);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const c=function xl(n){const e=n.match(ry);return e?e[0]:""}(this.remaining);c&&(r=c,this.capture(r))}const i=Al(t),a=Al(r);if(e.hasOwnProperty(i)){let c=e[i];Array.isArray(c)||(c=[c],e[i]=c),c.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=cu(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new _.vHH(4010,Fr);let a;r.indexOf(":")>-1?(a=r.slice(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=zt);const c=this.parseChildren();t[a]=1===Object.keys(c).length?c[zt]:new on([],c),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new _.vHH(4011,Fr)}}function ac(n){return n.segments.length>0?new on([],{[zt]:n}):n}function uc(n){const e={};for(const r of Object.keys(n.children)){const a=uc(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function Ml(n){if(1===n.numberOfChildren&&n.children[zt]){const e=n.children[zt];return new on(n.segments.concat(e.segments),e.children)}return n}(new on(n.segments,e))}function Ea(n){return n instanceof Ei}const xh=!1;function Wp(n,e,t,r,i){if(0===t.length)return lc(e.root,e.root,e.root,r,i);const a=function Nl(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new qp(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,c)=>{if("object"==typeof a&&null!=a){if(a.outlets){const h={};return Ar(a.outlets,(m,w)=>{h[w]="string"==typeof m?m.split("/"):m}),[...i,{outlets:h}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===c?(a.split("/").forEach((h,m)=>{0==m&&"."===h||(0==m&&""===h?t=!0:".."===h?e++:""!=h&&i.push(h))}),i):[...i,a]},[]);return new qp(t,e,r)}(t);return a.toRoot()?lc(e.root,e.root,new on([],{}),r,i):function c(m){const w=function kl(n,e,t,r){if(n.isAbsolute)return new eo(e.root,!0,0);if(-1===r)return new eo(t,t===e.root,0);return function Nh(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new _.vHH(4005,xh&&"Invalid number of '../'");i=r.segments.length}return new eo(r,!1,i-a)}(t,r+(Ia(n.commands[0])?0:1),n.numberOfDoubleDots)}(a,e,n.snapshot?._urlSegment,m),T=w.processChildren?Rr(w.segmentGroup,w.index,a.commands):du(w.segmentGroup,w.index,a.commands);return lc(e.root,w.segmentGroup,T,r,i)}(n.snapshot?._lastPathIndex)}function Ia(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function cc(n){return"object"==typeof n&&null!=n&&n.outlets}function lc(n,e,t,r,i){let c,a={};r&&Ar(r,(m,w)=>{a[w]=Array.isArray(m)?m.map(T=>`${T}`):`${m}`}),c=n===e?t:dc(n,e,t);const h=ac(uc(c));return new Ei(h,a,i)}function dc(n,e,t){const r={};return Ar(n.children,(i,a)=>{r[a]=i===e?t:dc(i,e,t)}),new on(n.segments,r)}class qp{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Ia(r[0]))throw new _.vHH(4003,xh&&"Root segment cannot have matrix parameters");const i=r.find(cc);if(i&&i!==Ih(r))throw new _.vHH(4004,xh&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class eo{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function du(n,e,t){if(n||(n=new on([],{})),0===n.segments.length&&n.hasChildren())return Rr(n,e,t);const r=function Ta(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const c=n.segments[i],h=t[r];if(cc(h))break;const m=`${h}`,w=r<t.length-1?t[r+1]:null;if(i>0&&void 0===m)break;if(m&&w&&"object"==typeof w&&void 0===w.outlets){if(!Ol(m,w,c))return a;r+=2}else{if(!Ol(m,{},c))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new on(n.segments.slice(0,r.pathIndex),{});return a.children[zt]=new on(n.segments.slice(r.pathIndex),n.children),Rr(a,0,i)}return r.match&&0===i.length?new on(n.segments,{}):r.match&&!n.hasChildren()?hu(n,e,t):r.match?Rr(n,0,i):hu(n,e,t)}function Rr(n,e,t){if(0===t.length)return new on(n.segments,{});{const r=function lu(n){return cc(n[0])?n[0].outlets:{[zt]:n}}(t),i={};return!r[zt]&&n.children[zt]&&1===n.numberOfChildren&&0===n.children[zt].segments.length?Rr(n.children[zt],e,t):(Ar(r,(a,c)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[c]=du(n.children[c],e,a))}),Ar(n.children,(a,c)=>{void 0===r[c]&&(i[c]=a)}),new on(n.segments,i))}}function hu(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(cc(a)){const m=Ph(a.outlets);return new on(r,m)}if(0===i&&Ia(t[0])){r.push(new ic(n.segments[e].path,Oo(t[0]))),i++;continue}const c=cc(a)?a.outlets[zt]:`${a}`,h=i<t.length-1?t[i+1]:null;c&&h&&Ia(h)?(r.push(new ic(c,Oo(h))),i+=2):(r.push(new ic(c,{})),i++)}return new on(r,{})}function Ph(n){const e={};return Ar(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=hu(new on([],{}),0,t))}),e}function Oo(n){const e={};return Ar(n,(t,r)=>e[r]=`${t}`),e}function Ol(n,e,t){return n==t.path&&es(e,t.parameters)}const fu="imperative";class gs{constructor(e,t){this.id=e,this.url=t}}class kh extends gs{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ci extends gs{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class pu extends gs{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class hc extends gs{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=16}}class gu extends gs{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Oh extends gs{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ba extends gs{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ii extends gs{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Lh extends gs{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Kp extends gs{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sy{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ms{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class fc{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fh{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pc{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ll{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class gc{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let Qp=(()=>{class n{createUrlTree(t,r,i,a,c,h){return Wp(t||r.root,i,a,c,h)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(e){return Qp.\u0275fac(e)},providedIn:"root"}),n})();class f{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=p(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=p(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=E(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return E(e,this._root).map(t=>t.value)}}function p(n,e){if(n===e.value)return e;for(const t of e.children){const r=p(n,t);if(r)return r}return null}function E(n,e){if(n===e.value)return[e];for(const t of e.children){const r=E(n,t);if(r.length)return r.unshift(e),r}return[]}class C{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function M(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class Q extends f{constructor(e,t){super(e),this.snapshot=t,mu(this,e)}toString(){return this.snapshot.toString()}}function fe(n,e){const t=function Ke(n,e){const c=new Yn([],{},{},"",{},zt,e,null,n.root,-1,{});return new ns("",new C(c,[]))}(n,e),r=new Xi([new ic("",{})]),i=new Xi({}),a=new Xi({}),c=new Xi({}),h=new Xi(""),m=new ut(r,i,c,h,a,zt,e,t.root);return m.snapshot=t.root,new Q(new C(m,[]),t)}class ut{constructor(e,t,r,i,a,c,h,m){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=c,this.component=h,this.title=this.data?.pipe((0,Ct.U)(w=>w[wi]))??ot(void 0),this._futureSnapshot=m}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ct.U)(e=>ou(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ct.U)(e=>ou(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ot(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function Nt(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Yn{get title(){return this.data?.[wi]}constructor(e,t,r,i,a,c,h,m,w,T,D){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=c,this.component=h,this.routeConfig=m,this._urlSegment=w,this._lastPathIndex=T,this._resolve=D}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ou(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ou(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ns extends f{constructor(e,t){super(t),this.url=e,mu(this,t)}toString(){return Uh(this._root)}}function mu(n,e){e.value._routerState=n,e.children.forEach(t=>mu(n,t))}function Uh(n){const e=n.children.length>0?` { ${n.children.map(Uh).join(", ")} } `:"";return`${n.value}${e}`}function mc(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,es(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),es(e.params,t.params)||n.params.next(t.params),function vl(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!es(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),es(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function _u(n,e){const t=es(n.params,e.params)&&function Cl(n,e){return va(n,e)&&n.every((t,r)=>es(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||_u(n.parent,e.parent))}function _s(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function Vh(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return _s(n,r,i);return _s(n,r)})}(n,e,t);return new C(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const c=a.route;return c.value._futureSnapshot=e.value,c.children=e.children.map(h=>_s(n,h)),c}}const r=function Bh(n){return new ut(new Xi(n.url),new Xi(n.params),new Xi(n.queryParams),new Xi(n.fragment),new Xi(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>_s(n,a));return new C(r,i)}}const yu="ngNavigationCancelingError";function Xp(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=Ea(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=ay(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function ay(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[yu]=!0,r.cancellationCode=e,t&&(r.url=t),r}function jh(n){return Fl(n)&&Ea(n.url)}function Fl(n){return n&&n[yu]}class uy{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Jp,this.attachRef=null}}let Jp=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new uy,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const cy=!1;let eg=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=zt,this.activateEvents=new _.vpe,this.deactivateEvents=new _.vpe,this.attachEvents=new _.vpe,this.detachEvents=new _.vpe,this.parentContexts=(0,_.f3M)(Jp),this.location=(0,_.f3M)(_.s_b),this.changeDetector=(0,_.f3M)(_.sBO),this.environmentInjector=(0,_.f3M)(_.lqb)}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new _.vHH(4012,cy);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new _.vHH(4012,cy);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new _.vHH(4012,cy);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new _.vHH(4013,cy);this._activatedRoute=t;const i=this.location,c=t.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,m=new YC(t,h,i.injector);if(r&&function QC(n){return!!n.resolveComponentFactory}(r)){const w=r.resolveComponentFactory(c);this.activated=i.createComponent(w,i.length,m)}else this.activated=i.createComponent(c,{index:i.length,injector:m,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=_.lG2({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[_.TTD]}),n})();class YC{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===ut?this.route:e===Jp?this.childContexts:this.parent.get(e,t)}}let tg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[_.jDz],decls:1,vars:0,template:function(t,r){1&t&&_._UZ(0,"router-outlet")},dependencies:[eg],encapsulation:2}),n})();function rE(n,e){return n.providers&&!n._injector&&(n._injector=(0,_.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ng(n){const e=n.children&&n.children.map(ng),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==zt&&(t.component=tg),t}function ys(n){return n.outlet||zt}function sE(n,e){const t=n.filter(r=>ys(r)===e);return t.push(...n.filter(r=>ys(r)!==e)),t}function $h(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class nD{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),mc(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=M(t);e.children.forEach(a=>{const c=a.value.outlet;this.deactivateRoutes(a,i[c],r),delete i[c]}),Ar(i,(a,c)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const c=r.getContext(i.outlet);c&&this.deactivateChildRoutes(e,t,c.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=M(e);for(const c of Object.keys(a))this.deactivateRouteAndItsChildren(a[c],i);if(r&&r.outlet){const c=r.outlet.detach(),h=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:c,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=M(e);for(const c of Object.keys(a))this.deactivateRouteAndItsChildren(a[c],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=M(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new Ll(a.value.snapshot))}),e.children.length&&this.forwardEvent(new Fh(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(mc(i),i===a)if(i.component){const c=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,c.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const c=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const h=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),c.children.onOutletReAttached(h.contexts),c.attachRef=h.componentRef,c.route=h.route.value,c.outlet&&c.outlet.attach(h.componentRef,h.route.value),mc(h.route.value),this.activateChildRoutes(e,null,c.children)}else{const h=$h(i.snapshot),m=h?.get(_._Vd)??null;c.attachRef=null,c.route=i,c.resolver=m,c.injector=h,c.outlet&&c.outlet.activateWith(i,c.injector),this.activateChildRoutes(e,null,c.children)}}else this.activateChildRoutes(e,null,r)}}class hy{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class fy{constructor(e,t){this.component=e,this.route=t}}function CN(n,e,t){const r=n._root;return Ul(r,e?e._root:null,t,[r.value])}function vu(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||(0,_.Z0I)(n)?e.get(n):n:r}function Ul(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=M(e);return n.children.forEach(c=>{(function oE(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,c=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(c&&a.routeConfig===c.routeConfig){const m=function aE(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!va(n.url,e.url);case"pathParamsOrQueryParamsChange":return!va(n.url,e.url)||!es(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!_u(n,e)||!es(n.queryParams,e.queryParams);default:return!_u(n,e)}}(c,a,a.routeConfig.runGuardsAndResolvers);m?i.canActivateChecks.push(new hy(r)):(a.data=c.data,a._resolvedData=c._resolvedData),Ul(n,e,a.component?h?h.children:null:t,r,i),m&&h&&h.outlet&&h.outlet.isActivated&&i.canDeactivateChecks.push(new fy(h.outlet.component,c))}else c&&rg(e,h,i),i.canActivateChecks.push(new hy(r)),Ul(n,null,a.component?h?h.children:null:t,r,i)})(c,a[c.value.outlet],t,r.concat([c.value]),i),delete a[c.value.outlet]}),Ar(a,(c,h)=>rg(c,t.getContext(h),i)),i}function rg(n,e,t){const r=M(n),i=n.value;Ar(r,(a,c)=>{rg(a,i.component?e?e.children.getContext(c):null:e,t)}),t.canDeactivateChecks.push(new fy(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Gh(n){return"function"==typeof n}function ig(n){return n instanceof tu||"EmptyError"===n?.name}const Lo=Symbol("INITIAL_VALUE");function Vl(){return zn(n=>ml(n.map(e=>e.pipe(ru(1),rc(Lo)))).pipe((0,Ct.U)(e=>{for(const t of e)if(!0!==t){if(t===Lo)return Lo;if(!1===t||t instanceof Ei)return t}return!0}),Li(e=>e!==Lo),ru(1)))}function fE(n){return(0,Y_.z)((0,ui.b)(e=>{if(Ea(e))throw Xp(0,e)}),(0,Ct.U)(e=>!0===e))}const wu={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function gE(n,e,t,r,i){const a=vy(n,e,t);return a.matched?function pE(n,e,t,r){const i=e.canMatch;return i&&0!==i.length?ot(i.map(c=>{const h=vu(c,n);return Po(function rD(n){return n&&Gh(n.canMatch)}(h)?h.canMatch(e,t):n.runInContext(()=>h(e,t)))})).pipe(Vl(),fE()):ot(!0)}(r=rE(e,r),e,t).pipe((0,Ct.U)(c=>!0===c?a:{...wu})):ot(a)}function vy(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...wu}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||J_)(t,n,e);if(!i)return{...wu};const a={};Ar(i.posParams,(h,m)=>{a[m]=h.path});const c=i.consumed.length>0?{...a,...i.consumed[i.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:c,positionalParamSegments:i.posParams??{}}}function ag(n,e,t,r){if(t.length>0&&function mE(n,e,t){return t.some(r=>zh(n,e,r)&&ys(r)!==zt)}(n,t,r)){const a=new on(e,function oD(n,e,t,r){const i={};i[zt]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&ys(a)!==zt){const c=new on([],{});c._sourceSegment=n,c._segmentIndexShift=e.length,i[ys(a)]=c}return i}(n,e,r,new on(t,n.children)));return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:[]}}if(0===t.length&&function aD(n,e,t){return t.some(r=>zh(n,e,r))}(n,t,r)){const a=new on(n.segments,function wy(n,e,t,r,i){const a={};for(const c of r)if(zh(n,t,c)&&!i[ys(c)]){const h=new on([],{});h._sourceSegment=n,h._segmentIndexShift=e.length,a[ys(c)]=h}return{...i,...a}}(n,e,t,r,n.children));return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}const i=new on(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:t}}function zh(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function uD(n,e,t,r){return!!(ys(n)===r||r!==zt&&zh(e,t,n))&&("**"===n.path||vy(e,n,t).matched)}function _E(n,e,t){return 0===e.length&&!n.children[t]}const Eu=!1;class ug{constructor(e){this.segmentGroup=e||null}}class yc{constructor(e){this.urlTree=e}}function Ca(n){return nu(new ug(n))}function yE(n){return nu(new yc(n))}class dD{constructor(e,t,r,i,a){this.injector=e,this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0}apply(){const e=ag(this.urlTree.root,[],[],this.config).segmentGroup,t=new on(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,zt).pipe((0,Ct.U)(a=>this.createUrlTree(uc(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ya(a=>{if(a instanceof yc)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof ug?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,zt).pipe((0,Ct.U)(i=>this.createUrlTree(uc(i),e.queryParams,e.fragment))).pipe(ya(i=>{throw i instanceof ug?this.noMatchError(i):i}))}noMatchError(e){return new _.vHH(4002,Eu)}createUrlTree(e,t,r){const i=ac(e);return new Ei(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,Ct.U)(a=>new on([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,Xt.D)(i).pipe(su(a=>{const c=r.children[a],h=sE(t,a);return this.expandSegmentGroup(e,h,c,a).pipe((0,Ct.U)(m=>({segment:m,outlet:a})))}),No((a,c)=>(a[c.outlet]=c.segment,a),{}),wh())}expandSegment(e,t,r,i,a,c){return(0,Xt.D)(r).pipe(su(h=>this.expandSegmentAgainstRoute(e,t,r,h,i,a,c).pipe(ya(w=>{if(w instanceof ug)return ot(null);throw w}))),ps(h=>!!h),ya((h,m)=>{if(ig(h))return _E(t,i,a)?ot(new on([],{})):Ca(t);throw h}))}expandSegmentAgainstRoute(e,t,r,i,a,c,h){return uD(i,t,a,c)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,c):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,c):Ca(t):Ca(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,c){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,c):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,c)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?yE(a):this.lineralizeSegments(r,a).pipe((0,Sr.z)(c=>{const h=new on(c,{});return this.expandSegment(e,h,t,c,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,c){const{matched:h,consumedSegments:m,remainingSegments:w,positionalParamSegments:T}=vy(t,i,a);if(!h)return Ca(t);const D=this.applyRedirectCommands(m,i.redirectTo,T);return i.redirectTo.startsWith("/")?yE(D):this.lineralizeSegments(i,D).pipe((0,Sr.z)(x=>this.expandSegment(e,t,r,x.concat(w),c,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){return"**"===r.path?(e=rE(r,e),r.loadChildren?(r._loadedRoutes?ot({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe((0,Ct.U)(h=>(r._loadedRoutes=h.routes,r._loadedInjector=h.injector,new on(i,{})))):ot(new on(i,{}))):gE(t,r,i,e).pipe(zn(({matched:c,consumedSegments:h,remainingSegments:m})=>c?this.getChildConfig(e=r._injector??e,r,i).pipe((0,Sr.z)(T=>{const D=T.injector??e,x=T.routes,{segmentGroup:F,slicedSegments:$}=ag(t,h,m,x),ee=new on(F.segments,F.children);if(0===$.length&&ee.hasChildren())return this.expandChildren(D,x,ee).pipe((0,Ct.U)(dt=>new on(h,dt)));if(0===x.length&&0===$.length)return ot(new on(h,{}));const se=ys(r)===a;return this.expandSegment(D,ee,x,$,se?zt:a,!0).pipe((0,Ct.U)(vt=>new on(h.concat(vt.segments),vt.children)))})):Ca(t)))}getChildConfig(e,t,r){return t.children?ot({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?ot({routes:t._loadedRoutes,injector:t._loadedInjector}):function sD(n,e,t,r){const i=e.canLoad;return void 0===i||0===i.length?ot(!0):ot(i.map(c=>{const h=vu(c,n);return Po(function cE(n){return n&&Gh(n.canLoad)}(h)?h.canLoad(e,t):n.runInContext(()=>h(e,t)))})).pipe(Vl(),fE())}(e,t,r).pipe((0,Sr.z)(i=>i?this.configLoader.loadChildren(e,t).pipe((0,ui.b)(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function cD(n){return nu(ay(Eu,3))}())):ot({routes:[],injector:e})}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return ot(r);if(i.numberOfChildren>1||!i.children[zt])return e.redirectTo,nu(new _.vHH(4e3,Eu));i=i.children[zt]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new Ei(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return Ar(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const h=i.substring(1);r[a]=t[h]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let c={};return Ar(t.children,(h,m)=>{c[m]=this.createSegmentGroup(e,h,r,i)}),new on(a,c)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new _.vHH(4001,Eu);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}class Iy{}class by{constructor(e,t,r,i,a,c,h){this.injector=e,this.rootComponentType=t,this.config=r,this.urlTree=i,this.url=a,this.paramsInheritanceStrategy=c,this.urlSerializer=h}recognize(){const e=ag(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,zt).pipe((0,Ct.U)(t=>{if(null===t)return null;const r=new Yn([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},zt,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new C(r,t),a=new ns(this.url,i);return this.inheritParamsAndData(a._root),a}))}inheritParamsAndData(e){const t=e.value,r=Ot(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i)}processChildren(e,t,r){return(0,Xt.D)(Object.keys(r.children)).pipe(su(i=>{const a=r.children[i],c=sE(t,i);return this.processSegmentGroup(e,c,a,i)}),No((i,a)=>i&&a?(i.push(...a),i):null),function Eh(n,e=!1){return(0,wr.e)((t,r)=>{let i=0;t.subscribe((0,Un.x)(r,a=>{const c=n(a,i++);(c||e)&&r.next(a),!c&&r.complete()}))})}(i=>null!==i),iu(null),wh(),(0,Ct.U)(i=>{if(null===i)return null;const a=EE(i);return function Wh(n){n.sort((e,t)=>e.value.outlet===zt?-1:t.value.outlet===zt?1:e.value.outlet.localeCompare(t.value.outlet))}(a),a}))}processSegment(e,t,r,i,a){return(0,Xt.D)(t).pipe(su(c=>this.processSegmentAgainstRoute(c._injector??e,c,r,i,a)),ps(c=>!!c),ya(c=>{if(ig(c))return _E(r,i,a)?ot([]):ot(null);throw c}))}processSegmentAgainstRoute(e,t,r,i,a){if(t.redirectTo||!uD(t,r,i,a))return ot(null);let c;if("**"===t.path){const h=i.length>0?Ih(i).parameters:{},m=TE(r)+i.length;c=ot({snapshot:new Yn(i,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,vc(t),ys(t),t.component??t._loadedComponent??null,t,IE(r),m,Fo(t)),consumedSegments:[],remainingSegments:[]})}else c=gE(r,t,i,e).pipe((0,Ct.U)(({matched:h,consumedSegments:m,remainingSegments:w,parameters:T})=>{if(!h)return null;const D=TE(r)+m.length;return{snapshot:new Yn(m,T,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,vc(t),ys(t),t.component??t._loadedComponent??null,t,IE(r),D,Fo(t)),consumedSegments:m,remainingSegments:w}}));return c.pipe(zn(h=>{if(null===h)return ot(null);const{snapshot:m,consumedSegments:w,remainingSegments:T}=h;e=t._injector??e;const D=t._loadedInjector??e,x=function fD(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:F,slicedSegments:$}=ag(r,w,T,x.filter(se=>void 0===se.redirectTo));if(0===$.length&&F.hasChildren())return this.processChildren(D,x,F).pipe((0,Ct.U)(se=>null===se?null:[new C(m,se)]));if(0===x.length&&0===$.length)return ot([new C(m,[])]);const ee=ys(t)===a;return this.processSegment(D,x,F,$,ee?zt:a).pipe((0,Ct.U)(se=>null===se?null:[new C(m,se)]))}))}}function pD(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function EE(n){const e=[],t=new Set;for(const r of n){if(!pD(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=EE(r.children);e.push(new C(r.value,i))}return e.filter(r=>!t.has(r))}function IE(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function TE(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function vc(n){return n.data||{}}function Fo(n){return n.resolve||{}}function Cy(n){return"string"==typeof n.title||null===n.title}function cg(n){return zn(e=>{const t=n(e);return t?(0,Xt.D)(t).pipe((0,Ct.U)(()=>e)):ot(e)})}const Bl=new _.OlP("ROUTES");let Sy=(()=>{class n{constructor(t,r){this.injector=t,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ot(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=Po(t.loadComponent()).pipe((0,Ct.U)(CE),(0,ui.b)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),yl(()=>{this.componentLoaders.delete(t)})),i=new nc(r,()=>new Mo.x).pipe(yh());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return ot({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const a=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe((0,Ct.U)(h=>{this.onLoadEndListener&&this.onLoadEndListener(r);let m,w,T=!1;Array.isArray(h)?w=h:(m=h.create(t).injector,w=$p(m.get(Bl,[],_.XFs.Self|_.XFs.Optional)));return{routes:w.map(ng),injector:m}}),yl(()=>{this.childrenLoaders.delete(r)})),c=new nc(a,()=>new Mo.x).pipe(yh());return this.childrenLoaders.set(r,c),c}loadModuleFactoryOrRoutes(t){return Po(t()).pipe((0,Ct.U)(CE),(0,Sr.z)(i=>i instanceof _.YKP||Array.isArray(i)?ot(i):(0,Xt.D)(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(_.zs3),_.LFG(_.Sil))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function CE(n){return function to(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let lg=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Mo.x,this.configLoader=(0,_.f3M)(Sy),this.environmentInjector=(0,_.f3M)(_.lqb),this.urlSerializer=(0,_.f3M)(wa),this.rootContexts=(0,_.f3M)(Jp),this.navigationId=0,this.afterPreactivation=()=>ot(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new ms(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new sy(i))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t){return this.transitions=new Xi({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:fu,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Li(r=>0!==r.id),(0,Ct.U)(r=>({...r,extractedUrl:t.urlHandlingStrategy.extract(r.rawUrl)})),zn(r=>{let i=!1,a=!1;return ot(r).pipe((0,ui.b)(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),zn(c=>{const h=t.browserUrlTree.toString(),m=!t.navigated||c.extractedUrl.toString()!==h||h!==t.currentUrlTree.toString();if(!m&&"reload"!==(c.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const T="";return this.events.next(new hc(c.id,t.serializeUrl(r.rawUrl),T,0)),t.rawUrlTree=c.rawUrl,c.resolve(null),fs.E}if(t.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return DE(c.source)&&(t.browserUrlTree=c.extractedUrl),ot(c).pipe(zn(T=>{const D=this.transitions?.getValue();return this.events.next(new kh(T.id,this.urlSerializer.serialize(T.extractedUrl),T.source,T.restoredState)),D!==this.transitions?.getValue()?fs.E:Promise.resolve(T)}),function wE(n,e,t,r){return zn(i=>function lD(n,e,t,r,i){return new dD(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,Ct.U)(a=>({...i,urlAfterRedirects:a}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),(0,ui.b)(T=>{this.currentNavigation={...this.currentNavigation,finalUrl:T.urlAfterRedirects},r.urlAfterRedirects=T.urlAfterRedirects}),function mD(n,e,t,r,i){return(0,Sr.z)(a=>function hD(n,e,t,r,i,a,c="emptyOnly"){return new by(n,e,t,r,i,c,a).recognize().pipe(zn(h=>null===h?function Ty(n){return new Oi.y(e=>e.error(n))}(new Iy):ot(h)))}(n,e,t,a.urlAfterRedirects,r.serialize(a.urlAfterRedirects),r,i).pipe((0,Ct.U)(c=>({...a,targetSnapshot:c}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),(0,ui.b)(T=>{if(r.targetSnapshot=T.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!T.extras.skipLocationChange){const x=t.urlHandlingStrategy.merge(T.urlAfterRedirects,T.rawUrl);t.setBrowserUrl(x,T)}t.browserUrlTree=T.urlAfterRedirects}const D=new Oh(T.id,this.urlSerializer.serialize(T.extractedUrl),this.urlSerializer.serialize(T.urlAfterRedirects),T.targetSnapshot);this.events.next(D)}));if(m&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:T,extractedUrl:D,source:x,restoredState:F,extras:$}=c,ee=new kh(T,this.urlSerializer.serialize(D),x,F);this.events.next(ee);const se=fe(D,this.rootComponentType).snapshot;return ot(r={...c,targetSnapshot:se,urlAfterRedirects:D,extras:{...$,skipLocationChange:!1,replaceUrl:!1}})}{const T="";return this.events.next(new hc(c.id,t.serializeUrl(r.extractedUrl),T,1)),t.rawUrlTree=c.rawUrl,c.resolve(null),fs.E}}),(0,ui.b)(c=>{const h=new ba(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(h)}),(0,Ct.U)(c=>r={...c,guards:CN(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function my(n,e){return(0,Sr.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:c}}=t;return 0===c.length&&0===a.length?ot({...t,guardsResult:!0}):function sg(n,e,t,r){return(0,Xt.D)(n).pipe((0,Sr.z)(i=>function yy(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?ot(a.map(h=>{const m=$h(e)??i,w=vu(h,m);return Po(function gy(n){return n&&Gh(n.canDeactivate)}(w)?w.canDeactivate(n,e,t,r):m.runInContext(()=>w(n,e,t,r))).pipe(ps())})).pipe(Vl()):ot(!0)}(i.component,i.route,t,e,r)),ps(i=>!0!==i,!0))}(c,r,i,n).pipe((0,Sr.z)(h=>h&&function uE(n){return"boolean"==typeof n}(h)?function iD(n,e,t,r){return(0,Xt.D)(e).pipe(su(i=>Bp(function og(n,e){return null!==n&&e&&e(new fc(n)),ot(!0)}(i.route.parent,r),function _y(n,e){return null!==n&&e&&e(new pc(n)),ot(!0)}(i.route,r),function hE(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(c=>function Hh(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(c)).filter(c=>null!==c).map(c=>mh(()=>ot(c.guards.map(m=>{const w=$h(c.node)??t,T=vu(m,w);return Po(function DN(n){return n&&Gh(n.canActivateChild)}(T)?T.canActivateChild(r,n):w.runInContext(()=>T(r,n))).pipe(ps())})).pipe(Vl())));return ot(a).pipe(Vl())}(n,i.path,t),function _c(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return ot(!0);const i=r.map(a=>mh(()=>{const c=$h(e)??t,h=vu(a,c);return Po(function py(n){return n&&Gh(n.canActivate)}(h)?h.canActivate(e,n):c.runInContext(()=>h(e,n))).pipe(ps())}));return ot(i).pipe(Vl())}(n,i.route,t))),ps(i=>!0!==i,!0))}(r,a,n,e):ot(h)),(0,Ct.U)(h=>({...t,guardsResult:h})))})}(this.environmentInjector,c=>this.events.next(c)),(0,ui.b)(c=>{if(r.guardsResult=c.guardsResult,Ea(c.guardsResult))throw Xp(0,c.guardsResult);const h=new Ii(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(h)}),Li(c=>!!c.guardsResult||(t.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),cg(c=>{if(c.guards.canActivateChecks.length)return ot(c).pipe((0,ui.b)(h=>{const m=new Lh(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(m)}),zn(h=>{let m=!1;return ot(h).pipe(function _D(n,e){return(0,Sr.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ot(t);let a=0;return(0,Xt.D)(i).pipe(su(c=>function AN(n,e,t,r){const i=n.routeConfig,a=n._resolve;return void 0!==i?.title&&!Cy(i)&&(a[wi]=i.title),function RN(n,e,t,r){const i=function bE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return ot({});const a={};return(0,Xt.D)(i).pipe((0,Sr.z)(c=>function xN(n,e,t,r){const i=$h(e)??r,a=vu(n,i);return Po(a.resolve?a.resolve(e,t):i.runInContext(()=>a(e,t)))}(n[c],e,t,r).pipe(ps(),(0,ui.b)(h=>{a[c]=h}))),vh(1),function jp(n){return(0,Ct.U)(()=>n)}(a),ya(c=>ig(c)?fs.E:nu(c)))}(a,n,e,r).pipe((0,Ct.U)(c=>(n._resolvedData=c,n.data=Ot(n,t).resolve,i&&Cy(i)&&(n.data[wi]=i.title),null)))}(c.route,r,n,e)),(0,ui.b)(()=>a++),vh(1),(0,Sr.z)(c=>a===i.length?ot(t):fs.E))})}(t.paramsInheritanceStrategy,this.environmentInjector),(0,ui.b)({next:()=>m=!0,complete:()=>{m||(t.restoreHistory(h),this.cancelNavigationTransition(h,"",2))}}))}),(0,ui.b)(h=>{const m=new Kp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(m)}))}),cg(c=>{const h=m=>{const w=[];m.routeConfig?.loadComponent&&!m.routeConfig._loadedComponent&&w.push(this.configLoader.loadComponent(m.routeConfig).pipe((0,ui.b)(T=>{m.component=T}),(0,Ct.U)(()=>{})));for(const T of m.children)w.push(...h(T));return w};return ml(h(c.targetSnapshot.root)).pipe(iu(),ru(1))}),cg(()=>this.afterPreactivation()),(0,Ct.U)(c=>{const h=function Ls(n,e,t){const r=_s(n,e._root,t?t._root:void 0);return new Q(r,e)}(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return r={...c,targetRouterState:h}}),(0,ui.b)(c=>{t.currentUrlTree=c.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),t.routerState=c.targetRouterState,"deferred"===t.urlUpdateStrategy&&(c.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,c),t.browserUrlTree=c.urlAfterRedirects)}),((n,e,t)=>(0,Ct.U)(r=>(new nD(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c)),(0,ui.b)({next:c=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new ci(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{i=!0}}),yl(()=>{i||a||this.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),ya(c=>{if(a=!0,Fl(c)){jh(c)||(t.navigated=!0,t.restoreHistory(r,!0));const h=new pu(r.id,this.urlSerializer.serialize(r.extractedUrl),c.message,c.cancellationCode);if(this.events.next(h),jh(c)){const m=t.urlHandlingStrategy.merge(c.url,t.rawUrlTree),w={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||DE(r.source)};t.scheduleNavigation(m,fu,null,w,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{t.restoreHistory(r,!0);const h=new gu(r.id,this.urlSerializer.serialize(r.extractedUrl),c,r.targetSnapshot??void 0);this.events.next(h);try{r.resolve(t.errorHandler(c))}catch(m){r.reject(m)}}return fs.E}))}))}cancelNavigationTransition(t,r,i){const a=new pu(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(a),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function DE(n){return n!==fu}let SE=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(a=>a.outlet===zt);return r}getResolvedTitleForRoute(t){return t.data[wi]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(vD)},providedIn:"root"}),n})(),vD=(()=>{class n extends SE{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Ao))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),AE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(ED)},providedIn:"root"}),n})();class wD{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let ED=(()=>{class n extends wD{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=_.n5z(n)))(r||n)}}(),n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Wt=new _.OlP("",{providedIn:"root",factory:()=>({})});let RE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(xE)},providedIn:"root"}),n})(),xE=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function TD(n){throw n}function bD(n,e,t){return e.parse("/")}const ME={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},CD={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ti=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,_.f3M)(_.c2e),this.isNgZoneEnabled=!1,this.options=(0,_.f3M)(Wt,{optional:!0})||{},this.errorHandler=this.options.errorHandler||TD,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||bD,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,_.f3M)(RE),this.routeReuseStrategy=(0,_.f3M)(AE),this.urlCreationStrategy=(0,_.f3M)(y),this.titleStrategy=(0,_.f3M)(SE),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=$p((0,_.f3M)(Bl,{optional:!0})??[]),this.navigationTransitions=(0,_.f3M)(lg),this.urlSerializer=(0,_.f3M)(wa),this.location=(0,_.f3M)(Ue),this.isNgZoneEnabled=(0,_.f3M)(_.R0b)instanceof _.R0b&&_.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Ei,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=fe(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),fu,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,i){const a={replaceUrl:!0},c=i?.navigationId?i:null;if(i){const m={...i};delete m.navigationId,delete m.\u0275routerPageId,0!==Object.keys(m).length&&(a.state=m)}const h=this.parseUrl(t);this.scheduleNavigation(h,r,c,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(ng),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:c,queryParamsHandling:h,preserveFragment:m}=r,w=m?this.currentUrlTree.fragment:c;let T=null;switch(h){case"merge":T={...this.currentUrlTree.queryParams,...a};break;case"preserve":T=this.currentUrlTree.queryParams;break;default:T=a||null}return null!==T&&(T=this.removeEmptyProps(T)),this.urlCreationStrategy.createUrlTree(i,this.routerState,this.currentUrlTree,t,T,w??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=Ea(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,fu,null,r)}navigate(t,r={skipLocationChange:!1}){return function DD(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new _.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...ME}:!1===r?{...CD}:r,Ea(t))return Il(this.currentUrlTree,t,i);const a=this.parseUrl(t);return Il(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}scheduleNavigation(t,r,i,a,c){if(this.disposed)return Promise.resolve(!1);let h,m,w,T;return c?(h=c.resolve,m=c.reject,w=c.promise):w=new Promise((D,x)=>{h=D,m=x}),T="computed"===this.canceledNavigationResolution?i&&i.\u0275routerPageId?i.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:T,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:a,resolve:h,reject:m,promise:w,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),w.catch(D=>Promise.reject(D))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),a={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",a):this.location.go(i,"",a)}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===i?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===i&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ry{}let xy=(()=>{class n{constructor(t,r,i,a,c){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=c}setUpPreloading(){this.subscription=this.router.events.pipe(Li(t=>t instanceof ci),su(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r){a.providers&&!a._injector&&(a._injector=(0,_.MMx)(a.providers,t,`Route: ${a.path}`));const c=a._injector??t,h=a._loadedInjector??c;a.loadChildren&&!a._loadedRoutes&&void 0===a.canLoad||a.loadComponent&&!a._loadedComponent?i.push(this.preloadConfig(c,a)):(a.children||a._loadedRoutes)&&i.push(this.processRoutes(h,a.children??a._loadedRoutes))}return(0,Xt.D)(i).pipe((0,Os.J)())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):ot(null);const a=i.pipe((0,Sr.z)(c=>null===c?ot(void 0):(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,this.processRoutes(c.injector??t,c.routes))));if(r.loadComponent&&!r._loadedComponent){const c=this.loader.loadComponent(r);return(0,Xt.D)([a,c]).pipe((0,Os.J)())}return a})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Ti),_.LFG(_.Sil),_.LFG(_.lqb),_.LFG(Ry),_.LFG(Sy))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Kh=new _.OlP("");let PE=(()=>{class n{constructor(t,r,i,a,c={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=a,this.options=c,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},c.scrollPositionRestoration=c.scrollPositionRestoration||"disabled",c.anchorScrolling=c.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof kh?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ci&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof gc&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new gc(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){_.$Z()},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();var Fs=(()=>((Fs=Fs||{})[Fs.COMPLETE=0]="COMPLETE",Fs[Fs.FAILED=1]="FAILED",Fs[Fs.REDIRECTING=2]="REDIRECTING",Fs))();const Zh=!1;function wc(n,e){return{\u0275kind:n,\u0275providers:e}}const Ny=new _.OlP("",{providedIn:"root",factory:()=>!1});function Yh(){const n=(0,_.f3M)(_.zs3);return e=>{const t=n.get(_.z2F);if(e!==t.components[0])return;const r=n.get(Ti),i=n.get(kE);1===n.get(hg)&&r.initialNavigation(),n.get(OE,null,_.XFs.Optional)?.setUpPreloading(),n.get(Kh,null,_.XFs.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.unsubscribe())}}const kE=new _.OlP(Zh?"bootstrap done indicator":"",{factory:()=>new Mo.x}),hg=new _.OlP(Zh?"initial navigation":"",{providedIn:"root",factory:()=>1});function xD(){let n=[];return n=Zh?[{provide:_.Xts,multi:!0,useFactory:()=>{const e=(0,_.f3M)(Ti);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function Zp(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],wc(1,n)}const OE=new _.OlP(Zh?"router preloader":"");function MD(n){return wc(0,[{provide:OE,useExisting:xy},{provide:Ry,useExisting:n}])}const Hl=!1,kD=new _.OlP(Hl?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),Py=[Ue,{provide:wa,useClass:sc},Ti,Jp,{provide:ut,useFactory:function My(n){return n.routerState.root},deps:[Ti]},Sy,Hl?{provide:Ny,useValue:!0}:[]];function OD(){return new _.PXZ("Router",Ti)}let FE=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[Py,Hl&&r?.enableTracing?xD().\u0275providers:[],{provide:Bl,multi:!0,useValue:t},{provide:kD,useFactory:VE,deps:[[Ti,new _.FiY,new _.tp0]]},{provide:Wt,useValue:r||{}},r?.useHash?{provide:rt,useClass:Ne}:{provide:rt,useClass:be},{provide:Kh,useFactory:()=>{const n=(0,_.f3M)(aa),e=(0,_.f3M)(_.R0b),t=(0,_.f3M)(Wt),r=(0,_.f3M)(lg),i=(0,_.f3M)(wa);return t.scrollOffset&&n.setOffset(t.scrollOffset),new PE(i,r,n,e,t)}},r?.preloadingStrategy?MD(r.preloadingStrategy).\u0275providers:[],{provide:_.PXZ,multi:!0,useFactory:OD},r?.initialNavigation?FD(r):[],[{provide:BE,useFactory:Yh},{provide:_.tb,multi:!0,useExisting:BE}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Bl,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(kD,8))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[tg]}),n})();function VE(n){if(Hl&&n)throw new _.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function FD(n){return["disabled"===n.initialNavigation?wc(3,[{provide:_.ip1,multi:!0,useFactory:()=>{const e=(0,_.f3M)(Ti);return()=>{e.setUpLocationChangeListener()}}},{provide:hg,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?wc(2,[{provide:hg,useValue:0},{provide:_.ip1,multi:!0,deps:[_.zs3],useFactory:e=>{const t=e.get(ue,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const i=e.get(Ti),a=e.get(kE);(function PN(n,e){n.events.pipe(Li(t=>t instanceof ci||t instanceof pu||t instanceof gu||t instanceof hc),(0,Ct.U)(t=>t instanceof ci||t instanceof hc?Fs.COMPLETE:t instanceof pu&&(0===t.code||1===t.code)?Fs.REDIRECTING:Fs.FAILED),Li(t=>t!==Fs.REDIRECTING),ru(1)).subscribe(()=>{e()})})(i,()=>{r(!0)}),e.get(lg).afterPreactivation=()=>(r(!0),a.closed?ot(void 0):a),i.initialNavigation()}))}}]).\u0275providers:[]]}const BE=new _.OlP(Hl?"Router Initializer":""),Oy=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"home",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-home"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"Im home!"),_.qZA())}}),n})()},{path:"contact",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-contacts"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"contacts works!"),_.qZA())}}),n})()},{path:"mission-vission",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-mission"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"mission works!"),_.qZA())}}),n})()},{path:"announcements",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-news"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"news works!"),_.qZA())}}),n})()},{path:"rules-regulations",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-rules"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"rules works!"),_.qZA())}}),n})()},{path:"search",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-search"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"search works!"),_.qZA())}}),n})()},{path:"services",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-services"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"services works!"),_.qZA())}}),n})()},{path:"sign-in",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-sign-in"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"sign-in works!"),_.qZA())}}),n})()},{path:"sign-up",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-sign-up"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"sign-up works!"),_.qZA())}}),n})()}];let BD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[FE.forRoot(Oy),FE]}),n})(),jD=(()=>{class n{constructor(){}ngOnInit(){new typeAnimation}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-header"]],decls:61,vars:0,consts:[[1,"navbar","navbar-default"],[1,"container"],[1,"navbar-header"],["href","../",1,"navbar-brand"],["src","https://htmlstream.com/preview/space-v2.3.1/assets/svg/logos/logo.svg","alt","Image Description",1,"navbar-brand-logo"],["type","button","data-toggle","collapse","data-target","#navbar-main",1,"navbar-toggle"],[1,"icon-bar"],["id","navbar-main",1,"navbar-collapse","collapse"],[1,"nav","navbar-nav","navbar-right"],["href","#"],[1,"dropdown"],["data-toggle","dropdown","href","#","id","download",1,"dropdown-toggle"],[1,"caret"],["aria-labelledby","download",1,"dropdown-menu"],[1,"divider"],[1,"navdivider"],[1,"btn-signin"],["type","button",1,"btn","btn-default"],["aria-hidden","true",1,"glyphicon","glyphicon-user"],[1,"banner","position-relative","overflow-hidden"],[1,"row"],[1,"col-md-6"],[1,"mb-5"],[1,"d-block"],[1,"typed-words"],[1,"position-absolute","top-0","end-0"],["src","https://htmlstream.com/preview/space-v2.3.1/assets/svg/components/shape-3-soft-light.svg","alt","SVG","width","500"],[1,"position-absolute","bottom-0","end-0","me-10"],["src","https://htmlstream.com/preview/space-v2.3.1/assets/svg/components/shape-1-soft-light.svg","alt","SVG","width","250"],[1,"position-absolute","bottom-0","start-0"],["src","https://htmlstream.com/preview/space-v2.3.1/assets/svg/components/shape-2-soft-light.svg","alt","SVG","width","400"]],template:function(t,r){1&t&&(_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),_._UZ(4,"img",4),_.qZA(),_.TgZ(5,"button",5),_._UZ(6,"span",6)(7,"span",6)(8,"span",6),_.qZA()(),_.TgZ(9,"div",7)(10,"ul",8)(11,"li")(12,"a",9),_._uU(13,"Home"),_.qZA()(),_.TgZ(14,"li")(15,"a",9),_._uU(16,"Search"),_.qZA()(),_.TgZ(17,"li")(18,"a",9),_._uU(19,"Announcements"),_.qZA()(),_.TgZ(20,"li",10)(21,"a",11),_._uU(22,"About "),_._UZ(23,"span",12),_.qZA(),_.TgZ(24,"ul",13)(25,"li")(26,"a",9),_._uU(27,"Services"),_.qZA()(),_._UZ(28,"li",14),_.TgZ(29,"li")(30,"a",9),_._uU(31,"Mission Vission"),_.qZA()(),_._UZ(32,"li",14),_.TgZ(33,"li")(34,"a",9),_._uU(35,"Rules & Regulations"),_.qZA()()()(),_.TgZ(36,"li")(37,"a",9),_._uU(38,"Contact"),_.qZA()(),_._UZ(39,"li",15),_.TgZ(40,"li",16)(41,"button",17),_._UZ(42,"span",18),_._uU(43," Login"),_.qZA()()()()()(),_.TgZ(44,"div",19)(45,"div",1)(46,"div",20)(47,"div",21)(48,"h1",22)(49,"span",23),_._uU(50,"Let's Enjoy Your"),_.qZA(),_._uU(51," Trip In "),_._UZ(52,"span",24),_.qZA()(),_.TgZ(53,"div",21),_._uU(54,"b"),_.qZA()()(),_.TgZ(55,"div",25),_._UZ(56,"img",26),_.qZA(),_.TgZ(57,"div",27),_._UZ(58,"img",28),_.qZA(),_.TgZ(59,"div",29),_._UZ(60,"img",30),_.qZA()())},styles:[".banner[_ngcontent-%COMP%]{background-color:#a62c3a!important}.position-absolute[_ngcontent-%COMP%]{position:absolute!important}.position-relative[_ngcontent-%COMP%]{position:relative!important}.top-0[_ngcontent-%COMP%]{top:0!important}.end-0[_ngcontent-%COMP%]{right:0!important}.bottom-0[_ngcontent-%COMP%]{bottom:0!important}.me-10[_ngcontent-%COMP%]{margin-right:4.5rem!important}.start-0[_ngcontent-%COMP%]{left:0!important}.overflow-hidden[_ngcontent-%COMP%]{overflow:hidden!important}"]}),n})(),WE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-footer"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"p"),_._uU(1,"footer works!"),_.qZA())}}),n})();function $D(n,e){1&n&&_._UZ(0,"app-header")}function qE(n,e){1&n&&_._UZ(0,"app-footer")}let KE=(()=>{class n{constructor(t,r){this.router=t,this.activatedRoute=r,this.title="SCC - Opac",this.showHeader=!1,this.showFooter=!1}ngOnInit(){this.router.events.subscribe(t=>{t instanceof ci&&(this.showHeader=!1!==this.activatedRoute.root.firstChild?.snapshot.data.showHeader,this.showFooter=!1!==this.activatedRoute.root.firstChild?.snapshot.data.showFooter)})}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(Ti),_.Y36(ut))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-root"]],decls:3,vars:2,consts:[[4,"ngIf"]],template:function(t,r){1&t&&(_.YNc(0,$D,1,0,"app-header",0),_._UZ(1,"router-outlet"),_.YNc(2,qE,1,0,"app-footer",0)),2&t&&(_.Q6J("ngIf",r.showHeader),_.xp6(2),_.Q6J("ngIf",r.showFooter))},dependencies:[Jo,eg,jD,WE]}),n})();var cr=P(2011),Ly=P(6451),li=P(5363),ZE=P(6063);class HD extends Mo.x{constructor(e=1/0,t=1/0,r=ZE.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:c}=this;t||(r.push(e),!i&&r.push(a.now()+c)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let c=0;c<a.length&&!e.closed;c+=r?1:2)e.next(a[c]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const c=t.now();let h=0;for(let m=1;m<r.length&&r[m]<=c;m+=2)h=m;h&&r.splice(0,h+1)}}}var GD=P(3099);function Xh(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,(0,GD.B)({connector:()=>new HD(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Fy(n,e){return(0,_h.m)(e)?zn(()=>n,e):zn(()=>n)}var Uy=P(9468),un=P(462);P(259);var me=P(5861),Fi=P(9681),no=P(4859),N=P(2090),vs=P(1877);const Wl=new Map,ZD={activated:!1,tokenObservers:[]},jy={initialized:!1,enabled:!1};function bi(n){return Wl.get(n)||Object.assign({},ZD)}function Jh(){return jy}const gg="https://content-firebaseappcheck.googleapis.com/v1",Sa="exchangeDebugToken",ef={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class tf{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,me.Z)(function*(){t.stop();try{t.pending=new N.BH,yield function YD(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new N.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Ci=new N.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function nI(n,e){return Hy.apply(this,arguments)}function Hy(){return(Hy=(0,me.Z)(function*({url:n,body:e},t){const r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const D=yield i.getHeartbeatsHeader();D&&(r["X-Firebase-Client"]=D)}const a={method:"POST",body:JSON.stringify(e),headers:r};let c,h;try{c=yield fetch(n,a)}catch(D){throw Ci.create("fetch-network-error",{originalErrorMessage:D?.message})}if(200!==c.status)throw Ci.create("fetch-status-error",{httpStatus:c.status});try{h=yield c.json()}catch(D){throw Ci.create("fetch-parse-error",{originalErrorMessage:D?.message})}const m=h.ttl.match(/^([\d.]+)(s)$/);if(!m||!m[2]||isNaN(Number(m[1])))throw Ci.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const w=1e3*Number(m[1]),T=Date.now();return{token:h.token,expireTimeMillis:T+w,issuedAtTimeMillis:T}})).apply(this,arguments)}const eS="firebase-app-check-database",tS=1,nf="firebase-app-check-store";let rf=null;function iI(n,e){return Wy.apply(this,arguments)}function Wy(){return(Wy=(0,me.Z)(function*(n,e){const r=(yield function rI(){return rf||(rf=new Promise((n,e)=>{try{const t=indexedDB.open(eS,tS);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Ci.create("storage-open",{originalErrorMessage:null===(i=r.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(nf,{keyPath:"compositeKey"})}}catch(t){e(Ci.create("storage-open",{originalErrorMessage:t?.message}))}}),rf)}()).transaction(nf,"readwrite"),a=r.objectStore(nf).put({compositeKey:n,value:e});return new Promise((c,h)=>{a.onsuccess=m=>{c()},r.onerror=m=>{var w;h(Ci.create("storage-set",{originalErrorMessage:null===(w=m.target.error)||void 0===w?void 0:w.message}))}})})).apply(this,arguments)}const ql=new vs.Yd("@firebase/app-check");function vg(n,e){return(0,N.hl)()?function nS(n,e){return iI(function Ky(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{ql.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function uI(){return sf.apply(this,arguments)}function sf(){return(sf=(0,me.Z)(function*(){const n=Jh();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const Uo={error:"UNKNOWN_ERROR"};function af(n){return N.US.encodeString(JSON.stringify(n),!1)}function zr(n){return Aa.apply(this,arguments)}function Aa(){return(Aa=(0,me.Z)(function*(n,e=!1){const t=n.app;!function tI(n){if(!bi(n).activated)throw Ci.create("use-before-activation",{appName:n.name})}(t);const r=bi(t);let a,i=r.token;if(i&&!ro(i)&&(r.token=void 0,i=void 0),!i){const m=yield r.cachedTokenPromise;m&&(ro(m)?i=m:yield vg(t,void 0))}if(!e&&i&&ro(i))return{token:i.token};let h,c=!1;if(function aI(){return Jh().enabled}()){r.exchangeTokenPromise||(r.exchangeTokenPromise=nI(function JD(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${gg}/projects/${t}/apps/${r}:${Sa}?key=${i}`,body:{debug_token:e}}}(t,yield uI()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),c=!0);const m=yield r.exchangeTokenPromise;return yield vg(t,m),r.token=m,{token:m.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),c=!0),i=yield bi(t).exchangeTokenPromise}catch(m){"appCheck/throttled"===m.code?ql.warn(m.message):ql.error(m),a=m}return i?a?h=ro(i)?{token:i.token,internalError:a}:Tc(a):(h={token:i.token},r.token=i,yield vg(t,i)):h=Tc(a),c&&function Ic(n,e){const t=bi(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}(t,h),h})).apply(this,arguments)}function rs(n,e){const t=bi(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function wg(n){const{app:e}=n,t=bi(e);let r=t.tokenRefresher;r||(r=function Yl(n){const{app:e}=n;return new tf((0,me.Z)(function*(){let r;if(r=bi(e).token?yield zr(n,!0):yield zr(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=bi(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},ef.RETRIAL_MIN_WAIT,ef.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function ro(n){return n.expireTimeMillis-Date.now()>0}function Tc(n){return{token:af(Uo),error:n}}class Ql{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=bi(this.app);for(const t of e)rs(this.app,t.next);return Promise.resolve()}}const tv="app-check-internal";!function cS(){(0,Fi._registerComponent)(new no.wA("app-check",n=>function Xl(n,e){return new Ql(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(tv).initialize()})),(0,Fi._registerComponent)(new no.wA(tv,n=>function Jl(n){return{getToken:e=>zr(n,e),addTokenListener:e=>function Zl(n,e,t,r){const{app:i}=n,a=bi(i);if(a.tokenObservers=[...a.tokenObservers,{next:t,error:r,type:e}],a.token&&ro(a.token)){const h=a.token;Promise.resolve().then(()=>{t({token:h.token}),wg(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>wg(n))}(n,"INTERNAL",e),removeTokenListener:e=>rs(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Fi.registerVersion)("@firebase/app-check","0.6.4")}();class nd{constructor(){return(0,un.vb)("app-check")}}typeof window<"u"&&window;var Iu=P(9260);const Ag=new _.OlP("angularfire2.auth.use-emulator"),Rg=new _.OlP("angularfire2.auth.settings"),xg=new _.OlP("angularfire2.auth.tenant-id"),rd=new _.OlP("angularfire2.auth.langugage-code"),Vo=new _.OlP("angularfire2.auth.use-device-language"),nv=new _.OlP("angularfire.auth.persistence"),rv=(n,e,t,r,i,a,c,h)=>(0,cr.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const m=e.runOutsideAngular(()=>n.auth());if(t&&m.useEmulator(...t),r&&(m.tenantId=r),m.languageCode=i,a&&m.useDeviceLanguage(),c)for(const[w,T]of Object.entries(c))m.settings[w]=T;return h&&m.setPersistence(h),m},[t,r,i,a,c,h]);let bc=(()=>{class n{constructor(t,r,i,a,c,h,m,w,T,D,x,F){const $=new Mo.x,ee=ot(void 0).pipe((0,li.Q)(c.outsideAngular),zn(()=>a.runOutsideAngular(()=>Promise.resolve().then(P.bind(P,8971)))),(0,Ct.U)(()=>(0,cr.on)(t,a,r)),(0,Ct.U)(se=>rv(se,a,h,w,T,D,m,x)),Xh({bufferSize:1,refCount:!1}));if(sa(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ot(null);else{ee.pipe(ps()).subscribe();const ht=ee.pipe(zn(It=>It.getRedirectResult().then(Vt=>Vt,()=>null)),un.iC,Xh({bufferSize:1,refCount:!1})),vt=ee.pipe(zn(It=>new Oi.y(Vt=>({unsubscribe:a.runOutsideAngular(()=>It.onAuthStateChanged(Zt=>Vt.next(Zt),Zt=>Vt.error(Zt),()=>Vt.complete()))})))),dt=ee.pipe(zn(It=>new Oi.y(Vt=>({unsubscribe:a.runOutsideAngular(()=>It.onIdTokenChanged(Zt=>Vt.next(Zt),Zt=>Vt.error(Zt),()=>Vt.complete()))}))));this.authState=ht.pipe(Fy(vt),(0,Uy.R)(c.outsideAngular),(0,li.Q)(c.insideAngular)),this.user=ht.pipe(Fy(dt),(0,Uy.R)(c.outsideAngular),(0,li.Q)(c.insideAngular)),this.idToken=this.user.pipe(zn(It=>It?(0,Xt.D)(It.getIdToken()):ot(null))),this.idTokenResult=this.user.pipe(zn(It=>It?(0,Xt.D)(It.getIdTokenResult()):ot(null))),this.credential=(0,Ly.T)(ht,$,this.authState.pipe(Li(It=>!It))).pipe((0,Ct.U)(It=>It?.user?It:null),(0,Uy.R)(c.outsideAngular),(0,li.Q)(c.insideAngular))}return(0,cr.pX)(this,ee,a,{spy:{apply:(se,ht,vt)=>{(se.startsWith("signIn")||se.startsWith("createUser"))&&vt.then(dt=>$.next(dt))}}})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(cr.Dh),_.LFG(cr.xv,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(un.HU),_.LFG(Ag,8),_.LFG(Rg,8),_.LFG(xg,8),_.LFG(rd,8),_.LFG(Vo,8),_.LFG(nv,8),_.LFG(nd,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Cc=(()=>{class n{constructor(){Iu.Z.registerVersion("angularfire",un.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[bc]}),n})();var cf=P(4986),lf=P(3942);const yS="firebasestorage.googleapis.com",vS="storageBucket";class lr extends N.ZR{constructor(e,t,r=0){super(Mg(e),`Firebase Storage: ${t} (${Mg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,lr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Mg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Jt=(()=>{return(n=Jt||(Jt={})).UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",Jt;var n})();function Mg(n){return"storage/"+n}function iv(){return new lr(Jt.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Dc(){return new lr(Jt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function SI(){return new lr(Jt.CANCELED,"User canceled the upload/download.")}function sv(){return new lr(Jt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Ui(n){return new lr(Jt.INVALID_ARGUMENT,n)}function MI(){return new lr(Jt.APP_DELETED,"The Firebase app was deleted.")}function NI(n){return new lr(Jt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function is(n,e){return new lr(Jt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Vi(n){throw new lr(Jt.INTERNAL_ERROR,"Internal error: "+n)}class Wn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Wn.makeFromUrl(e,t)}catch{return new Wn(e,"")}if(""===r.path)return r;throw function AI(n){return new lr(Jt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",h=new RegExp("^gs://"+i+"(/(.*))?$","i");function w(It){It.path_=decodeURIComponent(It.path)}const D=t.replace(/[.]/g,"\\."),dt=[{regex:h,indices:{bucket:1,path:3},postModify:function a(It){"/"===It.path.charAt(It.path.length-1)&&(It.path_=It.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${D}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:w},{regex:new RegExp(`^https?://${t===yS?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:w}];for(let It=0;It<dt.length;It++){const Vt=dt[It],Zt=Vt.regex.exec(e);if(Zt){let Gs=Zt[Vt.indices.path];Gs||(Gs=""),r=new Wn(Zt[Vt.indices.bucket],Gs),Vt.postModify(r);break}}if(null==r)throw function bS(n){return new lr(Jt.INVALID_URL,"Invalid URL '"+n+"'.")}(e);return r}}class PI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function id(n){return"string"==typeof n||n instanceof String}function sd(n){return ov()&&n instanceof Blob}function ov(){return typeof Blob<"u"&&!(0,N.UG)()}function Ng(n,e,t,r){if(r<e)throw Ui(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ui(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ra(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function av(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var xa=(()=>{return(n=xa||(xa={}))[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",xa;var n})();function df(n,e){const t=n>=500&&n<600,i=-1!==[408,429].indexOf(n),a=-1!==e.indexOf(n);return t||i||a}class xS{constructor(e,t,r,i,a,c,h,m,w,T,D,x=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=c,this.callback_=h,this.errorCallback_=m,this.timeout_=w,this.progressCallback_=T,this.connectionFactory_=D,this.retry=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((F,$)=>{this.resolve_=F,this.reject_=$,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,c=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const m=this.callback_(h,h.getResponse());!function SS(n){return void 0!==n}(m)?a():a(m)}catch(m){c(m)}else if(null!==h){const m=iv();m.serverResponse=h.getErrorText(),c(this.errorCallback_?this.errorCallback_(h,m):m)}else c(i.canceled?this.appDelete_?MI():SI():Dc())};this.canceled_?t(0,new hf(!1,null,!0)):this.backoffId_=function kI(n,e,t){let r=1,i=null,a=null,c=!1,h=0;function m(){return 2===h}let w=!1;function T(...se){w||(w=!0,e.apply(null,se))}function D(se){i=setTimeout(()=>{i=null,n(F,m())},se)}function x(){a&&clearTimeout(a)}function F(se,...ht){if(w)return void x();if(se)return x(),void T.call(null,se,...ht);if(m()||c)return x(),void T.call(null,se,...ht);let dt;r<64&&(r*=2),1===h?(h=2,dt=0):dt=1e3*(r+Math.random()),D(dt)}let $=!1;function ee(se){$||($=!0,x(),!w&&(null!==i?(se||(h=2),clearTimeout(i),D(0)):se||(h=1)))}return D(0),a=setTimeout(()=>{c=!0,ee(!0)},t),ee}((r,i)=>{if(i)return void r(!1,new hf(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const c=h=>{null!==this.progressCallback_&&this.progressCallback_(h.loaded,h.lengthComputable?h.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(c),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(c),this.pendingConnection_=null;const h=a.getErrorCode()===xa.NO_ERROR,m=a.getStatus();if(!h||df(m,this.additionalRetryCodes_)&&this.retry){const T=a.getErrorCode()===xa.ABORT;return void r(!1,new hf(!1,null,T))}const w=-1!==this.successCodes_.indexOf(m);r(!0,new hf(w,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function DS(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class hf{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function BI(...n){const e=function VI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(ov())return new Blob(n);throw new lr(Jt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const ss={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Pg{constructor(e,t){this.data=e,this.contentType=t||null}}function cv(n,e){switch(n){case ss.RAW:return new Pg(HI(e));case ss.BASE64:case ss.BASE64URL:return new Pg(GI(n,e));case ss.DATA_URL:return new Pg(function NS(n){const e=new zI(n);return e.base64?GI(ss.BASE64,e.rest):function MS(n){let e;try{e=decodeURIComponent(n)}catch{throw is(ss.DATA_URL,"Malformed data URL.")}return HI(e)}(e.rest)}(e),function PS(n){return new zI(n).contentType}(e))}throw iv()}function HI(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function GI(n,e){switch(n){case ss.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw is(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case ss.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw is(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function $I(n){if(typeof atob>"u")throw function xI(n){return new lr(Jt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(e)}catch(i){throw i.message.includes("polyfill")?i:is(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class zI{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw is(ss.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function kS(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class Bo{constructor(e,t){let r=0,i="";sd(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(sd(this.data_)){const i=function jI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new Bo(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Bo(r,!0)}}static getBlob(...e){if(ov()){const t=e.map(r=>r instanceof Bo?r.data_:r);return new Bo(BI.apply(null,t))}{const t=e.map(c=>id(c)?cv(ss.RAW,c).data:c.data_);let r=0;t.forEach(c=>{r+=c.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(c=>{for(let h=0;h<c.length;h++)i[a++]=c[h]}),new Bo(i,!0)}}uploadData(){return this.data_}}function lv(n){let e;try{e=JSON.parse(n)}catch{return null}return function RS(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function WI(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function FS(n,e){return e}class Bi{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||FS}}let kg=null;function ff(){if(kg)return kg;const n=[];n.push(new Bi("bucket")),n.push(new Bi("generation")),n.push(new Bi("metageneration")),n.push(new Bi("name","fullPath",!0));const t=new Bi("name");t.xform=function e(a,c){return function US(n){return!id(n)||n.length<2?n:WI(n)}(c)},n.push(t);const i=new Bi("size");return i.xform=function r(a,c){return void 0!==c?Number(c):c},n.push(i),n.push(new Bi("timeCreated")),n.push(new Bi("updated")),n.push(new Bi("md5Hash",null,!0)),n.push(new Bi("cacheControl",null,!0)),n.push(new Bi("contentDisposition",null,!0)),n.push(new Bi("contentEncoding",null,!0)),n.push(new Bi("contentLanguage",null,!0)),n.push(new Bi("contentType",null,!0)),n.push(new Bi("metadata","customMetadata",!0)),kg=n,kg}function dv(n,e,t){const r=lv(e);return null===r?null:function KI(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const c=t[a];r[c.local]=c.xform(r,e[c.server])}return function qI(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new Wn(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function Og(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const hv="prefixes",fv="items";class io{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function so(n){if(!n)throw iv()}function jo(n,e){return function t(r,i){const a=dv(n,i,e);return so(null!==a),a}}function oo(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function CI(){return new lr(Jt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function TS(){return new lr(Jt.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function bI(n){return new lr(Jt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function DI(n){return new lr(Jt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}}function Lg(n){const e=oo(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function IS(n){return new lr(Jt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function Fg(n,e,t){const i=Ra(e.fullServerUrl(),n.host,n._protocol),c=n.maxOperationRetryTime,h=new io(i,"GET",jo(n,t),c);return h.errorHandler=Lg(e),h}function QN(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const h=Ra(e.bucketOnlyServerUrl(),n.host,n._protocol),w=n.maxOperationRetryTime,T=new io(h,"GET",function VS(n,e){return function t(r,i){const a=function QI(n,e,t){const r=lv(t);return null===r?null:function YI(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[hv])for(const i of t[hv]){const a=i.replace(/\/$/,""),c=n._makeStorageReference(new Wn(e,a));r.prefixes.push(c)}if(t[fv])for(const i of t[fv]){const a=n._makeStorageReference(new Wn(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return so(null!==a),a}}(n,e.bucket),w);return T.urlParams=a,T.errorHandler=oo(e),T}function JI(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function jS(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class Ma{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function gv(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{so(!1)}return so(!!t&&-1!==(e||["active"]).indexOf(t)),t}const tT={STATE_CHANGED:"state_changed"},Di={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function mv(n){switch(n){case"running":case"pausing":case"canceling":return Di.RUNNING;case"paused":return Di.PAUSED;case"success":return Di.SUCCESS;case"canceled":return Di.CANCELED;default:return Di.ERROR}}class nT{constructor(e,t,r){if(function AS(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function Sc(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}let _v=null;class rT{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=xa.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=xa.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=xa.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Vi("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Vi("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Vi("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Vi("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Vi("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class $S extends rT{initXhr(){this.xhr_.responseType="text"}}function ao(){return _v?_v():new $S}class iT{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=ff(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Jt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(df(i.status,[])){if(!a)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=Dc()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Jt.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function Ug(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),c=JI(e,r,i),h={name:c.fullPath},m=Ra(a,n.host,n._protocol),T={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},D=Og(c,t),$=new io(m,"POST",function F(ee){let se;gv(ee);try{se=ee.getResponseHeader("X-Goog-Upload-URL")}catch{so(!1)}return so(id(se)),se},n.maxUploadRetryTime);return $.urlParams=h,$.headers=T,$.body=D,$.errorHandler=oo(e),$}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ao,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function Vg(n,e,t,r){const m=new io(t,"POST",function a(w){const T=gv(w,["active","final"]);let D=null;try{D=w.getResponseHeader("X-Goog-Upload-Size-Received")}catch{so(!1)}D||so(!1);const x=Number(D);return so(!isNaN(x)),new Ma(x,r.size(),"final"===T)},n.maxUploadRetryTime);return m.headers={"X-Goog-Upload-Command":"query"},m.errorHandler=oo(e),m}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,ao,t,r);this._request=a,a.getPromise().then(c=>{this._request=void 0,this._updateProgress(c.current),this._needToFetchStatus=!1,c.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new Ma(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let c;try{c=function JN(n,e,t,r,i,a,c,h){const m=new Ma(0,0);if(c?(m.current=c.current,m.total=c.total):(m.current=0,m.total=r.size()),r.size()!==m.total)throw function YN(){return new lr(Jt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const w=m.total-m.current;let T=w;i>0&&(T=Math.min(T,i));const D=m.current;let F="";F=0===T?"finalize":w===T?"upload, finalize":"upload";const $={"X-Goog-Upload-Command":F,"X-Goog-Upload-Offset":`${m.current}`},ee=r.slice(D,D+T);if(null===ee)throw sv();const dt=new io(t,"POST",function se(It,Vt){const Zt=gv(It,["active","final"]),$r=m.current+T,Gs=r.size();let TN;return TN="final"===Zt?jo(e,a)(It,Vt):null,new Ma($r,Gs,"final"===Zt,TN)},e.maxUploadRetryTime);return dt.headers=$,dt.body=ee.uploadData(),dt.progressCallback=h||null,dt.errorHandler=oo(n),dt}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(m){return this._error=m,void this._transition("error")}const h=this._ref.storage._makeRequest(c,ao,i,a,!1);this._request=h,h.getPromise().then(m=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(m.current),m.finalized?(this._metadata=m.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=Fg(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,ao,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function eT(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"},m=function h(){let dt="";for(let It=0;It<2;It++)dt+=Math.random().toString().slice(2);return dt}();c["Content-Type"]="multipart/related; boundary="+m;const w=JI(e,r,i),T=Og(w,t),F=Bo.getBlob("--"+m+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+T+"\r\n--"+m+"\r\nContent-Type: "+w.contentType+"\r\n\r\n",r,"\r\n--"+m+"--");if(null===F)throw sv();const $={name:w.fullPath},ee=Ra(a,n.host,n._protocol),ht=n.maxUploadRetryTime,vt=new io(ee,"POST",jo(n,t),ht);return vt.urlParams=$,vt.headers=c,vt.body=F.uploadData(),vt.errorHandler=oo(e),vt}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ao,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=SI(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=mv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new nT(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(mv(this._state)){case Di.SUCCESS:Sc(this._resolve.bind(null,this.snapshot))();break;case Di.CANCELED:case Di.ERROR:Sc(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(mv(this._state)){case Di.RUNNING:case Di.PAUSED:e.next&&Sc(e.next.bind(e,this.snapshot))();break;case Di.SUCCESS:e.complete&&Sc(e.complete.bind(e))();break;default:e.error&&Sc(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class $o{constructor(e,t){this._service=e,this._location=t instanceof Wn?t:Wn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new $o(e,t)}get root(){const e=new Wn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return WI(this._location.path)}get storage(){return this._service}get parent(){const e=function OS(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new Wn(this._location.bucket,e);return new $o(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw NI(e)}}function aT(n,e,t){return vv.apply(this,arguments)}function vv(){return(vv=(0,me.Z)(function*(n,e,t){const i=yield uT(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield aT(n,e,i.nextPageToken))})).apply(this,arguments)}function uT(n,e){null!=e&&"number"==typeof e.maxResults&&Ng("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=QN(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,ao)}function dT(n){n._throwIfRoot("getDownloadURL");const e=function XI(n,e,t){const i=Ra(e.fullServerUrl(),n.host,n._protocol),c=n.maxOperationRetryTime,h=new io(i,"GET",function BS(n,e){return function t(r,i){const a=dv(n,i,e);return so(null!==a),function ZI(n,e,t,r){const i=lv(e);if(null===i||!id(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const c=encodeURIComponent;return a.split(",").map(w=>{const D=n.fullPath;return Ra("/b/"+c(n.bucket)+"/o/"+c(D),t,r)+av({alt:"media",token:w})})[0]}(a,i,n.host,n._protocol)}}(n,t),c);return h.errorHandler=Lg(e),h}(n.storage,n._location,ff());return n.storage.makeRequestWithTokens(e,ao).then(t=>{if(null===t)throw function RI(){return new lr(Jt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return t})}function wv(n,e){const t=function LS(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new Wn(n._location.bucket,t);return new $o(n.storage,r)}function YS(n,e){if(n instanceof Bg){const t=n;if(null==t._bucket)throw function CS(){return new lr(Jt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+vS+"' property when initializing the app?")}();const r=new $o(t,t._bucket);return null!=e?YS(r,e):r}return void 0!==e?wv(n,e):n}function eP(n,e){if(e&&function KS(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof Bg)return function ZS(n,e){return new $o(n,e)}(n,e);throw Ui("To use ref(service, url), the first argument must be a Storage instance.")}return YS(n,e)}function QS(n,e){const t=e?.[vS];return null==t?null:Wn.makeFromBucketSpec(t,n)}class Bg{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=yS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Wn.makeFromBucketSpec(i,this._host):QS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?Wn.makeFromBucketSpec(this._url,e):QS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ng("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ng("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,me.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,me.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $o(this,e)}_makeRequest(e,t,r,i,a=!0){if(this._deleted)return new PI(MI());{const c=function UI(n,e,t,r,i,a,c=!0){const h=av(n.urlParams),m=n.url+h,w=Object.assign({},n.headers);return function uv(n,e){e&&(n["X-Firebase-GMPID"]=e)}(w,e),function OI(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(w,t),function LI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(w,a),function FI(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(w,r),new xS(m,n.method,w,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,c)}(e,this._appId,r,i,t,this._firebaseVersion,a);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}makeRequestWithTokens(e,t){var r=this;return(0,me.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const _f="@firebase/storage";function gT(n,e){return eP(n=(0,N.m9)(n),e)}function sA(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Bg(t,r,i,e,Fi.SDK_VERSION)}!function mT(){(0,Fi._registerComponent)(new no.wA("storage",sA,"PUBLIC").setMultipleInstances(!0)),(0,Fi.registerVersion)(_f,"0.11.2",""),(0,Fi.registerVersion)(_f,"0.11.2","esm2017")}();class $g{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class Hg{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new $g(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new $g(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?c=>t(new $g(c,this,this._ref)):{next:t.next?c=>t.next(new $g(c,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class _T{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Ho(e,this._service))}get items(){return this._delegate.items.map(e=>new Ho(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Ho{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function yf(n,e){return wv(n,e)}(this._delegate,e);return new Ho(t,this.storage)}get root(){return new Ho(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Ho(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new Hg(function JS(n,e,t){return function WS(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new iT(n,new Bo(e),t)}(n=(0,N.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=ss.RAW,r){this._throwIfRoot("putString");const i=cv(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new Hg(new iT(this._delegate,new Bo(i.data,!0),a),this)}listAll(){return function nA(n){return function mf(n){const e={prefixes:[],items:[]};return aT(n,e).then(()=>e)}(n=(0,N.m9)(n))}(this._delegate).then(e=>new _T(e,this.storage))}list(e){return function rP(n,e){return uT(n=(0,N.m9)(n),e)}(this._delegate,e||void 0).then(t=>new _T(t,this.storage))}getMetadata(){return function eA(n){return function cT(n){n._throwIfRoot("getMetadata");const e=Fg(n.storage,n._location,ff());return n.storage.makeRequestWithTokens(e,ao)}(n=(0,N.m9)(n))}(this._delegate)}updateMetadata(e){return function tA(n,e){return function lT(n,e){n._throwIfRoot("updateMetadata");const t=function XN(n,e,t,r){const a=Ra(e.fullServerUrl(),n.host,n._protocol),h=Og(t,r),w=n.maxOperationRetryTime,T=new io(a,"PATCH",jo(n,r),w);return T.headers={"Content-Type":"application/json; charset=utf-8"},T.body=h,T.errorHandler=Lg(e),T}(n.storage,n._location,e,ff());return n.storage.makeRequestWithTokens(t,ao)}(n=(0,N.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function pT(n){return dT(n=(0,N.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function rA(n){return function qS(n){n._throwIfRoot("deleteObject");const e=function Ut(n,e){const r=Ra(e.fullServerUrl(),n.host,n._protocol),h=new io(r,"DELETE",function c(m,w){},n.maxOperationRetryTime);return h.successCodes=[200,204],h.errorHandler=Lg(e),h}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,ao)}(n=(0,N.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw NI(e)}}class Iv{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(yT(e))throw Ui("ref() expected a child path but got a URL, use refFromURL instead.");return new Ho(gT(this._delegate,e),this)}refFromURL(e){if(!yT(e))throw Ui("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Wn.makeFromUrl(e,this._delegate.host)}catch{throw Ui("refFromUrl() expected a valid full URL but got an invalid one.")}return new Ho(gT(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function Ev(n,e,t,r={}){!function tP(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,N.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function yT(n){return/^[A-Za-z]+:\/\//.test(n)}function uA(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new Iv(t,r)}function wT(n){const e=function cA(n){return new Oi.y(e=>{const t=c=>e.next(c);t(n.snapshot);const a=n.on("state_changed",t);return n.then(c=>{t(c),e.complete()},c=>{t(n.snapshot),(c=>{e.error(c)})(c)}),function(){a()}}).pipe(function _S(n,e=cf.z){return(0,wr.e)((t,r)=>{let i=null,a=null,c=null;const h=()=>{if(i){i.unsubscribe(),i=null;const w=a;a=null,r.next(w)}};function m(){const w=c+n,T=e.now();if(T<w)return i=this.schedule(void 0,w-T),void r.add(i);h()}t.subscribe((0,Un.x)(r,w=>{a=w,c=e.now(),i||(i=e.schedule(m,n),r.add(i))},()=>{h(),r.complete()},void 0,()=>{a=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,Ct.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function Gg(n){return{getDownloadURL:()=>ot(void 0).pipe(un.fc,zn(()=>n.getDownloadURL()),un.iC),getMetadata:()=>ot(void 0).pipe(un.fc,zn(()=>n.getMetadata()),un.iC),delete:()=>(0,Xt.D)(n.delete()),child:e=>Gg(n.child(e)),updateMetadata:e=>(0,Xt.D)(n.updateMetadata(e)),put:(e,t)=>wT(n.put(e,t)),putString:(e,t,r)=>wT(n.putString(e,t,r)),list:e=>(0,Xt.D)(n.list(e)),listAll:()=>(0,Xt.D)(n.listAll())}}!function vT(n){const e={TaskState:Di,TaskEvent:tT,StringFormat:ss,Storage:Iv,Reference:Ho};n.INTERNAL.registerComponent(new no.wA("storage-compat",uA,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.2")}(lf.Z);const lA=new _.OlP("angularfire2.storageBucket"),dA=new _.OlP("angularfire2.storage.maxUploadRetryTime"),hA=new _.OlP("angularfire2.storage.maxOperationRetryTime"),fA=new _.OlP("angularfire2.storage.use-emulator");let pA=(()=>{class n{constructor(t,r,i,a,c,h,m,w,T,D){const x=(0,cr.on)(t,c,r);this.storage=(0,cr.cc)(`${x.name}.storage.${i}`,"AngularFireStorage",x.name,()=>{const F=c.runOutsideAngular(()=>x.storage(i||void 0)),$=T;return $&&F.useEmulator(...$),m&&F.setMaxUploadRetryTime(m),w&&F.setMaxOperationRetryTime(w),F},[m,w])}ref(t){return Gg(this.storage.ref(t))}refFromURL(t){return Gg(this.storage.refFromURL(t))}upload(t,r,i){return Gg(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(cr.Dh),_.LFG(cr.xv,8),_.LFG(lA,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(un.HU),_.LFG(dA,8),_.LFG(hA,8),_.LFG(fA,8),_.LFG(nd,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),ET=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})(),mA=(()=>{class n{constructor(){Iu.Z.registerVersion("angularfire",un.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[pA],imports:[ET]}),n})();function zg(){return(0,wr.e)((n,e)=>{let t,r=!1;n.subscribe((0,Un.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}function Wg(n,e=Ji.y){return n=n??_A,(0,wr.e)((t,r)=>{let i,a=!0;t.subscribe((0,Un.x)(r,c=>{const h=e(c);(a||!n(i,h))&&(a=!1,i=h,r.next(c))}))})}function _A(n,e){return n===e}P(8971);var Et,yA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uo={},qg=qg||{},qt=yA||self;function Kg(){}function Zg(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Ac(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var bv="closure_uid_"+(1e9*Math.random()>>>0),od=0;function IT(n,e,t){return n.call.apply(n.bind,arguments)}function wA(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function ji(n,e,t){return(ji=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?IT:wA).apply(null,arguments)}function vf(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Wr(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(r,i,a){for(var c=Array(arguments.length-2),h=2;h<arguments.length;h++)c[h-2]=arguments[h];return e.prototype[i].apply(r,c)}}function Tu(){this.s=this.s,this.o=this.o}Tu.prototype.s=!1,Tu.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function vA(n){Object.prototype.hasOwnProperty.call(n,bv)&&n[bv]||(n[bv]=++od)}(this)},Tu.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const TT=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Yg(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Qg(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Zg(r)){const i=n.length||0,a=r.length||0;n.length=i+a;for(let c=0;c<a;c++)n[i+c]=r[c]}else n.push(r)}}function di(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}di.prototype.h=function(){this.defaultPrevented=!0};var bT=function(){if(!qt.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{qt.addEventListener("test",Kg,e),qt.removeEventListener("test",Kg,e)}catch{}return n}();function wf(n){return/^[\s\xa0]*$/.test(n)}var Dv=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Sv(n,e){return n<e?-1:n>e?1:0}function Xg(){var n=qt.navigator;return n&&(n=n.userAgent)?n:""}function Go(n){return-1!=Xg().indexOf(n)}function Av(n){return Av[" "](n),n}Av[" "]=Kg;var Jg,n,aP=Go("Opera"),Rc=Go("Trident")||Go("MSIE"),DT=Go("Edge"),Rv=DT||Rc,EA=Go("Gecko")&&!(-1!=Xg().toLowerCase().indexOf("webkit")&&!Go("Edge"))&&!(Go("Trident")||Go("MSIE"))&&!Go("Edge"),IA=-1!=Xg().toLowerCase().indexOf("webkit")&&!Go("Edge");function ST(){var n=qt.document;return n?n.documentMode:void 0}e:{var xv="",Mv=(n=Xg(),EA?/rv:([^\);]+)(\)|;)/.exec(n):DT?/Edge\/([\d\.]+)/.exec(n):Rc?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):IA?/WebKit\/(\S+)/.exec(n):aP?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(Mv&&(xv=Mv?Mv[1]:""),Rc){var Nv=ST();if(null!=Nv&&Nv>parseFloat(xv)){Jg=String(Nv);break e}}Jg=xv}var TA={};var CA=qt.document&&Rc&&(ST()||parseInt(Jg,10))||void 0;function Ef(n,e){if(di.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(EA){e:{try{Av(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:If[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Ef.X.h.call(this)}}Wr(Ef,di);var If={2:"touch",3:"pen",4:"mouse"};Ef.prototype.h=function(){Ef.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var ad="closure_listenable_"+(1e6*Math.random()|0),RT=0;function xT(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ha=i,this.key=++RT,this.ba=this.ea=!1}function Tf(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function em(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function MT(n){const e={};for(const t in n)e[t]=n[t];return e}const NT="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function DA(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<NT.length;a++)t=NT[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function tm(n){this.src=n,this.g={},this.h=0}function kv(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=TT(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(Tf(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Ov(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ba&&a.listener==e&&a.capture==!!t&&a.ha==r)return i}return-1}tm.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var c=Ov(n,e,r,i);return-1<c?(e=n[c],t||(e.ea=!1)):((e=new xT(e,this.src,a,!!r,i)).ea=t,n.push(e)),e};var Lv="closure_lm_"+(1e6*Math.random()|0),Fv={};function ud(n,e,t,r,i){if(r&&r.once)return co(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)ud(n,e[a],t,r,i);return null}return t=ld(t),n&&n[ad]?n.N(e,t,Ac(r)?!!r.capture:!!r,i):PT(n,e,t,!1,r,i)}function PT(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var c=Ac(i)?!!i.capture:!!i,h=Vv(n);if(h||(n[Lv]=h=new tm(n)),(t=h.add(e,t,r,c,a)).proxy)return t;if(r=function Uv(){const e=SA;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)bT||(i=c),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(cd(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function co(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)co(n,e[a],t,r,i);return null}return t=ld(t),n&&n[ad]?n.O(e,t,Ac(r)?!!r.capture:!!r,i):PT(n,e,t,!0,r,i)}function kT(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)kT(n,e[a],t,r,i);else r=Ac(r)?!!r.capture:!!r,t=ld(t),n&&n[ad]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Ov(a=n.g[e],t,r,i))&&(Tf(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=Vv(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Ov(e,t,r,i)),(t=-1<n?e[n]:null)&&bf(t))}function bf(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[ad])kv(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(cd(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Vv(e))?(kv(t,n),0==t.h&&(t.src=null,e[Lv]=null)):Tf(n)}}}function cd(n){return n in Fv?Fv[n]:Fv[n]="on"+n}function SA(n,e){if(n.ba)n=!0;else{e=new Ef(e,this);var t=n.listener,r=n.ha||n.src;n.ea&&bf(n),n=t.call(r,e)}return n}function Vv(n){return(n=n[Lv])instanceof tm?n:null}var Bv="__closure_events_fn_"+(1e9*Math.random()>>>0);function ld(n){return"function"==typeof n?n:(n[Bv]||(n[Bv]=function(e){return n.handleEvent(e)}),n[Bv])}function xr(){Tu.call(this),this.i=new tm(this),this.P=this,this.I=null}function hi(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new di(e,n);else if(e instanceof di)e.target=e.target||n;else{var i=e;DA(e=new di(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var c=e.g=t[a];i=nm(c,r,!0,e)&&i}if(i=nm(c=e.g=n,r,!0,e)&&i,i=nm(c,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=nm(c=e.g=t[a],r,!1,e)&&i}function nm(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var c=e[a];if(c&&!c.ba&&c.capture==t){var h=c.listener,m=c.ha||c.src;c.ea&&kv(n.i,c),i=!1!==h.call(m,r)&&i}}return i&&!r.defaultPrevented}Wr(xr,Tu),xr.prototype[ad]=!0,xr.prototype.removeEventListener=function(n,e,t,r){kT(this,n,e,t,r)},xr.prototype.M=function(){if(xr.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Tf(t[r]);delete n.g[e],n.h--}}this.I=null},xr.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},xr.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var rm=qt.JSON.stringify;function OT(){var n=LT;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Cf,$v=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Hv,n=>n.reset());class Hv{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Gv(n){qt.setTimeout(()=>{throw n},0)}function zv(n,e){Cf||function Wv(){var n=qt.Promise.resolve(void 0);Cf=function(){n.then(AA)}}(),qv||(Cf(),qv=!0),LT.add(n,e)}var qv=!1,LT=new class jv{constructor(){this.h=this.g=null}add(e,t){const r=$v.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function AA(){for(var n;n=OT();){try{n.h.call(n.g)}catch(t){Gv(t)}var e=$v;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}qv=!1}function im(n,e){xr.call(this),this.h=n||1,this.g=e||qt,this.j=ji(this.lb,this),this.l=Date.now()}function sm(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function Df(n,e,t){if("function"==typeof n)t&&(n=ji(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=ji(n.handleEvent,n)}return 2147483647<Number(e)?-1:qt.setTimeout(n,e||0)}function Kv(n){n.g=Df(()=>{n.g=null,n.i&&(n.i=!1,Kv(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Wr(im,xr),(Et=im.prototype).ca=!1,Et.R=null,Et.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),hi(this,"tick"),this.ca&&(sm(this),this.start()))}},Et.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Et.M=function(){im.X.M.call(this),sm(this),delete this.g};class RA extends Tu{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Kv(this)}M(){super.M(),this.g&&(qt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function dd(n){Tu.call(this),this.h=n,this.g={}}Wr(dd,Tu);var Zv=[];function FT(n,e,t,r){Array.isArray(t)||(t&&(Zv[0]=t.toString()),t=Zv);for(var i=0;i<t.length;i++){var a=ud(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function Yv(n){em(n.g,function(e,t){this.g.hasOwnProperty(t)&&bf(e)},n),n.g={}}function Sf(){this.g=!0}function hd(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function fd(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var c=1;c<i.length;c++)i[c]=""}}}return rm(t)}catch{return e}}(n,t)+(r?" "+r:"")})}dd.prototype.M=function(){dd.X.M.call(this),Yv(this)},dd.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Sf.prototype.Aa=function(){this.g=!1},Sf.prototype.info=function(){};var xc={},VT=null;function Qv(){return VT=VT||new xr}function MA(n){di.call(this,xc.Pa,n)}function pd(n){const e=Qv();hi(e,new MA(e))}function om(n,e){di.call(this,xc.STAT_EVENT,n),this.stat=e}function qr(n){const e=Qv();hi(e,new om(e,n))}function BT(n,e){di.call(this,xc.Qa,n),this.size=e}function Mc(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return qt.setTimeout(function(){n()},e)}xc.Pa="serverreachability",Wr(MA,di),xc.STAT_EVENT="statevent",Wr(om,di),xc.Qa="timingevent",Wr(BT,di);var am={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Xv={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function Jv(){}function $T(){}Jv.prototype.h=null;var gd,Nc={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function um(){di.call(this,"d")}function cm(){di.call(this,"c")}function md(){}function lm(n,e,t,r){this.l=n,this.j=e,this.m=t,this.U=r||1,this.S=new dd(this),this.O=NA,this.T=new im(n=Rv?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new ew}function ew(){this.i=null,this.g="",this.h=!1}Wr(um,di),Wr(cm,di),Wr(md,Jv),md.prototype.g=function(){return new XMLHttpRequest},md.prototype.i=function(){return{}},gd=new md;var NA=45e3,dm={},Na={};function tw(n,e,t){n.K=1,n.v=mm(Pa(e)),n.s=t,n.P=!0,nw(n,null)}function nw(n,e){n.F=Date.now(),fm(n),n.A=Pa(n.v);var t=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),VA(t.i,"t",r),n.C=0,t=n.l.H,n.h=new ew,n.g=WA(n.l,t?e:null,!n.s),0<n.N&&(n.L=new RA(ji(n.La,n,n.g),n.N)),FT(n.S,n.g,"readystatechange",n.ib),e=n.H?MT(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),pd(),function xA(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var c="",h=a.split("&"),m=0;m<h.length;m++){var w=h[m].split("=");if(1<w.length){var T=w[0];w=w[1];var D=T.split("_");c=2<=D.length&&"type"==D[1]?c+(T+"=")+w+"&":c+(T+"=redacted&")}}else c=null;else c=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+c})}(n.j,n.u,n.A,n.m,n.U,n.s)}function hm(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function PA(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=kA(n,t),i==Na){4==e&&(n.o=4,qr(14),r=!1),hd(n.j,n.m,null,"[Incomplete Response]");break}if(i==dm){n.o=4,qr(15),hd(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}hd(n.j,n.m,i,null),gm(n,i)}hm(n)&&i!=Na&&i!=dm&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,qr(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),Mm(e),e.K=!0,qr(11))):(hd(n.j,n.m,t,"[Invalid Chunked Response]"),bu(n),Af(n))}function kA(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Na:(t=Number(e.substring(t,r)),isNaN(t)?dm:(r+=1)+t>e.length?Na:(e=e.substr(r,t),n.C=r+t,e))}function fm(n){n.V=Date.now()+n.O,HT(n,n.O)}function HT(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Mc(ji(n.gb,n),e)}function pm(n){n.B&&(qt.clearTimeout(n.B),n.B=null)}function Af(n){0==n.l.G||n.I||rb(n.l,n)}function bu(n){pm(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,sm(n.T),Yv(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function gm(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||aw(t.h,n)))if(!n.J&&aw(t.h,n)&&3==t.G){try{var r=t.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;fw(t),kf(t)}Lf(t),qr(18)}}else t.Ba=i[1],0<t.Ba-t.T&&37500>i[2]&&t.L&&0==t.A&&!t.v&&(t.v=Mc(ji(t.cb,t),6e3));if(1>=ow(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else Oc(t,11)}else if((n.J||t.g==n)&&fw(t),!wf(e))for(i=t.Fa.g.parse(e),e=0;e<i.length;e++){let w=i[e];if(t.T=w[0],w=w[1],2==t.G)if("c"==w[0]){t.I=w[1],t.ka=w[2];const T=w[3];null!=T&&(t.ma=T,t.j.info("VER="+t.ma));const D=w[4];null!=D&&(t.Ca=D,t.j.info("SVER="+t.Ca));const x=w[5];null!=x&&"number"==typeof x&&0<x&&(t.J=r=1.5*x,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const F=n.g;if(F){const $=F.g?F.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($){var a=r.h;a.g||-1==$.indexOf("spdy")&&-1==$.indexOf("quic")&&-1==$.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(KT(a,a.h),a.h=null))}if(r.D){const ee=F.g?F.g.getResponseHeader("X-HTTP-Session-Id"):null;ee&&(r.za=ee,Qn(r.F,r.D,ee))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var c=n;if((r=t).sa=pw(r,r.H?r.ka:null,r.V),c.J){BA(r.h,c);var h=c,m=r.J;m&&h.setTimeout(m),h.B&&(pm(h),fm(h)),r.g=c}else hw(r);0<t.i.length&&Of(t)}else"stop"!=w[0]&&"close"!=w[0]||Oc(t,7);else 3==t.G&&("stop"==w[0]||"close"==w[0]?"stop"==w[0]?Oc(t,7):Rm(t):"noop"!=w[0]&&t.l&&t.l.wa(w),t.A=0)}pd()}catch{}}function rw(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Zg(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function GT(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Zg(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function OA(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Zg(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}(Et=lm.prototype).setTimeout=function(n){this.O=n},Et.ib=function(n){n=n.target;const e=this.L;e&&3==ka(n)?e.l():this.La(n)},Et.La=function(n){try{if(n==this.g)e:{const T=ka(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>T)&&(3!=T||Rv||this.g&&(this.h.h||this.g.fa()||JT(this.g)))){this.I||4!=T||7==e||pd(),pm(this);var t=this.g.aa();this.Y=t;t:if(hm(this)){var r=JT(this.g);n="";var i=r.length,a=4==ka(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){bu(this),Af(this);var c="";break t}this.h.i=new qt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,c=this.h.g}else c=this.g.fa();if(this.i=200==t,function UT(n,e,t,r,i,a,c){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+c})}(this.j,this.u,this.A,this.m,this.U,T,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var h,m=this.g;if((h=m.g?m.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wf(h)){var w=h;break t}}w=null}if(!(t=w)){this.i=!1,this.o=3,qr(12),bu(this),Af(this);break e}hd(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,gm(this,t)}this.P?(PA(this,T,c),Rv&&this.i&&3==T&&(FT(this.S,this.T,"tick",this.hb),this.T.start())):(hd(this.j,this.m,c,null),gm(this,c)),4==T&&bu(this),this.i&&!this.I&&(4==T?rb(this.l,this):(this.i=!1,fm(this)))}else 400==t&&0<c.indexOf("Unknown SID")?(this.o=3,qr(12)):(this.o=0,qr(13)),bu(this),Af(this)}}}catch{}},Et.hb=function(){if(this.g){var n=ka(this.g),e=this.g.fa();this.C<e.length&&(pm(this),PA(this,n,e),this.i&&4!=n&&fm(this))}},Et.cancel=function(){this.I=!0,bu(this)},Et.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function $i(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(pd(),qr(17)),bu(this),this.o=2,Af(this)):HT(this,this.V-n)};var zT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cu(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Cu){this.h=void 0!==e?e:n.h,Rf(this,n.j),this.s=n.s,this.g=n.g,xf(this,n.m),this.l=n.l,e=n.i;var t=new ym;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),iw(this,t),this.o=n.o}else n&&(t=String(n).match(zT))?(this.h=!!e,Rf(this,t[1]||"",!0),this.s=Mf(t[2]||""),this.g=Mf(t[3]||"",!0),xf(this,t[4]),this.l=Mf(t[5]||"",!0),iw(this,t[6]||"",!0),this.o=Mf(t[7]||"")):(this.h=!!e,this.i=new ym(null,this.h))}function Pa(n){return new Cu(n)}function Rf(n,e,t){n.j=t?Mf(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function xf(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function iw(n,e,t){e instanceof ym?(n.i=e,function vm(n,e){e&&!n.j&&(Pc(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(UA(this,r),VA(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=_m(e,lP)),n.i=new ym(e,n.h))}function Qn(n,e,t){n.i.set(e,t)}function mm(n){return Qn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Mf(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function _m(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,WT),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function WT(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Cu.prototype.toString=function(){var n=[],e=this.j;e&&n.push(_m(e,FA,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(_m(e,FA,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(_m(t,"/"==t.charAt(0)?cP:uP,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",_m(t,dP)),n.join("")};var FA=/[#\/\?@]/g,uP=/[#\?:]/g,cP=/[#\?]/g,lP=/[#\?@]/g,dP=/#/g;function ym(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Pc(n){n.g||(n.g=new Map,n.h=0,n.i&&function LA(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function UA(n,e){Pc(n),e=kc(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Nf(n,e){return Pc(n),e=kc(n,e),n.g.has(e)}function VA(n,e,t){UA(n,e),0<t.length&&(n.i=null,n.g.set(kc(n,e),Yg(t)),n.h+=t.length)}function kc(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function sw(n){this.l=n||hP,n=qt.PerformanceNavigationTiming?0<(n=qt.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(qt.g&&qt.g.Ga&&qt.g.Ga()&&qt.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Et=ym.prototype).add=function(n,e){Pc(this),this.i=null,n=kc(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},Et.forEach=function(n,e){Pc(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},Et.oa=function(){Pc(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let a=0;a<i.length;a++)t.push(e[r])}return t},Et.W=function(n){Pc(this);let e=[];if("string"==typeof n)Nf(this,n)&&(e=e.concat(this.g.get(kc(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},Et.set=function(n,e){return Pc(this),this.i=null,Nf(this,n=kc(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},Et.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},Et.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const a=encodeURIComponent(String(r)),c=this.W(r);for(r=0;r<c.length;r++){var i=a;""!==c[r]&&(i+="="+encodeURIComponent(String(c[r]))),n.push(i)}}return this.i=n.join("&")};var hP=10;function wm(n){return!!n.h||!!n.g&&n.g.size>=n.j}function ow(n){return n.h?1:n.g?n.g.size:0}function aw(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function KT(n,e){n.g?n.g.add(e):n.h=e}function BA(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function ZT(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Yg(n.i)}function uw(){}function Em(){this.g=new uw}function jA(n,e,t){const r=t||"";try{rw(n,function(i,a){let c=i;Ac(i)&&(c=rm(i)),e.push(r+a+"="+encodeURIComponent(c))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function cw(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Im(n){this.l=n.ac||null,this.j=n.jb||!1}function Tm(n,e){xr.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=lw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}sw.prototype.cancel=function(){if(this.i=ZT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},uw.prototype.stringify=function(n){return qt.JSON.stringify(n,void 0)},uw.prototype.parse=function(n){return qt.JSON.parse(n,void 0)},Wr(Im,Jv),Im.prototype.g=function(){return new Tm(this.l,this.j)},Im.prototype.i=function(n){return function(){return n}}({}),Wr(Tm,xr);var lw=0;function YT(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function bm(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Pf(n)}function Pf(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Et=Tm.prototype).open=function(n,e){if(this.readyState!=lw)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Pf(this)},Et.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||qt).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},Et.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,bm(this)),this.readyState=lw},Et.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Pf(this)),this.g&&(this.readyState=3,Pf(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof qt.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;YT(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},Et.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?bm(this):Pf(this),3==this.readyState&&YT(this)}},Et.Va=function(n){this.g&&(this.response=this.responseText=n,bm(this))},Et.Ua=function(n){this.g&&(this.response=n,bm(this))},Et.ga=function(){this.g&&bm(this)},Et.setRequestHeader=function(n,e){this.v.append(n,e)},Et.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Et.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(Tm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var QT=qt.JSON.parse;function hr(n){xr.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=$A,this.K=this.L=!1}Wr(hr,xr);var $A="",lo=/^https?$/i,HA=["POST","PUT"];function XT(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,GA(n),Cm(n)}function GA(n){n.D||(n.D=!0,hi(n,"complete"),hi(n,"error"))}function ws(n){if(n.h&&typeof qg<"u"&&(!n.C[1]||4!=ka(n)||2!=n.aa()))if(n.v&&4==ka(n))Df(n.Ha,0,n);else if(hi(n,"readystatechange"),4==ka(n)){n.h=!1;try{const h=n.aa();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match(zT)[1]||null;if(!i&&qt.self&&qt.self.location){var a=qt.self.location.protocol;i=a.substr(0,a.length-1)}r=!lo.test(i?i.toLowerCase():"")}t=r}if(t)hi(n,"complete"),hi(n,"success");else{n.m=6;try{var c=2<ka(n)?n.g.statusText:""}catch{c=""}n.j=c+" ["+n.aa()+"]",GA(n)}}finally{Cm(n)}}}function Cm(n,e){if(n.g){Dm(n);const t=n.g,r=n.C[0]?Kg:null;n.g=null,n.C=null,e||hi(n,"ready");try{t.onreadystatechange=r}catch{}}}function Dm(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(qt.clearTimeout(n.A),n.A=null)}function ka(n){return n.g?n.g.readyState:0}function JT(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case $A:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Sm(n){let e="";return em(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function Am(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=Sm(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Qn(n,e,t))}function _d(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function eb(n){this.Ca=0,this.i=[],this.j=new Sf,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=_d("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=_d("baseRetryDelayMs",5e3,n),this.bb=_d("retryDelaySeedMs",1e4,n),this.$a=_d("forwardChannelMaxRetries",2,n),this.ta=_d("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new sw(n&&n.concurrentRequestLimit),this.Fa=new Em,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Rm(n){if(tb(n),3==n.G){var e=n.U++,t=Pa(n.F);Qn(t,"SID",n.I),Qn(t,"RID",e),Qn(t,"TYPE","terminate"),Es(n,t),(e=new lm(n,n.j,e,void 0)).K=2,e.v=mm(Pa(t)),t=!1,qt.navigator&&qt.navigator.sendBeacon&&(t=qt.navigator.sendBeacon(e.v.toString(),"")),!t&&qt.Image&&((new Image).src=e.v,t=!0),t||(e.g=WA(e.l,null),e.g.da(e.v)),e.F=Date.now(),fm(e)}sb(n)}function kf(n){n.g&&(Mm(n),n.g.cancel(),n.g=null)}function tb(n){kf(n),n.u&&(qt.clearTimeout(n.u),n.u=null),fw(n),n.h.cancel(),n.m&&("number"==typeof n.m&&qt.clearTimeout(n.m),n.m=null)}function Of(n){wm(n.h)||n.m||(n.m=!0,zv(n.Ja,n),n.C=0)}function xm(n,e){var t;t=e?e.m:n.U++;const r=Pa(n.F);Qn(r,"SID",n.I),Qn(r,"RID",t),Qn(r,"AID",n.T),Es(n,r),n.o&&n.s&&Am(r,n.o,n.s),t=new lm(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=Oa(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),KT(n.h,t),tw(t,r,e)}function Es(n,e){n.ia&&em(n.ia,function(t,r){Qn(e,r,t)}),n.l&&rw({},function(t,r){Qn(e,r,t)})}function Oa(n,e,t){t=Math.min(n.i.length,t);var r=n.l?ji(n.l.Ra,n.l,n):null;e:{var i=n.i;let a=-1;for(;;){const c=["count="+t];-1==a?0<t?(a=i[0].h,c.push("ofs="+a)):a=0:c.push("ofs="+a);let h=!0;for(let m=0;m<t;m++){let w=i[m].h;const T=i[m].g;if(w-=a,0>w)a=Math.max(0,i[m].h-100),h=!1;else try{jA(T,c,"req"+w+"_")}catch{r&&r(T)}}if(h){r=c.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,r}function hw(n){n.g||n.u||(n.Z=1,zv(n.Ia,n),n.A=0)}function Lf(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Mc(ji(n.Ia,n),ib(n,n.A)),n.A++,0))}function Mm(n){null!=n.B&&(qt.clearTimeout(n.B),n.B=null)}function nb(n){n.g=new lm(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=Pa(n.sa);Qn(e,"RID","rpc"),Qn(e,"SID",n.I),Qn(e,"CI",n.L?"0":"1"),Qn(e,"AID",n.T),Qn(e,"TYPE","xmlhttp"),Es(n,e),n.o&&n.s&&Am(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=mm(Pa(e)),t.s=null,t.P=!0,nw(t,n)}function fw(n){null!=n.v&&(qt.clearTimeout(n.v),n.v=null)}function rb(n,e){var t=null;if(n.g==e){fw(n),Mm(n),n.g=null;var r=2}else{if(!aw(n.h,e))return;t=e.D,BA(n.h,e),r=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;hi(r=Qv(),new BT(r,t)),Of(n)}else hw(n);else if(3==(i=e.o)||0==i&&0<n.pa||!(1==r&&function zA(n,e){return!(ow(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Mc(ji(n.Ja,n,e),ib(n,n.C)),n.C++,0)))}(n,e)||2==r&&Lf(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),i){case 1:Oc(n,5);break;case 4:Oc(n,10);break;case 3:Oc(n,6);break;default:Oc(n,2)}}function ib(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function Oc(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=ji(n.kb,n);t||(t=new Cu("//www.google.com/images/cleardot.gif"),qt.location&&"http"==qt.location.protocol||Rf(t,"https"),mm(t)),function fP(n,e){const t=new Sf;if(qt.Image){const r=new Image;r.onload=vf(cw,t,r,"TestLoadImage: loaded",!0,e),r.onerror=vf(cw,t,r,"TestLoadImage: error",!1,e),r.onabort=vf(cw,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=vf(cw,t,r,"TestLoadImage: timeout",!1,e),qt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else qr(2);n.G=0,n.l&&n.l.va(e),sb(n),tb(n)}function sb(n){if(n.G=0,n.la=[],n.l){const e=ZT(n.h);(0!=e.length||0!=n.i.length)&&(Qg(n.la,e),Qg(n.la,n.i),n.h.i.length=0,Yg(n.i),n.i.length=0),n.l.ua()}}function pw(n,e,t){var r=t instanceof Cu?Pa(t):new Cu(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),xf(r,r.m);else{var i=qt.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var a=new Cu(null,void 0);r&&Rf(a,r),e&&(a.g=e),i&&xf(a,i),t&&(a.l=t),r=a}return e=n.za,(t=n.D)&&e&&Qn(r,t,e),Qn(r,"VER",n.ma),Es(n,r),r}function WA(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new hr(t&&n.Da&&!n.ra?new Im({jb:!0}):n.ra)).Ka(n.H),e}function gw(){}function Nm(){if(Rc&&!(10<=Number(CA)))throw Error("Environmental error: no available transport.")}function os(n,e){xr.call(this),this.g=new eb(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!wf(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!wf(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Lc(this)}function qA(n){um.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Pm(){cm.call(this),this.status=1}function Lc(n){this.g=n}(Et=hr.prototype).Ka=function(n){this.L=n},Et.da=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():gd.g(),this.C=function jT(n){return n.h||(n.h=n.i())}(this.u?this.u:gd),this.g.onreadystatechange=ji(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void XT(this,a)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const a of r.keys())t.set(a,r.get(a))}r=Array.from(t.keys()).find(a=>"content-type"==a.toLowerCase()),i=qt.FormData&&n instanceof qt.FormData,!(0<=TT(HA,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,c]of t)this.g.setRequestHeader(a,c);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Dm(this),0<this.B&&((this.K=function dw(n){return Rc&&function bA(){return function CT(n){var e=TA;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=Dv(String(Jg)).split("."),t=Dv("9").split("."),r=Math.max(e.length,t.length);for(let c=0;0==n&&c<r;c++){var i=e[c]||"",a=t[c]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=Sv(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||Sv(0==i[2].length,0==a[2].length)||Sv(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ji(this.qa,this)):this.A=Df(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){XT(this,a)}},Et.qa=function(){typeof qg<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,hi(this,"timeout"),this.abort(8))},Et.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,hi(this,"complete"),hi(this,"abort"),Cm(this))},Et.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Cm(this,!0)),hr.X.M.call(this)},Et.Ha=function(){this.s||(this.F||this.v||this.l?ws(this):this.fb())},Et.fb=function(){ws(this)},Et.aa=function(){try{return 2<ka(this)?this.g.status:-1}catch{return-1}},Et.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},Et.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),QT(e)}},Et.Ea=function(){return this.m},Et.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Et=eb.prototype).ma=8,Et.G=1,Et.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const i=new lm(this,this.j,n,void 0);let a=this.s;if(this.S&&(a?(a=MT(a),DA(a,this.S)):a=this.S),null!==this.o||this.N||(i.H=a,a=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Oa(this,i,e),Qn(t=Pa(this.F),"RID",n),Qn(t,"CVER",22),this.D&&Qn(t,"X-HTTP-Session-Id",this.D),Es(this,t),a&&(this.N?e="headers="+encodeURIComponent(String(Sm(a)))+"&"+e:this.o&&Am(t,this.o,a)),KT(this.h,i),this.Ya&&Qn(t,"TYPE","init"),this.O?(Qn(t,"$req",e),Qn(t,"SID","null"),i.Z=!0,tw(i,t,null)):tw(i,t,e),this.G=2}}else 3==this.G&&(n?xm(this,n):0==this.i.length||wm(this.h)||xm(this))},Et.Ia=function(){if(this.u=null,nb(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Mc(ji(this.eb,this),n)}},Et.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,qr(10),kf(this),nb(this))},Et.cb=function(){null!=this.v&&(this.v=null,kf(this),Lf(this),qr(19))},Et.kb=function(n){n?(this.j.info("Successfully pinged google.com"),qr(2)):(this.j.info("Failed to ping google.com"),qr(1))},(Et=gw.prototype).xa=function(){},Et.wa=function(){},Et.va=function(){},Et.ua=function(){},Et.Ra=function(){},Nm.prototype.g=function(n,e){return new os(n,e)},Wr(os,xr),os.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;qr(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=pw(n,null,n.V),Of(n)},os.prototype.close=function(){Rm(this.g)},os.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=rm(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&Of(e)},os.prototype.M=function(){this.g.l=null,delete this.j,Rm(this.g),delete this.g,os.X.M.call(this)},Wr(qA,um),Wr(Pm,cm),Wr(Lc,gw),Lc.prototype.xa=function(){hi(this.g,"a")},Lc.prototype.wa=function(n){hi(this.g,new qA(n))},Lc.prototype.va=function(n){hi(this.g,new Pm)},Lc.prototype.ua=function(){hi(this.g,"b")},Nm.prototype.createWebChannel=Nm.prototype.g,os.prototype.send=os.prototype.u,os.prototype.open=os.prototype.m,os.prototype.close=os.prototype.close,am.NO_ERROR=0,am.TIMEOUT=8,am.HTTP_ERROR=6,Xv.COMPLETE="complete",$T.EventType=Nc,Nc.OPEN="a",Nc.CLOSE="b",Nc.ERROR="c",Nc.MESSAGE="d",xr.prototype.listen=xr.prototype.N,hr.prototype.listenOnce=hr.prototype.O,hr.prototype.getLastError=hr.prototype.Oa,hr.prototype.getLastErrorCode=hr.prototype.Ea,hr.prototype.getStatus=hr.prototype.aa,hr.prototype.getResponseJson=hr.prototype.Sa,hr.prototype.getResponseText=hr.prototype.fa,hr.prototype.send=hr.prototype.da,hr.prototype.setWithCredentials=hr.prototype.Ka;var ob=uo.createWebChannelTransport=function(){return new Nm},ab=uo.getStatEventTarget=function(){return Qv()},km=uo.ErrorCode=am,ub=uo.EventType=Xv,Om=uo.Event=xc,Ff=uo.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},cb=uo.FetchXmlHttpFactory=Im,Lm=uo.WebChannel=$T,KA=uo.XhrIo=hr;const lb="@firebase/firestore";class fi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fi.UNAUTHENTICATED=new fi(null),fi.GOOGLE_CREDENTIALS=new fi("google-credentials-uid"),fi.FIRST_PARTY=new fi("first-party-uid"),fi.MOCK_USER=new fi("mock-user");let Uf="9.18.0";const La=new vs.Yd("@firebase/firestore");function mw(){return La.logLevel}function je(n,...e){if(La.logLevel<=vs.in.DEBUG){const t=e.map(db);La.debug(`Firestore (${Uf}): ${n}`,...t)}}function Vr(n,...e){if(La.logLevel<=vs.in.ERROR){const t=e.map(db);La.error(`Firestore (${Uf}): ${n}`,...t)}}function yd(n,...e){if(La.logLevel<=vs.in.WARN){const t=e.map(db);La.warn(`Firestore (${Uf}): ${n}`,...t)}}function db(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function ft(n="Unexpected state"){const e=`FIRESTORE (${Uf}) INTERNAL ASSERTION FAILED: `+n;throw Vr(e),new Error(e)}function St(n,e){n||ft()}function tt(n,e){return n}const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Le extends N.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Br{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Du{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class hb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fi.UNAUTHENTICATED))}shutdown(){}}class _w{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class yw{constructor(e){this.t=e,this.currentUser=fi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=w=>this.i!==i?(i=this.i,t(w)):Promise.resolve();let c=new Br;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Br,e.enqueueRetryable(()=>a(this.currentUser))};const h=()=>{const w=c;e.enqueueRetryable((0,me.Z)(function*(){yield w.promise,yield a(r.currentUser)}))},m=w=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=w,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(w=>m(w)),setTimeout(()=>{if(!this.auth){const w=this.t.getImmediate({optional:!0});w?m(w):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Br)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(St("string"==typeof r.accessToken),new Du(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return St(null===e||"string"==typeof e),new fi(e)}}class QA{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i,this.type="FirstParty",this.user=fi.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(St(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class vw{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i}getToken(){return Promise.resolve(new QA(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(fi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Fm{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Um{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=a=>{null!=a.error&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.A;return this.A=a.token,je("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?i(a):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(St("string"==typeof t.token),this.A=t.token,new Fm(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function pP(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class XA{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=pP(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function en(n,e){return n<e?-1:n>e?1:0}function Fc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function fb(n){return n+"\0"}class nr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Le(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Le(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Le(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Le(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return nr.fromMillis(Date.now())}static fromDate(e){return nr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new nr(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?en(this.nanoseconds,e.nanoseconds):en(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Mt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Mt(e)}static min(){return new Mt(new nr(0,0))}static max(){return new Mt(new nr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Vf{constructor(e,t,r){void 0===t?t=0:t>e.length&&ft(),void 0===r?r=e.length-t:r>e.length-t&&ft(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Vf.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Vf?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),c=t.get(i);if(a<c)return-1;if(a>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class wn extends Vf{construct(e,t,r){return new wn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Le(ce.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new wn(t)}static emptyPath(){return new wn([])}}const pb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fr extends Vf{construct(e,t,r){return new fr(e,t,r)}static isValidIdentifier(e){return pb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new fr(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Le(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new Le(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[i+1];if("\\"!==m&&"."!==m&&"`"!==m)throw new Le(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,i+=2}else"`"===h?(c=!c,i++):"."!==h||c?(r+=h,i++):(a(),i++)}if(a(),c)throw new Le(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fr(t)}static emptyPath(){return new fr([])}}class nt{constructor(e){this.path=e}static fromPath(e){return new nt(wn.fromString(e))}static fromName(e){return new nt(wn.fromString(e).popFirst(5))}static empty(){return new nt(wn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===wn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return wn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nt(new wn(e.slice()))}}class Vm{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Bm(n){return n.fields.find(e=>2===e.kind)}function Fa(n){return n.fields.filter(e=>2!==e.kind)}Vm.UNKNOWN_ID=-1;class Bf{constructor(e,t){this.fieldPath=e,this.kind=t}}class jf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new jf(0,Us.min())}}function gb(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Mt.fromTimestamp(1e9===r?new nr(t+1,0):new nr(t,r));return new Us(i,nt.empty(),e)}function JA(n){return new Us(n.readTime,n.key,-1)}class Us{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Us(Mt.min(),nt.empty(),-1)}static max(){return new Us(Mt.max(),nt.empty(),-1)}}function Ew(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=nt.comparator(n.documentKey,e.documentKey),0!==t?t:en(n.largestBatchId,e.largestBatchId))}const mb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _b{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Uc(n){return yb.apply(this,arguments)}function yb(){return yb=(0,me.Z)(function*(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==mb)throw n;je("LocalStore","Unexpectedly lost primary lease")}),yb.apply(this,arguments)}class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ft(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ie((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ie?t:ie.resolve(t)}catch(t){return ie.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ie.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ie.reject(t)}static resolve(e){return new ie((t,r)=>{t(e)})}static reject(e){return new ie((t,r)=>{r(e)})}static waitFor(e){return new ie((t,r)=>{let i=0,a=0,c=!1;e.forEach(h=>{++i,h.next(()=>{++a,c&&a===i&&t()},m=>r(m))}),c=!0,a===i&&t()})}static or(e){let t=ie.resolve(!1);for(const r of e)t=t.next(i=>i?ie.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new ie((r,i)=>{const a=e.length,c=new Array(a);let h=0;for(let m=0;m<a;m++){const w=m;t(e[w]).next(T=>{c[w]=T,++h,h===a&&r(c)},T=>i(T))}})}static doWhile(e,t){return new ie((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class Iw{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.P=new Br,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{t.error?this.P.reject(new jm(e,t.error)):this.P.resolve()},this.transaction.onerror=r=>{const i=s(r.target.error);this.P.reject(new jm(e,i))}}static open(e,t,r,i){try{return new Iw(t,e.transaction(i,r))}catch(a){throw new jm(t,a)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(je("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new _P(t)}}class ho{constructor(e,t,r){this.name=e,this.version=t,this.S=r,12.2===ho.D((0,N.z$)())&&Vr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return je("SimpleDb","Removing database:",e),vd(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,N.hl)())return!1;if(ho.N())return!0;const e=(0,N.z$)(),t=ho.D(e),r=0<t&&t<10,i=ho.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static N(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.$)}static M(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var t=this;return(0,me.Z)(function*(){return t.db||(je("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=c=>{r(c.target.result)},a.onblocked=()=>{i(new jm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=c=>{const h=c.target.error;i("VersionError"===h.name?new Le(ce.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new Le(ce.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new jm(e,h))},a.onupgradeneeded=c=>{je("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',c.oldVersion),t.S.F(c.target.result,a.transaction,c.oldVersion,t.version).next(()=>{je("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,me.Z)(function*(){const c="readonly"===t;let h=0;for(;;){++h;try{a.db=yield a.O(e);const m=Iw.open(a.db,e,c?"readonly":"readwrite",r),w=i(m).next(T=>(m.V(),T)).catch(T=>(m.abort(T),ie.reject(T))).toPromise();return w.catch(()=>{}),yield m.v,w}catch(m){const w=m,T="FirebaseError"!==w.name&&h<3;if(je("SimpleDb","Transaction failed with error:",w.message,"Retrying:",T),a.close(),!T)return Promise.reject(w)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class mP{constructor(e){this.q=e,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(e){this.q=e}done(){this.U=!0}j(e){this.K=e}delete(){return vd(this.q.delete())}}class jm extends Le{constructor(e,t){super(ce.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Vc(n){return"IndexedDbTransactionError"===n.name}class _P{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(je("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(je("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),vd(r)}add(e){return je("SimpleDb","ADD",this.store.name,e,e),vd(this.store.add(e))}get(e){return vd(this.store.get(e)).next(t=>(void 0===t&&(t=null),je("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return je("SimpleDb","DELETE",this.store.name,e),vd(this.store.delete(e))}count(){return je("SimpleDb","COUNT",this.store.name),vd(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.H(i,(c,h)=>{a.push(h)}).next(()=>a)}{const i=this.store.getAll(r.range);return new ie((a,c)=>{i.onerror=h=>{c(h.target.error)},i.onsuccess=h=>{a(h.target.result)}})}}J(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new ie((i,a)=>{r.onerror=c=>{a(c.target.error)},r.onsuccess=c=>{i(c.target.result)}})}Y(e,t){je("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.Z=!1;const i=this.cursor(r);return this.H(i,(a,c,h)=>h.delete())}X(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}tt(e){const t=this.cursor({});return new ie((r,i)=>{t.onerror=a=>{const c=s(a.target.error);i(c)},t.onsuccess=a=>{const c=a.target.result;c?e(c.primaryKey,c.value).next(h=>{h?c.continue():r()}):r()}})}H(e,t){const r=[];return new ie((i,a)=>{e.onerror=c=>{a(c.target.error)},e.onsuccess=c=>{const h=c.target.result;if(!h)return void i();const m=new mP(h),w=t(h.primaryKey,h.value,m);if(w instanceof ie){const T=w.catch(D=>(m.done(),ie.reject(D)));r.push(T)}m.isDone?i():null===m.G?h.continue():h.continue(m.G)}}).next(()=>ie.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Z?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function vd(n){return new ie((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=s(r.target.error);t(i)}})}let eR=!1;function s(n){const e=ho.D((0,N.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Le("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return eR||(eR=!0,setTimeout(()=>{throw r},0)),r}}return n}class o{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;je("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,me.Z)(function*(){t.task=null;try{je("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(r){Vc(r)?je("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Uc(r)}yield t.nt(6e4)}))}}class u{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,me.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.it(r,e))})()}it(e,t){const r=new Set;let i=t,a=!0;return ie.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(c=>{if(null!==c&&!r.has(c))return je("IndexBackiller",`Processing collection: ${c}`),this.rt(e,c,i).next(h=>{i-=h,r.add(c)});a=!1})).next(()=>t-i)}rt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const c=a.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next(()=>this.ot(i,a)).next(h=>(je("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>c.size)}))}ot(e,t){let r=e;return t.changes.forEach((i,a)=>{const c=JA(a);Ew(c,r)>0&&(r=c)}),new Us(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let l=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ut(i),this.ct=i=>r.writeSequenceNumber(i))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}return n.at=-1,n})();class I{constructor(e,t,r,i,a,c,h,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.useFetchStreams=m}}class b{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new b("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof b&&e.projectId===this.projectId&&e.database===this.database}}function S(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function R(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function U(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function K(n){return null==n}function J(n){return 0===n&&1/n==-1/0}function Ee(n){return"number"==typeof n&&Number.isInteger(n)&&!J(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class ze extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xe{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw i instanceof DOMException?new ze("Invalid base64 string: "+i):i}}(e);return new Xe(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new Xe(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return en(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xe.EMPTY_BYTE_STRING=new Xe("");const jt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Me(n){if(St(!!n),"string"==typeof n){let e=0;const t=jt.exec(n);if(St(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pt(n.seconds),nanos:pt(n.nanos)}}function pt(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Nn(n){return"string"==typeof n?Xe.fromBase64String(n):Xe.fromUint8Array(n)}function pr(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function tR(n){const e=n.mapValue.fields.__previous_value__;return pr(e)?tR(e):e}function Tw(n){const e=Me(n.mapValue.fields.__local_write_time__.timestampValue);return new nr(e.seconds,e.nanos)}const wd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},vb={nullValue:"NULL_VALUE"};function $f(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?pr(n)?4:EP(n)?9007199254740991:10:ft()}function Su(n,e){if(n===e)return!0;const t=$f(n);if(t!==$f(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Tw(n).isEqual(Tw(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=Me(r.timestampValue),c=Me(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,Nn(n.bytesValue).isEqual(Nn(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return pt(r.geoPointValue.latitude)===pt(i.geoPointValue.latitude)&&pt(r.geoPointValue.longitude)===pt(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return pt(r.integerValue)===pt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=pt(r.doubleValue),c=pt(i.doubleValue);return a===c?J(a)===J(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return Fc(n.arrayValue.values||[],e.arrayValue.values||[],Su);case 10:return function(r,i){const a=r.mapValue.fields||{},c=i.mapValue.fields||{};if(S(a)!==S(c))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(void 0===c[h]||!Su(a[h],c[h])))return!1;return!0}(n,e);default:return ft()}var i}function bw(n,e){return void 0!==(n.values||[]).find(t=>Su(t,e))}function Ed(n,e){if(n===e)return 0;const t=$f(n),r=$f(e);if(t!==r)return en(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return en(n.booleanValue,e.booleanValue);case 2:return function(i,a){const c=pt(i.integerValue||i.doubleValue),h=pt(a.integerValue||a.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1}(n,e);case 3:return yP(n.timestampValue,e.timestampValue);case 4:return yP(Tw(n),Tw(e));case 5:return en(n.stringValue,e.stringValue);case 6:return function(i,a){const c=Nn(i),h=Nn(a);return c.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),h=a.split("/");for(let m=0;m<c.length&&m<h.length;m++){const w=en(c[m],h[m]);if(0!==w)return w}return en(c.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const c=en(pt(i.latitude),pt(a.latitude));return 0!==c?c:en(pt(i.longitude),pt(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const c=i.values||[],h=a.values||[];for(let m=0;m<c.length&&m<h.length;++m){const w=Ed(c[m],h[m]);if(w)return w}return en(c.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===wd.mapValue&&a===wd.mapValue)return 0;if(i===wd.mapValue)return 1;if(a===wd.mapValue)return-1;const c=i.fields||{},h=Object.keys(c),m=a.fields||{},w=Object.keys(m);h.sort(),w.sort();for(let T=0;T<h.length&&T<w.length;++T){const D=en(h[T],w[T]);if(0!==D)return D;const x=Ed(c[h[T]],m[w[T]]);if(0!==x)return x}return en(h.length,w.length)}(n.mapValue,e.mapValue);default:throw ft()}}function yP(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return en(n,e);const t=Me(n),r=Me(e),i=en(t.seconds,r.seconds);return 0!==i?i:en(t.nanos,r.nanos)}function $m(n){return nR(n)}function nR(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=Me(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Nn(n.bytesValue).toBase64():"referenceValue"in n?nt.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const c of r.values||[])a?a=!1:i+=",",i+=nR(c);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",c=!0;for(const h of i)c?c=!1:a+=",",a+=`${h}:${nR(r.fields[h])}`;return a+"}"}(n.mapValue):ft();var e}function Hf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function rR(n){return!!n&&"integerValue"in n}function Cw(n){return!!n&&"arrayValue"in n}function vP(n){return!!n&&"nullValue"in n}function wP(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function wb(n){return!!n&&"mapValue"in n}function Dw(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return R(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Dw(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dw(n.arrayValue.values[t]);return e}return Object.assign({},n)}function EP(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function uU(n){return"nullValue"in n?vb:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Hf(b.empty(),nt.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:ft()}function cU(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Hf(b.empty(),nt.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?wd:ft()}function IP(n,e){const t=Ed(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function TP(n,e){const t=Ed(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Id{constructor(e,t){this.position=e,this.inclusive=t}}function bP(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],c=n.position[i];if(r=a.field.isKeyField()?nt.comparator(nt.fromName(c.referenceValue),t.key):Ed(c,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function CP(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Su(n.position[t],e.position[t]))return!1;return!0}class DP{}class En extends DP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new lU(e,t,r):"array-contains"===t?new fU(e,r):"in"===t?new NP(e,r):"not-in"===t?new pU(e,r):"array-contains-any"===t?new gU(e,r):new En(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new dU(e,r):new hU(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Ed(t,this.value)):null!==t&&$f(this.value)===$f(t)&&this.matchesComparison(Ed(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ft()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class $n extends DP{constructor(e,t){super(),this.filters=e,this.op=t,this.ft=null}static create(e,t){return new $n(e,t)}matches(e){return Hm(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ft||(this.ft=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ft}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.dt(t=>t.isInequality());return null!==e?e.field:null}dt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Hm(n){return"and"===n.op}function iR(n){return"or"===n.op}function sR(n){return SP(n)&&Hm(n)}function SP(n){for(const e of n.filters)if(e instanceof $n)return!1;return!0}function oR(n){if(n instanceof En)return n.field.canonicalString()+n.op.toString()+$m(n.value);if(sR(n))return n.filters.map(e=>oR(e)).join(",");{const e=n.filters.map(t=>oR(t)).join(",");return`${n.op}(${e})`}}function AP(n,e){return n instanceof En?(t=n,(r=e)instanceof En&&t.op===r.op&&t.field.isEqual(r.field)&&Su(t.value,r.value)):n instanceof $n?function(t,r){return r instanceof $n&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((i,a,c)=>i&&AP(a,r.filters[c]),!0)}(n,e):void ft();var t,r}function RP(n,e){const t=n.filters.concat(e);return $n.create(t,n.op)}function xP(n){return n instanceof En?`${(e=n).field.canonicalString()} ${e.op} ${$m(e.value)}`:n instanceof $n?function(e){return e.op.toString()+" {"+e.getFilters().map(xP).join(" ,")+"}"}(n):"Filter";var e}class lU extends En{constructor(e,t,r){super(e,t,r),this.key=nt.fromName(r.referenceValue)}matches(e){const t=nt.comparator(e.key,this.key);return this.matchesComparison(t)}}class dU extends En{constructor(e,t){super(e,"in",t),this.keys=MP(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class hU extends En{constructor(e,t){super(e,"not-in",t),this.keys=MP(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function MP(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>nt.fromName(r.referenceValue))}class fU extends En{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Cw(t)&&bw(t.arrayValue,this.value)}}class NP extends En{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&bw(this.value.arrayValue,t)}}class pU extends En{constructor(e,t){super(e,"not-in",t)}matches(e){if(bw(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!bw(this.value.arrayValue,t)}}class gU extends En{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Cw(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>bw(this.value.arrayValue,r))}}class Gm{constructor(e,t="asc"){this.field=e,this.dir=t}}function mU(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class jr{constructor(e,t){this.comparator=e,this.root=t||Hi.EMPTY}insert(e,t){return new jr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Hi.BLACK,null,null))}remove(e){return new jr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Eb(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Eb(this.root,e,this.comparator,!1)}getReverseIterator(){return new Eb(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Eb(this.root,e,this.comparator,!0)}}class Eb{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Hi{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Hi.RED,this.left=i??Hi.EMPTY,this.right=a??Hi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Hi(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Hi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Hi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Hi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Hi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ft();const e=this.left.check();if(e!==this.right.check())throw ft();return e+(this.isRed()?0:1)}}Hi.EMPTY=null,Hi.RED=!0,Hi.BLACK=!1,Hi.EMPTY=new class{constructor(){this.size=0}get key(){throw ft()}get value(){throw ft()}get color(){throw ft()}get left(){throw ft()}get right(){throw ft()}copy(n,e,t,r,i){return this}insert(n,e,t){return new Hi(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class qn{constructor(e){this.comparator=e,this.data=new jr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new PP(this.data.getIterator())}getIteratorFrom(e){return new PP(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof qn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new qn(this.comparator);return t.data=e,t}}class PP{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function zm(n){return n.hasNext()?n.getNext():void 0}class Vs{constructor(e){this.fields=e,e.sort(fr.comparator)}static empty(){return new Vs([])}unionWith(e){let t=new qn(fr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fc(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Si{constructor(e){this.value=e}static empty(){return new Si({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!wb(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dw(t)}setAll(e){let t=fr.emptyPath(),r={},i=[];e.forEach((c,h)=>{if(!t.isImmediateParentOf(h)){const m=this.getFieldsMap(t);this.applyChanges(m,r,i),r={},i=[],t=h.popLast()}c?r[h.lastSegment()]=Dw(c):i.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());wb(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Su(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];wb(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){R(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new Si(Dw(this.value))}}function kP(n){const e=[];return R(n.fields,(t,r)=>{const i=new fr([t]);if(wb(r)){const a=kP(r.mapValue).fields;if(0===a.length)e.push(i);else for(const c of a)e.push(i.child(c))}else e.push(i)}),new Vs(e)}class gr{constructor(e,t,r,i,a,c,h){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=c,this.documentState=h}static newInvalidDocument(e){return new gr(e,0,Mt.min(),Mt.min(),Mt.min(),Si.empty(),0)}static newFoundDocument(e,t,r,i){return new gr(e,1,t,Mt.min(),r,i,0)}static newNoDocument(e,t){return new gr(e,2,t,Mt.min(),Mt.min(),Si.empty(),0)}static newUnknownDocument(e,t){return new gr(e,3,t,Mt.min(),Mt.min(),Si.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Mt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Si.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Si.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof gr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class _U{constructor(e,t=null,r=[],i=[],a=null,c=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=c,this.endAt=h,this._t=null}}function aR(n,e=null,t=[],r=[],i=null,a=null,c=null){return new _U(n,e,t,r,i,a,c)}function Gf(n){const e=tt(n);if(null===e._t){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>oR(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),K(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>$m(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>$m(r)).join(",")),e._t=t}return e._t}function Sw(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!mU(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!AP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!CP(n.startAt,e.startAt)&&CP(n.endAt,e.endAt)}function Ib(n){return nt.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Tb(n,e){return n.filters.filter(t=>t instanceof En&&t.field.isEqual(e))}function OP(n,e,t){let r=vb,i=!0;for(const a of Tb(n,e)){let c=vb,h=!0;switch(a.op){case"<":case"<=":c=uU(a.value);break;case"==":case"in":case">=":c=a.value;break;case">":c=a.value,h=!1;break;case"!=":case"not-in":c=vb}IP({value:r,inclusive:i},{value:c,inclusive:h})<0&&(r=c,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];IP({value:r,inclusive:i},{value:c,inclusive:t.inclusive})<0&&(r=c,i=t.inclusive);break}return{value:r,inclusive:i}}function LP(n,e,t){let r=wd,i=!0;for(const a of Tb(n,e)){let c=wd,h=!0;switch(a.op){case">=":case">":c=cU(a.value),h=!1;break;case"==":case"in":case"<=":c=a.value;break;case"<":c=a.value,h=!1;break;case"!=":case"not-in":c=wd}TP({value:r,inclusive:i},{value:c,inclusive:h})>0&&(r=c,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];TP({value:r,inclusive:i},{value:c,inclusive:t.inclusive})>0&&(r=c,i=t.inclusive);break}return{value:r,inclusive:i}}class Bc{constructor(e,t=null,r=[],i=[],a=null,c="F",h=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=c,this.startAt=h,this.endAt=m,this.wt=null,this.gt=null}}function FP(n,e,t,r,i,a,c,h){return new Bc(n,e,t,r,i,a,c,h)}function Wm(n){return new Bc(n)}function UP(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function uR(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function bb(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function cR(n){return null!==n.collectionGroup}function zf(n){const e=tt(n);if(null===e.wt){e.wt=[];const t=bb(e),r=uR(e);if(null!==t&&null===r)t.isKeyField()||e.wt.push(new Gm(t)),e.wt.push(new Gm(fr.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e.wt.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Gm(fr.keyField(),a))}}}return e.wt}function Is(n){const e=tt(n);if(!e.gt)if("F"===e.limitType)e.gt=aR(e.path,e.collectionGroup,zf(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of zf(e))t.push(new Gm(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new Id(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Id(e.startAt.position,e.startAt.inclusive):null;e.gt=aR(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.gt}function lR(n,e){e.getFirstInequalityField(),bb(n);const t=n.filters.concat([e]);return new Bc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Cb(n,e,t){return new Bc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Aw(n,e){return Sw(Is(n),Is(e))&&n.limitType===e.limitType}function VP(n){return`${Gf(Is(n))}|lt:${n.limitType}`}function dR(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>xP(r)).join(", ")}]`),K(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>{return`${(i=r).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>$m(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>$m(r)).join(",")),`Target(${t})`}(Is(n))}; limitType=${n.limitType})`}function Rw(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):nt.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of zf(t))if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,c){const h=bP(i,a,c);return i.inclusive?h<=0:h<0}(t.startAt,zf(t),r)||t.endAt&&!function(i,a,c){const h=bP(i,a,c);return i.inclusive?h>=0:h>0}(t.endAt,zf(t),r)));var t,r}function BP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function jP(n){return(e,t)=>{let r=!1;for(const i of zf(n)){const a=yU(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function yU(n,e,t){const r=n.field.isKeyField()?nt.comparator(e.key,t.key):function(i,a,c){const h=a.data.field(i),m=c.data.field(i);return null!==h&&null!==m?Ed(h,m):ft()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ft()}}function $P(n,e){if(n.yt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:J(e)?"-0":e}}function HP(n){return{integerValue:""+n}}function GP(n,e){return Ee(e)?HP(e):$P(n,e)}class Db{constructor(){this._=void 0}}function vU(n,e,t){return n instanceof qm?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof Wf?WP(n,e):n instanceof qf?qP(n,e):function(r,i){const a=zP(r,i),c=KP(a)+KP(r.It);return rR(a)&&rR(r.It)?HP(c):$P(r.Tt,c)}(n,e)}function wU(n,e,t){return n instanceof Wf?WP(n,e):n instanceof qf?qP(n,e):t}function zP(n,e){return n instanceof Km?rR(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class qm extends Db{}class Wf extends Db{constructor(e){super(),this.elements=e}}function WP(n,e){const t=ZP(e);for(const r of n.elements)t.some(i=>Su(i,r))||t.push(r);return{arrayValue:{values:t}}}class qf extends Db{constructor(e){super(),this.elements=e}}function qP(n,e){let t=ZP(e);for(const r of n.elements)t=t.filter(i=>!Su(i,r));return{arrayValue:{values:t}}}class Km extends Db{constructor(e,t){super(),this.Tt=e,this.It=t}}function KP(n){return pt(n.integerValue||n.doubleValue)}function ZP(n){return Cw(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class xw{constructor(e,t){this.field=e,this.transform=t}}class IU{constructor(e,t){this.version=e,this.transformResults=t}}class Er{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Er}static exists(e){return new Er(void 0,e)}static updateTime(e){return new Er(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sb(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Ab{}function YP(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Ym(n.key,Er.none()):new Zm(n.key,n.data,Er.none());{const t=n.data,r=Si.empty();let i=new qn(fr.comparator);for(let a of e.fields)if(!i.has(a)){let c=t.field(a);null===c&&a.length>1&&(a=a.popLast(),c=t.field(a)),null===c?r.delete(a):r.set(a,c),i=i.add(a)}return new jc(n.key,r,new Vs(i.toArray()),Er.none())}}function TU(n,e,t){n instanceof Zm?function(r,i,a){const c=r.value.clone(),h=JP(r.fieldTransforms,i,a.transformResults);c.setAll(h),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof jc?function(r,i,a){if(!Sb(r.precondition,i))return void i.convertToUnknownDocument(a.version);const c=JP(r.fieldTransforms,i,a.transformResults),h=i.data;h.setAll(XP(r)),h.setAll(c),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Mw(n,e,t,r){return n instanceof Zm?function(i,a,c,h){if(!Sb(i.precondition,a))return c;const m=i.value.clone(),w=ek(i.fieldTransforms,h,a);return m.setAll(w),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof jc?function(i,a,c,h){if(!Sb(i.precondition,a))return c;const m=ek(i.fieldTransforms,h,a),w=a.data;return w.setAll(XP(i)),w.setAll(m),a.convertToFoundDocument(a.version,w).setHasLocalMutations(),null===c?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(T=>T.field))}(n,e,t,r):(c=t,Sb(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c);var a,c}function bU(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=zP(r.transform,i||null);null!=a&&(null===t&&(t=Si.empty()),t.set(r.field,a))}return t||null}function QP(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Fc(t,r,(i,a)=>function EU(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof Wf&&r instanceof Wf||t instanceof qf&&r instanceof qf?Fc(t.elements,r.elements,Su):t instanceof Km&&r instanceof Km?Su(t.It,r.It):t instanceof qm&&r instanceof qm);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class Zm extends Ab{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class jc extends Ab{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function XP(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function JP(n,e,t){const r=new Map;St(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],c=a.transform,h=e.data.field(a.field);r.set(a.field,wU(c,h,t[i]))}return r}function ek(n,e,t){const r=new Map;for(const i of n){const a=i.transform,c=t.data.field(i.field);r.set(i.field,vU(a,c,e))}return r}class Ym extends Ab{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hR extends Ab{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class CU{constructor(e){this.count=e}}var ri,bn;function tk(n){switch(n){default:return ft();case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0}}function nk(n){if(void 0===n)return Vr("GRPC error has no .code"),ce.UNKNOWN;switch(n){case ri.OK:return ce.OK;case ri.CANCELLED:return ce.CANCELLED;case ri.UNKNOWN:return ce.UNKNOWN;case ri.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case ri.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case ri.INTERNAL:return ce.INTERNAL;case ri.UNAVAILABLE:return ce.UNAVAILABLE;case ri.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case ri.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case ri.NOT_FOUND:return ce.NOT_FOUND;case ri.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case ri.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case ri.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case ri.ABORTED:return ce.ABORTED;case ri.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case ri.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case ri.DATA_LOSS:return ce.DATA_LOSS;default:return ft()}}(bn=ri||(ri={}))[bn.OK=0]="OK",bn[bn.CANCELLED=1]="CANCELLED",bn[bn.UNKNOWN=2]="UNKNOWN",bn[bn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bn[bn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bn[bn.NOT_FOUND=5]="NOT_FOUND",bn[bn.ALREADY_EXISTS=6]="ALREADY_EXISTS",bn[bn.PERMISSION_DENIED=7]="PERMISSION_DENIED",bn[bn.UNAUTHENTICATED=16]="UNAUTHENTICATED",bn[bn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bn[bn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bn[bn.ABORTED=10]="ABORTED",bn[bn.OUT_OF_RANGE=11]="OUT_OF_RANGE",bn[bn.UNIMPLEMENTED=12]="UNIMPLEMENTED",bn[bn.INTERNAL=13]="INTERNAL",bn[bn.UNAVAILABLE=14]="UNAVAILABLE",bn[bn.DATA_LOSS=15]="DATA_LOSS";class Td{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){R(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return U(this.inner)}size(){return this.innerSize}}const DU=new jr(nt.comparator);function Bs(){return DU}const rk=new jr(nt.comparator);function Nw(...n){let e=rk;for(const t of n)e=e.insert(t.key,t);return e}function ik(n){let e=rk;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Au(){return Pw()}function sk(){return Pw()}function Pw(){return new Td(n=>n.toString(),(n,e)=>n.isEqual(e))}const SU=new jr(nt.comparator),AU=new qn(nt.comparator);function cn(...n){let e=AU;for(const t of n)e=e.add(t);return e}const RU=new qn(en);function Rb(){return RU}class kw{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Ow.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new kw(Mt.min(),i,Rb(),Bs(),cn())}}class Ow{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ow(r,t,cn(),cn(),cn())}}class xb{constructor(e,t,r,i){this.Et=e,this.removedTargetIds=t,this.key=r,this.At=i}}class ok{constructor(e,t){this.targetId=e,this.Rt=t}}class ak{constructor(e,t,r=Xe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class uk{constructor(){this.Pt=0,this.vt=lk(),this.bt=Xe.EMPTY_BYTE_STRING,this.Vt=!1,this.St=!0}get current(){return this.Vt}get resumeToken(){return this.bt}get Dt(){return 0!==this.Pt}get Ct(){return this.St}xt(e){e.approximateByteSize()>0&&(this.St=!0,this.bt=e)}Nt(){let e=cn(),t=cn(),r=cn();return this.vt.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ft()}}),new Ow(this.bt,this.Vt,e,t,r)}kt(){this.St=!1,this.vt=lk()}$t(e,t){this.St=!0,this.vt=this.vt.insert(e,t)}Mt(e){this.St=!0,this.vt=this.vt.remove(e)}Ot(){this.Pt+=1}Ft(){this.Pt-=1}Bt(){this.St=!0,this.Vt=!0}}class xU{constructor(e){this.Lt=e,this.qt=new Map,this.Ut=Bs(),this.Kt=ck(),this.Gt=new qn(en)}Qt(e){for(const t of e.Et)e.At&&e.At.isFoundDocument()?this.jt(t,e.At):this.zt(t,e.key,e.At);for(const t of e.removedTargetIds)this.zt(t,e.key,e.At)}Wt(e){this.forEachTarget(e,t=>{const r=this.Ht(t);switch(e.state){case 0:this.Jt(t)&&r.xt(e.resumeToken);break;case 1:r.Ft(),r.Dt||r.kt(),r.xt(e.resumeToken);break;case 2:r.Ft(),r.Dt||this.removeTarget(t);break;case 3:this.Jt(t)&&(r.Bt(),r.xt(e.resumeToken));break;case 4:this.Jt(t)&&(this.Yt(t),r.xt(e.resumeToken));break;default:ft()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qt.forEach((r,i)=>{this.Jt(i)&&t(i)})}Zt(e){const t=e.targetId,r=e.Rt.count,i=this.Xt(t);if(i){const a=i.target;if(Ib(a))if(0===r){const c=new nt(a.path);this.zt(t,c,gr.newNoDocument(c,Mt.min()))}else St(1===r);else this.te(t)!==r&&(this.Yt(t),this.Gt=this.Gt.add(t))}}ee(e){const t=new Map;this.qt.forEach((a,c)=>{const h=this.Xt(c);if(h){if(a.current&&Ib(h.target)){const m=new nt(h.target.path);null!==this.Ut.get(m)||this.ne(c,m)||this.zt(c,m,gr.newNoDocument(m,e))}a.Ct&&(t.set(c,a.Nt()),a.kt())}});let r=cn();this.Kt.forEach((a,c)=>{let h=!0;c.forEachWhile(m=>{const w=this.Xt(m);return!w||2===w.purpose||(h=!1,!1)}),h&&(r=r.add(a))}),this.Ut.forEach((a,c)=>c.setReadTime(e));const i=new kw(e,t,this.Gt,this.Ut,r);return this.Ut=Bs(),this.Kt=ck(),this.Gt=new qn(en),i}jt(e,t){if(!this.Jt(e))return;const r=this.ne(e,t.key)?2:0;this.Ht(e).$t(t.key,r),this.Ut=this.Ut.insert(t.key,t),this.Kt=this.Kt.insert(t.key,this.se(t.key).add(e))}zt(e,t,r){if(!this.Jt(e))return;const i=this.Ht(e);this.ne(e,t)?i.$t(t,1):i.Mt(t),this.Kt=this.Kt.insert(t,this.se(t).delete(e)),r&&(this.Ut=this.Ut.insert(t,r))}removeTarget(e){this.qt.delete(e)}te(e){const t=this.Ht(e).Nt();return this.Lt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.Ht(e).Ot()}Ht(e){let t=this.qt.get(e);return t||(t=new uk,this.qt.set(e,t)),t}se(e){let t=this.Kt.get(e);return t||(t=new qn(en),this.Kt=this.Kt.insert(e,t)),t}Jt(e){const t=null!==this.Xt(e);return t||je("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.qt.get(e);return t&&t.Dt?null:this.Lt.ie(e)}Yt(e){this.qt.set(e,new uk),this.Lt.getRemoteKeysForTarget(e).forEach(t=>{this.zt(e,t,null)})}ne(e,t){return this.Lt.getRemoteKeysForTarget(e).has(t)}}function ck(){return new jr(nt.comparator)}function lk(){return new jr(nt.comparator)}const MU={asc:"ASCENDING",desc:"DESCENDING"},NU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PU={and:"AND",or:"OR"};class kU{constructor(e,t){this.databaseId=e,this.yt=t}}function Qm(n,e){return n.yt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dk(n,e){return n.yt?e.toBase64():e.toUint8Array()}function OU(n,e){return Qm(n,e.toTimestamp())}function Kr(n){return St(!!n),Mt.fromTimestamp(function(e){const t=Me(e);return new nr(t.seconds,t.nanos)}(n))}function fR(n,e){return(t=n,new wn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function hk(n){const e=wn.fromString(n);return St(Ek(e)),e}function Lw(n,e){return fR(n.databaseId,e.path)}function Ru(n,e){const t=hk(e);if(t.get(1)!==n.databaseId.projectId)throw new Le(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Le(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new nt(pk(t))}function pR(n,e){return fR(n.databaseId,e)}function fk(n){const e=hk(n);return 4===e.length?wn.emptyPath():pk(e)}function Fw(n){return new wn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function pk(n){return St(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function gk(n,e,t){return{name:Lw(n,e),fields:t.value.mapValue.fields}}function mk(n,e,t){const r=Ru(n,e.name),i=Kr(e.updateTime),a=e.createTime?Kr(e.createTime):Mt.min(),c=new Si({mapValue:{fields:e.fields}}),h=gr.newFoundDocument(r,i,a,c);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function Uw(n,e){let t;if(e instanceof Zm)t={update:gk(n,e.key,e.value)};else if(e instanceof Ym)t={delete:Lw(n,e.key)};else if(e instanceof jc)t={update:gk(n,e.key,e.data),updateMask:HU(e.fieldMask)};else{if(!(e instanceof hR))return ft();t={verify:Lw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const c=a.transform;if(c instanceof qm)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Wf)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof qf)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Km)return{fieldPath:a.field.canonicalString(),increment:c.It};throw ft()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:OU(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:ft()),t;var i}function gR(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?Er.updateTime(Kr(i.updateTime)):void 0!==i.exists?Er.exists(i.exists):Er.none():Er.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,c){let h=null;"setToServerValue"in c?(St("REQUEST_TIME"===c.setToServerValue),h=new qm):"appendMissingElements"in c?h=new Wf(c.appendMissingElements.values||[]):"removeAllFromArray"in c?h=new qf(c.removeAllFromArray.values||[]):"increment"in c?h=new Km(a,c.increment):ft();const m=fr.fromServerFormat(c.fieldPath);return new xw(m,h)}(n,i)):[];var i;if(e.update){const i=Ru(n,e.update.name),a=new Si({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=new Vs((e.updateMask.fieldPaths||[]).map(w=>fr.fromServerFormat(w)));return new jc(i,a,c,t,r)}return new Zm(i,a,t,r)}if(e.delete){const i=Ru(n,e.delete);return new Ym(i,t)}if(e.verify){const i=Ru(n,e.verify);return new hR(i,t)}return ft()}function _k(n,e){return{documents:[pR(n,e.path)]}}function mR(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=pR(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=pR(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(m){if(0!==m.length)return wk($n.create(m,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const a=function(m){if(0!==m.length)return m.map(w=>{return{field:bd((T=w).field),direction:BU(T.dir)};var T})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=(w=e.limit,n.yt||K(w)?w:{value:w});var w,h,m;return null!==c&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(m=e.endAt).inclusive,values:m.position}),t}function yk(n){let e=fk(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){St(1===r);const T=t.from[0];T.allDescendants?i=T.collectionId:e=e.child(T.collectionId)}let a=[];t.where&&(a=function(T){const D=vk(T);return D instanceof $n&&sR(D)?D.getFilters():[D]}(t.where));let c=[];t.orderBy&&(c=t.orderBy.map(T=>{return new Gm(Xm((D=T).field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction));var D}));let h=null;t.limit&&(h=function(T){let D;return D="object"==typeof T?T.value:T,K(D)?null:D}(t.limit));let m=null;var T;t.startAt&&(m=new Id((T=t.startAt).values||[],!!T.before));let w=null;return t.endAt&&(w=function(T){return new Id(T.values||[],!T.before)}(t.endAt)),FP(e,i,c,a,h,"F",m,w)}function vk(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Xm(e.unaryFilter.field);return En.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=Xm(e.unaryFilter.field);return En.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Xm(e.unaryFilter.field);return En.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Xm(e.unaryFilter.field);return En.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ft()}}(n):void 0!==n.fieldFilter?En.create(Xm((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ft()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return $n.create(e.compositeFilter.filters.map(t=>vk(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return ft()}}(e.compositeFilter.op))}(n):ft();var e}function BU(n){return MU[n]}function jU(n){return NU[n]}function $U(n){return PU[n]}function bd(n){return{fieldPath:n.canonicalString()}}function Xm(n){return fr.fromServerFormat(n.fieldPath)}function wk(n){return n instanceof En?function(e){if("=="===e.op){if(wP(e.value))return{unaryFilter:{field:bd(e.field),op:"IS_NAN"}};if(vP(e.value))return{unaryFilter:{field:bd(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(wP(e.value))return{unaryFilter:{field:bd(e.field),op:"IS_NOT_NAN"}};if(vP(e.value))return{unaryFilter:{field:bd(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bd(e.field),op:jU(e.op),value:e.value}}}(n):n instanceof $n?function(e){const t=e.getFilters().map(r=>wk(r));return 1===t.length?t[0]:{compositeFilter:{op:$U(e.op),filters:t}}}(n):ft()}function HU(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ek(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Ts(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Ik(e)),e=GU(n.get(t),e);return Ik(e)}function GU(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function Ik(n){return n+"\x01\x01"}function xu(n){const e=n.length;if(St(e>=2),2===e)return St("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),wn.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const c=n.indexOf("\x01",a);switch((c<0||c>t)&&ft(),n.charAt(c+1)){case"\x01":const h=n.substring(a,c);let m;0===i.length?m=h:(i+=h,m=i,i=""),r.push(m);break;case"\x10":i+=n.substring(a,c),i+="\0";break;case"\x11":i+=n.substring(a,c+1);break;default:ft()}a=c+2}return new wn(r)}const Tk=["userId","batchId"];function Mb(n,e){return[n,Ts(e)]}function bk(n,e,t){return[n,Ts(e),t]}const zU={},WU=["prefixPath","collectionGroup","readTime","documentId"],qU=["prefixPath","collectionGroup","documentId"],KU=["collectionGroup","readTime","prefixPath","documentId"],ZU=["canonicalId","targetId"],YU=["targetId","path"],QU=["path","targetId"],XU=["collectionId","parent"],JU=["indexId","uid"],eV=["uid","sequenceNumber"],tV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],nV=["indexId","uid","orderedDocumentKey"],rV=["userId","collectionPath","documentId"],iV=["userId","collectionPath","largestBatchId"],sV=["userId","collectionGroup","largestBatchId"],Ck=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],oV=[...Ck,"documentOverlays"],Dk=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Sk=Dk,aV=[...Sk,"indexConfiguration","indexState","indexEntries"];class _R extends _b{constructor(e,t){super(),this.re=e,this.currentSequenceNumber=t}}function Ai(n,e){const t=tt(n);return ho.M(t.re,e)}class yR{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&TU(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Mw(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Mw(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=sk();return this.mutations.forEach(i=>{const a=e.get(i.key),c=a.overlayedDocument;let h=this.applyToLocalView(c,a.mutatedFields);h=t.has(i.key)?null:h;const m=YP(c,h);null!==m&&r.set(i.key,m),c.isValidDocument()||c.convertToNoDocument(Mt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),cn())}isEqual(e){return this.batchId===e.batchId&&Fc(this.mutations,e.mutations,(t,r)=>QP(t,r))&&Fc(this.baseMutations,e.baseMutations,(t,r)=>QP(t,r))}}class vR{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){St(e.mutations.length===r.length);let i=SU;const a=e.mutations;for(let c=0;c<a.length;c++)i=i.insert(a[c].key,r[c].version);return new vR(e,t,r,i)}}class wR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Cd{constructor(e,t,r,i,a=Mt.min(),c=Mt.min(),h=Xe.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h}withSequenceNumber(e){return new Cd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Cd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Cd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Ak{constructor(e){this.oe=e}}function Rk(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Nb(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Lw(i=n.oe,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:Qm(i,a.version.toTimestamp()),createTime:Qm(i,a.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Kf(e.version)};else{if(!e.isUnknownDocument())return ft();r.unknownDocument={path:t.path.toArray(),version:Kf(e.version)}}var i,a;return r}function Nb(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Kf(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zf(n){const e=new nr(n.seconds,n.nanoseconds);return Mt.fromTimestamp(e)}function Yf(n,e){const t=(e.baseMutations||[]).map(a=>gR(n.oe,a));for(let a=0;a<e.mutations.length-1;++a)a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(e.mutations[a].updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a);const r=e.mutations.map(a=>gR(n.oe,a)),i=nr.fromMillis(e.localWriteTimeMs);return new yR(e.batchId,i,t,r)}function Vw(n){const e=Zf(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Zf(n.lastLimboFreeSnapshotVersion):Mt.min();let r;var i;return void 0!==n.query.documents?(St(1===(i=n.query).documents.length),r=Is(Wm(fk(i.documents[0])))):r=Is(yk(n.query)),new Cd(r,n.targetId,0,n.lastListenSequenceNumber,e,t,Xe.fromBase64String(n.resumeToken))}function xk(n,e){const t=Kf(e.snapshotVersion),r=Kf(e.lastLimboFreeSnapshotVersion);let i;i=Ib(e.target)?_k(n.oe,e.target):mR(n.oe,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Gf(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function ER(n){const e=yk({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Cb(e,e.limit,"L"):e}function IR(n,e){return new wR(e.largestBatchId,gR(n.oe,e.overlayMutation))}function Mk(n,e){const t=e.path.lastSegment();return[n,Ts(e.path.popLast()),t]}function Nk(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Kf(r.readTime),documentKey:Ts(r.documentKey.path),largestBatchId:r.largestBatchId}}class cV{getBundleMetadata(e,t){return Pk(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Zf(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return Pk(e).put({bundleId:(r=t).id,createTime:Kf(Kr(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return kk(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:ER(i.bundledQuery),readTime:Zf(i.readTime)};var i})}saveNamedQuery(e,t){return kk(e).put({name:(r=t).name,readTime:Kf(Kr(r.readTime)),bundledQuery:r.bundledQuery});var r}}function Pk(n){return Ai(n,"bundles")}function kk(n){return Ai(n,"namedQueries")}class Pb{constructor(e,t){this.Tt=e,this.userId=t}static ue(e,t){return new Pb(e,t.uid||"")}getOverlay(e,t){return Bw(e).get(Mk(this.userId,t)).next(r=>r?IR(this.Tt,r):null)}getOverlays(e,t){const r=Au();return ie.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,c)=>{const h=new wR(t,c);i.push(this.ce(e,h))}),ie.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(c=>i.add(Ts(c.getCollectionPath())));const a=[];return i.forEach(c=>{const h=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,r+1],!1,!0);a.push(Bw(e).Y("collectionPathOverlayIndex",h))}),ie.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Au(),a=Ts(t),c=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Bw(e).W("collectionPathOverlayIndex",c).next(h=>{for(const m of h){const w=IR(this.Tt,m);i.set(w.getKey(),w)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=Au();let c;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Bw(e).X({index:"collectionGroupOverlayIndex",range:h},(m,w,T)=>{const D=IR(this.Tt,w);a.size()<i||D.largestBatchId===c?(a.set(D.getKey(),D),c=D.largestBatchId):T.done()}).next(()=>a)}ce(e,t){return Bw(e).put(function(r,i,a){const[c,h,m]=Mk(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Uw(r.oe,a.mutation)}}(this.Tt,this.userId,t))}}function Bw(n){return Ai(n,"documentOverlays")}class Qf{constructor(){}ae(e,t){this.he(e,t),t.le()}he(e,t){if("nullValue"in e)this.fe(t,5);else if("booleanValue"in e)this.fe(t,10),t.de(e.booleanValue?1:0);else if("integerValue"in e)this.fe(t,15),t.de(pt(e.integerValue));else if("doubleValue"in e){const r=pt(e.doubleValue);isNaN(r)?this.fe(t,13):(this.fe(t,15),J(r)?t.de(0):t.de(r))}else if("timestampValue"in e){const r=e.timestampValue;this.fe(t,20),"string"==typeof r?t._e(r):(t._e(`${r.seconds||""}`),t.de(r.nanos||0))}else if("stringValue"in e)this.we(e.stringValue,t),this.me(t);else if("bytesValue"in e)this.fe(t,30),t.ge(Nn(e.bytesValue)),this.me(t);else if("referenceValue"in e)this.ye(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.fe(t,45),t.de(r.latitude||0),t.de(r.longitude||0)}else"mapValue"in e?EP(e)?this.fe(t,Number.MAX_SAFE_INTEGER):(this.pe(e.mapValue,t),this.me(t)):"arrayValue"in e?(this.Ie(e.arrayValue,t),this.me(t)):ft()}we(e,t){this.fe(t,25),this.Te(e,t)}Te(e,t){t._e(e)}pe(e,t){const r=e.fields||{};this.fe(t,55);for(const i of Object.keys(r))this.we(i,t),this.he(r[i],t)}Ie(e,t){const r=e.values||[];this.fe(t,50);for(const i of r)this.he(i,t)}ye(e,t){this.fe(t,37),nt.fromName(e).path.forEach(r=>{this.fe(t,60),this.Te(r,t)})}fe(e,t){e.de(t)}me(e){e.de(2)}}function lV(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Ok(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=lV(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}Qf.Ee=new Qf;class dV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ae(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Re(r.value),r=t.next();this.Pe()}ve(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.be(r.value),r=t.next();this.Ve()}Se(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Re(r);else if(r<2048)this.Re(960|r>>>6),this.Re(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Re(480|r>>>12),this.Re(128|63&r>>>6),this.Re(128|63&r);else{const i=t.codePointAt(0);this.Re(240|i>>>18),this.Re(128|63&i>>>12),this.Re(128|63&i>>>6),this.Re(128|63&i)}}this.Pe()}De(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.be(r);else if(r<2048)this.be(960|r>>>6),this.be(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.be(480|r>>>12),this.be(128|63&r>>>6),this.be(128|63&r);else{const i=t.codePointAt(0);this.be(240|i>>>18),this.be(128|63&i>>>12),this.be(128|63&i>>>6),this.be(128|63&i)}}this.Ve()}Ce(e){const t=this.xe(e),r=Ok(t);this.Ne(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}ke(e){const t=this.xe(e),r=Ok(t);this.Ne(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$e(){this.Me(255),this.Me(255)}Oe(){this.Fe(255),this.Fe(255)}reset(){this.position=0}seed(e){this.Ne(e.length),this.buffer.set(e,this.position),this.position+=e.length}Be(){return this.buffer.slice(0,this.position)}xe(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Re(e){const t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(t)}be(e){const t=255&e;0===t?(this.Fe(0),this.Fe(255)):255===t?(this.Fe(255),this.Fe(0)):this.Fe(e)}Pe(){this.Me(0),this.Me(1)}Ve(){this.Fe(0),this.Fe(1)}Me(e){this.Ne(1),this.buffer[this.position++]=e}Fe(e){this.Ne(1),this.buffer[this.position++]=~e}Ne(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class hV{constructor(e){this.Le=e}ge(e){this.Le.Ae(e)}_e(e){this.Le.Se(e)}de(e){this.Le.Ce(e)}le(){this.Le.$e()}}class fV{constructor(e){this.Le=e}ge(e){this.Le.ve(e)}_e(e){this.Le.De(e)}de(e){this.Le.ke(e)}le(){this.Le.Oe()}}class jw{constructor(){this.Le=new dV,this.qe=new hV(this.Le),this.Ue=new fV(this.Le)}seed(e){this.Le.seed(e)}Ke(e){return 0===e?this.qe:this.Ue}Be(){return this.Le.Be()}reset(){this.Le.reset()}}class Xf{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ge(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Xf(this.indexId,this.documentKey,this.arrayValue,r)}}function Dd(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Lk(n.arrayValue,e.arrayValue),0!==t?t:(t=Lk(n.directionalValue,e.directionalValue),0!==t?t:nt.comparator(n.documentKey,e.documentKey)))}function Lk(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class pV{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Qe=e.orderBy,this.je=[];for(const t of e.filters){const r=t;r.isInequality()?this.ze=r:this.je.push(r)}}We(e){St(e.collectionGroup===this.collectionId);const t=Bm(e);if(void 0!==t&&!this.He(t))return!1;const r=Fa(e);let i=0,a=0;for(;i<r.length&&this.He(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.ze){const c=r[i];if(!this.Je(this.ze,c)||!this.Ye(this.Qe[a++],c))return!1;++i}for(;i<r.length;++i)if(a>=this.Qe.length||!this.Ye(this.Qe[a++],r[i]))return!1;return!0}He(e){for(const t of this.je)if(this.Je(t,e))return!0;return!1}Je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Ye(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Fk(n){var e,t;if(St(n instanceof En||n instanceof $n),n instanceof En){if(n instanceof NP){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(a=>En.create(n.field,"==",a)))||[];return $n.create(i,"or")}return n}const r=n.filters.map(i=>Fk(i));return $n.create(r,n.op)}function gV(n){if(0===n.getFilters().length)return[];const e=CR(Fk(n));return St(Uk(e)),TR(e)||bR(e)?[e]:e.getFilters()}function TR(n){return n instanceof En}function bR(n){return n instanceof $n&&sR(n)}function Uk(n){return TR(n)||bR(n)||function(e){if(e instanceof $n&&iR(e)){for(const t of e.getFilters())if(!TR(t)&&!bR(t))return!1;return!0}return!1}(n)}function CR(n){if(St(n instanceof En||n instanceof $n),n instanceof En)return n;if(1===n.filters.length)return CR(n.filters[0]);const e=n.filters.map(r=>CR(r));let t=$n.create(e,n.op);return t=kb(t),Uk(t)?t:(St(t instanceof $n),St(Hm(t)),St(t.filters.length>1),t.filters.reduce((r,i)=>DR(r,i)))}function DR(n,e){let t;return St(n instanceof En||n instanceof $n),St(e instanceof En||e instanceof $n),t=n instanceof En?e instanceof En?$n.create([n,e],"and"):Vk(n,e):e instanceof En?Vk(e,n):function(r,i){if(St(r.filters.length>0&&i.filters.length>0),Hm(r)&&Hm(i))return RP(r,i.getFilters());const a=iR(r)?r:i,c=iR(r)?i:r,h=a.filters.map(m=>DR(m,c));return $n.create(h,"or")}(n,e),kb(t)}function Vk(n,e){if(Hm(e))return RP(e,n.getFilters());{const t=e.filters.map(r=>DR(n,r));return $n.create(t,"or")}}function kb(n){if(St(n instanceof En||n instanceof $n),n instanceof En)return n;const e=n.getFilters();if(1===e.length)return kb(e[0]);if(SP(n))return n;const t=e.map(i=>kb(i)),r=[];return t.forEach(i=>{i instanceof En?r.push(i):i instanceof $n&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:$n.create(r,n.op)}class mV{constructor(){this.Ze=new SR}addToCollectionParentIndex(e,t){return this.Ze.add(t),ie.resolve()}getCollectionParents(e,t){return ie.resolve(this.Ze.getEntries(t))}addFieldIndex(e,t){return ie.resolve()}deleteFieldIndex(e,t){return ie.resolve()}getDocumentsMatchingTarget(e,t){return ie.resolve(null)}getIndexType(e,t){return ie.resolve(0)}getFieldIndexes(e,t){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,t){return ie.resolve(Us.min())}getMinOffsetFromCollectionGroup(e,t){return ie.resolve(Us.min())}updateCollectionGroup(e,t,r){return ie.resolve()}updateIndexEntries(e,t){return ie.resolve()}}class SR{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new qn(wn.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new qn(wn.comparator)).toArray()}}const Ob=new Uint8Array(0);class _V{constructor(e,t){this.user=e,this.databaseId=t,this.Xe=new SR,this.tn=new Td(r=>Gf(r),(r,i)=>Sw(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Xe.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Xe.add(t)});const a={collectionId:r,parent:Ts(i)};return Bk(e).put(a)}return ie.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[fb(t),""],!1,!0);return Bk(e).W(i).next(a=>{for(const c of a){if(c.collectionId!==t)break;r.push(xu(c.parent))}return r})}addFieldIndex(e,t){const r=Lb(e),i={indexId:(c=t).indexId,collectionGroup:c.collectionGroup,fields:c.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var c;delete i.indexId;const a=r.add(i);if(t.indexState){const c=Hw(e);return a.next(h=>{c.put(Nk(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=Lb(e),i=Hw(e),a=$w(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=$w(e);let i=!0;const a=new Map;return ie.forEach(this.en(t),c=>this.nn(e,c).next(h=>{i&&(i=!!h),a.set(c,h)})).next(()=>{if(i){let c=cn();const h=[];return ie.forEach(a,(m,w)=>{var T;je("IndexedDbIndexManager",`Using index ${T=m,`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(dt=>`${dt.fieldPath}:${dt.kind}`).join(",")}`} to execute ${Gf(t)}`);const D=function(dt,It){const Vt=Bm(It);if(void 0===Vt)return null;for(const Zt of Tb(dt,Vt.fieldPath))switch(Zt.op){case"array-contains-any":return Zt.value.arrayValue.values||[];case"array-contains":return[Zt.value]}return null}(w,m),x=function(dt,It){const Vt=new Map;for(const Zt of Fa(It))for(const $r of Tb(dt,Zt.fieldPath))switch($r.op){case"==":case"in":Vt.set(Zt.fieldPath.canonicalString(),$r.value);break;case"not-in":case"!=":return Vt.set(Zt.fieldPath.canonicalString(),$r.value),Array.from(Vt.values())}return null}(w,m),F=function(dt,It){const Vt=[];let Zt=!0;for(const $r of Fa(It)){const Gs=0===$r.kind?OP(dt,$r.fieldPath,dt.startAt):LP(dt,$r.fieldPath,dt.startAt);Vt.push(Gs.value),Zt&&(Zt=Gs.inclusive)}return new Id(Vt,Zt)}(w,m),$=function(dt,It){const Vt=[];let Zt=!0;for(const $r of Fa(It)){const Gs=0===$r.kind?LP(dt,$r.fieldPath,dt.endAt):OP(dt,$r.fieldPath,dt.endAt);Vt.push(Gs.value),Zt&&(Zt=Gs.inclusive)}return new Id(Vt,Zt)}(w,m),ee=this.sn(m,w,F),se=this.sn(m,w,$),ht=this.rn(m,w,x),vt=this.on(m.indexId,D,ee,F.inclusive,se,$.inclusive,ht);return ie.forEach(vt,dt=>r.J(dt,t.limit).next(It=>{It.forEach(Vt=>{const Zt=nt.fromSegments(Vt.documentKey);c.has(Zt)||(c=c.add(Zt),h.push(Zt))})}))}).next(()=>h)}return ie.resolve(null)})}en(e){let t=this.tn.get(e);return t||(t=0===e.filters.length?[e]:gV($n.create(e.filters,"and")).map(r=>aR(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.tn.set(e,t),t)}on(e,t,r,i,a,c,h){const m=(null!=t?t.length:1)*Math.max(r.length,a.length),w=m/(null!=t?t.length:1),T=[];for(let D=0;D<m;++D){const x=t?this.un(t[D/w]):Ob,F=this.cn(e,x,r[D%w],i),$=this.an(e,x,a[D%w],c),ee=h.map(se=>this.cn(e,x,se,!0));T.push(...this.createRange(F,$,ee))}return T}cn(e,t,r,i){const a=new Xf(e,nt.empty(),t,r);return i?a:a.Ge()}an(e,t,r,i){const a=new Xf(e,nt.empty(),t,r);return i?a.Ge():a}nn(e,t){const r=new pV(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let c=null;for(const h of a)r.We(h)&&(!c||h.fields.length>c.fields.length)&&(c=h);return c})}getIndexType(e,t){let r=2;const i=this.en(t);return ie.forEach(i,a=>this.nn(e,a).next(c=>{c?0!==r&&c.fields.length<function(h){let m=new qn(fr.comparator),w=!1;for(const T of h.filters)for(const D of T.getFlattenedFilters())D.field.isKeyField()||("array-contains"===D.op||"array-contains-any"===D.op?w=!0:m=m.add(D.field));for(const T of h.orderBy)T.field.isKeyField()||(m=m.add(T.field));return m.size+(w?1:0)}(a)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}hn(e,t){const r=new jw;for(const i of Fa(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const c=r.Ke(i.kind);Qf.Ee.ae(a,c)}return r.Be()}un(e){const t=new jw;return Qf.Ee.ae(e,t.Ke(0)),t.Be()}ln(e,t){const r=new jw;return Qf.Ee.ae(Hf(this.databaseId,t),r.Ke(function(i){const a=Fa(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.Be()}rn(e,t,r){if(null===r)return[];let i=[];i.push(new jw);let a=0;for(const c of Fa(e)){const h=r[a++];for(const m of i)if(this.fn(t,c.fieldPath)&&Cw(h))i=this.dn(i,c,h);else{const w=m.Ke(c.kind);Qf.Ee.ae(h,w)}}return this._n(i)}sn(e,t,r){return this.rn(e,t,r.position)}_n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Be();return t}dn(e,t,r){const i=[...e],a=[];for(const c of r.arrayValue.values||[])for(const h of i){const m=new jw;m.seed(h.Be()),Qf.Ee.ae(c,m.Ke(t.kind)),a.push(m)}return a}fn(e,t){return!!e.filters.find(r=>r instanceof En&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=Lb(e),i=Hw(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(a=>{const c=[];return ie.forEach(a,h=>i.get([h.indexId,this.uid]).next(m=>{c.push(function(w,T){const D=T?new jf(T.sequenceNumber,new Us(Zf(T.readTime),new nt(xu(T.documentKey)),T.largestBatchId)):jf.empty(),x=w.fields.map(([F,$])=>new Bf(fr.fromServerFormat(F),$));return new Vm(w.indexId,w.collectionGroup,x,D)}(h,m))})).next(()=>c)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:en(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Lb(e),a=Hw(e);return this.wn(e).next(c=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>ie.forEach(h,m=>a.put(Nk(m.indexId,this.user,c,r)))))}updateIndexEntries(e,t){const r=new Map;return ie.forEach(t,(i,a)=>{const c=r.get(i.collectionGroup);return(c?ie.resolve(c):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),ie.forEach(h,m=>this.mn(e,i,m).next(w=>{const T=this.gn(a,m);return w.isEqual(T)?ie.resolve():this.yn(e,a,m,w,T)}))))})}pn(e,t,r,i){return $w(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.ln(r,t.key),documentKey:t.key.path.toArray()})}In(e,t,r,i){return $w(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.ln(r,t.key),t.key.path.toArray()])}mn(e,t,r){const i=$w(e);let a=new qn(Dd);return i.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.ln(r,t)])},(c,h)=>{a=a.add(new Xf(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>a)}gn(e,t){let r=new qn(Dd);const i=this.hn(t,e);if(null==i)return r;const a=Bm(t);if(null!=a){const c=e.data.field(a.fieldPath);if(Cw(c))for(const h of c.arrayValue.values||[])r=r.add(new Xf(t.indexId,e.key,this.un(h),i))}else r=r.add(new Xf(t.indexId,e.key,Ob,i));return r}yn(e,t,r,i,a){je("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const c=[];return function(h,m,w,T,D){const x=h.getIterator(),F=m.getIterator();let $=zm(x),ee=zm(F);for(;$||ee;){let se=!1,ht=!1;if($&&ee){const vt=w($,ee);vt<0?ht=!0:vt>0&&(se=!0)}else null!=$?ht=!0:se=!0;se?(T(ee),ee=zm(F)):ht?(D($),$=zm(x)):($=zm(x),ee=zm(F))}}(i,a,Dd,h=>{c.push(this.pn(e,t,r,h))},h=>{c.push(this.In(e,t,r,h))}),ie.waitFor(c)}wn(e){let t=1;return Hw(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((c,h)=>Dd(c,h)).filter((c,h,m)=>!h||0!==Dd(c,m[h-1]));const i=[];i.push(e);for(const c of r){const h=Dd(c,e),m=Dd(c,t);if(0===h)i[0]=e.Ge();else if(h>0&&m<0)i.push(c),i.push(c.Ge());else if(m>0)break}i.push(t);const a=[];for(let c=0;c<i.length;c+=2){if(this.Tn(i[c],i[c+1]))return[];a.push(IDBKeyRange.bound([i[c].indexId,this.uid,i[c].arrayValue,i[c].directionalValue,Ob,[]],[i[c+1].indexId,this.uid,i[c+1].arrayValue,i[c+1].directionalValue,Ob,[]]))}return a}Tn(e,t){return Dd(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(jk)}getMinOffset(e,t){return ie.mapArray(this.en(t),r=>this.nn(e,r).next(i=>i||ft())).next(jk)}}function Bk(n){return Ai(n,"collectionParents")}function $w(n){return Ai(n,"indexEntries")}function Lb(n){return Ai(n,"indexConfiguration")}function Hw(n){return Ai(n,"indexState")}function jk(n){St(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Ew(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Us(e.readTime,e.documentKey,t)}const $k={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class js{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new js(e,js.DEFAULT_COLLECTION_PERCENTILE,js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Hk(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],c=IDBKeyRange.only(t.batchId);let h=0;const m=r.X({range:c},(T,D,x)=>(h++,x.delete()));a.push(m.next(()=>{St(1===h)}));const w=[];for(const T of t.mutations){const D=bk(e,T.key.path,t.batchId);a.push(i.delete(D)),w.push(T.key)}return ie.waitFor(a).next(()=>w)}function Fb(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ft();e=n.noDocument}return JSON.stringify(e).length}js.DEFAULT_COLLECTION_PERCENTILE=10,js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,js.DEFAULT=new js(41943040,js.DEFAULT_COLLECTION_PERCENTILE,js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),js.DISABLED=new js(-1,0,0);class Ub{constructor(e,t,r,i){this.userId=e,this.Tt=t,this.indexManager=r,this.referenceDelegate=i,this.En={}}static ue(e,t,r,i){St(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new Ub(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Sd(e).X({index:"userMutationsIndex",range:r},(i,a,c)=>{t=!1,c.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=Jm(e),c=Sd(e);return c.add({}).next(h=>{St("number"==typeof h);const m=new yR(h,t,r,i),w=function(x,F,$){const ee=$.baseMutations.map(ht=>Uw(x.oe,ht)),se=$.mutations.map(ht=>Uw(x.oe,ht));return{userId:F,batchId:$.batchId,localWriteTimeMs:$.localWriteTime.toMillis(),baseMutations:ee,mutations:se}}(this.Tt,this.userId,m),T=[];let D=new qn((x,F)=>en(x.canonicalString(),F.canonicalString()));for(const x of i){const F=bk(this.userId,x.key.path,h);D=D.add(x.key.path.popLast()),T.push(c.put(w)),T.push(a.put(F,zU))}return D.forEach(x=>{T.push(this.indexManager.addToCollectionParentIndex(e,x))}),e.addOnCommittedListener(()=>{this.En[h]=m.keys()}),ie.waitFor(T).next(()=>m)})}lookupMutationBatch(e,t){return Sd(e).get(t).next(r=>r?(St(r.userId===this.userId),Yf(this.Tt,r)):null)}An(e,t){return this.En[t]?ie.resolve(this.En[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.En[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Sd(e).X({index:"userMutationsIndex",range:i},(c,h,m)=>{h.userId===this.userId&&(St(h.batchId>=r),a=Yf(this.Tt,h)),m.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Sd(e).X({index:"userMutationsIndex",range:t,reverse:!0},(i,a,c)=>{r=a.batchId,c.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Sd(e).W("userMutationsIndex",t).next(r=>r.map(i=>Yf(this.Tt,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Mb(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Jm(e).X({range:i},(c,h,m)=>{const[w,T,D]=c,x=xu(T);if(w===this.userId&&t.path.isEqual(x))return Sd(e).get(D).next(F=>{if(!F)throw ft();St(F.userId===this.userId),a.push(Yf(this.Tt,F))});m.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qn(en);const i=[];return t.forEach(a=>{const c=Mb(this.userId,a.path),h=IDBKeyRange.lowerBound(c),m=Jm(e).X({range:h},(w,T,D)=>{const[x,F,$]=w,ee=xu(F);x===this.userId&&a.path.isEqual(ee)?r=r.add($):D.done()});i.push(m)}),ie.waitFor(i).next(()=>this.Rn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=Mb(this.userId,r),c=IDBKeyRange.lowerBound(a);let h=new qn(en);return Jm(e).X({range:c},(m,w,T)=>{const[D,x,F]=m,$=xu(x);D===this.userId&&r.isPrefixOf($)?$.length===i&&(h=h.add(F)):T.done()}).next(()=>this.Rn(e,h))}Rn(e,t){const r=[],i=[];return t.forEach(a=>{i.push(Sd(e).get(a).next(c=>{if(null===c)throw ft();St(c.userId===this.userId),r.push(Yf(this.Tt,c))}))}),ie.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Hk(e.re,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Pn(t.batchId)}),ie.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Pn(e){delete this.En[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ie.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Jm(e).X({range:r},(a,c,h)=>{if(a[0]===this.userId){const m=xu(a[1]);i.push(m)}else h.done()}).next(()=>{St(0===i.length)})})}containsKey(e,t){return Gk(e,this.userId,t)}vn(e){return zk(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Gk(n,e,t){const r=Mb(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let c=!1;return Jm(n).X({range:a,Z:!0},(h,m,w)=>{const[T,D,x]=h;T===e&&D===i&&(c=!0),w.done()}).next(()=>c)}function Sd(n){return Ai(n,"mutations")}function Jm(n){return Ai(n,"documentMutations")}function zk(n){return Ai(n,"mutationQueues")}class Jf{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Vn(){return new Jf(0)}static Sn(){return new Jf(-1)}}class yV{constructor(e,t){this.referenceDelegate=e,this.Tt=t}allocateTargetId(e){return this.Dn(e).next(t=>{const r=new Jf(t.highestTargetId);return t.highestTargetId=r.next(),this.Cn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Dn(e).next(t=>Mt.fromTimestamp(new nr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Dn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Dn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Cn(e,i)))}addTargetData(e,t){return this.xn(e,t).next(()=>this.Dn(e).next(r=>(r.targetCount+=1,this.Nn(t,r),this.Cn(e,r))))}updateTargetData(e,t){return this.xn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>e_(e).delete(t.targetId)).next(()=>this.Dn(e)).next(r=>(St(r.targetCount>0),r.targetCount-=1,this.Cn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return e_(e).X((c,h)=>{const m=Vw(h);m.sequenceNumber<=t&&null===r.get(m.targetId)&&(i++,a.push(this.removeTargetData(e,m)))}).next(()=>ie.waitFor(a)).next(()=>i)}forEachTarget(e,t){return e_(e).X((r,i)=>{const a=Vw(i);t(a)})}Dn(e){return Wk(e).get("targetGlobalKey").next(t=>(St(null!==t),t))}Cn(e,t){return Wk(e).put("targetGlobalKey",t)}xn(e,t){return e_(e).put(xk(this.Tt,t))}Nn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Dn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Gf(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return e_(e).X({range:i,index:"queryTargetsIndex"},(c,h,m)=>{const w=Vw(h);Sw(t,w.target)&&(a=w,m.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=Ad(e);return t.forEach(c=>{const h=Ts(c.path);i.push(a.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,c))}),ie.waitFor(i)}removeMatchingKeys(e,t,r){const i=Ad(e);return ie.forEach(t,a=>{const c=Ts(a.path);return ie.waitFor([i.delete([r,c]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=Ad(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ad(e);let a=cn();return i.X({range:r,Z:!0},(c,h,m)=>{const w=xu(c[1]),T=new nt(w);a=a.add(T)}).next(()=>a)}containsKey(e,t){const r=Ts(t.path),i=IDBKeyRange.bound([r],[fb(r)],!1,!0);let a=0;return Ad(e).X({index:"documentTargetsIndex",Z:!0,range:i},([c,h],m,w)=>{0!==c&&(a++,w.done())}).next(()=>a>0)}ie(e,t){return e_(e).get(t).next(r=>r?Vw(r):null)}}function e_(n){return Ai(n,"targets")}function Wk(n){return Ai(n,"targetGlobal")}function Ad(n){return Ai(n,"targetDocuments")}function qk([n,e],[t,r]){const i=en(n,t);return 0===i?en(e,r):i}class vV{constructor(e){this.kn=e,this.buffer=new qn(qk),this.$n=0}Mn(){return++this.$n}On(e){const t=[e,this.Mn()];if(this.buffer.size<this.kn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();qk(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class wV{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Fn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Bn(6e4)}stop(){this.Fn&&(this.Fn.cancel(),this.Fn=null)}get started(){return null!==this.Fn}Bn(e){var t=this;je("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Fn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,me.Z)(function*(){t.Fn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Vc(r)?je("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Uc(r)}yield t.Bn(3e5)}))}}class EV{constructor(e,t){this.Ln=e,this.params=t}calculateTargetCount(e,t){return this.Ln.qn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return ie.resolve(l.at);const r=new vV(t);return this.Ln.forEachTarget(e,i=>r.On(i.sequenceNumber)).next(()=>this.Ln.Un(e,i=>r.On(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Ln.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Ln.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve($k)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$k):this.Kn(e,t))}getCacheSize(e){return this.Ln.getCacheSize(e)}Kn(e,t){let r,i,a,c,h,m,w;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(D=>(D>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${D}`),i=this.params.maximumSequenceNumbersToCollect):i=D,c=Date.now(),this.nthSequenceNumber(e,i))).next(D=>(r=D,h=Date.now(),this.removeTargets(e,r,t))).next(D=>(a=D,m=Date.now(),this.removeOrphanedDocuments(e,r))).next(D=>(w=Date.now(),mw()<=vs.in.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${c-T}ms\n\tDetermined least recently used ${i} in `+(h-c)+`ms\n\tRemoved ${a} targets in `+(m-h)+`ms\n\tRemoved ${D} documents in `+(w-m)+`ms\nTotal Duration: ${w-T}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:D})))}}class IV{constructor(e,t){this.db=e,this.garbageCollector=new EV(this,t)}qn(e){const t=this.Gn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Gn(e){let t=0;return this.Un(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Un(e,t){return this.Qn(e,(r,i)=>t(i))}addReference(e,t,r){return Vb(e,r)}removeReference(e,t,r){return Vb(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Vb(e,t)}jn(e,t){return function(r,i){let a=!1;return zk(r).tt(c=>Gk(r,c,i).next(h=>(h&&(a=!0),ie.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Qn(e,(c,h)=>{if(h<=t){const m=this.jn(e,c).next(w=>{if(!w)return a++,r.getEntry(e,c).next(()=>(r.removeEntry(c,Mt.min()),Ad(e).delete([0,Ts(c.path)])))});i.push(m)}}).next(()=>ie.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Vb(e,t)}Qn(e,t){const r=Ad(e);let i,a=l.at;return r.X({index:"documentTargetsIndex"},([c,h],{path:m,sequenceNumber:w})=>{0===c?(a!==l.at&&t(new nt(xu(i)),a),a=w,i=m):a=l.at}).next(()=>{a!==l.at&&t(new nt(xu(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Vb(n,e){return Ad(n).put((r=n.currentSequenceNumber,{targetId:0,path:Ts(e.path),sequenceNumber:r}));var r}class Kk{constructor(){this.changes=new Td(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,gr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?ie.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class TV{constructor(e){this.Tt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ep(e).put(r)}removeEntry(e,t,r){return ep(e).delete(function(i,a){const c=i.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Nb(a),c[c.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.zn(e,r)))}getEntry(e,t){let r=gr.newInvalidDocument(t);return ep(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Gw(t))},(i,a)=>{r=this.Wn(t,a)}).next(()=>r)}Hn(e,t){let r={size:0,document:gr.newInvalidDocument(t)};return ep(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Gw(t))},(i,a)=>{r={document:this.Wn(t,a),size:Fb(a)}}).next(()=>r)}getEntries(e,t){let r=Bs();return this.Jn(e,t,(i,a)=>{const c=this.Wn(i,a);r=r.insert(i,c)}).next(()=>r)}Yn(e,t){let r=Bs(),i=new jr(nt.comparator);return this.Jn(e,t,(a,c)=>{const h=this.Wn(a,c);r=r.insert(a,h),i=i.insert(a,Fb(c))}).next(()=>({documents:r,Zn:i}))}Jn(e,t,r){if(t.isEmpty())return ie.resolve();let i=new qn(Xk);t.forEach(m=>i=i.add(m));const a=IDBKeyRange.bound(Gw(i.first()),Gw(i.last())),c=i.getIterator();let h=c.getNext();return ep(e).X({index:"documentKeyIndex",range:a},(m,w,T)=>{const D=nt.fromSegments([...w.prefixPath,w.collectionGroup,w.documentId]);for(;h&&Xk(h,D)<0;)r(h,null),h=c.getNext();h&&h.isEqual(D)&&(r(h,w),h=c.hasNext()?c.getNext():null),h?T.j(Gw(h)):T.done()}).next(()=>{for(;h;)r(h,null),h=c.hasNext()?c.getNext():null})}getDocumentsMatchingQuery(e,t,r,i){const a=t.path,c=[a.popLast().toArray(),a.lastSegment(),Nb(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ep(e).W(IDBKeyRange.bound(c,h,!0)).next(m=>{let w=Bs();for(const T of m){const D=this.Wn(nt.fromSegments(T.prefixPath.concat(T.collectionGroup,T.documentId)),T);D.isFoundDocument()&&(Rw(t,D)||i.has(D.key))&&(w=w.insert(D.key,D))}return w})}getAllFromCollectionGroup(e,t,r,i){let a=Bs();const c=Qk(t,r),h=Qk(t,Us.max());return ep(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(c,h,!0)},(m,w,T)=>{const D=this.Wn(nt.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);a=a.insert(D.key,D),a.size===i&&T.done()}).next(()=>a)}newChangeBuffer(e){return new bV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Yk(e).get("remoteDocumentGlobalKey").next(t=>(St(!!t),t))}zn(e,t){return Yk(e).put("remoteDocumentGlobalKey",t)}Wn(e,t){if(t){const r=function uV(n,e){let t;if(e.document)t=mk(n.oe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=nt.fromSegments(e.noDocument.path),i=Zf(e.noDocument.readTime);t=gr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ft();{const r=nt.fromSegments(e.unknownDocument.path),i=Zf(e.unknownDocument.version);t=gr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new nr(r[0],r[1]);return Mt.fromTimestamp(i)}(e.readTime)),t}(this.Tt,t);if(!r.isNoDocument()||!r.version.isEqual(Mt.min()))return r}return gr.newInvalidDocument(e)}}function Zk(n){return new TV(n)}class bV extends Kk{constructor(e,t){super(),this.Xn=e,this.trackRemovals=t,this.ts=new Td(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new qn((a,c)=>en(a.canonicalString(),c.canonicalString()));return this.changes.forEach((a,c)=>{const h=this.ts.get(a);if(t.push(this.Xn.removeEntry(e,a,h.readTime)),c.isValidDocument()){const m=Rk(this.Xn.Tt,c);i=i.add(a.path.popLast());const w=Fb(m);r+=w-h.size,t.push(this.Xn.addEntry(e,a,m))}else if(r-=h.size,this.trackRemovals){const m=Rk(this.Xn.Tt,c.convertToNoDocument(Mt.min()));t.push(this.Xn.addEntry(e,a,m))}}),i.forEach(a=>{t.push(this.Xn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Xn.updateMetadata(e,r)),ie.waitFor(t)}getFromCache(e,t){return this.Xn.Hn(e,t).next(r=>(this.ts.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Xn.Yn(e,t).next(({documents:r,Zn:i})=>(i.forEach((a,c)=>{this.ts.set(a,{size:c,readTime:r.get(a).readTime})}),r))}}function Yk(n){return Ai(n,"remoteDocumentGlobal")}function ep(n){return Ai(n,"remoteDocumentsV14")}function Gw(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Qk(n,e){const t=e.documentKey.path.toArray();return[n,Nb(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Xk(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=en(t[a],r[a]),i)return i;return i=en(t.length,r.length),i||(i=en(t[t.length-2],r[r.length-2]),i||en(t[t.length-1],r[r.length-1]))}class CV{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Jk{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&Mw(r.mutation,i,Vs.empty(),nr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,cn()).next(()=>r))}getLocalViewOfDocuments(e,t,r=cn()){const i=Au();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let c=Nw();return a.forEach((h,m)=>{c=c.insert(h,m.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){const r=Au();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,cn()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((c,h)=>{t.set(c,h)})})}computeViews(e,t,r,i){let a=Bs();const c=Pw(),h=Pw();return t.forEach((m,w)=>{const T=r.get(w.key);i.has(w.key)&&(void 0===T||T.mutation instanceof jc)?a=a.insert(w.key,w):void 0!==T?(c.set(w.key,T.mutation.getFieldMask()),Mw(T.mutation,w,T.mutation.getFieldMask(),nr.now())):c.set(w.key,Vs.empty())}),this.recalculateAndSaveOverlays(e,a).next(m=>(m.forEach((w,T)=>c.set(w,T)),t.forEach((w,T)=>{var D;return h.set(w,new CV(T,null!==(D=c.get(w))&&void 0!==D?D:null))}),h))}recalculateAndSaveOverlays(e,t){const r=Pw();let i=new jr((c,h)=>c-h),a=cn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(const h of c)h.keys().forEach(m=>{const w=t.get(m);if(null===w)return;let T=r.get(m)||Vs.empty();T=h.applyToLocalView(w,T),r.set(m,T);const D=(i.get(h.batchId)||cn()).add(m);i=i.insert(h.batchId,D)})}).next(()=>{const c=[],h=i.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),w=m.key,T=m.value,D=sk();T.forEach(x=>{if(!a.has(x)){const F=YP(t.get(x),r.get(x));null!==F&&D.set(x,F),a=a.add(x)}}),c.push(this.documentOverlayCache.saveOverlays(e,w,D))}return ie.waitFor(c)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return nt.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):cR(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const c=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ie.resolve(Au());let h=-1,m=a;return c.next(w=>ie.forEach(w,(T,D)=>(h<D.largestBatchId&&(h=D.largestBatchId),a.get(T)?ie.resolve():this.remoteDocumentCache.getEntry(e,T).next(x=>{m=m.insert(T,x)}))).next(()=>this.populateOverlays(e,w,a)).next(()=>this.computeViews(e,m,w,cn())).next(T=>({batchId:h,changes:ik(T)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new nt(t)).next(r=>{let i=Nw();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=Nw();return this.indexManager.getCollectionParents(e,i).next(c=>ie.forEach(c,h=>{const m=(w=t,T=h.child(i),new Bc(T,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt));var w,T;return this.getDocumentsMatchingCollectionQuery(e,m,r).next(w=>{w.forEach((T,D)=>{a=a.insert(T,D)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i))).next(a=>{i.forEach((h,m)=>{const w=m.getKey();null===a.get(w)&&(a=a.insert(w,gr.newInvalidDocument(w)))});let c=Nw();return a.forEach((h,m)=>{const w=i.get(h);void 0!==w&&Mw(w.mutation,m,Vs.empty(),nr.now()),Rw(t,m)&&(c=c.insert(h,m))}),c})}}class DV{constructor(e){this.Tt=e,this.es=new Map,this.ns=new Map}getBundleMetadata(e,t){return ie.resolve(this.es.get(t))}saveBundleMetadata(e,t){var r;return this.es.set(t.id,{id:(r=t).id,version:r.version,createTime:Kr(r.createTime)}),ie.resolve()}getNamedQuery(e,t){return ie.resolve(this.ns.get(t))}saveNamedQuery(e,t){return this.ns.set(t.name,{name:(r=t).name,query:ER(r.bundledQuery),readTime:Kr(r.readTime)}),ie.resolve();var r}}class SV{constructor(){this.overlays=new jr(nt.comparator),this.ss=new Map}getOverlay(e,t){return ie.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Au();return ie.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.ce(e,t,a)}),ie.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.ss.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.ss.delete(r)),ie.resolve()}getOverlaysForCollection(e,t,r){const i=Au(),a=t.length+1,c=new nt(t.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const m=h.getNext().value,w=m.getKey();if(!t.isPrefixOf(w.path))break;w.path.length===a&&m.largestBatchId>r&&i.set(m.getKey(),m)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new jr((w,T)=>w-T);const c=this.overlays.getIterator();for(;c.hasNext();){const w=c.getNext().value;if(w.getKey().getCollectionGroup()===t&&w.largestBatchId>r){let T=a.get(w.largestBatchId);null===T&&(T=Au(),a=a.insert(w.largestBatchId,T)),T.set(w.getKey(),w)}}const h=Au(),m=a.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((w,T)=>h.set(w,T)),!(h.size()>=i)););return ie.resolve(h)}ce(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const c=this.ss.get(i.largestBatchId).delete(r.key);this.ss.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new wR(t,r));let a=this.ss.get(t);void 0===a&&(a=cn(),this.ss.set(t,a)),this.ss.set(t,a.add(r.key))}}class AR{constructor(){this.rs=new qn(Ri.os),this.us=new qn(Ri.cs)}isEmpty(){return this.rs.isEmpty()}addReference(e,t){const r=new Ri(e,t);this.rs=this.rs.add(r),this.us=this.us.add(r)}hs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ls(new Ri(e,t))}fs(e,t){e.forEach(r=>this.removeReference(r,t))}ds(e){const t=new nt(new wn([])),r=new Ri(t,e),i=new Ri(t,e+1),a=[];return this.us.forEachInRange([r,i],c=>{this.ls(c),a.push(c.key)}),a}_s(){this.rs.forEach(e=>this.ls(e))}ls(e){this.rs=this.rs.delete(e),this.us=this.us.delete(e)}ws(e){const t=new nt(new wn([])),r=new Ri(t,e),i=new Ri(t,e+1);let a=cn();return this.us.forEachInRange([r,i],c=>{a=a.add(c.key)}),a}containsKey(e){const t=new Ri(e,0),r=this.rs.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Ri{constructor(e,t){this.key=e,this.gs=t}static os(e,t){return nt.comparator(e.key,t.key)||en(e.gs,t.gs)}static cs(e,t){return en(e.gs,t.gs)||nt.comparator(e.key,t.key)}}class AV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ys=1,this.ps=new qn(Ri.os)}checkEmpty(e){return ie.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.ys;this.ys++;const c=new yR(a,t,r,i);this.mutationQueue.push(c);for(const h of i)this.ps=this.ps.add(new Ri(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return ie.resolve(c)}lookupMutationBatch(e,t){return ie.resolve(this.Is(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.Ts(t+1),a=i<0?0:i;return ie.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(0===this.mutationQueue.length?-1:this.ys-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ri(t,0),i=new Ri(t,Number.POSITIVE_INFINITY),a=[];return this.ps.forEachInRange([r,i],c=>{const h=this.Is(c.gs);a.push(h)}),ie.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qn(en);return t.forEach(i=>{const a=new Ri(i,0),c=new Ri(i,Number.POSITIVE_INFINITY);this.ps.forEachInRange([a,c],h=>{r=r.add(h.gs)})}),ie.resolve(this.Es(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;nt.isDocumentKey(a)||(a=a.child(""));const c=new Ri(new nt(a),0);let h=new qn(en);return this.ps.forEachWhile(m=>{const w=m.key.path;return!!r.isPrefixOf(w)&&(w.length===i&&(h=h.add(m.gs)),!0)},c),ie.resolve(this.Es(h))}Es(e){const t=[];return e.forEach(r=>{const i=this.Is(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){St(0===this.As(t.batchId,"removed")),this.mutationQueue.shift();let r=this.ps;return ie.forEach(t.mutations,i=>{const a=new Ri(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ps=r})}Pn(e){}containsKey(e,t){const r=new Ri(t,0),i=this.ps.firstAfterOrEqual(r);return ie.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ie.resolve()}As(e,t){return this.Ts(e)}Ts(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Is(e){const t=this.Ts(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class RV{constructor(e){this.Rs=e,this.docs=new jr(nt.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,c=this.Rs(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ie.resolve(r?r.document.mutableCopy():gr.newInvalidDocument(t))}getEntries(e,t){let r=Bs();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():gr.newInvalidDocument(i))}),ie.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=Bs();const c=t.path,h=new nt(c.child("")),m=this.docs.getIteratorFrom(h);for(;m.hasNext();){const{key:w,value:{document:T}}=m.getNext();if(!c.isPrefixOf(w.path))break;w.path.length>c.length+1||Ew(JA(T),r)<=0||(i.has(T.key)||Rw(t,T))&&(a=a.insert(T.key,T.mutableCopy()))}return ie.resolve(a)}getAllFromCollectionGroup(e,t,r,i){ft()}Ps(e,t){return ie.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new xV(this)}getSize(e){return ie.resolve(this.size)}}class xV extends Kk{constructor(e){super(),this.Xn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Xn.addEntry(e,i)):this.Xn.removeEntry(r)}),ie.waitFor(t)}getFromCache(e,t){return this.Xn.getEntry(e,t)}getAllFromCache(e,t){return this.Xn.getEntries(e,t)}}class MV{constructor(e){this.persistence=e,this.vs=new Td(t=>Gf(t),Sw),this.lastRemoteSnapshotVersion=Mt.min(),this.highestTargetId=0,this.bs=0,this.Vs=new AR,this.targetCount=0,this.Ss=Jf.Vn()}forEachTarget(e,t){return this.vs.forEach((r,i)=>t(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.Ss.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.bs&&(this.bs=t),ie.resolve()}xn(e){this.vs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ss=new Jf(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.xn(t),this.targetCount+=1,ie.resolve()}updateTargetData(e,t){return this.xn(t),ie.resolve()}removeTargetData(e,t){return this.vs.delete(t.target),this.Vs.ds(t.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.vs.forEach((c,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.vs.delete(c),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),ie.waitFor(a).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,t){const r=this.vs.get(t)||null;return ie.resolve(r)}addMatchingKeys(e,t,r){return this.Vs.hs(t,r),ie.resolve()}removeMatchingKeys(e,t,r){this.Vs.fs(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(c=>{a.push(i.markPotentiallyOrphaned(e,c))}),ie.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Vs.ds(t),ie.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Vs.ws(t);return ie.resolve(r)}containsKey(e,t){return ie.resolve(this.Vs.containsKey(t))}}class eO{constructor(e,t){this.Ds={},this.overlays={},this.Cs=new l(0),this.xs=!1,this.xs=!0,this.referenceDelegate=e(this),this.Ns=new MV(this),this.indexManager=new mV,this.remoteDocumentCache=new RV(r=>this.referenceDelegate.ks(r)),this.Tt=new Ak(t),this.$s=new DV(this.Tt)}start(){return Promise.resolve()}shutdown(){return this.xs=!1,Promise.resolve()}get started(){return this.xs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new SV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Ds[e.toKey()];return r||(r=new AV(t,this.referenceDelegate),this.Ds[e.toKey()]=r),r}getTargetCache(){return this.Ns}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$s}runTransaction(e,t,r){je("MemoryPersistence","Starting transaction:",e);const i=new NV(this.Cs.next());return this.referenceDelegate.Ms(),r(i).next(a=>this.referenceDelegate.Os(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Fs(e,t){return ie.or(Object.values(this.Ds).map(r=>()=>r.containsKey(e,t)))}}class NV extends _b{constructor(e){super(),this.currentSequenceNumber=e}}class Bb{constructor(e){this.persistence=e,this.Bs=new AR,this.Ls=null}static qs(e){return new Bb(e)}get Us(){if(this.Ls)return this.Ls;throw ft()}addReference(e,t,r){return this.Bs.addReference(r,t),this.Us.delete(r.toString()),ie.resolve()}removeReference(e,t,r){return this.Bs.removeReference(r,t),this.Us.add(r.toString()),ie.resolve()}markPotentiallyOrphaned(e,t){return this.Us.add(t.toString()),ie.resolve()}removeTarget(e,t){this.Bs.ds(t.targetId).forEach(i=>this.Us.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Us.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}Ms(){this.Ls=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.Us,r=>{const i=nt.fromPath(r);return this.Ks(e,i).next(a=>{a||t.removeEntry(i,Mt.min())})}).next(()=>(this.Ls=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ks(e,t).next(r=>{r?this.Us.delete(t.toString()):this.Us.add(t.toString())})}ks(e){return 0}Ks(e,t){return ie.or([()=>ie.resolve(this.Bs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Fs(e,t)])}}class PV{constructor(e){this.Tt=e}F(e,t,r,i){const a=new Iw("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Tk,{unique:!0}),h.createObjectStore("documentMutations"),tO(e),function(h){h.createObjectStore("remoteDocuments")}(e));let c=ie.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),tO(e)),c=c.next(()=>function(h){const m=h.store("targetGlobal"),w={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Mt.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",w)}(a))),r<4&&i>=4&&(0!==r&&(c=c.next(()=>function(h,m){return m.store("mutations").W().next(w=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Tk,{unique:!0});const T=m.store("mutations"),D=w.map(x=>T.put(x));return ie.waitFor(D)})}(e,a))),c=c.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(c=c.next(()=>this.Gs(a))),r<6&&i>=6&&(c=c.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Qs(a)))),r<7&&i>=7&&(c=c.next(()=>this.js(a))),r<8&&i>=8&&(c=c.next(()=>this.zs(e,a))),r<9&&i>=9&&(c=c.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(c=c.next(()=>this.Ws(a))),r<11&&i>=11&&(c=c.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(c=c.next(()=>{!function(h){const m=h.createObjectStore("documentOverlays",{keyPath:rV});m.createIndex("collectionPathOverlayIndex",iV,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",sV,{unique:!1})}(e)})),r<13&&i>=13&&(c=c.next(()=>function(h){const m=h.createObjectStore("remoteDocumentsV14",{keyPath:WU});m.createIndex("documentKeyIndex",qU),m.createIndex("collectionGroupIndex",KU)}(e)).next(()=>this.Hs(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(c=c.next(()=>this.Js(e,a))),r<15&&i>=15&&(c=c.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:JU}).createIndex("sequenceNumberIndex",eV,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:tV}).createIndex("documentKeyIndex",nV,{unique:!1})}(e))),c}Qs(e){let t=0;return e.store("remoteDocuments").X((r,i)=>{t+=Fb(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Gs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>ie.forEach(i,a=>{const c=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",c).next(h=>ie.forEach(h,m=>{St(m.userId===a.userId);const w=Yf(this.Tt,m);return Hk(e,a.userId,w).next(()=>{})}))}))}js(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.X((c,h)=>{const m=new wn(c),w=[0,Ts(m)];a.push(t.get(w).next(T=>T?ie.resolve():t.put({targetId:0,path:Ts(m),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>ie.waitFor(a))})}zs(e,t){e.createObjectStore("collectionParents",{keyPath:XU});const r=t.store("collectionParents"),i=new SR,a=c=>{if(i.add(c)){const h=c.lastSegment(),m=c.popLast();return r.put({collectionId:h,parent:Ts(m)})}};return t.store("remoteDocuments").X({Z:!0},(c,h)=>{const m=new wn(c);return a(m.popLast())}).next(()=>t.store("documentMutations").X({Z:!0},([c,h,m],w)=>{const T=xu(h);return a(T.popLast())}))}Ws(e){const t=e.store("targets");return t.X((r,i)=>{const a=Vw(i),c=xk(this.Tt,a);return t.put(c)})}Hs(e,t){const r=t.store("remoteDocuments"),i=[];return r.X((a,c)=>{const h=t.store("remoteDocumentsV14"),m=(w=c,w.document?new nt(wn.fromString(w.document.name).popFirst(5)):w.noDocument?nt.fromSegments(w.noDocument.path):w.unknownDocument?nt.fromSegments(w.unknownDocument.path):ft()).path.toArray();var w;const T={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};i.push(h.put(T))}).next(()=>ie.waitFor(i))}Js(e,t){const r=t.store("mutations"),i=Zk(this.Tt),a=new eO(Bb.qs,this.Tt.oe);return r.W().next(c=>{const h=new Map;return c.forEach(m=>{var w;let T=null!==(w=h.get(m.userId))&&void 0!==w?w:cn();Yf(this.Tt,m).keys().forEach(D=>T=T.add(D)),h.set(m.userId,T)}),ie.forEach(h,(m,w)=>{const T=new fi(w),D=Pb.ue(this.Tt,T),x=a.getIndexManager(T),F=Ub.ue(T,this.Tt,x,a.referenceDelegate);return new Jk(i,F,D,x).recalculateAndSaveOverlaysForDocumentKeys(new _R(t,l.at),m).next()})})}}function tO(n){n.createObjectStore("targetDocuments",{keyPath:YU}).createIndex("documentTargetsIndex",QU,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ZU,{unique:!0}),n.createObjectStore("targetGlobal")}const RR="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class xR{constructor(e,t,r,i,a,c,h,m,w,T,D=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ys=a,this.window=c,this.document=h,this.Zs=w,this.Xs=T,this.ti=D,this.Cs=null,this.xs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ei=null,this.inForeground=!1,this.ni=null,this.si=null,this.ii=Number.NEGATIVE_INFINITY,this.ri=x=>Promise.resolve(),!xR.C())throw new Le(ce.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new IV(this,i),this.oi=t+"main",this.Tt=new Ak(m),this.ui=new ho(this.oi,this.ti,new PV(this.Tt)),this.Ns=new yV(this.referenceDelegate,this.Tt),this.remoteDocumentCache=Zk(this.Tt),this.$s=new cV,this.window&&this.window.localStorage?this.ci=this.window.localStorage:(this.ci=null,!1===T&&Vr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Le(ce.FAILED_PRECONDITION,RR);return this.hi(),this.li(),this.fi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ns.getHighestSequenceNumber(e))}).then(e=>{this.Cs=new l(e,this.Zs)}).then(()=>{this.xs=!0}).catch(e=>(this.ui&&this.ui.close(),Promise.reject(e)))}di(e){var t=this;return this.ri=function(){var r=(0,me.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ui.L(function(){var t=(0,me.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Ys.enqueueAndForget((0,me.Z)(function*(){t.started&&(yield t.ai())})))}ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>jb(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this._i(e).next(t=>{t||(this.isPrimary=!1,this.Ys.enqueueRetryable(()=>this.ri(!1)))})}).next(()=>this.wi(e)).next(t=>this.isPrimary&&!t?this.mi(e).next(()=>!1):!!t&&this.gi(e).next(()=>!0))).catch(e=>{if(Vc(e))return je("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return je("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ys.enqueueRetryable(()=>this.ri(e)),this.isPrimary=e})}_i(e){return zw(e).get("owner").next(t=>ie.resolve(this.yi(t)))}pi(e){return jb(e).delete(this.clientId)}Ii(){var e=this;return(0,me.Z)(function*(){if(e.isPrimary&&!e.Ti(e.ii,18e5)){e.ii=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Ai(r,"clientMetadata");return i.W().next(a=>{const c=e.Ei(a,18e5),h=a.filter(m=>-1===c.indexOf(m));return ie.forEach(h,m=>i.delete(m.clientId)).next(()=>h)})}).catch(()=>[]);if(e.ci)for(const r of t)e.ci.removeItem(e.Ai(r.clientId))}})()}fi(){this.si=this.Ys.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ai().then(()=>this.Ii()).then(()=>this.fi()))}yi(e){return!!e&&e.ownerId===this.clientId}wi(e){return this.Xs?ie.resolve(!0):zw(e).get("owner").next(t=>{if(null!==t&&this.Ti(t.leaseTimestampMs,5e3)&&!this.Ri(t.ownerId)){if(this.yi(t)&&this.networkEnabled)return!0;if(!this.yi(t)){if(!t.allowTabSynchronization)throw new Le(ce.FAILED_PRECONDITION,RR);return!1}}return!(!this.networkEnabled||!this.inForeground)||jb(e).W().next(r=>void 0===this.Ei(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&je("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,me.Z)(function*(){e.xs=!1,e.Pi(),e.si&&(e.si.cancel(),e.si=null),e.vi(),e.bi(),yield e.ui.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new _R(t,l.at);return e.mi(r).next(()=>e.pi(r))}),e.ui.close(),e.Vi()})()}Ei(e,t){return e.filter(r=>this.Ti(r.updateTimeMs,t)&&!this.Ri(r.clientId))}Si(){return this.runTransaction("getActiveClients","readonly",e=>jb(e).W().next(t=>this.Ei(t,18e5).map(r=>r.clientId)))}get started(){return this.xs}getMutationQueue(e,t){return Ub.ue(e,this.Tt,t,this.referenceDelegate)}getTargetCache(){return this.Ns}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new _V(e,this.Tt.oe.databaseId)}getDocumentOverlayCache(e){return Pb.ue(this.Tt,e)}getBundleCache(){return this.$s}runTransaction(e,t,r){je("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(c=this.ti)?aV:14===c?Sk:13===c?Dk:12===c?oV:11===c?Ck:void ft();var c;let h;return this.ui.runTransaction(e,i,a,m=>(h=new _R(m,this.Cs?this.Cs.next():l.at),"readwrite-primary"===t?this._i(h).next(w=>!!w||this.wi(h)).next(w=>{if(!w)throw Vr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ys.enqueueRetryable(()=>this.ri(!1)),new Le(ce.FAILED_PRECONDITION,mb);return r(h)}).next(w=>this.gi(h).next(()=>w)):this.Di(h).next(()=>r(h)))).then(m=>(h.raiseOnCommittedEvent(),m))}Di(e){return zw(e).get("owner").next(t=>{if(null!==t&&this.Ti(t.leaseTimestampMs,5e3)&&!this.Ri(t.ownerId)&&!this.yi(t)&&!(this.Xs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Le(ce.FAILED_PRECONDITION,RR)})}gi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return zw(e).put("owner",t)}static C(){return ho.C()}mi(e){const t=zw(e);return t.get("owner").next(r=>this.yi(r)?(je("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):ie.resolve())}Ti(e,t){const r=Date.now();return!(e<r-t||e>r&&(Vr(`Detected an update time that is in the future: ${e} > ${r}`),1))}hi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ni=()=>{this.Ys.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ai()))},this.document.addEventListener("visibilitychange",this.ni),this.inForeground="visible"===this.document.visibilityState)}vi(){this.ni&&(this.document.removeEventListener("visibilitychange",this.ni),this.ni=null)}li(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ei=()=>{this.Pi();const t=/(?:Version|Mobile)\/1[456]/;(0,N.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ys.enterRestrictedMode(!0),this.Ys.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ei))}bi(){this.ei&&(this.window.removeEventListener("pagehide",this.ei),this.ei=null)}Ri(e){var t;try{const r=null!==(null===(t=this.ci)||void 0===t?void 0:t.getItem(this.Ai(e)));return je("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Vr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Pi(){if(this.ci)try{this.ci.setItem(this.Ai(this.clientId),String(Date.now()))}catch(e){Vr("Failed to set zombie client id.",e)}}Vi(){if(this.ci)try{this.ci.removeItem(this.Ai(this.clientId))}catch{}}Ai(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function zw(n){return Ai(n,"owner")}function jb(n){return Ai(n,"clientMetadata")}function MR(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class NR{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ci=r,this.xi=i}static Ni(e,t){let r=cn(),i=cn();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new NR(e,t.fromCache,r,i)}}class nO{constructor(){this.ki=!1}initialize(e,t){this.$i=e,this.indexManager=t,this.ki=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Mi(e,t).next(a=>a||this.Oi(e,t,i,r)).next(a=>a||this.Fi(e,t))}Mi(e,t){if(UP(t))return ie.resolve(null);let r=Is(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Cb(t,null,"F"),r=Is(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const c=cn(...a);return this.$i.getDocuments(e,c).next(h=>this.indexManager.getMinOffset(e,r).next(m=>{const w=this.Bi(t,h);return this.Li(t,w,c,m.readTime)?this.Mi(e,Cb(t,null,"F")):this.qi(e,w,t,m)}))})))}Oi(e,t,r,i){return UP(t)||i.isEqual(Mt.min())?this.Fi(e,t):this.$i.getDocuments(e,r).next(a=>{const c=this.Bi(t,a);return this.Li(t,c,r,i)?this.Fi(e,t):(mw()<=vs.in.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),dR(t)),this.qi(e,c,t,gb(i,-1)))})}Bi(e,t){let r=new qn(jP(e));return t.forEach((i,a)=>{Rw(e,a)&&(r=r.add(a))}),r}Li(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Fi(e,t){return mw()<=vs.in.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",dR(t)),this.$i.getDocumentsMatchingQuery(e,t,Us.min())}qi(e,t,r,i){return this.$i.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(c=>{a=a.insert(c.key,c)}),a))}}class kV{constructor(e,t,r,i){this.persistence=e,this.Ui=t,this.Tt=i,this.Ki=new jr(en),this.Gi=new Td(a=>Gf(a),Sw),this.Qi=new Map,this.ji=e.getRemoteDocumentCache(),this.Ns=e.getTargetCache(),this.$s=e.getBundleCache(),this.zi(r)}zi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Jk(this.ji,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ji.setIndexManager(this.indexManager),this.Ui.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ki))}}function rO(n,e,t,r){return new kV(n,e,t,r)}function iO(n,e){return PR.apply(this,arguments)}function PR(){return PR=(0,me.Z)(function*(n,e){const t=tt(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.zi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const c=[],h=[];let m=cn();for(const w of i){c.push(w.batchId);for(const T of w.mutations)m=m.add(T.key)}for(const w of a){h.push(w.batchId);for(const T of w.mutations)m=m.add(T.key)}return t.localDocuments.getDocuments(r,m).next(w=>({Wi:w,removedBatchIds:c,addedBatchIds:h}))})})}),PR.apply(this,arguments)}function sO(n){const e=tt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ns.getLastRemoteSnapshotVersion(t))}function oO(n,e,t){let r=cn(),i=cn();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let c=Bs();return t.forEach((h,m)=>{const w=a.get(h);m.isFoundDocument()!==w.isFoundDocument()&&(i=i.add(h)),m.isNoDocument()&&m.version.isEqual(Mt.min())?(e.removeEntry(h,m.readTime),c=c.insert(h,m)):!w.isValidDocument()||m.version.compareTo(w.version)>0||0===m.version.compareTo(w.version)&&w.hasPendingWrites?(e.addEntry(m),c=c.insert(h,m)):je("LocalStore","Ignoring outdated watch update for ",h,". Current version:",w.version," Watch version:",m.version)}),{Hi:c,Ji:i}})}function FV(n,e){const t=tt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function t_(n,e){const t=tt(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ns.getTargetData(r,e).next(a=>a?(i=a,ie.resolve(i)):t.Ns.allocateTargetId(r).next(c=>(i=new Cd(e,c,0,r.currentSequenceNumber),t.Ns.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ki.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ki=t.Ki.insert(r.targetId,r),t.Gi.set(e,r.targetId)),r})}function n_(n,e,t){return kR.apply(this,arguments)}function kR(){return kR=(0,me.Z)(function*(n,e,t){const r=tt(n),i=r.Ki.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,c=>r.persistence.referenceDelegate.removeTarget(c,i)))}catch(c){if(!Vc(c))throw c;je("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}r.Ki=r.Ki.remove(e),r.Gi.delete(i.target)}),kR.apply(this,arguments)}function $b(n,e,t){const r=tt(n);let i=Mt.min(),a=cn();return r.persistence.runTransaction("Execute query","readonly",c=>function(h,m,w){const T=tt(h),D=T.Gi.get(w);return void 0!==D?ie.resolve(T.Ki.get(D)):T.Ns.getTargetData(m,w)}(r,c,Is(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Ns.getMatchingKeysForTargetId(c,h.targetId).next(m=>{a=m})}).next(()=>r.Ui.getDocumentsMatchingQuery(c,e,t?i:Mt.min(),t?a:cn())).next(h=>(cO(r,BP(e),h),{documents:h,Yi:a})))}function aO(n,e){const t=tt(n),r=tt(t.Ns),i=t.Ki.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.ie(a,e).next(c=>c?c.target:null))}function uO(n,e){const t=tt(n),r=t.Qi.get(e)||Mt.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ji.getAllFromCollectionGroup(i,e,gb(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(cO(t,e,i),i))}function cO(n,e,t){let r=n.Qi.get(e)||Mt.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Qi.set(e,r)}function OR(){return OR=(0,me.Z)(function*(n,e,t,r){const i=tt(n);let a=cn(),c=Bs();for(const w of t){const T=e.Zi(w.metadata.name);w.document&&(a=a.add(T));const D=e.Xi(w);D.setReadTime(e.tr(w.metadata.readTime)),c=c.insert(T,D)}const h=i.ji.newChangeBuffer({trackRemovals:!0}),m=yield t_(i,(w=r,Is(Wm(wn.fromString(`__bundle__/docs/${w}`)))));var w;return i.persistence.runTransaction("Apply bundle documents","readwrite",w=>oO(w,h,c).next(T=>(h.apply(w),T)).next(T=>i.Ns.removeMatchingKeysForTargetId(w,m.targetId).next(()=>i.Ns.addMatchingKeys(w,a,m.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(w,T.Hi,T.Ji)).next(()=>T.Hi)))}),OR.apply(this,arguments)}function VV(n,e){return LR.apply(this,arguments)}function LR(){return LR=(0,me.Z)(function*(n,e,t=cn()){const r=yield t_(n,Is(ER(e.bundledQuery))),i=tt(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const c=Kr(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return i.$s.saveNamedQuery(a,e);const h=r.withResumeToken(Xe.EMPTY_BYTE_STRING,c);return i.Ki=i.Ki.insert(h.targetId,h),i.Ns.updateTargetData(a,h).next(()=>i.Ns.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Ns.addMatchingKeys(a,t,r.targetId)).next(()=>i.$s.saveNamedQuery(a,e))})}),LR.apply(this,arguments)}function lO(n,e){return`firestore_clients_${n}_${e}`}function dO(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function FR(n,e){return`firestore_targets_${n}_${e}`}class Hb{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static er(e,t,r){const i=JSON.parse(r);let a,c="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return c&&i.error&&(c="string"==typeof i.error.message&&"string"==typeof i.error.code,c&&(a=new Le(i.error.code,i.error.message))),c?new Hb(e,t,i.state,a):(Vr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}nr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ww{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static er(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Le(r.error.code,r.error.message))),a?new Ww(e,r.state,i):(Vr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}nr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Gb{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static er(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=Rb();for(let c=0;i&&c<r.activeTargetIds.length;++c)i=Ee(r.activeTargetIds[c]),a=a.add(r.activeTargetIds[c]);return i?new Gb(e,a):(Vr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class UR{constructor(e,t){this.clientId=e,this.onlineState=t}static er(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new UR(t.clientId,t.onlineState):(Vr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class VR{constructor(){this.activeTargetIds=Rb()}sr(e){this.activeTargetIds=this.activeTargetIds.add(e)}ir(e){this.activeTargetIds=this.activeTargetIds.delete(e)}nr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class BR{constructor(e,t,r,i,a){this.window=e,this.Ys=t,this.persistenceKey=r,this.rr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ur=this.cr.bind(this),this.ar=new jr(en),this.started=!1,this.hr=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.lr=lO(this.persistenceKey,this.rr),this.dr=`firestore_sequence_number_${this.persistenceKey}`,this.ar=this.ar.insert(this.rr,new VR),this._r=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.wr=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.mr=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.gr=`firestore_online_state_${this.persistenceKey}`,this.yr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ur)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,me.Z)(function*(){const t=yield e.syncEngine.Si();for(const i of t){if(i===e.rr)continue;const a=e.getItem(lO(e.persistenceKey,i));if(a){const c=Gb.er(i,a);c&&(e.ar=e.ar.insert(c.clientId,c))}}e.pr();const r=e.storage.getItem(e.gr);if(r){const i=e.Ir(r);i&&e.Tr(i)}for(const i of e.hr)e.cr(i);e.hr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.dr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Er(this.ar)}isActiveQueryTarget(e){let t=!1;return this.ar.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ar(e,"pending")}updateMutationState(e,t,r){this.Ar(e,t,r),this.Rr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(FR(this.persistenceKey,e));if(r){const i=Ww.er(e,r);i&&(t=i.state)}}return this.Pr.sr(e),this.pr(),t}removeLocalQueryTarget(e){this.Pr.ir(e),this.pr()}isLocalQueryTarget(e){return this.Pr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(FR(this.persistenceKey,e))}updateQueryState(e,t,r){this.vr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Rr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Vr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ur),this.removeItem(this.lr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return je("SharedClientState","READ",e,t),t}setItem(e,t){je("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){je("SharedClientState","REMOVE",e),this.storage.removeItem(e)}cr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(je("SharedClientState","EVENT",r.key,r.newValue),r.key===this.lr)return void Vr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ys.enqueueRetryable((0,me.Z)(function*(){if(t.started){if(null!==r.key)if(t._r.test(r.key)){if(null==r.newValue){const i=t.Sr(r.key);return t.Dr(i,null)}{const i=t.Cr(r.key,r.newValue);if(i)return t.Dr(i.clientId,i)}}else if(t.wr.test(r.key)){if(null!==r.newValue){const i=t.Nr(r.key,r.newValue);if(i)return t.kr(i)}}else if(t.mr.test(r.key)){if(null!==r.newValue){const i=t.$r(r.key,r.newValue);if(i)return t.Mr(i)}}else if(r.key===t.gr){if(null!==r.newValue){const i=t.Ir(r.newValue);if(i)return t.Tr(i)}}else if(r.key===t.dr){const i=function(a){let c=l.at;if(null!=a)try{const h=JSON.parse(a);St("number"==typeof h),c=h}catch(h){Vr("SharedClientState","Failed to read sequence number from WebStorage",h)}return c}(r.newValue);i!==l.at&&t.sequenceNumberHandler(i)}else if(r.key===t.yr){const i=t.Or(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Fr(a)))}}else t.hr.push(r)}))}}get Pr(){return this.ar.get(this.rr)}pr(){this.setItem(this.lr,this.Pr.nr())}Ar(e,t,r){const i=new Hb(this.currentUser,e,t,r),a=dO(this.persistenceKey,this.currentUser,e);this.setItem(a,i.nr())}Rr(e){const t=dO(this.persistenceKey,this.currentUser,e);this.removeItem(t)}br(e){this.storage.setItem(this.gr,JSON.stringify({clientId:this.rr,onlineState:e}))}vr(e,t,r){const i=FR(this.persistenceKey,e),a=new Ww(e,t,r);this.setItem(i,a.nr())}Vr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.yr,t)}Sr(e){const t=this._r.exec(e);return t?t[1]:null}Cr(e,t){const r=this.Sr(e);return Gb.er(r,t)}Nr(e,t){const r=this.wr.exec(e),i=Number(r[1]);return Hb.er(new fi(void 0!==r[2]?r[2]:null),i,t)}$r(e,t){const r=this.mr.exec(e),i=Number(r[1]);return Ww.er(i,t)}Ir(e){return UR.er(e)}Or(e){return JSON.parse(e)}kr(e){var t=this;return(0,me.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Br(e.batchId,e.state,e.error);je("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Mr(e){return this.syncEngine.Lr(e.targetId,e.state,e.error)}Dr(e,t){const r=t?this.ar.insert(e,t):this.ar.remove(e),i=this.Er(this.ar),a=this.Er(r),c=[],h=[];return a.forEach(m=>{i.has(m)||c.push(m)}),i.forEach(m=>{a.has(m)||h.push(m)}),this.syncEngine.qr(c,h).then(()=>{this.ar=r})}Tr(e){this.ar.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Er(e){let t=Rb();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class hO{constructor(){this.Ur=new VR,this.Kr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Ur.sr(e),this.Kr[e]||"not-current"}updateQueryState(e,t,r){this.Kr[e]=t}removeLocalQueryTarget(e){this.Ur.ir(e)}isLocalQueryTarget(e){return this.Ur.activeTargetIds.has(e)}clearQueryState(e){delete this.Kr[e]}getAllActiveQueryTargets(){return this.Ur.activeTargetIds}isActiveQueryTarget(e){return this.Ur.activeTargetIds.has(e)}start(){return this.Ur=new VR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class BV{Gr(e){}shutdown(){}}class fO{constructor(){this.Qr=()=>this.jr(),this.zr=()=>this.Wr(),this.Hr=[],this.Jr()}Gr(e){this.Hr.push(e)}shutdown(){window.removeEventListener("online",this.Qr),window.removeEventListener("offline",this.zr)}Jr(){window.addEventListener("online",this.Qr),window.addEventListener("offline",this.zr)}jr(){je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Hr)e(0)}Wr(){je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Hr)e(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let zb=null;function jR(){return null===zb?zb=268435456+Math.round(2147483648*Math.random()):zb++,"0x"+zb.toString(16)}const jV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $V{constructor(e){this.Yr=e.Yr,this.Zr=e.Zr}Xr(e){this.eo=e}no(e){this.so=e}onMessage(e){this.io=e}close(){this.Zr()}send(e){this.Yr(e)}ro(){this.eo()}oo(e){this.so(e)}uo(e){this.io(e)}}const as="WebChannelConnection";class HV extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.co=(e.ssl?"https":"http")+"://"+e.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get ho(){return!1}lo(e,t,r,i,a){const c=jR(),h=this.fo(e,t);je("RestConnection",`Sending RPC '${e}' ${c}:`,h,r);const m={};return this._o(m,i,a),this.wo(e,h,m,r).then(w=>(je("RestConnection",`Received RPC '${e}' ${c}: `,w),w),w=>{throw yd("RestConnection",`RPC '${e}' ${c} failed with error: `,w,"url: ",h,"request:",r),w})}mo(e,t,r,i,a,c){return this.lo(e,t,r,i,a)}_o(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Uf,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}fo(e,t){return`${this.co}/v1/${t}:${jV[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}wo(e,t,r,i){const a=jR();return new Promise((c,h)=>{const m=new KA;m.setWithCredentials(!0),m.listenOnce(ub.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case km.NO_ERROR:const T=m.getResponseJson();je(as,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(T)),c(T);break;case km.TIMEOUT:je(as,`RPC '${e}' ${a} timed out`),h(new Le(ce.DEADLINE_EXCEEDED,"Request time out"));break;case km.HTTP_ERROR:const D=m.getStatus();if(je(as,`RPC '${e}' ${a} failed with status:`,D,"response text:",m.getResponseText()),D>0){let x=m.getResponseJson();Array.isArray(x)&&(x=x[0]);const F=x?.error;if(F&&F.status&&F.message){const $=function(ee){const se=ee.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(se)>=0?se:ce.UNKNOWN}(F.status);h(new Le($,F.message))}else h(new Le(ce.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new Le(ce.UNAVAILABLE,"Connection failed."));break;default:ft()}}finally{je(as,`RPC '${e}' ${a} completed.`)}});const w=JSON.stringify(i);je(as,`RPC '${e}' ${a} sending request:`,i),m.send(t,"POST",w,r,15)})}yo(e,t,r){const i=jR(),a=[this.co,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=ob(),h=ab(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(m.xmlHttpFactory=new cb({})),this._o(m.initMessageHeaders,t,r),m.encodeInitMessageHeaders=!0;const w=a.join("");je(as,`Creating RPC '${e}' stream ${i}: ${w}`,m);const T=c.createWebChannel(w,m);let D=!1,x=!1;const F=new $V({Yr:ee=>{x?je(as,`Not sending because RPC '${e}' stream ${i} is closed:`,ee):(D||(je(as,`Opening RPC '${e}' stream ${i} transport.`),T.open(),D=!0),je(as,`RPC '${e}' stream ${i} sending:`,ee),T.send(ee))},Zr:()=>T.close()}),$=(ee,se,ht)=>{ee.listen(se,vt=>{try{ht(vt)}catch(dt){setTimeout(()=>{throw dt},0)}})};return $(T,Lm.EventType.OPEN,()=>{x||je(as,`RPC '${e}' stream ${i} transport opened.`)}),$(T,Lm.EventType.CLOSE,()=>{x||(x=!0,je(as,`RPC '${e}' stream ${i} transport closed`),F.oo())}),$(T,Lm.EventType.ERROR,ee=>{x||(x=!0,yd(as,`RPC '${e}' stream ${i} transport errored:`,ee),F.oo(new Le(ce.UNAVAILABLE,"The operation could not be completed")))}),$(T,Lm.EventType.MESSAGE,ee=>{var se;if(!x){const ht=ee.data[0];St(!!ht);const dt=ht.error||(null===(se=ht[0])||void 0===se?void 0:se.error);if(dt){je(as,`RPC '${e}' stream ${i} received error:`,dt);const It=dt.status;let Vt=function($r){const Gs=ri[$r];if(void 0!==Gs)return nk(Gs)}(It),Zt=dt.message;void 0===Vt&&(Vt=ce.INTERNAL,Zt="Unknown error status: "+It+" with message "+dt.message),x=!0,F.oo(new Le(Vt,Zt)),T.close()}else je(as,`RPC '${e}' stream ${i} received:`,ht),F.uo(ht)}}),$(h,Om.STAT_EVENT,ee=>{ee.stat===Ff.PROXY?je(as,`RPC '${e}' stream ${i} detected buffering proxy`):ee.stat===Ff.NOPROXY&&je(as,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{F.ro()},0),F}}function pO(){return typeof window<"u"?window:null}function Wb(){return typeof document<"u"?document:null}function qw(n){return new kU(n,!0)}class $R{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Ys=e,this.timerId=t,this.po=r,this.Io=i,this.To=a,this.Eo=0,this.Ao=null,this.Ro=Date.now(),this.reset()}reset(){this.Eo=0}Po(){this.Eo=this.To}vo(e){this.cancel();const t=Math.floor(this.Eo+this.bo()),r=Math.max(0,Date.now()-this.Ro),i=Math.max(0,t-r);i>0&&je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Eo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Ao=this.Ys.enqueueAfterDelay(this.timerId,i,()=>(this.Ro=Date.now(),e())),this.Eo*=this.Io,this.Eo<this.po&&(this.Eo=this.po),this.Eo>this.To&&(this.Eo=this.To)}Vo(){null!==this.Ao&&(this.Ao.skipDelay(),this.Ao=null)}cancel(){null!==this.Ao&&(this.Ao.cancel(),this.Ao=null)}bo(){return(Math.random()-.5)*this.Eo}}class gO{constructor(e,t,r,i,a,c,h,m){this.Ys=e,this.So=r,this.Do=i,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.Co=0,this.xo=null,this.No=null,this.stream=null,this.ko=new $R(e,t)}$o(){return 1===this.state||5===this.state||this.Mo()}Mo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var e=this;return(0,me.Z)(function*(){e.$o()&&(yield e.close(0))})()}Fo(){this.state=0,this.ko.reset()}Bo(){this.Mo()&&null===this.xo&&(this.xo=this.Ys.enqueueAfterDelay(this.So,6e4,()=>this.Lo()))}qo(e){this.Uo(),this.stream.send(e)}Lo(){var e=this;return(0,me.Z)(function*(){if(e.Mo())return e.close(0)})()}Uo(){this.xo&&(this.xo.cancel(),this.xo=null)}Ko(){this.No&&(this.No.cancel(),this.No=null)}close(e,t){var r=this;return(0,me.Z)(function*(){r.Uo(),r.Ko(),r.ko.cancel(),r.Co++,4!==e?r.ko.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(Vr(t.toString()),Vr("Using maximum backoff delay to prevent overloading the backend."),r.ko.Po()):t&&t.code===ce.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Go(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.no(t)})()}Go(){}auth(){this.state=1;const e=this.Qo(this.Co),t=this.Co;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Co===t&&this.jo(r,i)},r=>{e(()=>{const i=new Le(ce.UNKNOWN,"Fetching auth token failed: "+r.message);return this.zo(i)})})}jo(e,t){const r=this.Qo(this.Co);this.stream=this.Wo(e,t),this.stream.Xr(()=>{r(()=>(this.state=2,this.No=this.Ys.enqueueAfterDelay(this.Do,1e4,()=>(this.Mo()&&(this.state=3),Promise.resolve())),this.listener.Xr()))}),this.stream.no(i=>{r(()=>this.zo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Oo(){var e=this;this.state=5,this.ko.vo((0,me.Z)(function*(){e.state=0,e.start()}))}zo(e){return je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Qo(e){return t=>{this.Ys.enqueueAndForget(()=>this.Co===e?t():(je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class GV extends gO{constructor(e,t,r,i,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,c),this.Tt=a}Wo(e,t){return this.connection.yo("Listen",e,t)}onMessage(e){this.ko.reset();const t=function FU(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(m=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===m?1:"REMOVE"===m?2:"CURRENT"===m?3:"RESET"===m?4:ft(),i=e.targetChange.targetIds||[],a=function(m,w){return m.yt?(St(void 0===w||"string"==typeof w),Xe.fromBase64String(w||"")):(St(void 0===w||w instanceof Uint8Array),Xe.fromUint8Array(w||new Uint8Array))}(n,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&function(m){const w=void 0===m.code?ce.UNKNOWN:nk(m.code);return new Le(w,m.message||"")}(c);t=new ak(r,i,a,h||null)}else if("documentChange"in e){const r=e.documentChange,i=Ru(n,r.document.name),a=Kr(r.document.updateTime),c=r.document.createTime?Kr(r.document.createTime):Mt.min(),h=new Si({mapValue:{fields:r.document.fields}}),m=gr.newFoundDocument(i,a,c,h);t=new xb(r.targetIds||[],r.removedTargetIds||[],m.key,m)}else if("documentDelete"in e){const r=e.documentDelete,i=Ru(n,r.document),a=r.readTime?Kr(r.readTime):Mt.min(),c=gr.newNoDocument(i,a);t=new xb([],r.removedTargetIds||[],c.key,c)}else if("documentRemove"in e){const r=e.documentRemove,i=Ru(n,r.document);t=new xb([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return ft();{const r=e.filter,a=new CU(r.count||0);t=new ok(r.targetId,a)}}var m;return t}(this.Tt,e),r=function(i){if(!("targetChange"in i))return Mt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Mt.min():a.readTime?Kr(a.readTime):Mt.min()}(e);return this.listener.Ho(t,r)}Jo(e){const t={};t.database=Fw(this.Tt),t.addTarget=function(i,a){let c;const h=a.target;return c=Ib(h)?{documents:_k(i,h)}:{query:mR(i,h)},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?c.resumeToken=dk(i,a.resumeToken):a.snapshotVersion.compareTo(Mt.min())>0&&(c.readTime=Qm(i,a.snapshotVersion.toTimestamp())),c}(this.Tt,e);const r=function VU(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ft()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.qo(t)}Yo(e){const t={};t.database=Fw(this.Tt),t.removeTarget=e,this.qo(t)}}class zV extends gO{constructor(e,t,r,i,a,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,c),this.Tt=a,this.Zo=!1}get Xo(){return this.Zo}start(){this.Zo=!1,this.lastStreamToken=void 0,super.start()}Go(){this.Zo&&this.tu([])}Wo(e,t){return this.connection.yo("Write",e,t)}onMessage(e){if(St(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Zo){this.ko.reset();const t=function UU(n,e){return n&&n.length>0?(St(void 0!==e),n.map(t=>function(r,i){let a=Kr(r.updateTime?r.updateTime:i);return a.isEqual(Mt.min())&&(a=Kr(i)),new IU(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Kr(e.commitTime);return this.listener.eu(r,t)}return St(!e.writeResults||0===e.writeResults.length),this.Zo=!0,this.listener.nu()}su(){const e={};e.database=Fw(this.Tt),this.qo(e)}tu(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Uw(this.Tt,r))};this.qo(t)}}class WV extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.Tt=i,this.iu=!1}ru(){if(this.iu)throw new Le(ce.FAILED_PRECONDITION,"The client has already been terminated.")}lo(e,t,r){return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.lo(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Le(ce.UNKNOWN,i.toString())})}mo(e,t,r,i){return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.mo(e,t,r,a,c,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Le(ce.UNKNOWN,a.toString())})}terminate(){this.iu=!0}}class KV{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ou=0,this.uu=null,this.cu=!0}au(){0===this.ou&&(this.hu("Unknown"),this.uu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.uu=null,this.lu("Backend didn't respond within 10 seconds."),this.hu("Offline"),Promise.resolve())))}fu(e){"Online"===this.state?this.hu("Unknown"):(this.ou++,this.ou>=1&&(this.du(),this.lu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.hu("Offline")))}set(e){this.du(),this.ou=0,"Online"===e&&(this.cu=!1),this.hu(e)}hu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}lu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.cu?(Vr(t),this.cu=!1):je("OnlineStateTracker",t)}du(){null!==this.uu&&(this.uu.cancel(),this.uu=null)}}class ZV{constructor(e,t,r,i,a){var c=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this._u=[],this.wu=new Map,this.mu=new Set,this.gu=[],this.yu=a,this.yu.Gr(h=>{r.enqueueAndForget((0,me.Z)(function*(){var m;$c(c)&&(je("RemoteStore","Restarting streams for network reachability change."),yield(m=(0,me.Z)(function*(w){const T=tt(w);T.mu.add(4),yield r_(T),T.pu.set("Unknown"),T.mu.delete(4),yield Kw(T)}),function(w){return m.apply(this,arguments)})(c))}))}),this.pu=new KV(r,i)}}function Kw(n){return GR.apply(this,arguments)}function GR(){return GR=(0,me.Z)(function*(n){if($c(n))for(const e of n.gu)yield e(!0)}),GR.apply(this,arguments)}function r_(n){return zR.apply(this,arguments)}function zR(){return zR=(0,me.Z)(function*(n){for(const e of n.gu)yield e(!1)}),zR.apply(this,arguments)}function qb(n,e){const t=tt(n);t.wu.has(e.targetId)||(t.wu.set(e.targetId,e),KR(t)?qR(t):s_(t).Mo()&&WR(t,e))}function Zw(n,e){const t=tt(n),r=s_(t);t.wu.delete(e),r.Mo()&&mO(t,e),0===t.wu.size&&(r.Mo()?r.Bo():$c(t)&&t.pu.set("Unknown"))}function WR(n,e){n.Iu.Ot(e.targetId),s_(n).Jo(e)}function mO(n,e){n.Iu.Ot(e),s_(n).Yo(e)}function qR(n){n.Iu=new xU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ie:e=>n.wu.get(e)||null}),s_(n).start(),n.pu.au()}function KR(n){return $c(n)&&!s_(n).$o()&&n.wu.size>0}function $c(n){return 0===tt(n).mu.size}function _O(n){n.Iu=void 0}function YV(n){return ZR.apply(this,arguments)}function ZR(){return ZR=(0,me.Z)(function*(n){n.wu.forEach((e,t)=>{WR(n,e)})}),ZR.apply(this,arguments)}function QV(n,e){return YR.apply(this,arguments)}function YR(){return YR=(0,me.Z)(function*(n,e){_O(n),KR(n)?(n.pu.fu(e),qR(n)):n.pu.set("Unknown")}),YR.apply(this,arguments)}function XV(n,e,t){return QR.apply(this,arguments)}function QR(){return QR=(0,me.Z)(function*(n,e,t){if(n.pu.set("Online"),e instanceof ak&&2===e.state&&e.cause)try{yield(r=(0,me.Z)(function*(i,a){const c=a.cause;for(const h of a.targetIds)i.wu.has(h)&&(yield i.remoteSyncer.rejectListen(h,c),i.wu.delete(h),i.Iu.removeTarget(h))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Kb(n,r)}else if(e instanceof xb?n.Iu.Qt(e):e instanceof ok?n.Iu.Zt(e):n.Iu.Wt(e),!t.isEqual(Mt.min()))try{const r=yield sO(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const c=i.Iu.ee(a);return c.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const w=i.wu.get(m);w&&i.wu.set(m,w.withResumeToken(h.resumeToken,a))}}),c.targetMismatches.forEach(h=>{const m=i.wu.get(h);if(!m)return;i.wu.set(h,m.withResumeToken(Xe.EMPTY_BYTE_STRING,m.snapshotVersion)),mO(i,h);const w=new Cd(m.target,h,1,m.sequenceNumber);WR(i,w)}),i.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){je("RemoteStore","Failed to raise snapshot:",r),yield Kb(n,r)}var r}),QR.apply(this,arguments)}function Kb(n,e,t){return XR.apply(this,arguments)}function XR(){return XR=(0,me.Z)(function*(n,e,t){if(!Vc(e))throw e;n.mu.add(1),yield r_(n),n.pu.set("Offline"),t||(t=()=>sO(n.localStore)),n.asyncQueue.enqueueRetryable((0,me.Z)(function*(){je("RemoteStore","Retrying IndexedDB access"),yield t(),n.mu.delete(1),yield Kw(n)}))}),XR.apply(this,arguments)}function yO(n,e){return e().catch(t=>Kb(n,t,e))}function i_(n){return JR.apply(this,arguments)}function JR(){return JR=(0,me.Z)(function*(n){const e=tt(n),t=Rd(e);let r=e._u.length>0?e._u[e._u.length-1].batchId:-1;for(;JV(e);)try{const i=yield FV(e.localStore,r);if(null===i){0===e._u.length&&t.Bo();break}r=i.batchId,eB(e,i)}catch(i){yield Kb(e,i)}vO(e)&&wO(e)}),JR.apply(this,arguments)}function JV(n){return $c(n)&&n._u.length<10}function eB(n,e){n._u.push(e);const t=Rd(n);t.Mo()&&t.Xo&&t.tu(e.mutations)}function vO(n){return $c(n)&&!Rd(n).$o()&&n._u.length>0}function wO(n){Rd(n).start()}function tB(n){return ex.apply(this,arguments)}function ex(){return ex=(0,me.Z)(function*(n){Rd(n).su()}),ex.apply(this,arguments)}function nB(n){return tx.apply(this,arguments)}function tx(){return tx=(0,me.Z)(function*(n){const e=Rd(n);for(const t of n._u)e.tu(t.mutations)}),tx.apply(this,arguments)}function rB(n,e,t){return nx.apply(this,arguments)}function nx(){return nx=(0,me.Z)(function*(n,e,t){const r=n._u.shift(),i=vR.from(r,e,t);yield yO(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield i_(n)}),nx.apply(this,arguments)}function iB(n,e){return rx.apply(this,arguments)}function rx(){return rx=(0,me.Z)(function*(n,e){var t;e&&Rd(n).Xo&&(yield(t=(0,me.Z)(function*(r,i){if(tk(a=i.code)&&a!==ce.ABORTED){const c=r._u.shift();Rd(r).Fo(),yield yO(r,()=>r.remoteSyncer.rejectFailedWrite(c.batchId,i)),yield i_(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),vO(n)&&wO(n)}),rx.apply(this,arguments)}function EO(n,e){return ix.apply(this,arguments)}function ix(){return ix=(0,me.Z)(function*(n,e){const t=tt(n);t.asyncQueue.verifyOperationInProgress(),je("RemoteStore","RemoteStore received new credentials");const r=$c(t);t.mu.add(3),yield r_(t),r&&t.pu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.mu.delete(3),yield Kw(t)}),ix.apply(this,arguments)}function sx(n,e){return ox.apply(this,arguments)}function ox(){return ox=(0,me.Z)(function*(n,e){const t=tt(n);e?(t.mu.delete(2),yield Kw(t)):e||(t.mu.add(2),yield r_(t),t.pu.set("Unknown"))}),ox.apply(this,arguments)}function s_(n){return n.Tu||(n.Tu=function(e,t,r){const i=tt(e);return i.ru(),new GV(t,i.connection,i.authCredentials,i.appCheckCredentials,i.Tt,r)}(n.datastore,n.asyncQueue,{Xr:YV.bind(null,n),no:QV.bind(null,n),Ho:XV.bind(null,n)}),n.gu.push(function(){var e=(0,me.Z)(function*(t){t?(n.Tu.Fo(),KR(n)?qR(n):n.pu.set("Unknown")):(yield n.Tu.stop(),_O(n))});return function(t){return e.apply(this,arguments)}}())),n.Tu}function Rd(n){return n.Eu||(n.Eu=function(e,t,r){const i=tt(e);return i.ru(),new zV(t,i.connection,i.authCredentials,i.appCheckCredentials,i.Tt,r)}(n.datastore,n.asyncQueue,{Xr:tB.bind(null,n),no:iB.bind(null,n),nu:nB.bind(null,n),eu:rB.bind(null,n)}),n.gu.push(function(){var e=(0,me.Z)(function*(t){t?(n.Eu.Fo(),yield i_(n)):(yield n.Eu.stop(),n._u.length>0&&(je("RemoteStore",`Stopping write stream with ${n._u.length} pending writes`),n._u=[]))});return function(t){return e.apply(this,arguments)}}())),n.Eu}class ax{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Br,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}static createAndSchedule(e,t,r,i,a){const c=Date.now()+r,h=new ax(e,t,c,i,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Le(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function o_(n,e){if(Vr("AsyncQueue",`${e}: ${n}`),Vc(n))return new Le(ce.UNAVAILABLE,`${e}: ${n}`);throw n}class a_{constructor(e){this.comparator=e?(t,r)=>e(t,r)||nt.comparator(t.key,r.key):(t,r)=>nt.comparator(t.key,r.key),this.keyedMap=Nw(),this.sortedSet=new jr(this.comparator)}static emptySet(e){return new a_(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof a_)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new a_;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class IO{constructor(){this.Au=new jr(nt.comparator)}track(e){const t=e.doc.key,r=this.Au.get(t);r?0!==e.type&&3===r.type?this.Au=this.Au.insert(t,e):3===e.type&&1!==r.type?this.Au=this.Au.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Au=this.Au.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Au=this.Au.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Au=this.Au.remove(t):1===e.type&&2===r.type?this.Au=this.Au.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Au=this.Au.insert(t,{type:2,doc:e.doc}):ft():this.Au=this.Au.insert(t,e)}Ru(){const e=[];return this.Au.inorderTraversal((t,r)=>{e.push(r)}),e}}class u_{constructor(e,t,r,i,a,c,h,m,w){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=m,this.hasCachedResults=w}static fromInitialDocuments(e,t,r,i,a){const c=[];return t.forEach(h=>{c.push({type:0,doc:h})}),new u_(e,t,a_.emptySet(t),c,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Aw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class sB{constructor(){this.Pu=void 0,this.listeners=[]}}class oB{constructor(){this.queries=new Td(e=>VP(e),Aw),this.onlineState="Unknown",this.vu=new Set}}function ux(n,e){return cx.apply(this,arguments)}function cx(){return cx=(0,me.Z)(function*(n,e){const t=tt(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new sB),i)try{a.Pu=yield t.onListen(r)}catch(c){const h=o_(c,`Initialization of query '${dR(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,a),a.listeners.push(e),e.bu(t.onlineState),a.Pu&&e.Vu(a.Pu)&&hx(t)}),cx.apply(this,arguments)}function lx(n,e){return dx.apply(this,arguments)}function dx(){return dx=(0,me.Z)(function*(n,e){const t=tt(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const c=a.listeners.indexOf(e);c>=0&&(a.listeners.splice(c,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),dx.apply(this,arguments)}function aB(n,e){const t=tt(n);let r=!1;for(const i of e){const c=t.queries.get(i.query);if(c){for(const h of c.listeners)h.Vu(i)&&(r=!0);c.Pu=i}}r&&hx(t)}function uB(n,e,t){const r=tt(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function hx(n){n.vu.forEach(e=>{e.next()})}class fx{constructor(e,t,r){this.query=e,this.Su=t,this.Du=!1,this.Cu=null,this.onlineState="Unknown",this.options=r||{}}Vu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new u_(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Du?this.xu(e)&&(this.Su.next(e),t=!0):this.Nu(e,this.onlineState)&&(this.ku(e),t=!0),this.Cu=e,t}onError(e){this.Su.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Cu&&!this.Du&&this.Nu(this.Cu,e)&&(this.ku(this.Cu),t=!0),t}Nu(e,t){return!e.fromCache||(!this.options.$u||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}xu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Cu&&this.Cu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}ku(e){e=u_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Du=!0,this.Su.next(e)}}class cB{constructor(e,t){this.Mu=e,this.byteLength=t}Ou(){return"metadata"in this.Mu}}class TO{constructor(e){this.Tt=e}Zi(e){return Ru(this.Tt,e)}Xi(e){return e.metadata.exists?mk(this.Tt,e.document,!1):gr.newNoDocument(this.Zi(e.metadata.name),this.tr(e.metadata.readTime))}tr(e){return Kr(e)}}class lB{constructor(e,t,r){this.Fu=e,this.localStore=t,this.Tt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=bO(e)}Bu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Mu.namedQuery)this.queries.push(e.Mu.namedQuery);else if(e.Mu.documentMetadata){this.documents.push({metadata:e.Mu.documentMetadata}),e.Mu.documentMetadata.exists||++t;const r=wn.fromString(e.Mu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Mu.document&&(this.documents[this.documents.length-1].document=e.Mu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Lu(e){const t=new Map,r=new TO(this.Tt);for(const i of e)if(i.metadata.queries){const a=r.Zi(i.metadata.name);for(const c of i.metadata.queries){const h=(t.get(c)||cn()).add(a);t.set(c,h)}}return t}complete(){var e=this;return(0,me.Z)(function*(){const t=yield function UV(n,e,t,r){return OR.apply(this,arguments)}(e.localStore,new TO(e.Tt),e.documents,e.Fu.id),r=e.Lu(e.documents);for(const i of e.queries)yield VV(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,qu:e.collectionGroups,Uu:t}})()}}function bO(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class CO{constructor(e){this.key=e}}class DO{constructor(e){this.key=e}}class SO{constructor(e,t){this.query=e,this.Ku=t,this.Gu=null,this.hasCachedResults=!1,this.current=!1,this.Qu=cn(),this.mutatedKeys=cn(),this.ju=jP(e),this.zu=new a_(this.ju)}get Wu(){return this.Ku}Hu(e,t){const r=t?t.Ju:new IO,i=t?t.zu:this.zu;let a=t?t.mutatedKeys:this.mutatedKeys,c=i,h=!1;const m="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,w="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((T,D)=>{const x=i.get(T),F=Rw(this.query,D)?D:null,$=!!x&&this.mutatedKeys.has(x.key),ee=!!F&&(F.hasLocalMutations||this.mutatedKeys.has(F.key)&&F.hasCommittedMutations);let se=!1;x&&F?x.data.isEqual(F.data)?$!==ee&&(r.track({type:3,doc:F}),se=!0):this.Yu(x,F)||(r.track({type:2,doc:F}),se=!0,(m&&this.ju(F,m)>0||w&&this.ju(F,w)<0)&&(h=!0)):!x&&F?(r.track({type:0,doc:F}),se=!0):x&&!F&&(r.track({type:1,doc:x}),se=!0,(m||w)&&(h=!0)),se&&(F?(c=c.add(F),a=ee?a.add(T):a.delete(T)):(c=c.delete(T),a=a.delete(T)))}),null!==this.query.limit)for(;c.size>this.query.limit;){const T="F"===this.query.limitType?c.last():c.first();c=c.delete(T.key),a=a.delete(T.key),r.track({type:1,doc:T})}return{zu:c,Ju:r,Li:h,mutatedKeys:a}}Yu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.zu;this.zu=e.zu,this.mutatedKeys=e.mutatedKeys;const a=e.Ju.Ru();a.sort((w,T)=>function(D,x){const F=$=>{switch($){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ft()}};return F(D)-F(x)}(w.type,T.type)||this.ju(w.doc,T.doc)),this.Zu(r);const c=t?this.Xu():[],h=0===this.Qu.size&&this.current?1:0,m=h!==this.Gu;return this.Gu=h,0!==a.length||m?{snapshot:new u_(this.query,e.zu,i,a,e.mutatedKeys,0===h,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),tc:c}:{tc:c}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({zu:this.zu,Ju:new IO,mutatedKeys:this.mutatedKeys,Li:!1},!1)):{tc:[]}}ec(e){return!this.Ku.has(e)&&!!this.zu.has(e)&&!this.zu.get(e).hasLocalMutations}Zu(e){e&&(e.addedDocuments.forEach(t=>this.Ku=this.Ku.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ku=this.Ku.delete(t)),this.current=e.current)}Xu(){if(!this.current)return[];const e=this.Qu;this.Qu=cn(),this.zu.forEach(r=>{this.ec(r.key)&&(this.Qu=this.Qu.add(r.key))});const t=[];return e.forEach(r=>{this.Qu.has(r)||t.push(new DO(r))}),this.Qu.forEach(r=>{e.has(r)||t.push(new CO(r))}),t}nc(e){this.Ku=e.Yi,this.Qu=cn();const t=this.Hu(e.documents);return this.applyChanges(t,!0)}sc(){return u_.fromInitialDocuments(this.query,this.zu,this.mutatedKeys,0===this.Gu,this.hasCachedResults)}}class dB{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class hB{constructor(e){this.key=e,this.ic=!1}}class fB{constructor(e,t,r,i,a,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.rc={},this.oc=new Td(h=>VP(h),Aw),this.uc=new Map,this.cc=new Set,this.ac=new jr(nt.comparator),this.hc=new Map,this.lc=new AR,this.fc={},this.dc=new Map,this._c=Jf.Sn(),this.onlineState="Unknown",this.wc=void 0}get isPrimaryClient(){return!0===this.wc}}function pB(n,e){return px.apply(this,arguments)}function px(){return px=(0,me.Z)(function*(n,e){const t=Fx(n);let r,i;const a=t.oc.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.sc();else{const c=yield t_(t.localStore,Is(e));t.isPrimaryClient&&qb(t.remoteStore,c);const h=t.sharedClientState.addLocalQueryTarget(c.targetId);r=c.targetId,i=yield gx(t,e,r,"current"===h,c.resumeToken)}return i}),px.apply(this,arguments)}function gx(n,e,t,r,i){return mx.apply(this,arguments)}function mx(){return mx=(0,me.Z)(function*(n,e,t,r,i){n.mc=(D,x,F)=>{return($=(0,me.Z)(function*(ee,se,ht,vt){let dt=se.view.Hu(ht);dt.Li&&(dt=yield $b(ee.localStore,se.query,!1).then(({documents:Zt})=>se.view.Hu(Zt,dt)));const It=vt&&vt.targetChanges.get(se.targetId),Vt=se.view.applyChanges(dt,ee.isPrimaryClient,It);return Dx(ee,se.targetId,Vt.tc),Vt.snapshot}),function(ee,se,ht,vt){return $.apply(this,arguments)})(n,D,x,F);var $};const a=yield $b(n.localStore,e,!0),c=new SO(e,a.Yi),h=c.Hu(a.documents),m=Ow.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),w=c.applyChanges(h,n.isPrimaryClient,m);Dx(n,t,w.tc);const T=new dB(e,t,c);return n.oc.set(e,T),n.uc.has(t)?n.uc.get(t).push(e):n.uc.set(t,[e]),w.snapshot}),mx.apply(this,arguments)}function gB(n,e){return _x.apply(this,arguments)}function _x(){return _x=(0,me.Z)(function*(n,e){const t=tt(n),r=t.oc.get(e),i=t.uc.get(r.targetId);if(i.length>1)return t.uc.set(r.targetId,i.filter(a=>!Aw(a,e))),void t.oc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield n_(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Zw(t.remoteStore,r.targetId),c_(t,r.targetId)}).catch(Uc))):(c_(t,r.targetId),yield n_(t.localStore,r.targetId,!0))}),_x.apply(this,arguments)}function yx(){return yx=(0,me.Z)(function*(n,e,t){const r=Ux(n);try{const i=yield function(a,c){const h=tt(a),m=nr.now(),w=c.reduce((x,F)=>x.add(F.key),cn());let T,D;return h.persistence.runTransaction("Locally write mutations","readwrite",x=>{let F=Bs(),$=cn();return h.ji.getEntries(x,w).next(ee=>{F=ee,F.forEach((se,ht)=>{ht.isValidDocument()||($=$.add(se))})}).next(()=>h.localDocuments.getOverlayedDocuments(x,F)).next(ee=>{T=ee;const se=[];for(const ht of c){const vt=bU(ht,T.get(ht.key).overlayedDocument);null!=vt&&se.push(new jc(ht.key,vt,kP(vt.value.mapValue),Er.exists(!0)))}return h.mutationQueue.addMutationBatch(x,m,se,c)}).next(ee=>{D=ee;const se=ee.applyToLocalDocumentSet(T,$);return h.documentOverlayCache.saveOverlays(x,ee.batchId,se)})}).then(()=>({batchId:D.batchId,changes:ik(T)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,h){let m=a.fc[a.currentUser.toKey()];m||(m=new jr(en)),m=m.insert(c,h),a.fc[a.currentUser.toKey()]=m}(r,i.batchId,t),yield Hc(r,i.changes),yield i_(r.remoteStore)}catch(i){const a=o_(i,"Failed to persist write");t.reject(a)}}),yx.apply(this,arguments)}function AO(n,e){return vx.apply(this,arguments)}function vx(){return vx=(0,me.Z)(function*(n,e){const t=tt(n);try{const r=yield function LV(n,e){const t=tt(n),r=e.snapshotVersion;let i=t.Ki;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const c=t.ji.newChangeBuffer({trackRemovals:!0});i=t.Ki;const h=[];e.targetChanges.forEach((T,D)=>{const x=i.get(D);if(!x)return;h.push(t.Ns.removeMatchingKeys(a,T.removedDocuments,D).next(()=>t.Ns.addMatchingKeys(a,T.addedDocuments,D)));let F=x.withSequenceNumber(a.currentSequenceNumber);var $,ee,se;e.targetMismatches.has(D)?F=F.withResumeToken(Xe.EMPTY_BYTE_STRING,Mt.min()).withLastLimboFreeSnapshotVersion(Mt.min()):T.resumeToken.approximateByteSize()>0&&(F=F.withResumeToken(T.resumeToken,r)),i=i.insert(D,F),ee=F,se=T,(0===($=x).resumeToken.approximateByteSize()||ee.snapshotVersion.toMicroseconds()-$.snapshotVersion.toMicroseconds()>=3e8||se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0)&&h.push(t.Ns.updateTargetData(a,F))});let m=Bs(),w=cn();if(e.documentUpdates.forEach(T=>{e.resolvedLimboDocuments.has(T)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,T))}),h.push(oO(a,c,e.documentUpdates).next(T=>{m=T.Hi,w=T.Ji})),!r.isEqual(Mt.min())){const T=t.Ns.getLastRemoteSnapshotVersion(a).next(D=>t.Ns.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(T)}return ie.waitFor(h).next(()=>c.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,m,w)).next(()=>m)}).then(a=>(t.Ki=i,a))}(t.localStore,e);e.targetChanges.forEach((i,a)=>{const c=t.hc.get(a);c&&(St(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?c.ic=!0:i.modifiedDocuments.size>0?St(c.ic):i.removedDocuments.size>0&&(St(c.ic),c.ic=!1))}),yield Hc(t,r,e)}catch(r){yield Uc(r)}}),vx.apply(this,arguments)}function RO(n,e,t){const r=tt(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.oc.forEach((a,c)=>{const h=c.view.bu(e);h.snapshot&&i.push(h.snapshot)}),function(a,c){const h=tt(a);h.onlineState=c;let m=!1;h.queries.forEach((w,T)=>{for(const D of T.listeners)D.bu(c)&&(m=!0)}),m&&hx(h)}(r.eventManager,e),i.length&&r.rc.Ho(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function _B(n,e,t){return wx.apply(this,arguments)}function wx(){return wx=(0,me.Z)(function*(n,e,t){const r=tt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.hc.get(e),a=i&&i.key;if(a){let c=new jr(nt.comparator);c=c.insert(a,gr.newNoDocument(a,Mt.min()));const h=cn().add(a),m=new kw(Mt.min(),new Map,new qn(en),c,h);yield AO(r,m),r.ac=r.ac.remove(a),r.hc.delete(e),Sx(r)}else yield n_(r.localStore,e,!1).then(()=>c_(r,e,t)).catch(Uc)}),wx.apply(this,arguments)}function yB(n,e){return Ex.apply(this,arguments)}function Ex(){return Ex=(0,me.Z)(function*(n,e){const t=tt(n),r=e.batch.batchId;try{const i=yield function OV(n,e){const t=tt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.ji.newChangeBuffer({trackRemovals:!0});return function(c,h,m,w){const T=m.batch,D=T.keys();let x=ie.resolve();return D.forEach(F=>{x=x.next(()=>w.getEntry(h,F)).next($=>{const ee=m.docVersions.get(F);St(null!==ee),$.version.compareTo(ee)<0&&(T.applyToRemoteDocument($,m),$.isValidDocument()&&($.setReadTime(m.commitVersion),w.addEntry($)))})}),x.next(()=>c.mutationQueue.removeMutationBatch(h,T))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let h=cn();for(let m=0;m<c.mutationResults.length;++m)c.mutationResults[m].transformResults.length>0&&(h=h.add(c.batch.mutations[m].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);Cx(t,r,null),bx(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Hc(t,i)}catch(i){yield Uc(i)}}),Ex.apply(this,arguments)}function vB(n,e,t){return Ix.apply(this,arguments)}function Ix(){return Ix=(0,me.Z)(function*(n,e,t){const r=tt(n);try{const i=yield function(a,c){const h=tt(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let w;return h.mutationQueue.lookupMutationBatch(m,c).next(T=>(St(null!==T),w=T.keys(),h.mutationQueue.removeMutationBatch(m,T))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,w,c)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,w)).next(()=>h.localDocuments.getDocuments(m,w))})}(r.localStore,e);Cx(r,e,t),bx(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Hc(r,i)}catch(i){yield Uc(i)}}),Ix.apply(this,arguments)}function Tx(){return Tx=(0,me.Z)(function*(n,e){const t=tt(n);$c(t.remoteStore)||je("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const c=tt(a);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>c.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.dc.get(r)||[];i.push(e),t.dc.set(r,i)}catch(r){const i=o_(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),Tx.apply(this,arguments)}function bx(n,e){(n.dc.get(e)||[]).forEach(t=>{t.resolve()}),n.dc.delete(e)}function Cx(n,e,t){const r=tt(n);let i=r.fc[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.fc[r.currentUser.toKey()]=i}}function c_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.uc.get(e))n.oc.delete(r),t&&n.rc.gc(r,t);n.uc.delete(e),n.isPrimaryClient&&n.lc.ds(e).forEach(r=>{n.lc.containsKey(r)||xO(n,r)})}function xO(n,e){n.cc.delete(e.path.canonicalString());const t=n.ac.get(e);null!==t&&(Zw(n.remoteStore,t),n.ac=n.ac.remove(e),n.hc.delete(t),Sx(n))}function Dx(n,e,t){for(const r of t)r instanceof CO?(n.lc.addReference(r.key,e),EB(n,r)):r instanceof DO?(je("SyncEngine","Document no longer in limbo: "+r.key),n.lc.removeReference(r.key,e),n.lc.containsKey(r.key)||xO(n,r.key)):ft()}function EB(n,e){const t=e.key,r=t.path.canonicalString();n.ac.get(t)||n.cc.has(r)||(je("SyncEngine","New document in limbo: "+t),n.cc.add(r),Sx(n))}function Sx(n){for(;n.cc.size>0&&n.ac.size<n.maxConcurrentLimboResolutions;){const e=n.cc.values().next().value;n.cc.delete(e);const t=new nt(wn.fromString(e)),r=n._c.next();n.hc.set(r,new hB(t)),n.ac=n.ac.insert(t,r),qb(n.remoteStore,new Cd(Is(Wm(t.path)),r,2,l.at))}}function Hc(n,e,t){return Ax.apply(this,arguments)}function Ax(){return Ax=(0,me.Z)(function*(n,e,t){const r=tt(n),i=[],a=[],c=[];var h;r.oc.isEmpty()||(r.oc.forEach((h,m)=>{c.push(r.mc(m,e,t).then(w=>{if((w||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(m.targetId,w?.fromCache?"not-current":"current"),w){i.push(w);const T=NR.Ni(m.targetId,w);a.push(T)}}))}),yield Promise.all(c),r.rc.Ho(i),yield(h=(0,me.Z)(function*(m,w){const T=tt(m);try{yield T.persistence.runTransaction("notifyLocalViewChanges","readwrite",D=>ie.forEach(w,x=>ie.forEach(x.Ci,F=>T.persistence.referenceDelegate.addReference(D,x.targetId,F)).next(()=>ie.forEach(x.xi,F=>T.persistence.referenceDelegate.removeReference(D,x.targetId,F)))))}catch(D){if(!Vc(D))throw D;je("LocalStore","Failed to update sequence numbers: "+D)}for(const D of w){const x=D.targetId;if(!D.fromCache){const F=T.Ki.get(x),ee=F.withLastLimboFreeSnapshotVersion(F.snapshotVersion);T.Ki=T.Ki.insert(x,ee)}}}),function(m,w){return h.apply(this,arguments)})(r.localStore,a))}),Ax.apply(this,arguments)}function IB(n,e){return Rx.apply(this,arguments)}function Rx(){return Rx=(0,me.Z)(function*(n,e){const t=tt(n);if(!t.currentUser.isEqual(e)){je("SyncEngine","User change. New user:",e.toKey());const r=yield iO(t.localStore,e);t.currentUser=e,(i=t).dc.forEach(c=>{c.forEach(h=>{h.reject(new Le(ce.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.dc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Hc(t,r.Wi)}var i}),Rx.apply(this,arguments)}function TB(n,e){const t=tt(n),r=t.hc.get(e);if(r&&r.ic)return cn().add(r.key);{let i=cn();const a=t.uc.get(e);if(!a)return i;for(const c of a){const h=t.oc.get(c);i=i.unionWith(h.view.Wu)}return i}}function bB(n,e){return xx.apply(this,arguments)}function xx(){return xx=(0,me.Z)(function*(n,e){const t=tt(n),r=yield $b(t.localStore,e.query,!0),i=e.view.nc(r);return t.isPrimaryClient&&Dx(t,e.targetId,i.tc),i}),xx.apply(this,arguments)}function CB(n,e){return Mx.apply(this,arguments)}function Mx(){return Mx=(0,me.Z)(function*(n,e){const t=tt(n);return uO(t.localStore,e).then(r=>Hc(t,r))}),Mx.apply(this,arguments)}function DB(n,e,t,r){return Nx.apply(this,arguments)}function Nx(){return Nx=(0,me.Z)(function*(n,e,t,r){const i=tt(n),a=yield function(c,h){const m=tt(c),w=tt(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",T=>w.An(T,h).next(D=>D?m.localDocuments.getDocuments(T,D):ie.resolve(null)))}(i.localStore,e);var h;null!==a?("pending"===t?yield i_(i.remoteStore):"acknowledged"===t||"rejected"===t?(Cx(i,e,r||null),bx(i,e),h=e,tt(tt(i.localStore).mutationQueue).Pn(h)):ft(),yield Hc(i,a)):je("SyncEngine","Cannot apply mutation batch with id: "+e)}),Nx.apply(this,arguments)}function Px(){return Px=(0,me.Z)(function*(n,e){const t=tt(n);if(Fx(t),Ux(t),!0===e&&!0!==t.wc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield MO(t,r.toArray());t.wc=!0,yield sx(t.remoteStore,!0);for(const a of i)qb(t.remoteStore,a)}else if(!1===e&&!1!==t.wc){const r=[];let i=Promise.resolve();t.uc.forEach((a,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):i=i.then(()=>(c_(t,c),n_(t.localStore,c,!0))),Zw(t.remoteStore,c)}),yield i,yield MO(t,r),function(a){const c=tt(a);c.hc.forEach((h,m)=>{Zw(c.remoteStore,m)}),c.lc._s(),c.hc=new Map,c.ac=new jr(nt.comparator)}(t),t.wc=!1,yield sx(t.remoteStore,!1)}}),Px.apply(this,arguments)}function MO(n,e,t){return kx.apply(this,arguments)}function kx(){return kx=(0,me.Z)(function*(n,e,t){const r=tt(n),i=[],a=[];for(const c of e){let h;const m=r.uc.get(c);if(m&&0!==m.length){h=yield t_(r.localStore,Is(m[0]));for(const w of m){const T=r.oc.get(w),D=yield bB(r,T);D.snapshot&&a.push(D.snapshot)}}else{const w=yield aO(r.localStore,c);h=yield t_(r.localStore,w),yield gx(r,NO(w),c,!1,h.resumeToken)}i.push(h)}return r.rc.Ho(a),i}),kx.apply(this,arguments)}function NO(n){return FP(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function AB(n){const e=tt(n);return tt(tt(e.localStore).persistence).Si()}function RB(n,e,t,r){return Ox.apply(this,arguments)}function Ox(){return Ox=(0,me.Z)(function*(n,e,t,r){const i=tt(n);if(i.wc)return void je("SyncEngine","Ignoring unexpected query state notification.");const a=i.uc.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const c=yield uO(i.localStore,BP(a[0])),h=kw.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Xe.EMPTY_BYTE_STRING);yield Hc(i,c,h);break}case"rejected":yield n_(i.localStore,e,!0),c_(i,e,r);break;default:ft()}}),Ox.apply(this,arguments)}function xB(n,e,t){return Lx.apply(this,arguments)}function Lx(){return Lx=(0,me.Z)(function*(n,e,t){const r=Fx(n);if(r.wc){for(const i of e){if(r.uc.has(i)){je("SyncEngine","Adding an already active target "+i);continue}const a=yield aO(r.localStore,i),c=yield t_(r.localStore,a);yield gx(r,NO(a),c.targetId,!1,c.resumeToken),qb(r.remoteStore,c)}for(const i of t)r.uc.has(i)&&(yield n_(r.localStore,i,!1).then(()=>{Zw(r.remoteStore,i),c_(r,i)}).catch(Uc))}}),Lx.apply(this,arguments)}function Fx(n){const e=tt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=AO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_B.bind(null,e),e.rc.Ho=aB.bind(null,e.eventManager),e.rc.gc=uB.bind(null,e.eventManager),e}function Ux(n){const e=tt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vB.bind(null,e),e}class PO{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,me.Z)(function*(){t.Tt=qw(e.databaseInfo.databaseId),t.sharedClientState=t.Ic(e),t.persistence=t.Tc(e),yield t.persistence.start(),t.localStore=t.Ec(e),t.gcScheduler=t.Ac(e,t.localStore),t.indexBackfillerScheduler=t.Rc(e,t.localStore)})()}Ac(e,t){return null}Rc(e,t){return null}Ec(e){return rO(this.persistence,new nO,e.initialUser,this.Tt)}Tc(e){return new eO(Bb.qs,this.Tt)}Ic(e){return new hO}terminate(){var e=this;return(0,me.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class kO extends PO{constructor(e,t,r){super(),this.Pc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,me.Z)(function*(){yield t().call(r,e),yield r.Pc.initialize(r,e),yield Ux(r.Pc.syncEngine),yield i_(r.Pc.remoteStore),yield r.persistence.di(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ec(e){return rO(this.persistence,new nO,e.initialUser,this.Tt)}Ac(e,t){return new wV(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Rc(e,t){const r=new u(t,this.persistence);return new o(e.asyncQueue,r)}Tc(e){const t=MR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?js.withCacheSize(this.cacheSizeBytes):js.DEFAULT;return new xR(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,pO(),Wb(),this.Tt,this.sharedClientState,!!this.forceOwnership)}Ic(e){return new hO}}class NB extends kO{constructor(e,t){super(e,t,!1),this.Pc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,me.Z)(function*(){yield t().call(r,e);const i=r.Pc.syncEngine;r.sharedClientState instanceof BR&&(r.sharedClientState.syncEngine={Br:DB.bind(null,i),Lr:RB.bind(null,i),qr:xB.bind(null,i),Si:AB.bind(null,i),Fr:CB.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.di(function(){var a=(0,me.Z)(function*(c){yield function SB(n,e){return Px.apply(this,arguments)}(r.Pc.syncEngine,c),r.gcScheduler&&(c&&!r.gcScheduler.started?r.gcScheduler.start():c||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(c&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():c||r.indexBackfillerScheduler.stop())});return function(c){return a.apply(this,arguments)}}())})()}Ic(e){const t=pO();if(!BR.C(t))throw new Le(ce.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=MR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new BR(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Vx{initialize(e,t){var r=this;return(0,me.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>RO(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=IB.bind(null,r.syncEngine),yield sx(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new oB}createDatastore(e){const t=qw(e.databaseInfo.databaseId),r=new HV(e.databaseInfo);return new WV(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=h=>RO(this.syncEngine,h,0),c=fO.C()?new fO:new BV,new ZV(t,r,i,a,c);var t,r,i,a,c}createSyncEngine(e,t){return function(r,i,a,c,h,m,w){const T=new fB(r,i,a,c,h,m);return w&&(T.wc=!0),T}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,me.Z)(function*(t){const r=tt(t);je("RemoteStore","RemoteStore shutting down."),r.mu.add(5),yield r_(r),r.yu.shutdown(),r.pu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function OO(n,e=10240){let t=0;return{read:()=>(0,me.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,me.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Zb{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.vc(this.observer.next,e)}error(e){this.observer.error?this.vc(this.observer.error,e):Vr("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}vc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class PB{constructor(e,t){this.Vc=e,this.Tt=t,this.metadata=new Br,this.buffer=new Uint8Array,this.Sc=new TextDecoder("utf-8"),this.Dc().then(r=>{r&&r.Ou()?this.metadata.resolve(r.Mu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Mu)}`))},r=>this.metadata.reject(r))}close(){return this.Vc.cancel()}getMetadata(){var e=this;return(0,me.Z)(function*(){return e.metadata.promise})()}yc(){var e=this;return(0,me.Z)(function*(){return yield e.getMetadata(),e.Dc()})()}Dc(){var e=this;return(0,me.Z)(function*(){const t=yield e.Cc();if(null===t)return null;const r=e.Sc.decode(t),i=Number(r);isNaN(i)&&e.xc(`length string (${r}) is not valid number`);const a=yield e.Nc(i);return new cB(JSON.parse(a),t.length+i)})()}kc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Cc(){var e=this;return(0,me.Z)(function*(){for(;e.kc()<0&&!(yield e.$c()););if(0===e.buffer.length)return null;const t=e.kc();t<0&&e.xc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Nc(e){var t=this;return(0,me.Z)(function*(){for(;t.buffer.length<e;)(yield t.$c())&&t.xc("Reached the end of bundle when more is expected.");const r=t.Sc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}xc(e){throw this.Vc.cancel(),new Error(`Invalid bundle format: ${e}`)}$c(){var e=this;return(0,me.Z)(function*(){const t=yield e.Vc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class kB{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,me.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Le(ce.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,me.Z)(function*(a,c){const h=tt(a),m=Fw(h.Tt)+"/documents",w={documents:c.map(F=>Lw(h.Tt,F))},T=yield h.mo("BatchGetDocuments",m,w,c.length),D=new Map;T.forEach(F=>{const $=function LU(n,e){return"found"in e?function(t,r){St(!!r.found);const i=Ru(t,r.found.name),a=Kr(r.found.updateTime),c=r.found.createTime?Kr(r.found.createTime):Mt.min(),h=new Si({mapValue:{fields:r.found.fields}});return gr.newFoundDocument(i,a,c,h)}(n,e):"missing"in e?function(t,r){St(!!r.missing),St(!!r.readTime);const i=Ru(t,r.missing),a=Kr(r.readTime);return gr.newNoDocument(i,a)}(n,e):ft()}(h.Tt,F);D.set($.key.toString(),$)});const x=[];return c.forEach(F=>{const $=D.get(F.toString());St(!!$),x.push($)}),x}),function(a,c){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ym(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,me.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=nt.fromPath(i);e.mutations.push(new hR(a,e.precondition(a)))}),yield(r=(0,me.Z)(function*(i,a){const c=tt(i),h=Fw(c.Tt)+"/documents",m={writes:a.map(w=>Uw(c.Tt,w))};yield c.lo("Commit",h,m)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ft();t=Mt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Le(ce.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Mt.min())?Er.exists(!1):Er.updateTime(t):Er.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Mt.min()))throw new Le(ce.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Er.updateTime(t)}return Er.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class OB{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.Mc=r.maxAttempts,this.ko=new $R(this.asyncQueue,"transaction_retry")}run(){this.Mc-=1,this.Oc()}Oc(){var e=this;this.ko.vo((0,me.Z)(function*(){const t=new kB(e.datastore),r=e.Fc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Bc(a)}))}).catch(i=>{e.Bc(i)})}))}Fc(e){try{const t=this.updateFunction(e);return!K(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Bc(e){this.Mc>0&&this.Lc(e)?(this.Mc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(e)}Lc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!tk(t)}return!1}}class LB{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=fi.UNAUTHENTICATED,this.clientId=XA.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var c=(0,me.Z)(function*(h){je("FirestoreClient","Received user=",h.uid),yield a.authCredentialListener(h),a.user=h});return function(h){return c.apply(this,arguments)}}()),this.appCheckCredentials.start(r,c=>(je("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}getConfiguration(){var e=this;return(0,me.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Le(ce.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Br;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,me.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=o_(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function LO(n,e){return Bx.apply(this,arguments)}function Bx(){return Bx=(0,me.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),je("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,me.Z)(function*(a){r.isEqual(a)||(yield iO(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),Bx.apply(this,arguments)}function FO(n,e){return jx.apply(this,arguments)}function jx(){return jx=(0,me.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield $x(n);je("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>EO(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>EO(e.remoteStore,a)),n.onlineComponents=e}),jx.apply(this,arguments)}function $x(n){return Hx.apply(this,arguments)}function Hx(){return Hx=(0,me.Z)(function*(n){return n.offlineComponents||(je("FirestoreClient","Using default OfflineComponentProvider"),yield LO(n,new PO)),n.offlineComponents}),Hx.apply(this,arguments)}function Yb(n){return Gx.apply(this,arguments)}function Gx(){return Gx=(0,me.Z)(function*(n){return n.onlineComponents||(je("FirestoreClient","Using default OnlineComponentProvider"),yield FO(n,new Vx)),n.onlineComponents}),Gx.apply(this,arguments)}function UO(n){return $x(n).then(e=>e.persistence)}function Qb(n){return $x(n).then(e=>e.localStore)}function zx(n){return Yb(n).then(e=>e.remoteStore)}function Wx(n){return Yb(n).then(e=>e.syncEngine)}function l_(n){return qx.apply(this,arguments)}function qx(){return qx=(0,me.Z)(function*(n){const e=yield Yb(n),t=e.eventManager;return t.onListen=pB.bind(null,e.syncEngine),t.onUnlisten=gB.bind(null,e.syncEngine),t}),qx.apply(this,arguments)}function BO(n,e,t={}){const r=new Br;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function(i,a,c,h,m){const w=new Zb({next:D=>{a.enqueueAndForget(()=>lx(i,T));const x=D.docs.has(c);!x&&D.fromCache?m.reject(new Le(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&D.fromCache&&h&&"server"===h.source?m.reject(new Le(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(D)},error:D=>m.reject(D)}),T=new fx(Wm(c.path),w,{includeMetadataChanges:!0,$u:!0});return ux(i,T)}(yield l_(n),n.asyncQueue,e,t,r)})),r.promise}function jO(n,e,t={}){const r=new Br;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function(i,a,c,h,m){const w=new Zb({next:D=>{a.enqueueAndForget(()=>lx(i,T)),D.fromCache&&"server"===h.source?m.reject(new Le(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(D)},error:D=>m.reject(D)}),T=new fx(c,w,{includeMetadataChanges:!0,$u:!0});return ux(i,T)}(yield l_(n),n.asyncQueue,e,t,r)})),r.promise}const $O=new Map;function Kx(n,e,t){if(!t)throw new Le(ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function HO(n,e,t,r){if(!0===e&&!0===r)throw new Le(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function GO(n){if(!nt.isDocumentKey(n))throw new Le(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function zO(n){if(nt.isDocumentKey(n))throw new Le(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Xb(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":ft()}function In(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Le(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Xb(n);throw new Le(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function WO(n,e){if(e<=0)throw new Le(ce.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class qO{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Le(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Le(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,HO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Yw{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qO({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Le(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Le(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qO(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new hb;switch(t.type){case"gapi":return new vw(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Le(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=$O.get(e);t&&(je("ComponentProvider","Removing Datastore"),$O.delete(e),t.terminate())}(this),Promise.resolve()}}class mr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mr(this.firestore,e,this._key)}}class Gi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Gi(this.firestore,e,this._query)}}class Mu extends Gi{constructor(e,t,r){super(e,t,Wm(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mr(this.firestore,null,new nt(e))}withConverter(e){return new Mu(this.firestore,e,this._path)}}function ZO(n,e,...t){if(n=(0,N.m9)(n),Kx("collection","path",e),n instanceof Yw){const r=wn.fromString(e,...t);return zO(r),new Mu(n,null,r)}{if(!(n instanceof mr||n instanceof Mu))throw new Le(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(wn.fromString(e,...t));return zO(r),new Mu(n.firestore,null,r)}}function Jb(n,e,...t){if(n=(0,N.m9)(n),1===arguments.length&&(e=XA.R()),Kx("doc","path",e),n instanceof Yw){const r=wn.fromString(e,...t);return GO(r),new mr(n,null,new nt(r))}{if(!(n instanceof mr||n instanceof Mu))throw new Le(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(wn.fromString(e,...t));return GO(r),new mr(n.firestore,n instanceof Mu?n.converter:null,new nt(r))}}function YO(n,e){return n=(0,N.m9)(n),e=(0,N.m9)(e),(n instanceof mr||n instanceof Mu)&&(e instanceof mr||e instanceof Mu)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Zx(n,e){return n=(0,N.m9)(n),e=(0,N.m9)(e),n instanceof Gi&&e instanceof Gi&&n.firestore===e.firestore&&Aw(n._query,e._query)&&n.converter===e.converter}class zB{constructor(){this.qc=Promise.resolve(),this.Uc=[],this.Kc=!1,this.Gc=[],this.Qc=null,this.jc=!1,this.zc=!1,this.Wc=[],this.ko=new $R(this,"async_queue_retry"),this.Hc=()=>{const t=Wb();t&&je("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ko.Vo()};const e=Wb();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Hc)}get isShuttingDown(){return this.Kc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Jc(),this.Yc(e)}enterRestrictedMode(e){if(!this.Kc){this.Kc=!0,this.zc=e||!1;const t=Wb();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Hc)}}enqueue(e){if(this.Jc(),this.Kc)return new Promise(()=>{});const t=new Br;return this.Yc(()=>this.Kc&&this.zc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Uc.push(e),this.Zc()))}Zc(){var e=this;return(0,me.Z)(function*(){if(0!==e.Uc.length){try{yield e.Uc[0](),e.Uc.shift(),e.ko.reset()}catch(t){if(!Vc(t))throw t;je("AsyncQueue","Operation failed with retryable error: "+t)}e.Uc.length>0&&e.ko.vo(()=>e.Zc())}})()}Yc(e){const t=this.qc.then(()=>(this.jc=!0,e().catch(r=>{throw this.Qc=r,this.jc=!1,Vr("INTERNAL UNHANDLED ERROR: ",function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),c}(r)),r}).then(r=>(this.jc=!1,r))));return this.qc=t,t}enqueueAfterDelay(e,t,r){this.Jc(),this.Wc.indexOf(e)>-1&&(t=0);const i=ax.createAndSchedule(this,e,t,r,a=>this.Xc(a));return this.Gc.push(i),i}Jc(){this.Qc&&ft()}verifyOperationInProgress(){}ta(){var e=this;return(0,me.Z)(function*(){let t;do{t=e.qc,yield t}while(t!==e.qc)})()}ea(e){for(const t of this.Gc)if(t.timerId===e)return!0;return!1}na(e){return this.ta().then(()=>{this.Gc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Gc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.ta()})}sa(e){this.Wc.push(e)}Xc(e){const t=this.Gc.indexOf(e);this.Gc.splice(t,1)}}function Yx(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class WB{constructor(){this._progressObserver={},this._taskCompletionResolver=new Br,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class _r extends Yw{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new zB,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||QO(this),this._firestoreClient.terminate()}}function Zr(n){return n._firestoreClient||QO(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function QO(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new I(n._databaseId,a,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var a,h;n._firestoreClient=new LB(n._authCredentials,n._appCheckCredentials,n._queue,r)}function XO(n,e,t){const r=new Br;return n.asyncQueue.enqueue((0,me.Z)(function*(){try{yield LO(n,t),yield FO(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(c=a).name?c.code===ce.FAILED_PRECONDITION||c.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&c instanceof DOMException)||22===c.code||20===c.code||11===c.code))throw a;yd("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var c})).then(()=>r.promise)}function JO(n){if(n._initialized||n._terminated)throw new Le(ce.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Nu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nu(Xe.fromBase64String(e))}catch(t){throw new Le(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Nu(Xe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Gc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Le(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class tp{constructor(e){this._methodName=e}}class eC{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Le(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Le(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return en(this._lat,e._lat)||en(this._long,e._long)}}const r2=/^__.*__$/;class s2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new jc(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zm(e,this.data,t,this.fieldTransforms)}}class e1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new jc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function t1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ft()}}class tC{constructor(e,t,r,i,a,c){this.settings=e,this.databaseId=t,this.Tt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.ia(),this.fieldTransforms=a||[],this.fieldMask=c||[]}get path(){return this.settings.path}get ra(){return this.settings.ra}oa(e){return new tC(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.Tt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ua(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.oa({path:r,ca:!1});return i.aa(e),i}ha(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.oa({path:r,ca:!1});return i.ia(),i}la(e){return this.oa({path:void 0,ca:!0})}fa(e){return iC(e,this.settings.methodName,this.settings.da||!1,this.path,this.settings._a)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ia(){if(this.path)for(let e=0;e<this.path.length;e++)this.aa(this.path.get(e))}aa(e){if(0===e.length)throw this.fa("Document fields must not be empty");if(t1(this.ra)&&r2.test(e))throw this.fa('Document fields cannot begin and end with "__"')}}class o2{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.Tt=r||qw(e)}wa(e,t,r,i=!1){return new tC({ra:e,methodName:t,_a:r,path:fr.emptyPath(),ca:!1,da:i},this.databaseId,this.Tt,this.ignoreUndefinedProperties)}}function np(n){const e=n._freezeSettings(),t=qw(n._databaseId);return new o2(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nC(n,e,t,r,i,a={}){const c=n.wa(a.merge||a.mergeFields?2:0,e,t,i);eM("Data must be an object, but it was:",c,r);const h=s1(r,c);let m,w;if(a.merge)m=new Vs(c.fieldMask),w=c.fieldTransforms;else if(a.mergeFields){const T=[];for(const D of a.mergeFields){const x=Jw(e,D,t);if(!c.contains(x))throw new Le(ce.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);a1(T,x)||T.push(x)}m=new Vs(T),w=c.fieldTransforms.filter(D=>m.covers(D.field))}else m=null,w=c.fieldTransforms;return new s2(new Si(h),m,w)}class Xw extends tp{_toFieldTransform(e){if(2!==e.ra)throw e.fa(1===e.ra?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xw}}function n1(n,e,t){return new tC({ra:3,_a:e.settings._a,methodName:n._methodName,ca:t},e.databaseId,e.Tt,e.ignoreUndefinedProperties)}class Qx extends tp{_toFieldTransform(e){return new xw(e.path,new qm)}isEqual(e){return e instanceof Qx}}class a2 extends tp{constructor(e,t){super(e),this.ma=t}_toFieldTransform(e){const t=n1(this,e,!0),r=this.ma.map(a=>rp(a,t)),i=new Wf(r);return new xw(e.path,i)}isEqual(e){return this===e}}class u2 extends tp{constructor(e,t){super(e),this.ma=t}_toFieldTransform(e){const t=n1(this,e,!0),r=this.ma.map(a=>rp(a,t)),i=new qf(r);return new xw(e.path,i)}isEqual(e){return this===e}}class c2 extends tp{constructor(e,t){super(e),this.ga=t}_toFieldTransform(e){const t=new Km(e.Tt,GP(e.Tt,this.ga));return new xw(e.path,t)}isEqual(e){return this===e}}function Xx(n,e,t,r){const i=n.wa(1,e,t);eM("Data must be an object, but it was:",i,r);const a=[],c=Si.empty();R(r,(m,w)=>{const T=rC(e,m,t);w=(0,N.m9)(w);const D=i.ha(T);if(w instanceof Xw)a.push(T);else{const x=rp(w,D);null!=x&&(a.push(T),c.set(T,x))}});const h=new Vs(a);return new e1(c,h,i.fieldTransforms)}function Jx(n,e,t,r,i,a){const c=n.wa(1,e,t),h=[Jw(e,r,t)],m=[i];if(a.length%2!=0)throw new Le(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)h.push(Jw(e,a[x])),m.push(a[x+1]);const w=[],T=Si.empty();for(let x=h.length-1;x>=0;--x)if(!a1(w,h[x])){const F=h[x];let $=m[x];$=(0,N.m9)($);const ee=c.ha(F);if($ instanceof Xw)w.push(F);else{const se=rp($,ee);null!=se&&(w.push(F),T.set(F,se))}}const D=new Vs(w);return new e1(T,D,c.fieldTransforms)}function r1(n,e,t,r=!1){return rp(t,n.wa(r?4:3,e))}function rp(n,e){if(o1(n=(0,N.m9)(n)))return eM("Unsupported field value:",e,n),s1(n,e);if(n instanceof tp)return function(t,r){if(!t1(r.ra))throw r.fa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.fa(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.ca&&4!==e.ra)throw e.fa("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const c of t){let h=rp(c,r.la(a));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,N.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return GP(r.Tt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=nr.fromDate(t);return{timestampValue:Qm(r.Tt,i)}}if(t instanceof nr){const i=new nr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Qm(r.Tt,i)}}if(t instanceof eC)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Nu)return{bytesValue:dk(r.Tt,t._byteString)};if(t instanceof mr){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.fa(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:fR(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.fa(`Unsupported field value: ${Xb(t)}`)}(n,e)}function s1(n,e){const t={};return U(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):R(n,(r,i)=>{const a=rp(i,e.ua(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function o1(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof nr||n instanceof eC||n instanceof Nu||n instanceof mr||n instanceof tp)}function eM(n,e,t){if(!o1(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=Xb(t);throw e.fa("an object"===r?n+" a custom object":n+" "+r)}var r}function Jw(n,e,t){if((e=(0,N.m9)(e))instanceof Gc)return e._internalPath;if("string"==typeof e)return rC(n,e);throw iC("Field path arguments must be of type string or ",n,!1,void 0,t)}const l2=new RegExp("[~\\*/\\[\\]]");function rC(n,e,t){if(e.search(l2)>=0)throw iC(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gc(...e.split("."))._internalPath}catch{throw iC(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function iC(n,e,t,r,i){const a=r&&!r.isEmpty(),c=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(a||c)&&(m+=" (found",a&&(m+=` in field ${r}`),c&&(m+=` in document ${i}`),m+=")"),new Le(ce.INVALID_ARGUMENT,h+n+m)}function a1(n,e){return n.some(t=>t.isEqual(e))}class e0{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new mr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new d2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(sC("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class d2 extends e0{data(){return super.data()}}function sC(n,e){return"string"==typeof e?rC(n,e):e instanceof Gc?e._internalPath:e._delegate._internalPath}function u1(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Le(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tM{}class t0 extends tM{}function xd(n,e,...t){let r=[];e instanceof tM&&r.push(e),r=r.concat(t),function(i){const a=i.filter(h=>h instanceof d_).length,c=i.filter(h=>h instanceof n0).length;if(a>1||a>0&&c>0)throw new Le(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class n0 extends t0{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n0(e,t,r)}_apply(e){const t=this._parse(e);return h1(e._query,t),new Gi(e.firestore,e.converter,lR(e._query,t))}_parse(e){const t=np(e.firestore);return function(i,a,c,h,m,w,T){let D;if(m.isKeyField()){if("array-contains"===w||"array-contains-any"===w)throw new Le(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if("in"===w||"not-in"===w){d1(T,w);const x=[];for(const F of T)x.push(l1(h,i,F));D={arrayValue:{values:x}}}else D=l1(h,i,T)}else"in"!==w&&"not-in"!==w&&"array-contains-any"!==w||d1(T,w),D=r1(c,"where",T,"in"===w||"not-in"===w);return En.create(m,w,D)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class d_ extends tM{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new d_(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:$n.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(r,i){let a=r;const c=i.getFlattenedFilters();for(const h of c)h1(a,h),a=lR(a,h)}(e._query,t),new Gi(e.firestore,e.converter,lR(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class nM extends t0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new nM(e,t)}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Le(ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Le(ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const c=new Gm(i,a);return function(h,m){if(null===uR(h)){const w=bb(h);null!==w&&f1(0,w,m.field)}}(r,c),c}(e._query,this._field,this._direction);return new Gi(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Bc(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class oC extends t0{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new oC(e,t,r)}_apply(e){return new Gi(e.firestore,e.converter,Cb(e._query,this._limit,this._limitType))}}class aC extends t0{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new aC(e,t,r)}_apply(e){const t=c1(e,this.type,this._docOrFields,this._inclusive);return new Gi(e.firestore,e.converter,(i=t,new Bc((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class uC extends t0{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new uC(e,t,r)}_apply(e){const t=c1(e,this.type,this._docOrFields,this._inclusive);return new Gi(e.firestore,e.converter,(i=t,new Bc((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function c1(n,e,t,r){if(t[0]=(0,N.m9)(t[0]),t[0]instanceof e0)return function(i,a,c,h,m){if(!h)throw new Le(ce.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const w=[];for(const T of zf(i))if(T.field.isKeyField())w.push(Hf(a,h.key));else{const D=h.data.field(T.field);if(pr(D))throw new Le(ce.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+T.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===D){const x=T.field.canonicalString();throw new Le(ce.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}w.push(D)}return new Id(w,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=np(n.firestore);return function(a,c,h,m,w,T){const D=a.explicitOrderBy;if(w.length>D.length)throw new Le(ce.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const x=[];for(let F=0;F<w.length;F++){const $=w[F];if(D[F].field.isKeyField()){if("string"!=typeof $)throw new Le(ce.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof $}`);if(!cR(a)&&-1!==$.indexOf("/"))throw new Le(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${$}' contains a slash.`);const ee=a.path.child(wn.fromString($));if(!nt.isDocumentKey(ee))throw new Le(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${ee}' is not because it contains an odd number of segments.`);const se=new nt(ee);x.push(Hf(c,se))}else{const ee=r1(h,m,$);x.push(ee)}}return new Id(x,T)}(n._query,n.firestore._databaseId,i,e,t,r)}}function l1(n,e,t){if("string"==typeof(t=(0,N.m9)(t))){if(""===t)throw new Le(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cR(e)&&-1!==t.indexOf("/"))throw new Le(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(wn.fromString(t));if(!nt.isDocumentKey(r))throw new Le(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Hf(n,new nt(r))}if(t instanceof mr)return Hf(n,t._key);throw new Le(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xb(t)}.`)}function d1(n,e){if(!Array.isArray(n)||0===n.length)throw new Le(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function h1(n,e){if(e.isInequality()){const r=bb(n),i=e.field;if(null!==r&&!r.isEqual(i))throw new Le(ce.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const a=uR(n);null!==a&&f1(0,i,a)}const t=function(r,i){for(const a of r)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Le(ce.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function f1(n,e,t){if(!t.isEqual(e))throw new Le(ce.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class rM{convertValue(e,t="none"){switch($f(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Nn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ft()}}convertObject(e,t){const r={};return R(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new eC(pt(e.latitude),pt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=tR(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Tw(e));default:return null}}convertTimestamp(e){const t=Me(e);return new nr(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=wn.fromString(e);St(Ek(r));const i=new b(r.get(1),r.get(3)),a=new nt(r.popFirst(5));return i.isEqual(t)||Vr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function cC(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class w2 extends rM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new mr(this.firestore,null,t)}}class ip{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zc extends e0{constructor(e,t,r,i,a,c){super(e,t,r,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new r0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(sC("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class r0 extends zc{data(e={}){return super.data(e)}}class Md{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ip(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new r0(this._firestore,this._userDataWriter,r.key,r,new ip(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Le(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(c=>({type:"added",doc:new r0(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ip(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>i||3!==c.type).map(c=>{const h=new r0(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ip(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,w=-1;return 0!==c.type&&(m=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),1!==c.type&&(a=a.add(c.doc),w=a.indexOf(c.doc.key)),{type:I2(c.type),doc:h,oldIndex:m,newIndex:w}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function I2(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ft()}}function g1(n,e){return n instanceof zc&&e instanceof zc?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Md&&e instanceof Md&&n._firestore===e._firestore&&Zx(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Nd extends rM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new mr(this.firestore,null,t)}}function m1(n,e,t){n=In(n,mr);const r=In(n.firestore,_r),i=cC(n.converter,e,t);return h_(r,[nC(np(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Er.none())])}function _1(n,e,t,...r){n=In(n,mr);const i=In(n.firestore,_r),a=np(i);let c;return c="string"==typeof(e=(0,N.m9)(e))||e instanceof Gc?Jx(a,"updateDoc",n._key,e,t,r):Xx(a,"updateDoc",n._key,e),h_(i,[c.toMutation(n._key,Er.exists(!0))])}function y1(n,...e){var t,r,i;n=(0,N.m9)(n);let a={includeMetadataChanges:!1},c=0;"object"!=typeof e[c]||Yx(e[c])||(a=e[c],c++);const h={includeMetadataChanges:a.includeMetadataChanges};if(Yx(e[c])){const D=e[c];e[c]=null===(t=D.next)||void 0===t?void 0:t.bind(D),e[c+1]=null===(r=D.error)||void 0===r?void 0:r.bind(D),e[c+2]=null===(i=D.complete)||void 0===i?void 0:i.bind(D)}let m,w,T;if(n instanceof mr)w=In(n.firestore,_r),T=Wm(n._key.path),m={next:D=>{e[c]&&e[c](iM(w,n,D))},error:e[c+1],complete:e[c+2]};else{const D=In(n,Gi);w=In(D.firestore,_r),T=D._query;const x=new Nd(w);m={next:F=>{e[c]&&e[c](new Md(w,x,D,F))},error:e[c+1],complete:e[c+2]},u1(n._query)}return function(D,x,F,$){const ee=new Zb($),se=new fx(x,ee,F);return D.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return ux(yield l_(D),se)})),()=>{ee.bc(),D.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return lx(yield l_(D),se)}))}}(Zr(w),T,h,m)}function h_(n,e){return function(t,r){const i=new Br;return t.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function mB(n,e,t){return yx.apply(this,arguments)}(yield Wx(t),r,i)})),i.promise}(Zr(n),e)}function iM(n,e,t){const r=t.docs.get(e._key),i=new Nd(n);return new zc(n,i,e._key,r,new ip(t.hasPendingWrites,t.fromCache),e.converter)}const P2={maxAttempts:5};class v1{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=np(e)}set(e,t,r){this._verifyNotCommitted();const i=Pd(e,this._firestore),a=cC(i.converter,t,r),c=nC(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(c.toMutation(i._key,Er.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Pd(e,this._firestore);let c;return c="string"==typeof(t=(0,N.m9)(t))||t instanceof Gc?Jx(this._dataReader,"WriteBatch.update",a._key,t,r,i):Xx(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(c.toMutation(a._key,Er.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Pd(e,this._firestore);return this._mutations=this._mutations.concat(new Ym(t._key,Er.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Le(ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Pd(n,e){if((n=(0,N.m9)(n)).firestore!==e)throw new Le(ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class k2 extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=np(e)}get(e){const t=Pd(e,this._firestore),r=new w2(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return ft();const a=i[0];if(a.isFoundDocument())return new e0(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new e0(this._firestore,r,t._key,null,t.converter);throw ft()})}set(e,t,r){const i=Pd(e,this._firestore),a=cC(i.converter,t,r),c=nC(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,c),this}update(e,t,r,...i){const a=Pd(e,this._firestore);let c;return c="string"==typeof(t=(0,N.m9)(t))||t instanceof Gc?Jx(this._dataReader,"Transaction.update",a._key,t,r,i):Xx(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,c),this}delete(e){const t=Pd(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Pd(e,this._firestore),r=new Nd(this._firestore);return super.get(e).then(i=>new zc(this._firestore,r,t._key,i._document,new ip(!1,!1),t.converter))}}!function(n,e=!0){Uf=Fi.SDK_VERSION,(0,Fi._registerComponent)(new no.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const a=t.getProvider("app").getImmediate(),c=new _r(new yw(t.getProvider("auth-internal")),new Um(t.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Le(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new b(h.options.projectId,m)}(a,r),a);return i=Object.assign({useFetchStreams:e},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),(0,Fi.registerVersion)(lb,"3.9.0",n),(0,Fi.registerVersion)(lb,"3.9.0","esm2017")}();function sM(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Le("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function E1(){if(typeof Uint8Array>"u")throw new Le("unimplemented","Uint8Arrays are not available in this environment.")}function I1(){if(!function it(){return typeof atob<"u"}())throw new Le("unimplemented","Blobs are unavailable in Firestore in this environment.")}class s0{constructor(e){this._delegate=e}static fromBase64String(e){return I1(),new s0(Nu.fromBase64String(e))}static fromUint8Array(e){return E1(),new s0(Nu.fromUint8Array(e))}toBase64(){return I1(),this._delegate.toBase64()}toUint8Array(){return E1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function oM(n){return function H2(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class G2{enableIndexedDbPersistence(e,t){return function KB(n,e){JO(n=In(n,_r));const t=Zr(n),r=n._freezeSettings(),i=new Vx;return XO(t,i,new kO(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function ZB(n){JO(n=In(n,_r));const e=Zr(n),t=n._freezeSettings(),r=new Vx;return XO(e,r,new NB(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function YB(n){if(n._initialized&&!n._terminated)throw new Le(ce.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Br;return n._queue.enqueueAndForgetEvenWhileRestricted((0,me.Z)(function*(){try{yield(t=(0,me.Z)(function*(r){if(!ho.C())return Promise.resolve();const i=r+"main";yield ho.delete(i)}),function(r){return t.apply(this,arguments)})(MR(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class T1{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof b||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&yd("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function KO(n,e,t,r={}){var i;const a=(n=In(n,Yw))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&yd("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let c,h;if("string"==typeof r.mockUserToken)c=r.mockUserToken,h=fi.MOCK_USER;else{c=(0,N.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Le(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new fi(m)}n._authCredentials=new _w(new Du(c,h))}}(this._delegate,e,t,r)}enableNetwork(){return function XB(n){return function FB(n){return n.asyncQueue.enqueue((0,me.Z)(function*(){const e=yield UO(n),t=yield zx(n);return e.setNetworkEnabled(!0),function(r){const i=tt(r);return i.mu.delete(0),Kw(i)}(t)}))}(Zr(n=In(n,_r)))}(this._delegate)}disableNetwork(){return function JB(n){return function UB(n){return n.asyncQueue.enqueue((0,me.Z)(function*(){const e=yield UO(n),t=yield zx(n);return e.setNetworkEnabled(!1),(r=(0,me.Z)(function*(i){const a=tt(i);a.mu.add(0),yield r_(a),a.pu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(Zr(n=In(n,_r)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,HO("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function QB(n){return function(e){const t=new Br;return e.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function wB(n,e){return Tx.apply(this,arguments)}(yield Wx(e),t)})),t.promise}(Zr(n=In(n,_r)))}(this._delegate)}onSnapshotsInSync(e){return function M2(n,e){return function jB(n,e){const t=new Zb(e);return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return r=yield l_(n),i=t,tt(r).vu.add(i),void i.next();var r,i})),()=>{t.bc(),n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return r=yield l_(n),i=t,void tt(r).vu.delete(i);var r,i}))}}(Zr(n=In(n,_r)),Yx(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Le("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new f_(this,ZO(this._delegate,e))}catch(t){throw bs(t,"collection()","Firestore.collection()")}}doc(e){try{return new zo(this,Jb(this._delegate,e))}catch(t){throw bs(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Cs(this,function GB(n,e){if(n=In(n,Yw),Kx("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Le(ce.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Gi(n,null,(t=e,new Bc(wn.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw bs(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function O2(n,e,t){n=In(n,_r);const r=Object.assign(Object.assign({},P2),t);return function(i){if(i.maxAttempts<1)throw new Le(ce.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,a,c){const h=new Br;return i.asyncQueue.enqueueAndForget((0,me.Z)(function*(){const m=yield function VO(n){return Yb(n).then(e=>e.datastore)}(i);new OB(i.asyncQueue,m,c,a,h).run()})),h.promise}(Zr(n),i=>e(new k2(n,i)),r)}(this._delegate,t=>e(new b1(this,t)))}batch(){return Zr(this._delegate),new C1(new v1(this._delegate,e=>h_(this._delegate,e)))}loadBundle(e){return function e2(n,e){const t=Zr(n=In(n,_r)),r=new WB;return function $B(n,e,t,r){const i=function(a,c){let h;return h="string"==typeof a?(new TextEncoder).encode(a):a,m=function(m,w){if(m instanceof Uint8Array)return OO(m,w);if(m instanceof ArrayBuffer)return OO(new Uint8Array(m),w);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new PB(m,c);var m}(t,qw(e));n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){!function MB(n,e,t){const r=tt(n);var i;(i=(0,me.Z)(function*(a,c,h){try{const m=yield c.getMetadata();if(yield function(x,F){const $=tt(x),ee=Kr(F.createTime);return $.persistence.runTransaction("hasNewerBundle","readonly",se=>$.$s.getBundleMetadata(se,F.id)).then(se=>!!se&&se.createTime.compareTo(ee)>=0)}(a.localStore,m))return yield c.close(),h._completeWith({taskState:"Success",documentsLoaded:(x=m).totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}),Promise.resolve(new Set);h._updateProgress(bO(m));const w=new lB(m,a.localStore,c.Tt);let T=yield c.yc();for(;T;){const x=yield w.Bu(T);x&&h._updateProgress(x),T=yield c.yc()}const D=yield w.complete();return yield Hc(a,D.Uu,void 0),yield function(x,F){const $=tt(x);return $.persistence.runTransaction("Save bundle","readwrite",ee=>$.$s.saveBundleMetadata(ee,F))}(a.localStore,m),h._completeWith(D.progress),Promise.resolve(D.qu)}catch(m){return yd("SyncEngine",`Loading bundle failed with ${m}`),h._failWith(m),Promise.resolve(new Set)}var x}),function(a,c,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield Wx(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function t2(n,e){return function HB(n,e){return n.asyncQueue.enqueue((0,me.Z)(function*(){return function(t,r){const i=tt(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.$s.getNamedQuery(a,r))}(yield Qb(n),e)}))}(Zr(n=In(n,_r)),e).then(t=>t?new Gi(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Cs(this,t):null)}}class lC extends rM{constructor(e){super(),this.firestore=e}convertBytes(e){return new s0(new Nu(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return zo.forKey(t,this.firestore,null)}}class b1{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new lC(e)}get(e){const t=op(e);return this._delegate.get(t).then(r=>new o0(this._firestore,new zc(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=op(e);return r?(sM("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=op(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=op(e);return this._delegate.delete(t),this}}class C1{constructor(e){this._delegate=e}set(e,t,r){const i=op(e);return r?(sM("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=op(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=op(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class sp{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new r0(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new a0(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=sp.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new sp(e,new lC(e),t),i.set(t,a)),a}}sp.INSTANCES=new WeakMap;class zo{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new lC(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Le("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new zo(t,new mr(t._delegate,r,new nt(e)))}static forKey(e,t,r){return new zo(t,new mr(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new f_(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new f_(this.firestore,ZO(this._delegate,e))}catch(t){throw bs(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,N.m9)(e))instanceof mr&&YO(this._delegate,e)}set(e,t){t=sM("DocumentReference.set",t);try{return t?m1(this._delegate,e,t):m1(this._delegate,e)}catch(r){throw bs(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?_1(this._delegate,e):_1(this._delegate,e,t,...r)}catch(i){throw bs(i,"updateDoc()","DocumentReference.update()")}}delete(){return function R2(n){return h_(In(n.firestore,_r),[new Ym(n._key,Er.none())])}(this._delegate)}onSnapshot(...e){const t=D1(e),r=S1(e,i=>new o0(this.firestore,new zc(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return y1(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function b2(n){n=In(n,mr);const e=In(n.firestore,_r),t=Zr(e),r=new Nd(e);return function VB(n,e){const t=new Br;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return(r=(0,me.Z)(function*(i,a,c){try{const h=yield function(m,w){const T=tt(m);return T.persistence.runTransaction("read document","readonly",D=>T.localDocuments.getDocument(D,w))}(i,a);h.isFoundDocument()?c.resolve(h):h.isNoDocument()?c.resolve(null):c.reject(new Le(ce.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const m=o_(h,`Failed to get document '${a} from cache`);c.reject(m)}}),function(i,a,c){return r.apply(this,arguments)})(yield Qb(n),e,t);var r})),t.promise}(t,n._key).then(i=>new zc(e,r,n._key,i,new ip(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function C2(n){n=In(n,mr);const e=In(n.firestore,_r);return BO(Zr(e),n._key,{source:"server"}).then(t=>iM(e,n,t))}(this._delegate):function T2(n){n=In(n,mr);const e=In(n.firestore,_r);return BO(Zr(e),n._key).then(t=>iM(e,n,t))}(this._delegate),t.then(r=>new o0(this.firestore,new zc(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new zo(this.firestore,this._delegate.withConverter(e?sp.getInstance(this.firestore,e):null))}}function bs(n,e,t){return n.message=n.message.replace(e,t),n}function D1(n){for(const e of n)if("object"==typeof e&&!oM(e))return e;return{}}function S1(n,e){var t,r;let i;return i=oM(n[0])?n[0]:oM(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class o0{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new zo(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return g1(this._delegate,e._delegate)}}class a0 extends o0{data(e){const t=this._delegate.data(e);return function YA(n,e){n||ft()}(void 0!==t),t}}class Cs{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new lC(e)}where(e,t,r){try{return new Cs(this.firestore,xd(this._delegate,function h2(n,e,t){const r=e,i=sC("where",n);return n0._create(i,r,t)}(e,t,r)))}catch(i){throw bs(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Cs(this.firestore,xd(this._delegate,function f2(n,e="asc"){const t=e,r=sC("orderBy",n);return nM._create(r,t)}(e,t)))}catch(r){throw bs(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Cs(this.firestore,xd(this._delegate,function p2(n){return WO("limit",n),oC._create("limit",n,"F")}(e)))}catch(t){throw bs(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Cs(this.firestore,xd(this._delegate,function g2(n){return WO("limitToLast",n),oC._create("limitToLast",n,"L")}(e)))}catch(t){throw bs(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Cs(this.firestore,xd(this._delegate,function m2(...n){return aC._create("startAt",n,!0)}(...e)))}catch(t){throw bs(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Cs(this.firestore,xd(this._delegate,function _2(...n){return aC._create("startAfter",n,!1)}(...e)))}catch(t){throw bs(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Cs(this.firestore,xd(this._delegate,function y2(...n){return uC._create("endBefore",n,!1)}(...e)))}catch(t){throw bs(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Cs(this.firestore,xd(this._delegate,function v2(...n){return uC._create("endAt",n,!0)}(...e)))}catch(t){throw bs(t,"endAt()","Query.endAt()")}}isEqual(e){return Zx(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function S2(n){n=In(n,Gi);const e=In(n.firestore,_r),t=Zr(e),r=new Nd(e);return function BB(n,e){const t=new Br;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return(r=(0,me.Z)(function*(i,a,c){try{const h=yield $b(i,a,!0),m=new SO(a,h.Yi),w=m.Hu(h.documents),T=m.applyChanges(w,!1);c.resolve(T.snapshot)}catch(h){const m=o_(h,`Failed to execute query '${a} against cache`);c.reject(m)}}),function(i,a,c){return r.apply(this,arguments)})(yield Qb(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Md(e,r,n,i))}(this._delegate):"server"===e?.source?function A2(n){n=In(n,Gi);const e=In(n.firestore,_r),t=Zr(e),r=new Nd(e);return jO(t,n._query,{source:"server"}).then(i=>new Md(e,r,n,i))}(this._delegate):function D2(n){n=In(n,Gi);const e=In(n.firestore,_r),t=Zr(e),r=new Nd(e);return u1(n._query),jO(t,n._query).then(i=>new Md(e,r,n,i))}(this._delegate),t.then(r=>new aM(this.firestore,new Md(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=D1(e),r=S1(e,i=>new aM(this.firestore,new Md(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return y1(this._delegate,t,r)}withConverter(e){return new Cs(this.firestore,this._delegate.withConverter(e?sp.getInstance(this.firestore,e):null))}}class W2{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new a0(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class aM{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Cs(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new a0(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new W2(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new a0(this._firestore,r))})}isEqual(e){return g1(this._delegate,e._delegate)}}class f_ extends Cs{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new zo(this.firestore,e):null}doc(e){try{return new zo(this.firestore,void 0===e?Jb(this._delegate):Jb(this._delegate,e))}catch(t){throw bs(t,"doc()","CollectionReference.doc()")}}add(e){return function x2(n,e){const t=In(n.firestore,_r),r=Jb(n),i=cC(n.converter,e);return h_(t,[nC(np(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Er.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new zo(this.firestore,t))}isEqual(e){return YO(this._delegate,e._delegate)}withConverter(e){return new f_(this.firestore,this._delegate.withConverter(e?sp.getInstance(this.firestore,e):null))}}function op(n){return In(n,mr)}class uM{constructor(...e){this._delegate=new Gc(...e)}static documentId(){return new uM(fr.keyField().canonicalString())}isEqual(e){return(e=(0,N.m9)(e))instanceof Gc&&this._delegate._internalPath.isEqual(e._internalPath)}}class ap{constructor(e){this._delegate=e}static serverTimestamp(){const e=function F2(){return new Qx("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new ap(e)}static delete(){const e=function L2(){return new Xw("deleteField")}();return e._methodName="FieldValue.delete",new ap(e)}static arrayUnion(...e){const t=function U2(...n){return new a2("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new ap(t)}static arrayRemove(...e){const t=function V2(...n){return new u2("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new ap(t)}static increment(e){const t=function B2(n){return new c2("increment",n)}(e);return t._methodName="FieldValue.increment",new ap(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const q2={Firestore:T1,GeoPoint:eC,Timestamp:nr,Blob:s0,Transaction:b1,WriteBatch:C1,DocumentReference:zo,DocumentSnapshot:o0,Query:Cs,QueryDocumentSnapshot:a0,QuerySnapshot:aM,CollectionReference:f_,FieldPath:uM,FieldValue:ap,setLogLevel:function z2(n){!function ZA(n){La.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function A1(n,e){return function Y2(n,e=cf.z){return new Oi.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function cM(n,e){return A1(n,e).pipe((0,Ct.U)(t=>({payload:t,type:"query"})))}function dC(n,e){return cM(n,e).pipe(rc(void 0),zg(),(0,Ct.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(c=>({type:c.type,payload:c}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((c,h)=>{const m=i.find(T=>T.doc.ref.isEqual(c.ref)),w=t?.payload.docs.find(T=>T.ref.isEqual(c.ref));m&&JSON.stringify(m.doc.metadata)===JSON.stringify(c.metadata)||!m&&w&&JSON.stringify(w.metadata)===JSON.stringify(c.metadata)||a.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:c}})}),a}))}function R1(n,e,t){return dC(n,t).pipe(No((r,i)=>function X2(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function J2(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return lM(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return lM(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return lM(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),Wg(),(0,Ct.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function lM(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function x1(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function Z2(n){(function K2(n,e){n.INTERNAL.registerComponent(new no.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},q2)))})(n,(e,t)=>new T1(e,t,new G2)),n.registerVersion("@firebase/firestore-compat","0.3.5")}(lf.Z);class M1{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=dC(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Ct.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(rc(void 0),zg(),Li(([r,i])=>i.length>0||!r),(0,Ct.U)(([r,i])=>i),un.iC)}auditTrail(e){return this.stateChanges(e).pipe(No((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=x1(e);return R1(this.query,t,this.afs.schedulers.outsideAngular).pipe(un.iC)}valueChanges(e={}){return cM(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ct.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),un.iC)}get(e){return(0,Xt.D)(this.query.get(e)).pipe(un.iC)}add(e){return this.ref.add(e)}doc(e){return new N1(this.ref.doc(e),this.afs)}}class N1{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=O1(r,t);return new M1(i,a,this.afs)}snapshotChanges(){return function Q2(n,e){return A1(n,e).pipe(rc(void 0),zg(),(0,Ct.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(un.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Ct.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,Xt.D)(this.ref.get(e)).pipe(un.iC)}}class ej{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?dC(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ct.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),Li(t=>t.length>0),un.iC):dC(this.query,this.afs.schedulers.outsideAngular).pipe(un.iC)}auditTrail(e){return this.stateChanges(e).pipe(No((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=x1(e);return R1(this.query,t,this.afs.schedulers.outsideAngular).pipe(un.iC)}valueChanges(e={}){return cM(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ct.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),un.iC)}get(e){return(0,Xt.D)(this.query.get(e)).pipe(un.iC)}}const P1=new _.OlP("angularfire2.enableFirestorePersistence"),k1=new _.OlP("angularfire2.firestore.persistenceSettings"),tj=new _.OlP("angularfire2.firestore.settings"),nj=new _.OlP("angularfire2.firestore.use-emulator");function O1(n,e=(t=>t)){return{query:e(n),ref:n}}let rj=(()=>{class n{constructor(t,r,i,a,c,h,m,w,T,D,x,F,$,ee,se,ht,vt){this.schedulers=m;const dt=(0,cr.on)(t,h,r),It=T;D&&rv(dt,h,x,$,ee,se,F,ht),[this.firestore,this.persistenceEnabled$]=(0,cr.cc)(`${dt.name}.firestore`,"AngularFirestore",dt.name,()=>{const Vt=h.runOutsideAngular(()=>dt.firestore());if(a&&Vt.settings(a),It&&Vt.useEmulator(...It),i&&!sa(c)){const Zt=()=>{try{return(0,Xt.D)(Vt.enablePersistence(w||void 0).then(()=>!0,()=>!1))}catch($r){return typeof console<"u"&&console.warn($r),ot(!1)}};return[Vt,h.runOutsideAngular(Zt)]}return[Vt,ot(!1)]},[a,It,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:c}=O1(i,r),h=this.schedulers.ngZone.run(()=>a);return new M1(h,c,this)}collectionGroup(t,r){const i=r||(c=>c),a=this.firestore.collectionGroup(t);return new ej(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new N1(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(cr.Dh),_.LFG(cr.xv,8),_.LFG(P1,8),_.LFG(tj,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(un.HU),_.LFG(k1,8),_.LFG(nj,8),_.LFG(bc,8),_.LFG(Ag,8),_.LFG(Rg,8),_.LFG(xg,8),_.LFG(rd,8),_.LFG(Vo,8),_.LFG(nv,8),_.LFG(nd,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),ij=(()=>{class n{constructor(){Iu.Z.registerVersion("angularfire",un.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:P1,useValue:!0},{provide:k1,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[rj]}),n})();var sj=P(5032);const L1="@firebase/database";let dM="";function U1(n){dM=n}class uj{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,N.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,N.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class cj{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,N.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const V1=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new uj(e)}}catch{}return new cj},up=V1("localStorage"),hM=V1("sessionStorage"),p_=new vs.Yd("@firebase/database"),B1=function(){let n=1;return function(){return n++}}(),j1=function(n){const e=(0,N.dS)(n),t=new N.gQ;t.update(e);const r=t.digest();return N.US.encodeByteArray(r)},u0=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=u0.apply(null,r):e+="object"==typeof r?(0,N.Wl)(r):r,e+=" "}return e};let cp=null,$1=!0;const H1=function(n,e){(0,N.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(p_.logLevel=vs.in.VERBOSE,cp=p_.log.bind(p_),e&&hM.set("logging_enabled",!0)):"function"==typeof n?cp=n:(cp=null,hM.remove("logging_enabled"))},xi=function(...n){if(!0===$1&&($1=!1,null===cp&&!0===hM.get("logging_enabled")&&H1(!0)),cp){const e=u0.apply(null,n);cp(e)}},c0=function(n){return function(...e){xi(n,...e)}},fM=function(...n){const e="FIREBASE INTERNAL ERROR: "+u0(...n);p_.error(e)},Pu=function(...n){const e=`FIREBASE FATAL ERROR: ${u0(...n)}`;throw p_.error(e),new Error(e)},us=function(...n){const e="FIREBASE WARNING: "+u0(...n);p_.warn(e)},hC=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},kd="[MIN_NAME]",Wc="[MAX_NAME]",lp=function(n,e){if(n===e)return 0;if(n===kd||e===Wc)return-1;if(e===kd||n===Wc)return 1;{const t=W1(n),r=W1(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},hj=function(n,e){return n===e?0:n<e?-1:1},l0=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,N.Wl)(e))},pM=function(n){if("object"!=typeof n||null===n)return(0,N.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,N.Wl)(e[r]),t+=":",t+=pM(n[e[r]]);return t+="}",t},G1=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Mi(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const z1=function(n){(0,N.hu)(!hC(n),"Invalid JSON number");const r=1023;let i,a,c,h,m;0===n?(a=0,c=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,c=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(a=0,c=Math.round(n/Math.pow(2,-1074))));const w=[];for(m=52;m;m-=1)w.push(c%2?1:0),c=Math.floor(c/2);for(m=11;m;m-=1)w.push(a%2?1:0),a=Math.floor(a/2);w.push(i?1:0),w.reverse();const T=w.join("");let D="";for(m=0;m<64;m+=8){let x=parseInt(T.substr(m,8),2).toString(16);1===x.length&&(x="0"+x),D+=x}return D.toLowerCase()},mj=new RegExp("^-?(0*)\\d{1,10}$"),W1=function(n){if(mj.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},g_=function(n){try{n()}catch(e){setTimeout(()=>{throw us("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},vj=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},d0=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class wj{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){us(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Ej{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(xi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',us(e)}}let h0=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const Q1=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,eL="websocket",tL="long_polling";class mM{constructor(e,t,r,i,a=!1,c="",h=!1,m=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=c,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=m,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=up.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&up.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function nL(n,e,t){let r;if((0,N.hu)("string"==typeof e,"typeof type must == string"),(0,N.hu)("object"==typeof t,"typeof params must == object"),e===eL)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==tL)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Ij(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Mi(t,(a,c)=>{i.push(a+"="+c)}),r+i.join("&")}class Tj{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,N.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,N.p$)(this.counters_)}}const _M={},yM={};function vM(n){const e=n.toString();return _M[e]||(_M[e]=new Tj),_M[e]}class Cj{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&g_(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Od{constructor(e,t,r,i,a,c,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=c0(e),this.stats_=vM(t),this.urlFn=m=>(this.appCheckToken&&(m.ac=this.appCheckToken),nL(t,tL,m))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Cj(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,N.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new wM((...a)=>{const[c,h,m,w,T]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===c)this.id=h,this.password=m;else{if("close"!==c)throw new Error("Unrecognized command received: "+c);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[c,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(c,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&Q1.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Od.forceAllow_=!0}static forceDisallow(){Od.forceDisallow_=!0}static isAvailable(){return!((0,N.Yr)()||!Od.forceAllow_&&(Od.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,N.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,N.h$)(t),i=G1(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,N.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,N.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class wM{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,N.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=B1(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=wM.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(h){xi("frame writing exception"),h.stack&&xi(h.stack),xi(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||xi("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const c=this.pendingSegs.shift();r=r+"&seg"+i+"="+c.seg+"&ts"+i+"="+c.ts+"&d"+i+"="+c.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,N.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{xi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let pC=null;typeof MozWebSocket<"u"?pC=MozWebSocket:typeof WebSocket<"u"&&(pC=WebSocket);let m_=(()=>{class n{constructor(t,r,i,a,c,h,m){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=c,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=c0(this.connId),this.stats_=vM(r),this.connURL=n.connectionURL_(r,h,m,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,c){const h={v:"5"};return!(0,N.Yr)()&&typeof location<"u"&&location.hostname&&Q1.test(location.hostname)&&(h.r="f"),r&&(h.s=r),i&&(h.ls=i),a&&(h.ac=a),c&&(h.p=c),nL(t,eL,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,up.set("previous_websocket_failure",!0);try{let i;if((0,N.Yr)()){i={headers:{"User-Agent":`Firebase/5/${dM}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const c=process.env,h=0===this.connURL.indexOf("wss://")?c.HTTPS_PROXY||c.https_proxy:c.HTTP_PROXY||c.http_proxy;h&&(i.proxy={origin:h})}this.mySock=new pC(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==pC&&!n.forceDisallow_}static previouslyFailed(){return up.isInMemoryStorage||!0===up.get("previous_websocket_failure")}markConnectionHealthy(){up.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,N.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,N.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,N.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=G1(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),cL=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Od,m_]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=m_&&m_.isAvailable();let i=r&&!m_.previouslyFailed();if(t.webSocketOnly&&(r||us("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[m_];else{const a=this.transports_=[];for(const c of n.ALL_TRANSPORTS)c&&c.isAvailable()&&a.push(c);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class mL{constructor(e,t,r,i,a,c,h,m,w,T){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=m,this.onKill_=w,this.lastSessionId=T,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=c0("c:"+this.id+":"),this.transportManager_=new cL(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=d0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=l0("t",e),r=l0("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=l0("t",e),r=l0("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=l0("t",e);if("d"in e){const r=e.d;if("h"===t){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?fM("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):fM("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&us("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),d0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):d0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(up.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class _L{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class yL{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,N.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,N.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class gC extends yL{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,N.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new gC}getInitialEvent(e){return(0,N.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const vL=32,wL=768;class Vn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Pn(){return new Vn("")}function gn(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Ld(n){return n.pieces_.length-n.pieceNum_}function Xn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Vn(n.pieces_,e)}function IM(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function f0(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function EL(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Vn(e,0)}function Ir(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Vn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Vn(t,0)}function mn(n){return n.pieceNum_>=n.pieces_.length}function Ds(n,e){const t=gn(n),r=gn(e);if(null===t)return e;if(t===r)return Ds(Xn(n),Xn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function qj(n,e){const t=f0(n,0),r=f0(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=lp(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function TM(n,e){if(Ld(n)!==Ld(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Wo(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Ld(n)>Ld(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class Kj{constructor(e,t){this.errorPrefix_=t,this.parts_=f0(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,N.ug)(this.parts_[r]);IL(this)}}function IL(n){if(n.byteLength_>wL)throw new Error(n.errorPrefix_+"has a key path longer than "+wL+" bytes ("+n.byteLength_+").");if(n.parts_.length>vL)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+vL+") or object contains a cycle "+dp(n))}function dp(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class bM extends yL{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new bM}getInitialEvent(e){return(0,N.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const p0=1e3;let _C,hp=(()=>{class n extends _L{constructor(t,r,i,a,c,h,m,w){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=c,this.authTokenProvider_=h,this.appCheckTokenProvider_=m,this.authOverride_=w,this.id=n.nextPersistentConnectionId_++,this.log_=c0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=p0,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,w&&!(0,N.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");bM.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&gC.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,c={r:a,a:t,b:r};this.log_((0,N.Wl)(c)),(0,N.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(c),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new N.BH,a={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:h=>{const m=h.d;"ok"===h.s?r.resolve(m):r.reject(m)}};return this.outstandingGets_.push(a),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const c=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+c),this.listens.has(h)||this.listens.set(h,new Map),(0,N.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,N.hu)(!this.listens.get(h).has(c),"listen() called twice for same path/queryId.");const m={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(h).set(c,m),this.connected_&&this.sendListen_(m)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const c={p:i};t.tag&&(c.q=r._queryObject,c.t=t.tag),c.h=t.hashFn(),this.sendRequest("q",c,m=>{const w=m.d,T=m.s;n.warnOnListenWarnings_(w,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",m),"ok"!==T&&this.removeListen_(i,a),t.onComplete&&t.onComplete(T,w))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,N.r3)(t,"w")){const i=(0,N.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',c=r._path.toString();us(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${c} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,N.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,N.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const c=a.s,h=a.d||"error";this.authToken_===t&&("ok"===c?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(c,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,N.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const c={p:t};a&&(c.q=i,c.t=a),this.sendRequest("n",c)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const c={p:r,d:i};this.log_("onDisconnect "+t,c),this.sendRequest(t,c,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,c){this.initConnection_();const h={p:r,d:i};void 0!==c&&(h.h=c),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,c=>{this.log_(r+" response",c),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(c.s,c.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,N.Wl)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):fM("Unrecognized action received from server: "+(0,N.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,N.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=p0,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=p0,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=p0),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,me.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),c=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let m=!1,w=null;const T=function(){w?w.close():(m=!0,a())};t.realtime_={close:T,sendRequest:function(F){(0,N.hu)(w,"sendRequest call when we're not connected not allowed."),w.sendRequest(F)}};const x=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[F,$]=yield Promise.all([t.authTokenProvider_.getToken(x),t.appCheckTokenProvider_.getToken(x)]);m?xi("getToken() completed but was canceled"):(xi("getToken() completed. Creating connection."),t.authToken_=F&&F.accessToken,t.appCheckToken_=$&&$.token,w=new mL(c,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,ee=>{us(ee+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch(F){t.log_("Failed to get token: "+F),m||(t.repoInfo_.nodeAdmin&&us(F),T())}}})()}interrupt(t){xi("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){xi("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,N.xb)(this.interruptReasons_)&&(this.reconnectDelay_=p0,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(c=>pM(c)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new Vn(t).toString();let a;if(this.listens.has(i)){const c=this.listens.get(i);a=c.get(r),c.delete(r),0===c.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){xi("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){xi("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,N.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+dM.replace(/\./g,"-")]=1,(0,N.uI)()?t["framework.cordova"]=1:(0,N.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=gC.getInstance().currentlyOnline();return(0,N.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class yn{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new yn(e,t)}}class mC{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new yn(kd,e),i=new yn(kd,t);return 0!==this.compare(r,i)}minPost(){return yn.MIN}}class CL extends mC{static get __EMPTY_NODE(){return _C}static set __EMPTY_NODE(e){_C=e}compare(e,t){return lp(e.name,t.name)}isDefinedOn(e){throw(0,N.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return yn.MIN}maxPost(){return new yn(Wc,_C)}makePost(e,t){return(0,N.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new yn(e,_C)}toString(){return".key"}}const ku=new CL;class yC{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(c=t?r(e.key,t):1,i&&(c*=-1),c<0)e=this.isReverse_?e.left:e.right;else{if(0===c){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let DM,Ua=(()=>{class n{constructor(t,r,i,a,c){this.key=t,this.value=r,this.color=i??n.RED,this.left=a??$s.EMPTY_NODE,this.right=c??$s.EMPTY_NODE}copy(t,r,i,a,c){return new n(t??this.key,r??this.value,i??this.color,a??this.left,c??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const c=i(t,a.key);return a=c<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===c?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return $s.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return $s.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class $s{constructor(e,t=$s.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new $s(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ua.BLACK,null,null))}remove(e){return new $s(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ua.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new yC(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new yC(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new yC(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new yC(this.root_,null,this.comparator_,!0,e)}}function n$(n,e){return lp(n.name,e.name)}function CM(n,e){return lp(n,e)}$s.EMPTY_NODE=new class t${copy(e,t,r,i,a){return this}insert(e,t,r){return new Ua(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const DL=function(n){return"number"==typeof n?"number:"+z1(n):"string:"+n},SL=function(n){if(n.isLeafNode()){const e=n.val();(0,N.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,N.r3)(e,".sv"),"Priority must be a string or number.")}else(0,N.hu)(n===DM||n.isEmpty(),"priority of unexpected type.");(0,N.hu)(n===DM||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let AL,RL,xL,__=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,N.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),SL(this.priorityNode_)}static set __childrenNodeConstructor(t){AL=t}static get __childrenNodeConstructor(){return AL}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return mn(t)?this:".priority"===gn(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=gn(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,N.hu)(".priority"!==i||1===Ld(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Xn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+DL(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?z1(this.value_):this.value_,this.lazyHash_=j1(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,N.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),c=n.VALUE_TYPE_ORDER.indexOf(i);return(0,N.hu)(a>=0,"Unknown leaf type: "+r),(0,N.hu)(c>=0,"Unknown leaf type: "+i),a===c?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:c-a}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const rr=new class o$ extends mC{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?lp(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return yn.MIN}maxPost(){return new yn(Wc,new __("[PRIORITY-POST]",xL))}makePost(e,t){const r=RL(e);return new yn(t,new __("[PRIORITY-POST]",r))}toString(){return".priority"}},a$=Math.log(2);class u${constructor(e){this.count=parseInt(Math.log(e+1)/a$,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const vC=function(n,e,t,r){n.sort(e);const i=function(m,w){const T=w-m;let D,x;if(0===T)return null;if(1===T)return D=n[m],x=t?t(D):D,new Ua(x,D.node,Ua.BLACK,null,null);{const F=parseInt(T/2,10)+m,$=i(m,F),ee=i(F+1,w);return D=n[F],x=t?t(D):D,new Ua(x,D.node,Ua.BLACK,$,ee)}},h=function(m){let w=null,T=null,D=n.length;const x=function($,ee){const se=D-$,ht=D;D-=$;const vt=i(se+1,ht),dt=n[se],It=t?t(dt):dt;F(new Ua(It,dt.node,ee,null,vt))},F=function($){w?(w.left=$,w=$):(T=$,w=$)};for(let $=0;$<m.count;++$){const ee=m.nextBitIsOne(),se=Math.pow(2,m.count-($+1));ee?x(se,Ua.BLACK):(x(se,Ua.BLACK),x(se,Ua.RED))}return T}(new u$(n.length));return new $s(r||e,h)};let SM;const y_={};class qc{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,N.hu)(y_&&rr,"ChildrenNode.ts has not been loaded"),SM=SM||new qc({".priority":y_},{".priority":rr}),SM}get(e){const t=(0,N.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof $s?t:null}hasIndex(e){return(0,N.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,N.hu)(e!==ku,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(yn.Wrap);let h,c=a.getNext();for(;c;)i=i||e.isDefinedOn(c.node),r.push(c),c=a.getNext();h=i?vC(r,e.getCompare()):y_;const m=e.toString(),w=Object.assign({},this.indexSet_);w[m]=e;const T=Object.assign({},this.indexes_);return T[m]=h,new qc(T,w)}addToIndexes(e,t){const r=(0,N.UI)(this.indexes_,(i,a)=>{const c=(0,N.DV)(this.indexSet_,a);if((0,N.hu)(c,"Missing index implementation for "+a),i===y_){if(c.isDefinedOn(e.node)){const h=[],m=t.getIterator(yn.Wrap);let w=m.getNext();for(;w;)w.name!==e.name&&h.push(w),w=m.getNext();return h.push(e),vC(h,c.getCompare())}return y_}{const h=t.get(e.name);let m=i;return h&&(m=m.remove(new yn(e.name,h))),m.insert(e,e.node)}});return new qc(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,N.UI)(this.indexes_,i=>{if(i===y_)return i;{const a=t.get(e.name);return a?i.remove(new yn(e.name,a)):i}});return new qc(r,this.indexSet_)}}let g0,an=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&SL(this.priorityNode_),this.children_.isEmpty()&&(0,N.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return g0||(g0=new n(new $s(CM),null,qc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||g0}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?g0:r}}getChild(t){const r=gn(t);return null===r?this:this.getImmediateChild(r).getChild(Xn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,N.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new yn(t,r);let a,c;r.isEmpty()?(a=this.children_.remove(t),c=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),c=this.indexMap_.addToIndexes(i,this.children_));const h=a.isEmpty()?g0:this.priorityNode_;return new n(a,h,c)}}updateChild(t,r){const i=gn(t);if(null===i)return r;{(0,N.hu)(".priority"!==gn(t)||1===Ld(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(Xn(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,c=!0;if(this.forEachChild(rr,(h,m)=>{r[h]=m.val(t),i++,c&&n.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):c=!1}),!t&&c&&a<2*i){const h=[];for(const m in r)h[m]=r[m];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+DL(this.getPriority().val())+":"),this.forEachChild(rr,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":j1(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const c=a.getPredecessorKey(new yn(t,r));return c?c.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new yn(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new yn(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,yn.Wrap);let c=a.peek();for(;null!=c&&r.compare(c,t)<0;)a.getNext(),c=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,yn.Wrap);let c=a.peek();for(;null!=c&&r.compare(c,t)>0;)a.getNext(),c=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===m0?-1:0}withIndex(t){if(t===ku||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ku||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(rr),a=r.getIterator(rr);let c=i.getNext(),h=a.getNext();for(;c&&h;){if(c.name!==h.name||!c.node.equals(h.node))return!1;c=i.getNext(),h=a.getNext()}return null===c&&null===h}return!1}return!1}}resolveIndex_(t){return t===ku?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const m0=new class c$ extends an{constructor(){super(new $s(CM),an.EMPTY_NODE,qc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return an.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(yn,{MIN:{value:new yn(kd,an.EMPTY_NODE)},MAX:{value:new yn(Wc,m0)}}),CL.__EMPTY_NODE=an.EMPTY_NODE,__.__childrenNodeConstructor=an,function r$(n){DM=n}(m0),function s$(n){xL=n}(m0);const l$=!0;function Mr(n,e=null){if(null===n)return an.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,N.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new __(n,Mr(e));if(n instanceof Array||!l$){let t=an.EMPTY_NODE;return Mi(n,(r,i)=>{if((0,N.r3)(n,r)&&"."!==r.substring(0,1)){const a=Mr(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(Mr(e))}{const t=[];let r=!1;if(Mi(n,(c,h)=>{if("."!==c.substring(0,1)){const m=Mr(h);m.isEmpty()||(r=r||!m.getPriority().isEmpty(),t.push(new yn(c,m)))}}),0===t.length)return an.EMPTY_NODE;const a=vC(t,n$,c=>c.name,CM);if(r){const c=vC(t,rr.getCompare());return new an(a,Mr(e),new qc({".priority":c},{".priority":rr}))}return new an(a,Mr(e),qc.Default)}}!function i$(n){RL=n}(Mr);class AM extends mC{constructor(e){super(),this.indexPath_=e,(0,N.hu)(!mn(e)&&".priority"!==gn(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?lp(e.name,t.name):a}makePost(e,t){const r=Mr(e),i=an.EMPTY_NODE.updateChild(this.indexPath_,r);return new yn(t,i)}maxPost(){const e=an.EMPTY_NODE.updateChild(this.indexPath_,m0);return new yn(Wc,e)}toString(){return f0(this.indexPath_,0).join("/")}}const RM=new class d$ extends mC{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?lp(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return yn.MIN}maxPost(){return yn.MAX}makePost(e,t){const r=Mr(e);return new yn(t,r)}toString(){return".value"}};function ML(n){return{type:"value",snapshotNode:n}}function v_(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function _0(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function y0(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class xM{constructor(e){this.index_=e}updateChild(e,t,r,i,a,c){(0,N.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(i).equals(r.getChild(i))&&h.isEmpty()===r.isEmpty()||(null!=c&&(r.isEmpty()?e.hasChild(t)?c.trackChildChange(_0(t,h)):(0,N.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?c.trackChildChange(v_(t,r)):c.trackChildChange(y0(t,r,h))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(rr,(i,a)=>{t.hasChild(i)||r.trackChildChange(_0(i,a))}),t.isLeafNode()||t.forEachChild(rr,(i,a)=>{if(e.hasChild(i)){const c=e.getImmediateChild(i);c.equals(a)||r.trackChildChange(y0(i,a,c))}else r.trackChildChange(v_(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?an.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class v0{constructor(e){this.indexedFilter_=new xM(e.getIndex()),this.index_=e.getIndex(),this.startPost_=v0.getStartPost_(e),this.endPost_=v0.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,a,c){return this.matches(new yn(t,r))||(r=an.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,c)}updateFullNode(e,t,r){t.isLeafNode()&&(t=an.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(an.EMPTY_NODE);const a=this;return t.forEachChild(rr,(c,h)=>{a.matches(new yn(c,h))||(i=i.updateImmediateChild(c,an.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class f${constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new v0(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,a,c){return this.rangedFilter_.matches(new yn(t,r))||(r=an.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,c):this.fullLimitUpdateChild_(e,t,r,a,c)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=an.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=an.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;a.hasNext()&&c<this.limit_;){const h=a.getNext();if(this.withinDirectionalStart(h)){if(!this.withinDirectionalEnd(h))break;i=i.updateImmediateChild(h.name,h.node),c++}}}else{let a;i=t.withIndex(this.index_),i=i.updatePriority(an.EMPTY_NODE),a=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let c=0;for(;a.hasNext();){const h=a.getNext();c<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?c++:i=i.updateImmediateChild(h.name,an.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let c;if(this.reverse_){const D=this.index_.getCompare();c=(x,F)=>D(F,x)}else c=this.index_.getCompare();const h=e;(0,N.hu)(h.numChildren()===this.limit_,"");const m=new yn(t,r),w=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),T=this.rangedFilter_.matches(m);if(h.hasChild(t)){const D=h.getImmediateChild(t);let x=i.getChildAfterChild(this.index_,w,this.reverse_);for(;null!=x&&(x.name===t||h.hasChild(x.name));)x=i.getChildAfterChild(this.index_,x,this.reverse_);const F=null==x?1:c(x,m);if(T&&!r.isEmpty()&&F>=0)return a?.trackChildChange(y0(t,r,D)),h.updateImmediateChild(t,r);{a?.trackChildChange(_0(t,D));const ee=h.updateImmediateChild(t,an.EMPTY_NODE);return null!=x&&this.rangedFilter_.matches(x)?(a?.trackChildChange(v_(x.name,x.node)),ee.updateImmediateChild(x.name,x.node)):ee}}return r.isEmpty()?e:T&&c(w,m)>=0?(null!=a&&(a.trackChildChange(_0(w.name,w.node)),a.trackChildChange(v_(t,r))),h.updateImmediateChild(t,r).updateImmediateChild(w.name,an.EMPTY_NODE)):e}}class wC{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=rr}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,N.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,N.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:kd}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,N.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,N.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Wc}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,N.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===rr}copy(){const e=new wC;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function MM(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function NM(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function EC(n,e){const t=n.copy();return t.index_=e,t}function NL(n){const e={};if(n.isDefault())return e;let t;if(n.index_===rr?t="$priority":n.index_===RM?t="$value":n.index_===ku?t="$key":((0,N.hu)(n.index_ instanceof AM,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,N.Wl)(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=(0,N.Wl)(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+(0,N.Wl)(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=(0,N.Wl)(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+(0,N.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function PL(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==rr&&(e.i=n.index_.toString()),e}class IC extends _L{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=c0("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,N.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const c=IC.getListenId_(e,r),h={};this.listens_[c]=h;const m=NL(e._queryParams);this.restRequest_(a+".json",m,(w,T)=>{let D=T;if(404===w&&(D=null,w=null),null===w&&this.onDataUpdate_(a,D,!1,r),(0,N.DV)(this.listens_,c)===h){let x;x=w?401===w?"permission_denied":"rest_error:"+w:"ok",i(x,null)}})}unlisten(e,t){const r=IC.getListenId_(e,t);delete this.listens_[r]}get(e){const t=NL(e._queryParams),r=e._path.toString(),i=new N.BH;return this.restRequest_(r+".json",t,(a,c)=>{let h=c;404===a&&(h=null,a=null),null===a?(this.onDataUpdate_(r,h,!1,null),i.resolve(h)):i.reject(new Error(h))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,N.xO)(t);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let m=null;if(h.status>=200&&h.status<300){try{m=(0,N.cI)(h.responseText)}catch{us("Failed to parse JSON response for "+c+": "+h.responseText)}r(null,m)}else 401!==h.status&&404!==h.status&&us("Got unsuccessful REST response for "+c+" Status: "+h.status),r(h.status);r=null}},h.open("GET",c,!0),h.send()})}}class v${constructor(){this.rootNode_=an.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function TC(){return{value:null,children:new Map}}function w_(n,e,t){if(mn(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=gn(e);n.children.has(r)||n.children.set(r,TC()),w_(n.children.get(r),e=Xn(e),t)}}function PM(n,e){if(mn(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(rr,(r,i)=>{w_(n,new Vn(r),i)}),PM(n,e)}}if(n.children.size>0){const t=gn(e);return e=Xn(e),n.children.has(t)&&PM(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function kM(n,e,t){null!==n.value?t(e,n.value):function w$(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{kM(i,new Vn(e.toString()+"/"+r),t)})}class E${constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Mi(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class b${constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new E$(e);const r=1e4+2e4*Math.random();d0(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Mi(e,(i,a)=>{a>0&&(0,N.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),d0(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var qo=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(qo||(qo={})),qo))();function FM(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class bC{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=qo.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(mn(this.path)){if(null!=this.affectedTree.value)return(0,N.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Vn(e));return new bC(Pn(),t,this.revert)}}return(0,N.hu)(gn(this.path)===e,"operationForChild called for unrelated child."),new bC(Xn(this.path),this.affectedTree,this.revert)}}class w0{constructor(e,t){this.source=e,this.path=t,this.type=qo.LISTEN_COMPLETE}operationForChild(e){return mn(this.path)?new w0(this.source,Pn()):new w0(this.source,Xn(this.path))}}class fp{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=qo.OVERWRITE}operationForChild(e){return mn(this.path)?new fp(this.source,Pn(),this.snap.getImmediateChild(e)):new fp(this.source,Xn(this.path),this.snap)}}class E_{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=qo.MERGE}operationForChild(e){if(mn(this.path)){const t=this.children.subtree(new Vn(e));return t.isEmpty()?null:t.value?new fp(this.source,Pn(),t.value):new E_(this.source,Pn(),t)}return(0,N.hu)(gn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new E_(this.source,Xn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Fd{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(mn(e))return this.isFullyInitialized()&&!this.filtered_;const t=gn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class C${constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function E0(n,e,t,r,i,a){const c=r.filter(h=>h.type===t);c.sort((h,m)=>function A$(n,e,t){if(null==e.childName||null==t.childName)throw(0,N.g5)("Should only compare child_ events.");const r=new yn(e.childName,e.snapshotNode),i=new yn(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,h,m)),c.forEach(h=>{const m=function S$(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,a);i.forEach(w=>{w.respondsTo(h.type)&&e.push(w.createEvent(m,n.query_))})})}function CC(n,e){return{eventCache:n,serverCache:e}}function I0(n,e,t,r){return CC(new Fd(e,t,r),n.serverCache)}function OL(n,e,t,r){return CC(n.eventCache,new Fd(e,t,r))}function DC(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function pp(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let UM;class ir{constructor(e,t=(()=>(UM||(UM=new $s(hj)),UM))()){this.value=e,this.children=t}static fromObject(e){let t=new ir(null);return Mi(e,(r,i)=>{t=t.set(new Vn(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Pn(),value:this.value};if(mn(e))return null;{const r=gn(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(Xn(e),t);return null!=a?{path:Ir(new Vn(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(mn(e))return this;{const t=gn(e),r=this.children.get(t);return null!==r?r.subtree(Xn(e)):new ir(null)}}set(e,t){if(mn(e))return new ir(t,this.children);{const r=gn(e),a=(this.children.get(r)||new ir(null)).set(Xn(e),t),c=this.children.insert(r,a);return new ir(this.value,c)}}remove(e){if(mn(e))return this.children.isEmpty()?new ir(null):new ir(null,this.children);{const t=gn(e),r=this.children.get(t);if(r){const i=r.remove(Xn(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new ir(null):new ir(this.value,a)}return this}}get(e){if(mn(e))return this.value;{const t=gn(e),r=this.children.get(t);return r?r.get(Xn(e)):null}}setTree(e,t){if(mn(e))return t;{const r=gn(e),a=(this.children.get(r)||new ir(null)).setTree(Xn(e),t);let c;return c=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new ir(this.value,c)}}fold(e){return this.fold_(Pn(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(Ir(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Pn(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(mn(e))return null;{const a=gn(e),c=this.children.get(a);return c?c.findOnPath_(Xn(e),Ir(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Pn(),t)}foreachOnPath_(e,t,r){if(mn(e))return this;{this.value&&r(t,this.value);const i=gn(e),a=this.children.get(i);return a?a.foreachOnPath_(Xn(e),Ir(t,i),r):new ir(null)}}foreach(e){this.foreach_(Pn(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Ir(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Va{constructor(e){this.writeTree_=e}static empty(){return new Va(new ir(null))}}function T0(n,e,t){if(mn(e))return new Va(new ir(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const c=Ds(i,e);return a=a.updateChild(c,t),new Va(n.writeTree_.set(i,a))}{const i=new ir(t),a=n.writeTree_.setTree(e,i);return new Va(a)}}}function VM(n,e,t){let r=n;return Mi(t,(i,a)=>{r=T0(r,Ir(e,i),a)}),r}function LL(n,e){if(mn(e))return Va.empty();{const t=n.writeTree_.setTree(e,new ir(null));return new Va(t)}}function BM(n,e){return null!=gp(n,e)}function gp(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Ds(t.path,e)):null}function FL(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(rr,(r,i)=>{e.push(new yn(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new yn(r,i.value))}),e}function Ud(n,e){if(mn(e))return n;{const t=gp(n,e);return new Va(null!=t?new ir(t):n.writeTree_.subtree(e))}}function jM(n){return n.writeTree_.isEmpty()}function I_(n,e){return UL(Pn(),n.writeTree_,e)}function UL(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,N.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=UL(Ir(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Ir(n,".priority"),r)),t}}function SC(n,e){return HL(e,n)}function k$(n,e){if(n.snap)return Wo(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Wo(Ir(n.path,t),e))return!0;return!1}function L$(n){return n.visible}function VL(n,e,t){let r=Va.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const c=a.path;let h;if(a.snap)Wo(t,c)?(h=Ds(t,c),r=T0(r,h,a.snap)):Wo(c,t)&&(h=Ds(c,t),r=T0(r,Pn(),a.snap.getChild(h)));else{if(!a.children)throw(0,N.g5)("WriteRecord should have .snap or .children");if(Wo(t,c))h=Ds(t,c),r=VM(r,h,a.children);else if(Wo(c,t))if(h=Ds(c,t),mn(h))r=VM(r,Pn(),a.children);else{const m=(0,N.DV)(a.children,gn(h));if(m){const w=m.getChild(Xn(h));r=T0(r,Pn(),w)}}}}}return r}function BL(n,e,t,r,i){if(r||i){const a=Ud(n.visibleWrites,e);return!i&&jM(a)?t:i||null!=t||BM(a,Pn())?I_(VL(n.allWrites,function(w){return(w.visible||i)&&(!r||!~r.indexOf(w.writeId))&&(Wo(w.path,e)||Wo(e,w.path))},e),t||an.EMPTY_NODE):null}{const a=gp(n.visibleWrites,e);if(null!=a)return a;{const c=Ud(n.visibleWrites,e);return jM(c)?t:null!=t||BM(c,Pn())?I_(c,t||an.EMPTY_NODE):null}}}function AC(n,e,t,r){return BL(n.writeTree,n.treePath,e,t,r)}function $M(n,e){return function F$(n,e,t){let r=an.EMPTY_NODE;const i=gp(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(rr,(a,c)=>{r=r.updateImmediateChild(a,c)}),r;if(t){const a=Ud(n.visibleWrites,e);return t.forEachChild(rr,(c,h)=>{const m=I_(Ud(a,new Vn(c)),h);r=r.updateImmediateChild(c,m)}),FL(a).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}return FL(Ud(n.visibleWrites,e)).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}(n.writeTree,n.treePath,e)}function jL(n,e,t,r){return function U$(n,e,t,r,i){(0,N.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=Ir(e,t);if(BM(n.visibleWrites,a))return null;{const c=Ud(n.visibleWrites,a);return jM(c)?i.getChild(t):I_(c,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function RC(n,e){return function B$(n,e){return gp(n.visibleWrites,e)}(n.writeTree,Ir(n.treePath,e))}function HM(n,e,t){return function V$(n,e,t,r){const i=Ir(e,t),a=gp(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?I_(Ud(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function $L(n,e){return HL(Ir(n.treePath,e),n.writeTree)}function HL(n,e){return{treePath:n,writeTree:e}}class G${constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,N.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,N.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,y0(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,_0(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,v_(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,N.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,y0(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const GL=new class z${getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class GM{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Fd(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return HM(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:pp(this.viewCache_),a=function H$(n,e,t,r,i,a){return function j$(n,e,t,r,i,a,c){let h;const m=Ud(n.visibleWrites,e),w=gp(m,Pn());if(null!=w)h=w;else{if(null==t)return[];h=I_(m,t)}if(h=h.withIndex(c),h.isEmpty()||h.isLeafNode())return[];{const T=[],D=c.getCompare(),x=a?h.getReverseIteratorFrom(r,c):h.getIteratorFrom(r,c);let F=x.getNext();for(;F&&T.length<i;)0!==D(F,r)&&T.push(F),F=x.getNext();return T}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function zL(n,e,t,r,i,a){const c=e.eventCache;if(null!=RC(r,t))return e;{let h,m;if(mn(t))if((0,N.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const w=pp(e),D=$M(r,w instanceof an?w:an.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),D,a)}else{const w=AC(r,pp(e));h=n.filter.updateFullNode(e.eventCache.getNode(),w,a)}else{const w=gn(t);if(".priority"===w){(0,N.hu)(1===Ld(t),"Can't have a priority with additional path components");const T=c.getNode();m=e.serverCache.getNode();const D=jL(r,t,T,m);h=null!=D?n.filter.updatePriority(T,D):c.getNode()}else{const T=Xn(t);let D;if(c.isCompleteForChild(w)){m=e.serverCache.getNode();const x=jL(r,t,c.getNode(),m);D=null!=x?c.getNode().getImmediateChild(w).updateChild(T,x):c.getNode().getImmediateChild(w)}else D=HM(r,w,e.serverCache);h=null!=D?n.filter.updateChild(c.getNode(),w,D,T,i,a):c.getNode()}}return I0(e,h,c.isFullyInitialized()||mn(t),n.filter.filtersNodes())}}function xC(n,e,t,r,i,a,c,h){const m=e.serverCache;let w;const T=c?n.filter:n.filter.getIndexedFilter();if(mn(t))w=T.updateFullNode(m.getNode(),r,null);else if(T.filtersNodes()&&!m.isFiltered()){const F=m.getNode().updateChild(t,r);w=T.updateFullNode(m.getNode(),F,null)}else{const F=gn(t);if(!m.isCompleteForPath(t)&&Ld(t)>1)return e;const $=Xn(t),se=m.getNode().getImmediateChild(F).updateChild($,r);w=".priority"===F?T.updatePriority(m.getNode(),se):T.updateChild(m.getNode(),F,se,$,GL,null)}const D=OL(e,w,m.isFullyInitialized()||mn(t),T.filtersNodes());return zL(n,D,t,i,new GM(i,D,a),h)}function zM(n,e,t,r,i,a,c){const h=e.eventCache;let m,w;const T=new GM(i,e,a);if(mn(t))w=n.filter.updateFullNode(e.eventCache.getNode(),r,c),m=I0(e,w,!0,n.filter.filtersNodes());else{const D=gn(t);if(".priority"===D)w=n.filter.updatePriority(e.eventCache.getNode(),r),m=I0(e,w,h.isFullyInitialized(),h.isFiltered());else{const x=Xn(t),F=h.getNode().getImmediateChild(D);let $;if(mn(x))$=r;else{const ee=T.getCompleteChild(D);$=null!=ee?".priority"===IM(x)&&ee.getChild(EL(x)).isEmpty()?ee:ee.updateChild(x,r):an.EMPTY_NODE}m=F.equals($)?e:I0(e,n.filter.updateChild(h.getNode(),D,$,x,T,c),h.isFullyInitialized(),n.filter.filtersNodes())}}return m}function WL(n,e){return n.eventCache.isCompleteForChild(e)}function qL(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function WM(n,e,t,r,i,a,c,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let w,m=e;w=mn(t)?r:new ir(null).setTree(t,r);const T=e.serverCache.getNode();return w.children.inorderTraversal((D,x)=>{if(T.hasChild(D)){const $=qL(0,e.serverCache.getNode().getImmediateChild(D),x);m=xC(n,m,new Vn(D),$,i,a,c,h)}}),w.children.inorderTraversal((D,x)=>{const F=!e.serverCache.isCompleteForChild(D)&&null===x.value;if(!T.hasChild(D)&&!F){const ee=qL(0,e.serverCache.getNode().getImmediateChild(D),x);m=xC(n,m,new Vn(D),ee,i,a,c,h)}}),m}class eH{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new xM(r.getIndex()),a=function p$(n){return n.loadsAllData()?new xM(n.getIndex()):n.hasLimit()?new f$(n):new v0(n)}(r);this.processor_=function W$(n){return{filter:n}}(a);const c=t.serverCache,h=t.eventCache,m=i.updateFullNode(an.EMPTY_NODE,c.getNode(),null),w=a.updateFullNode(an.EMPTY_NODE,h.getNode(),null),T=new Fd(m,c.isFullyInitialized(),i.filtersNodes()),D=new Fd(w,h.isFullyInitialized(),a.filtersNodes());this.viewCache_=CC(D,T),this.eventGenerator_=new C$(this.query_)}get query(){return this.query_}}function rH(n,e){const t=pp(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!mn(e)&&!t.getImmediateChild(gn(e)).isEmpty())?t.getChild(e):null}function KL(n){return 0===n.eventRegistrations_.length}function ZL(n,e,t){const r=[];if(t){(0,N.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const c=a.createCancelEvent(t,i);c&&r.push(c)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const c=n.eventRegistrations_[a];if(c.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(c)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function YL(n,e,t,r){e.type===qo.MERGE&&null!==e.source.queryId&&((0,N.hu)(pp(n.viewCache_),"We should always have a full cache before handling merges"),(0,N.hu)(DC(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function K$(n,e,t,r,i){const a=new G$;let c,h;if(t.type===qo.OVERWRITE){const w=t;w.source.fromUser?c=zM(n,e,w.path,w.snap,r,i,a):((0,N.hu)(w.source.fromServer,"Unknown source."),h=w.source.tagged||e.serverCache.isFiltered()&&!mn(w.path),c=xC(n,e,w.path,w.snap,r,i,h,a))}else if(t.type===qo.MERGE){const w=t;w.source.fromUser?c=function Y$(n,e,t,r,i,a,c){let h=e;return r.foreach((m,w)=>{const T=Ir(t,m);WL(e,gn(T))&&(h=zM(n,h,T,w,i,a,c))}),r.foreach((m,w)=>{const T=Ir(t,m);WL(e,gn(T))||(h=zM(n,h,T,w,i,a,c))}),h}(n,e,w.path,w.children,r,i,a):((0,N.hu)(w.source.fromServer,"Unknown source."),h=w.source.tagged||e.serverCache.isFiltered(),c=WM(n,e,w.path,w.children,r,i,h,a))}else if(t.type===qo.ACK_USER_WRITE){const w=t;c=w.revert?function J$(n,e,t,r,i,a){let c;if(null!=RC(r,t))return e;{const h=new GM(r,e,i),m=e.eventCache.getNode();let w;if(mn(t)||".priority"===gn(t)){let T;if(e.serverCache.isFullyInitialized())T=AC(r,pp(e));else{const D=e.serverCache.getNode();(0,N.hu)(D instanceof an,"serverChildren would be complete if leaf node"),T=$M(r,D)}w=n.filter.updateFullNode(m,T,a)}else{const T=gn(t);let D=HM(r,T,e.serverCache);null==D&&e.serverCache.isCompleteForChild(T)&&(D=m.getImmediateChild(T)),w=null!=D?n.filter.updateChild(m,T,D,Xn(t),h,a):e.eventCache.getNode().hasChild(T)?n.filter.updateChild(m,T,an.EMPTY_NODE,Xn(t),h,a):m,w.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=AC(r,pp(e)),c.isLeafNode()&&(w=n.filter.updateFullNode(w,c,a)))}return c=e.serverCache.isFullyInitialized()||null!=RC(r,Pn()),I0(e,w,c,n.filter.filtersNodes())}}(n,e,w.path,r,i,a):function Q$(n,e,t,r,i,a,c){if(null!=RC(i,t))return e;const h=e.serverCache.isFiltered(),m=e.serverCache;if(null!=r.value){if(mn(t)&&m.isFullyInitialized()||m.isCompleteForPath(t))return xC(n,e,t,m.getNode().getChild(t),i,a,h,c);if(mn(t)){let w=new ir(null);return m.getNode().forEachChild(ku,(T,D)=>{w=w.set(new Vn(T),D)}),WM(n,e,t,w,i,a,h,c)}return e}{let w=new ir(null);return r.foreach((T,D)=>{const x=Ir(t,T);m.isCompleteForPath(x)&&(w=w.set(T,m.getNode().getChild(x)))}),WM(n,e,t,w,i,a,h,c)}}(n,e,w.path,w.affectedTree,r,i,a)}else{if(t.type!==qo.LISTEN_COMPLETE)throw(0,N.g5)("Unknown operation type: "+t.type);c=function X$(n,e,t,r,i){const a=e.serverCache;return zL(n,OL(e,a.getNode(),a.isFullyInitialized()||mn(t),a.isFiltered()),t,r,GL,i)}(n,e,t.path,r,a)}const m=a.getChanges();return function Z$(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=DC(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(ML(DC(e)))}}(e,c,m),{viewCache:c,changes:m}}(n.processor_,i,e,t,r);return function q$(n,e){(0,N.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,N.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,N.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,QL(n,a.changes,a.viewCache.eventCache.getNode(),null)}function QL(n,e,t,r){return function D$(n,e,t,r){const i=[],a=[];return e.forEach(c=>{"child_changed"===c.type&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&a.push(function h$(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(c.childName,c.snapshotNode))}),E0(n,i,"child_removed",e,r,t),E0(n,i,"child_added",e,r,t),E0(n,i,"child_moved",a,r,t),E0(n,i,"child_changed",e,r,t),E0(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let MC,PC;class XL{constructor(){this.views=new Map}}function qM(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,N.hu)(null!=a,"SyncTree gave us an op for an invalid query."),YL(a,e,t,r)}{let a=[];for(const c of n.views.values())a=a.concat(YL(c,e,t,r));return a}}function JL(n,e,t,r,i){const c=n.views.get(e._queryIdentifier);if(!c){let h=AC(t,i?r:null),m=!1;h?m=!0:r instanceof an?(h=$M(t,r),m=!1):(h=an.EMPTY_NODE,m=!1);const w=CC(new Fd(h,m,!1),new Fd(r,i,!1));return new eH(e,w)}return c}function eF(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Vd(n,e){let t=null;for(const r of n.views.values())t=t||rH(r,e);return t}function tF(n,e){return e._queryParams.loadsAllData()?NC(n):n.views.get(e._queryIdentifier)}function nF(n,e){return null!=tF(n,e)}function Bd(n){return null!=NC(n)}function NC(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let fH=1;class rF{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ir(null),this.pendingWriteTree_=function $$(){return{visibleWrites:Va.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function KM(n,e,t,r,i){return function x$(n,e,t,r,i){(0,N.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=T0(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?T_(n,new fp({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function jd(n,e,t=!1){const r=function N$(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function P$(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,N.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,c=n.allWrites.length-1;for(;i&&c>=0;){const h=n.allWrites[c];h.visible&&(c>=t&&k$(h,r.path)?i=!1:Wo(r.path,h.path)&&(a=!0)),c--}return!!i&&(a?(function O$(n){n.visibleWrites=VL(n.allWrites,L$,Pn()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=LL(n.visibleWrites,r.path):Mi(r.children,m=>{n.visibleWrites=LL(n.visibleWrites,Ir(r.path,m))}),!0))}(n.pendingWriteTree_,e)){let a=new ir(null);return null!=r.snap?a=a.set(Pn(),!0):Mi(r.children,c=>{a=a.set(new Vn(c),!0)}),T_(n,new bC(r.path,a,t))}return[]}function b0(n,e,t){return T_(n,new fp({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function kC(n,e,t,r,i=!1){const a=e._path,c=n.syncPointTree_.get(a);let h=[];if(c&&("default"===e._queryIdentifier||nF(c,e))){const m=function lH(n,e,t,r){const i=e._queryIdentifier,a=[];let c=[];const h=Bd(n);if("default"===i)for(const[m,w]of n.views.entries())c=c.concat(ZL(w,t,r)),KL(w)&&(n.views.delete(m),w.query._queryParams.loadsAllData()||a.push(w.query));else{const m=n.views.get(i);m&&(c=c.concat(ZL(m,t,r)),KL(m)&&(n.views.delete(i),m.query._queryParams.loadsAllData()||a.push(m.query)))}return h&&!Bd(n)&&a.push(new(function aH(){return(0,N.hu)(MC,"Reference.ts has not been loaded"),MC}())(e._repo,e._path)),{removed:a,events:c}}(c,e,t,r);(function uH(n){return 0===n.views.size})(c)&&(n.syncPointTree_=n.syncPointTree_.remove(a));const w=m.removed;if(h=m.events,!i){const T=-1!==w.findIndex(x=>x._queryParams.loadsAllData()),D=n.syncPointTree_.findOnPath(a,(x,F)=>Bd(F));if(T&&!D){const x=n.syncPointTree_.subtree(a);if(!x.isEmpty()){const F=function wH(n){return n.fold((e,t,r)=>{if(t&&Bd(t))return[NC(t)];{let i=[];return t&&(i=eF(t)),Mi(r,(a,c)=>{i=i.concat(c)}),i}})}(x);for(let $=0;$<F.length;++$){const ee=F[$],se=ee.query,ht=aF(n,ee);n.listenProvider_.startListening(D0(se),C0(n,se),ht.hashFn,ht.onComplete)}}}!D&&w.length>0&&!r&&(T?n.listenProvider_.stopListening(D0(e),null):w.forEach(x=>{const F=n.queryToTagMap.get(LC(x));n.listenProvider_.stopListening(D0(x),F)}))}!function EH(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=LC(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,w)}return h}function iF(n,e,t,r){const i=YM(n,r);if(null!=i){const a=QM(i),c=a.path,h=a.queryId,m=Ds(c,e);return XM(n,c,new fp(FM(h),m,t))}return[]}function ZM(n,e,t,r=!1){const i=e._path;let a=null,c=!1;n.syncPointTree_.foreachOnPath(i,(x,F)=>{const $=Ds(x,i);a=a||Vd(F,$),c=c||Bd(F)});let m,h=n.syncPointTree_.get(i);h?(c=c||Bd(h),a=a||Vd(h,Pn())):(h=new XL,n.syncPointTree_=n.syncPointTree_.set(i,h)),null!=a?m=!0:(m=!1,a=an.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((F,$)=>{const ee=Vd($,Pn());ee&&(a=a.updateImmediateChild(F,ee))}));const w=nF(h,e);if(!w&&!e._queryParams.loadsAllData()){const x=LC(e);(0,N.hu)(!n.queryToTagMap.has(x),"View does not exist, but we have a tag");const F=function IH(){return fH++}();n.queryToTagMap.set(x,F),n.tagToQueryMap.set(F,x)}let D=function cH(n,e,t,r,i,a){const c=JL(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),function iH(n,e){n.eventRegistrations_.push(e)}(c,t),function sH(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(rr,(a,c)=>{r.push(v_(a,c))}),t.isFullyInitialized()&&r.push(ML(t.getNode())),QL(n,r,t.getNode(),e)}(c,t)}(h,e,t,SC(n.pendingWriteTree_,i),a,m);if(!w&&!c&&!r){const x=tF(h,e);D=D.concat(function TH(n,e,t){const r=e._path,i=C0(n,e),a=aF(n,t),c=n.listenProvider_.startListening(D0(e),i,a.hashFn,a.onComplete),h=n.syncPointTree_.subtree(r);if(i)(0,N.hu)(!Bd(h.value),"If we're adding a query, it shouldn't be shadowed");else{const m=h.fold((w,T,D)=>{if(!mn(w)&&T&&Bd(T))return[NC(T).query];{let x=[];return T&&(x=x.concat(eF(T).map(F=>F.query))),Mi(D,(F,$)=>{x=x.concat($)}),x}});for(let w=0;w<m.length;++w){const T=m[w];n.listenProvider_.stopListening(D0(T),C0(n,T))}}return c}(n,e,x))}return D}function OC(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(c,h)=>{const w=Vd(h,Ds(c,e));if(w)return w});return BL(i,e,a,t,!0)}function T_(n,e){return sF(e,n.syncPointTree_,null,SC(n.pendingWriteTree_,Pn()))}function sF(n,e,t,r){if(mn(n.path))return oF(n,e,t,r);{const i=e.get(Pn());null==t&&null!=i&&(t=Vd(i,Pn()));let a=[];const c=gn(n.path),h=n.operationForChild(c),m=e.children.get(c);if(m&&h){const w=t?t.getImmediateChild(c):null,T=$L(r,c);a=a.concat(sF(h,m,w,T))}return i&&(a=a.concat(qM(i,n,r,t))),a}}function oF(n,e,t,r){const i=e.get(Pn());null==t&&null!=i&&(t=Vd(i,Pn()));let a=[];return e.children.inorderTraversal((c,h)=>{const m=t?t.getImmediateChild(c):null,w=$L(r,c),T=n.operationForChild(c);T&&(a=a.concat(oF(T,h,m,w)))}),i&&(a=a.concat(qM(i,n,r,t))),a}function aF(n,e){const t=e.query,r=C0(n,t);return{hashFn:()=>(function tH(n){return n.viewCache_.serverCache.getNode()}(e)||an.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function _H(n,e,t){const r=YM(n,t);if(r){const i=QM(r),a=i.path,c=i.queryId,h=Ds(a,e);return XM(n,a,new w0(FM(c),h))}return[]}(n,t._path,r):function mH(n,e){return T_(n,new w0({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function gj(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return kC(n,t,null,a)}}}}function C0(n,e){const t=LC(e);return n.queryToTagMap.get(t)}function LC(n){return n._path.toString()+"$"+n._queryIdentifier}function YM(n,e){return n.tagToQueryMap.get(e)}function QM(n){const e=n.indexOf("$");return(0,N.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Vn(n.substr(0,e))}}function XM(n,e,t){const r=n.syncPointTree_.get(e);return(0,N.hu)(r,"Missing sync point for query tag that we're tracking"),qM(r,t,SC(n.pendingWriteTree_,e),null)}function D0(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function hH(){return(0,N.hu)(PC,"Reference.ts has not been loaded"),PC}())(n._repo,n._path):n}class JM{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new JM(t)}node(){return this.node_}}class eN{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ir(this.path_,e);return new eN(this.syncTree_,t)}node(){return OC(this.syncTree_,this.path_)}}const bH=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},uF=function(n,e,t){return n&&"object"==typeof n?((0,N.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?CH(n[".sv"],e,t):"object"==typeof n[".sv"]?DH(n[".sv"],e):void(0,N.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},CH=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,N.hu)(!1,"Unexpected server value: "+n)},DH=function(n,e,t){n.hasOwnProperty("increment")||(0,N.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,N.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,N.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const c=i.getValue();return"number"!=typeof c?r:c+r},cF=function(n,e,t,r){return nN(e,new eN(t,n),r)},tN=function(n,e,t){return nN(n,new JM(e),t)};function nN(n,e,t){const r=n.getPriority().val(),i=uF(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const c=n,h=uF(c.getValue(),e,t);return h!==c.getValue()||i!==c.getPriority().val()?new __(h,Mr(i)):n}{const c=n;return a=c,i!==c.getPriority().val()&&(a=a.updatePriority(new __(i))),c.forEachChild(rr,(h,m)=>{const w=nN(m,e.getImmediateChild(h),t);w!==m&&(a=a.updateImmediateChild(h,w))}),a}}class rN{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function FC(n,e){let t=e instanceof Vn?e:new Vn(e),r=n,i=gn(t);for(;null!==i;){const a=(0,N.DV)(r.node.children,i)||{children:{},childCount:0};r=new rN(i,r,a),t=Xn(t),i=gn(t)}return r}function mp(n){return n.node.value}function iN(n,e){n.node.value=e,sN(n)}function lF(n){return n.node.childCount>0}function UC(n,e){Mi(n.node.children,(t,r)=>{e(new rN(t,n,r))})}function dF(n,e,t,r){t&&!r&&e(n),UC(n,i=>{dF(i,e,!0,r)}),t&&r&&e(n)}function S0(n){return new Vn(null===n.parent?n.name:S0(n.parent)+"/"+n.name)}function sN(n){null!==n.parent&&function RH(n,e,t){const r=function SH(n){return void 0===mp(n)&&!lF(n)}(t),i=(0,N.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,sN(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,sN(n))}(n.parent,n.name,n)}const xH=/[\[\].#$\/\u0000-\u001F\u007F]/,MH=/[\[\].#$\u0000-\u001F\u007F]/,oN=10485760,VC=function(n){return"string"==typeof n&&0!==n.length&&!xH.test(n)},hF=function(n){return"string"==typeof n&&0!==n.length&&!MH.test(n)},A0=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!hC(n)||n&&"object"==typeof n&&(0,N.r3)(n,".sv")},Ou=function(n,e,t,r){r&&void 0===e||R0((0,N.gK)(n,"value"),e,t)},R0=function(n,e,t){const r=t instanceof Vn?new Kj(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+dp(r));if("function"==typeof e)throw new Error(n+"contains a function "+dp(r)+" with contents = "+e.toString());if(hC(e))throw new Error(n+"contains "+e.toString()+" "+dp(r));if("string"==typeof e&&e.length>oN/3&&(0,N.ug)(e)>oN)throw new Error(n+"contains a string greater than "+oN+" utf8 bytes "+dp(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(Mi(e,(c,h)=>{if(".value"===c)i=!0;else if(".priority"!==c&&".sv"!==c&&(a=!0,!VC(c)))throw new Error(n+" contains an invalid key ("+c+") "+dp(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Zj(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,N.ug)(e),IL(n)})(r,c),R0(n,h,r),function Yj(n){const e=n.parts_.pop();n.byteLength_-=(0,N.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+dp(r)+" in addition to actual children.")}},fF=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,N.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];Mi(e,(c,h)=>{const m=new Vn(c);if(R0(i,h,Ir(t,m)),".priority"===IM(m)&&!A0(h))throw new Error(i+"contains an invalid value for '"+m.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(m)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=f0(r);for(let c=0;c<a.length;c++)if((".priority"!==a[c]||c!==a.length-1)&&!VC(a[c]))throw new Error(n+"contains an invalid key ("+a[c]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(qj);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&Wo(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},aN=function(n,e,t){if(!t||void 0!==e){if(hC(e))throw new Error((0,N.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!A0(e))throw new Error((0,N.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},x0=function(n,e,t,r){if(!(r&&void 0===t||VC(t)))throw new Error((0,N.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},M0=function(n,e,t,r){if(!(r&&void 0===t||hF(t)))throw new Error((0,N.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},kH=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),M0(n,e,t,r)},Ko=function(n,e){if(".info"===gn(e))throw new Error(n+" failed = Can't modify data under /.info/")},pF=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!VC(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),hF(n)}(t))throw new Error((0,N.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class OH{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function BC(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!TM(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function gF(n,e,t){BC(n,t),mF(n,r=>TM(r,e))}function fo(n,e,t){BC(n,t),mF(n,r=>Wo(r,e)||Wo(e,r))}function mF(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(LH(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function LH(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();cp&&xi("event: "+t.toString()),g_(r)}}}const _F="repo_interrupt",FH=25;class UH{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new OH,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=TC(),this.transactionQueueTree_=new rN,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function yF(n){const t=n.infoData_.getNode(new Vn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function N0(n){return bH({timestamp:yF(n)})}function vF(n,e,t,r,i){n.dataUpdateCount++;const a=new Vn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(i)if(r){const m=(0,N.UI)(t,w=>Mr(w));c=function yH(n,e,t,r){const i=YM(n,r);if(i){const a=QM(i),c=a.path,h=a.queryId,m=Ds(c,e),w=ir.fromObject(t);return XM(n,c,new E_(FM(h),m,w))}return[]}(n.serverSyncTree_,a,m,i)}else{const m=Mr(t);c=iF(n.serverSyncTree_,a,m,i)}else if(r){const m=(0,N.UI)(t,w=>Mr(w));c=function gH(n,e,t){const r=ir.fromObject(t);return T_(n,new E_({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,m)}else{const m=Mr(t);c=b0(n.serverSyncTree_,a,m)}let h=a;c.length>0&&(h=C_(n,a)),fo(n.eventQueue_,h,c)}function wF(n,e){uN(n,"connected",e),!1===e&&function HH(n){b_(n,"onDisconnectEvents");const e=N0(n),t=TC();kM(n.onDisconnect_,Pn(),(i,a)=>{const c=cF(i,a,n.serverSyncTree_,e);w_(t,i,c)});let r=[];kM(t,Pn(),(i,a)=>{r=r.concat(b0(n.serverSyncTree_,i,a));const c=hN(n,i);C_(n,c)}),n.onDisconnect_=TC(),fo(n.eventQueue_,Pn(),r)}(n)}function uN(n,e,t){const r=new Vn("/.info/"+e),i=Mr(t);n.infoData_.updateSnapshot(r,i);const a=b0(n.infoSyncTree_,r,i);fo(n.eventQueue_,r,a)}function jC(n){return n.nextWriteId_++}function cN(n,e,t,r,i){b_(n,"set",{path:e.toString(),value:t,priority:r});const a=N0(n),c=Mr(t,r),h=OC(n.serverSyncTree_,e),m=tN(c,h,a),w=jC(n),T=KM(n.serverSyncTree_,e,m,w,!0);BC(n.eventQueue_,T),n.server_.put(e.toString(),c.val(!0),(x,F)=>{const $="ok"===x;$||us("set at "+e+" failed: "+x);const ee=jd(n.serverSyncTree_,w,!$);fo(n.eventQueue_,e,ee),$d(0,i,x,F)});const D=hN(n,e);C_(n,D),fo(n.eventQueue_,D,[])}function GH(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&PM(n.onDisconnect_,e),$d(0,t,r,i)})}function EF(n,e,t,r){const i=Mr(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,c)=>{"ok"===a&&w_(n.onDisconnect_,e,i),$d(0,r,a,c)})}function lN(n,e,t){let r;r=".info"===gn(e._path)?kC(n.infoSyncTree_,e,t):kC(n.serverSyncTree_,e,t),gF(n.eventQueue_,e._path,r)}function IF(n){n.persistentConnection_&&n.persistentConnection_.interrupt(_F)}function b_(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),xi(t,...e)}function $d(n,e,t,r){e&&g_(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const c=new Error(a);c.code=i,e(c)}})}function dN(n,e,t){return OC(n.serverSyncTree_,e,t)||an.EMPTY_NODE}function $C(n,e=n.transactionQueueTree_){if(e||HC(n,e),mp(e)){const t=bF(n,e);(0,N.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function YH(n,e,t){const r=t.map(w=>w.currentWriteId),i=dN(n,e,r);let a=i;const c=i.hash();for(let w=0;w<t.length;w++){const T=t[w];(0,N.hu)(0===T.status,"tryToSendTransactionQueue_: items in queue should all be run."),T.status=1,T.retryCount++;const D=Ds(e,T.path);a=a.updateChild(D,T.currentOutputSnapshotRaw)}const h=a.val(!0),m=e;n.server_.put(m.toString(),h,w=>{b_(n,"transaction put response",{path:m.toString(),status:w});let T=[];if("ok"===w){const D=[];for(let x=0;x<t.length;x++)t[x].status=2,T=T.concat(jd(n.serverSyncTree_,t[x].currentWriteId)),t[x].onComplete&&D.push(()=>t[x].onComplete(null,!0,t[x].currentOutputSnapshotResolved)),t[x].unwatcher();HC(n,FC(n.transactionQueueTree_,e)),$C(n,n.transactionQueueTree_),fo(n.eventQueue_,e,T);for(let x=0;x<D.length;x++)g_(D[x])}else{if("datastale"===w)for(let D=0;D<t.length;D++)t[D].status=3===t[D].status?4:0;else{us("transaction at "+m.toString()+" failed: "+w);for(let D=0;D<t.length;D++)t[D].status=4,t[D].abortReason=w}C_(n,e)}},c)}(n,S0(e),t)}else lF(e)&&UC(e,t=>{$C(n,t)})}function C_(n,e){const t=TF(n,e),r=S0(t);return function QH(n,e,t){if(0===e.length)return;const r=[];let i=[];const c=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const m=e[h],w=Ds(t,m.path);let D,T=!1;if((0,N.hu)(null!==w,"rerunTransactionsUnderNode_: relativePath should not be null."),4===m.status)T=!0,D=m.abortReason,i=i.concat(jd(n.serverSyncTree_,m.currentWriteId,!0));else if(0===m.status)if(m.retryCount>=FH)T=!0,D="maxretry",i=i.concat(jd(n.serverSyncTree_,m.currentWriteId,!0));else{const x=dN(n,m.path,c);m.currentInputSnapshot=x;const F=e[h].update(x.val());if(void 0!==F){R0("transaction failed: Data returned ",F,m.path);let $=Mr(F);"object"==typeof F&&null!=F&&(0,N.r3)(F,".priority")||($=$.updatePriority(x.getPriority()));const se=m.currentWriteId,ht=N0(n),vt=tN($,x,ht);m.currentOutputSnapshotRaw=$,m.currentOutputSnapshotResolved=vt,m.currentWriteId=jC(n),c.splice(c.indexOf(se),1),i=i.concat(KM(n.serverSyncTree_,m.path,vt,m.currentWriteId,m.applyLocally)),i=i.concat(jd(n.serverSyncTree_,se,!0))}else T=!0,D="nodata",i=i.concat(jd(n.serverSyncTree_,m.currentWriteId,!0))}fo(n.eventQueue_,t,i),i=[],T&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===D?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(D),!1,null)))}HC(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)g_(r[h]);$C(n,n.transactionQueueTree_)}(n,bF(n,t),r),r}function TF(n,e){let t,r=n.transactionQueueTree_;for(t=gn(e);null!==t&&void 0===mp(r);)r=FC(r,t),t=gn(e=Xn(e));return r}function bF(n,e){const t=[];return CF(n,e,t),t.sort((r,i)=>r.order-i.order),t}function CF(n,e,t){const r=mp(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);UC(e,i=>{CF(n,i,t)})}function HC(n,e){const t=mp(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,iN(e,t.length>0?t:void 0)}UC(e,r=>{HC(n,r)})}function hN(n,e){const t=S0(TF(n,e)),r=FC(n.transactionQueueTree_,e);return function AH(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{fN(n,i)}),fN(n,r),dF(r,i=>{fN(n,i)}),t}function fN(n,e){const t=mp(e);if(t){const r=[];let i=[],a=-1;for(let c=0;c<t.length;c++)3===t[c].status||(1===t[c].status?((0,N.hu)(a===c-1,"All SENT items should be at beginning of queue."),a=c,t[c].status=3,t[c].abortReason="set"):((0,N.hu)(0===t[c].status,"Unexpected transaction status in abort"),t[c].unwatcher(),i=i.concat(jd(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&r.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));-1===a?iN(e,void 0):t.length=a+1,fo(n.eventQueue_,S0(e),i);for(let c=0;c<r.length;c++)g_(r[c])}}const pN=function(n,e){const t=eG(n),r=t.namespace;return"firebase.com"===t.domain&&Pu(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Pu("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&us("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new mM(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new Vn(t.pathString)}},eG=function(n){let e="",t="",r="",i="",a="",c=!0,h="https",m=443;if("string"==typeof n){let w=n.indexOf("//");w>=0&&(h=n.substring(0,w-1),n=n.substring(w+2));let T=n.indexOf("/");-1===T&&(T=n.length);let D=n.indexOf("?");-1===D&&(D=n.length),e=n.substring(0,Math.min(T,D)),T<D&&(i=function XH(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(T,D)));const x=function JH(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):us(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,D)));w=e.indexOf(":"),w>=0?(c="https"===h||"wss"===h,m=parseInt(e.substring(w+1),10)):w=e.length;const F=e.slice(0,w);if("localhost"===F.toLowerCase())t="localhost";else if(F.split(".").length<=2)t=F;else{const $=e.indexOf(".");r=e.substring(0,$).toLowerCase(),t=e.substring($+1),a=r}"ns"in x&&(a=x.ns)}return{host:e,port:m,domain:t,subdomain:r,secure:c,scheme:h,pathString:i,namespace:a}},DF="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",tG=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=DF.charAt(t%64),t=Math.floor(t/64);(0,N.hu)(0===t,"Cannot push at time == 0");let c=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)c+=DF.charAt(e[i]);return(0,N.hu)(20===c.length,"nextPushId: Length should be 20."),c}}();class SF{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,N.Wl)(this.snapshot.exportVal())}}class AF{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class gN{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,N.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class RF{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new N.BH;return GH(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Ko("OnDisconnect.remove",this._path);const e=new N.BH;return EF(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Ko("OnDisconnect.set",this._path),Ou("OnDisconnect.set",e,this._path,!1);const t=new N.BH;return EF(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Ko("OnDisconnect.setWithPriority",this._path),Ou("OnDisconnect.setWithPriority",e,this._path,!1),aN("OnDisconnect.setWithPriority",t,!1);const r=new N.BH;return function zH(n,e,t,r,i){const a=Mr(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(c,h)=>{"ok"===c&&w_(n.onDisconnect_,e,a),$d(0,i,c,h)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Ko("OnDisconnect.update",this._path),fF("OnDisconnect.update",e,this._path,!1);const t=new N.BH;return function WH(n,e,t,r){if((0,N.xb)(t))return xi("onDisconnect().update() called with empty data.  Don't do anything."),void $d(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&Mi(t,(c,h)=>{const m=Mr(h);w_(n.onDisconnect_,Ir(e,c),m)}),$d(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class Hs{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return mn(this._path)?null:IM(this._path)}get ref(){return new Zo(this._repo,this._path)}get _queryIdentifier(){const e=PL(this._queryParams),t=pM(e);return"{}"===t?"default":t}get _queryObject(){return PL(this._queryParams)}isEqual(e){if(!((e=(0,N.m9)(e))instanceof Hs))return!1;const t=this._repo===e._repo,r=TM(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Wj(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function GC(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Hd(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ku){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==kd)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Wc)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===rr){if(null!=e&&!A0(e)||null!=t&&!A0(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,N.hu)(n.getIndex()instanceof AM||n.getIndex()===RM,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function zC(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Zo extends Hs{constructor(e,t){super(e,t,new wC,!1)}get parent(){const e=EL(this._path);return null===e?null:new Zo(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class _p{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Vn(e),r=yp(this.ref,e);return new _p(this._node.getChild(t),r,rr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new _p(i,yp(this.ref,r),rr)))}hasChild(e){const t=new Vn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function xF(n,e){return(n=(0,N.m9)(n))._checkNotDeleted("ref"),void 0!==e?yp(n._root,e):n._root}function MF(n,e){(n=(0,N.m9)(n))._checkNotDeleted("refFromURL");const t=pN(e,n._repo.repoInfo_.nodeAdmin);pF("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Pu("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),xF(n,t.path.toString())}function yp(n,e){return null===gn((n=(0,N.m9)(n))._path)?kH("child","path",e,!1):M0("child","path",e,!1),new Zo(n._repo,Ir(n._path,e))}function mN(n,e){n=(0,N.m9)(n),Ko("set",n._path),Ou("set",e,n._path,!1);const t=new N.BH;return cN(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function oG(n,e){fF("update",e,n._path,!1);const t=new N.BH;return function $H(n,e,t,r){b_(n,"update",{path:e.toString(),value:t});let i=!0;const a=N0(n),c={};if(Mi(t,(h,m)=>{i=!1,c[h]=cF(Ir(e,h),Mr(m),n.serverSyncTree_,a)}),i)xi("update() called with empty data.  Don't do anything."),$d(0,r,"ok",void 0);else{const h=jC(n),m=function pH(n,e,t,r){!function M$(n,e,t,r){(0,N.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=VM(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=ir.fromObject(t);return T_(n,new E_({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,c,h);BC(n.eventQueue_,m),n.server_.merge(e.toString(),t,(w,T)=>{const D="ok"===w;D||us("update at "+e+" failed: "+w);const x=jd(n.serverSyncTree_,h,!D),F=x.length>0?C_(n,e):e;fo(n.eventQueue_,F,x),$d(0,r,w,T)}),Mi(t,w=>{const T=hN(n,Ir(e,w));C_(n,T)}),fo(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function aG(n){n=(0,N.m9)(n);const e=new gN(()=>{}),t=new P0(e);return function jH(n,e,t){const r=function vH(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(w,T)=>{const D=Ds(w,t);r=r||Vd(T,D)});let i=n.syncPointTree_.get(t);i?r=r||Vd(i,Pn()):(i=new XL,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,c=a?new Fd(r,!0,!1):null;return function nH(n){return DC(n.viewCache_)}(JL(i,e,SC(n.pendingWriteTree_,e._path),a?c.getNode():an.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const a=Mr(i).withIndex(e._queryParams.getIndex());let c;if(ZM(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())c=b0(n.serverSyncTree_,e._path,a);else{const h=C0(n.serverSyncTree_,e);c=iF(n.serverSyncTree_,e._path,a,h)}return fo(n.eventQueue_,e._path,c),kC(n.serverSyncTree_,e,t,null,!0),a},i=>(b_(n,"get for query "+(0,N.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new _p(r,new Zo(n._repo,n._path),n._queryParams.getIndex()))}class P0{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new SF("value",this,new _p(e.snapshotNode,new Zo(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new AF(this,e,t):null}matches(e){return e instanceof P0&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class WC{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new AF(this,e,t):null}createEvent(e,t){(0,N.hu)(null!=e.childName,"Child events should have a childName.");const r=yp(new Zo(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new SF(e.type,this,new _p(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof WC&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function k0(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const m=t,w=(T,D)=>{lN(n._repo,n,h),m(T,D)};w.userCallback=t.userCallback,w.context=t.context,t=w}const c=new gN(t,a||void 0),h="value"===e?new P0(c):new WC(e,c);return function qH(n,e,t){let r;r=".info"===gn(e._path)?ZM(n.infoSyncTree_,e,t):ZM(n.serverSyncTree_,e,t),gF(n.eventQueue_,e._path,r)}(n._repo,n,h),()=>lN(n._repo,n,h)}function _N(n,e,t,r){return k0(n,"value",e,t,r)}function NF(n,e,t,r){return k0(n,"child_added",e,t,r)}function PF(n,e,t,r){return k0(n,"child_changed",e,t,r)}function kF(n,e,t,r){return k0(n,"child_moved",e,t,r)}function OF(n,e,t,r){return k0(n,"child_removed",e,t,r)}function LF(n,e,t){let r=null;const i=t?new gN(t):null;"value"===e?r=new P0(i):e&&(r=new WC(e,i)),lN(n._repo,n,r)}class Ba{}class FF extends Ba{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Ou("endAt",this._value,e._path,!0);const t=NM(e._queryParams,this._value,this._key);if(zC(t),Hd(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Hs(e._repo,e._path,t,e._orderByCalled)}}class cG extends Ba{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Ou("endBefore",this._value,e._path,!1);const t=function y$(n,e,t){let r;return r=NM(n,e,n.index_===ku||t?t:kd),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(zC(t),Hd(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Hs(e._repo,e._path,t,e._orderByCalled)}}class UF extends Ba{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Ou("startAt",this._value,e._path,!0);const t=MM(e._queryParams,this._value,this._key);if(zC(t),Hd(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Hs(e._repo,e._path,t,e._orderByCalled)}}class hG extends Ba{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Ou("startAfter",this._value,e._path,!1);const t=function _$(n,e,t){let r;return r=MM(n,e,n.index_===ku||t?t:Wc),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(zC(t),Hd(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Hs(e._repo,e._path,t,e._orderByCalled)}}class pG extends Ba{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Hs(e._repo,e._path,function g$(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class mG extends Ba{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Hs(e._repo,e._path,function m$(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class yG extends Ba{constructor(e){super(),this._path=e}_apply(e){GC(e,"orderByChild");const t=new Vn(this._path);if(mn(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new AM(t),i=EC(e._queryParams,r);return Hd(i),new Hs(e._repo,e._path,i,!0)}}class wG extends Ba{_apply(e){GC(e,"orderByKey");const t=EC(e._queryParams,ku);return Hd(t),new Hs(e._repo,e._path,t,!0)}}class IG extends Ba{_apply(e){GC(e,"orderByPriority");const t=EC(e._queryParams,rr);return Hd(t),new Hs(e._repo,e._path,t,!0)}}class bG extends Ba{_apply(e){GC(e,"orderByValue");const t=EC(e._queryParams,RM);return Hd(t),new Hs(e._repo,e._path,t,!0)}}class DG extends Ba{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(Ou("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new FF(this._value,this._key)._apply(new UF(this._value,this._key)._apply(e))}}function ja(n,...e){let t=(0,N.m9)(n);for(const r of e)t=r._apply(t);return t}(function oH(n){(0,N.hu)(!MC,"__referenceConstructor has already been defined"),MC=n})(Zo),function dH(n){(0,N.hu)(!PC,"__referenceConstructor has already been defined"),PC=n}(Zo);const AG="FIREBASE_DATABASE_EMULATOR_HOST",yN={};let VF=!1;function BF(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||Pu("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),xi("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let m,w,c=pN(a,i),h=c.repoInfo;typeof process<"u"&&process.env&&(w=process.env[AG]),w?(m=!0,a=`http://${w}?ns=${h.namespace}`,c=pN(a,i),h=c.repoInfo):m=!c.repoInfo.secure;const T=i&&m?new h0(h0.OWNER):new Ej(n.name,n.options,e);pF("Invalid Firebase Database URL",c),mn(c.path)||Pu("Database URL must point to the root of a Firebase Database (not including a child path).");const D=function MG(n,e,t,r){let i=yN[e.name];i||(i={},yN[e.name]=i);let a=i[n.toURLString()];return a&&Pu("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new UH(n,VF,t,r),i[n.toURLString()]=a,a}(h,n,T,new wj(n.name,t));return new PG(D,n)}class PG{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function VH(n,e,t){if(n.stats_=vM(n.repoInfo_),n.forceRestClient_||vj())n.server_=new IC(n.repoInfo_,(r,i,a,c)=>{vF(n,r,i,a,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>wF(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,N.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new hp(n.repoInfo_,e,(r,i,a,c)=>{vF(n,r,i,a,c)},r=>{wF(n,r)},r=>{!function BH(n,e){Mi(e,(t,r)=>{uN(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function bj(n,e){const t=n.toString();return yM[t]||(yM[t]=e()),yM[t]}(n.repoInfo_,()=>new b$(n.stats_,n.server_)),n.infoData_=new v$,n.infoSyncTree_=new rF({startListening:(r,i,a,c)=>{let h=[];const m=n.infoData_.getNode(r._path);return m.isEmpty()||(h=b0(n.infoSyncTree_,r._path,m),setTimeout(()=>{c("ok")},0)),h},stopListening:()=>{}}),uN(n,"connected",!1),n.serverSyncTree_=new rF({startListening:(r,i,a,c)=>(n.server_.listen(r,a,i,(h,m)=>{const w=c(h,m);fo(n.eventQueue_,r._path,w)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Zo(this._repo,Pn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function xG(n,e){const t=yN[e];(!t||t[n.key]!==n)&&Pu(`Database ${e}(${n.repoInfo_}) has already been deleted.`),IF(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Pu("Cannot call "+e+" on a deleted database.")}}function jF(){cL.IS_TRANSPORT_INITIALIZED&&us("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function kG(){jF(),Od.forceDisallow()}function OG(){jF(),m_.forceDisallow(),Od.forceAllow()}function UG(n,e){H1(n,e)}const BG={".sv":"timestamp"};class HG{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}hp.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},hp.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function VG(n){U1(Fi.SDK_VERSION),(0,Fi._registerComponent)(new no.wA("database",(e,{instanceIdentifier:t})=>BF(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,Fi.registerVersion)(L1,"0.14.4",n),(0,Fi.registerVersion)(L1,"0.14.4","esm2017")}();const qG=new vs.Yd("@firebase/database-compat"),HF=function(n){qG.warn("FIREBASE WARNING: "+n)};class YG{constructor(e){this._delegate=e}cancel(e){(0,N.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,N.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,N.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,N.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,N.Dv)("OnDisconnect.set",1,2,arguments.length),(0,N.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,N.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,N.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,N.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,HF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,N.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class QG{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,N.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Gd{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,N.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,N.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,N.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,N.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,N.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),M0("DataSnapshot.child","path",e,!1),new Gd(this._database,this._delegate.child(e))}hasChild(e){return(0,N.Dv)("DataSnapshot.hasChild",1,1,arguments.length),M0("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,N.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,N.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,N.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Gd(this._database,t)))}hasChildren(){return(0,N.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,N.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,N.Dv)("DataSnapshot.ref",0,0,arguments.length),new po(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class zi{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,N.Dv)("Query.on",2,4,arguments.length),(0,N.Wj)("Query.on","callback",t,!1);const c=zi.getCancelAndContextArgs_("Query.on",r,i),h=(w,T)=>{t.call(c.context,new Gd(this.database,w),T)};h.userCallback=t,h.context=c.context;const m=null===(a=c.cancel)||void 0===a?void 0:a.bind(c.context);switch(e){case"value":return _N(this._delegate,h,m),t;case"child_added":return NF(this._delegate,h,m),t;case"child_removed":return OF(this._delegate,h,m),t;case"child_changed":return PF(this._delegate,h,m),t;case"child_moved":return kF(this._delegate,h,m),t;default:throw new Error((0,N.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,N.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,N.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,N.Wj)("Query.off","callback",t,!0),(0,N.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,LF(this._delegate,e,i)}else LF(this._delegate,e)}get(){return aG(this._delegate).then(e=>new Gd(this.database,e))}once(e,t,r,i){(0,N.Dv)("Query.once",1,4,arguments.length),(0,N.Wj)("Query.once","callback",t,!0);const a=zi.getCancelAndContextArgs_("Query.once",r,i),c=new N.BH,h=(w,T)=>{const D=new Gd(this.database,w);t&&t.call(a.context,D,T),c.resolve(D)};h.userCallback=t,h.context=a.context;const m=w=>{a.cancel&&a.cancel.call(a.context,w),c.reject(w)};switch(e){case"value":_N(this._delegate,h,m,{onlyOnce:!0});break;case"child_added":NF(this._delegate,h,m,{onlyOnce:!0});break;case"child_removed":OF(this._delegate,h,m,{onlyOnce:!0});break;case"child_changed":PF(this._delegate,h,m,{onlyOnce:!0});break;case"child_moved":kF(this._delegate,h,m,{onlyOnce:!0});break;default:throw new Error((0,N.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return(0,N.Dv)("Query.limitToFirst",1,1,arguments.length),new zi(this.database,ja(this._delegate,function gG(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new pG(n)}(e)))}limitToLast(e){return(0,N.Dv)("Query.limitToLast",1,1,arguments.length),new zi(this.database,ja(this._delegate,function _G(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new mG(n)}(e)))}orderByChild(e){return(0,N.Dv)("Query.orderByChild",1,1,arguments.length),new zi(this.database,ja(this._delegate,function vG(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return M0("orderByChild","path",n,!1),new yG(n)}(e)))}orderByKey(){return(0,N.Dv)("Query.orderByKey",0,0,arguments.length),new zi(this.database,ja(this._delegate,function EG(){return new wG}()))}orderByPriority(){return(0,N.Dv)("Query.orderByPriority",0,0,arguments.length),new zi(this.database,ja(this._delegate,function TG(){return new IG}()))}orderByValue(){return(0,N.Dv)("Query.orderByValue",0,0,arguments.length),new zi(this.database,ja(this._delegate,function CG(){return new bG}()))}startAt(e=null,t){return(0,N.Dv)("Query.startAt",0,2,arguments.length),new zi(this.database,ja(this._delegate,function dG(n=null,e){return x0("startAt","key",e,!0),new UF(n,e)}(e,t)))}startAfter(e=null,t){return(0,N.Dv)("Query.startAfter",0,2,arguments.length),new zi(this.database,ja(this._delegate,function fG(n,e){return x0("startAfter","key",e,!0),new hG(n,e)}(e,t)))}endAt(e=null,t){return(0,N.Dv)("Query.endAt",0,2,arguments.length),new zi(this.database,ja(this._delegate,function uG(n,e){return x0("endAt","key",e,!0),new FF(n,e)}(e,t)))}endBefore(e=null,t){return(0,N.Dv)("Query.endBefore",0,2,arguments.length),new zi(this.database,ja(this._delegate,function lG(n,e){return x0("endBefore","key",e,!0),new cG(n,e)}(e,t)))}equalTo(e,t){return(0,N.Dv)("Query.equalTo",1,2,arguments.length),new zi(this.database,ja(this._delegate,function SG(n,e){return x0("equalTo","key",e,!0),new DG(n,e)}(e,t)))}toString(){return(0,N.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,N.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,N.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof zi))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,N.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,N.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,N.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new po(this.database,new Zo(this._delegate._repo,this._delegate._path))}}class po extends zi{constructor(e,t){super(e,new Hs(t._repo,t._path,new wC,!1)),this.database=e,this._delegate=t}getKey(){return(0,N.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,N.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new po(this.database,yp(this._delegate,e))}getParent(){(0,N.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new po(this.database,e):null}getRoot(){return(0,N.Dv)("Reference.root",0,0,arguments.length),new po(this.database,this._delegate.root)}set(e,t){(0,N.Dv)("Reference.set",1,2,arguments.length),(0,N.Wj)("Reference.set","onComplete",t,!0);const r=mN(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,N.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,HF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ko("Reference.update",this._delegate._path),(0,N.Wj)("Reference.update","onComplete",t,!0);const r=oG(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,N.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,N.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function sG(n,e,t){if(Ko("setWithPriority",n._path),Ou("setWithPriority",e,n._path,!1),aN("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new N.BH;return cN(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,N.Dv)("Reference.remove",0,1,arguments.length),(0,N.Wj)("Reference.remove","onComplete",e,!0);const t=function rG(n){return Ko("remove",n._path),mN(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,N.Dv)("Reference.transaction",1,3,arguments.length),(0,N.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,N.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,N.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function GG(n,e,t){var r;if(n=(0,N.m9)(n),Ko("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,a=new N.BH,h=_N(n,()=>{});return function ZH(n,e,t,r,i,a){b_(n,"transaction on "+e);const c={path:e,update:t,onComplete:r,status:null,order:B1(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=dN(n,e,void 0);c.currentInputSnapshot=h;const m=c.update(h.val());if(void 0===m)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{R0("transaction failed: Data returned ",m,c.path),c.status=0;const w=FC(n.transactionQueueTree_,e),T=mp(w)||[];let D;T.push(c),iN(w,T),"object"==typeof m&&null!==m&&(0,N.r3)(m,".priority")?(D=(0,N.DV)(m,".priority"),(0,N.hu)(A0(D),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):D=(OC(n.serverSyncTree_,e)||an.EMPTY_NODE).getPriority().val();const x=N0(n),F=Mr(m,D),$=tN(F,h,x);c.currentOutputSnapshotRaw=F,c.currentOutputSnapshotResolved=$,c.currentWriteId=jC(n);const ee=KM(n.serverSyncTree_,e,$,c.currentWriteId,c.applyLocally);fo(n.eventQueue_,e,ee),$C(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(m,w,T)=>{let D=null;m?a.reject(m):(D=new _p(T,new Zo(n._repo,n._path),rr),a.resolve(new HG(w,D)))},h,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new QG(a.committed,new Gd(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,N.Dv)("Reference.setPriority",1,2,arguments.length),(0,N.Wj)("Reference.setPriority","onComplete",t,!0);const r=function iG(n,e){n=(0,N.m9)(n),Ko("setPriority",n._path),aN("setPriority",e,!1);const t=new N.BH;return cN(n._repo,Ir(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,N.Dv)("Reference.push",0,2,arguments.length),(0,N.Wj)("Reference.push","onComplete",t,!0);const r=function nG(n,e){n=(0,N.m9)(n),Ko("push",n._path),Ou("push",e,n._path,!0);const t=yF(n._repo),r=tG(t),i=yp(n,r),a=yp(n,r);let c;return c=null!=e?mN(a,e).then(()=>a):Promise.resolve(a),i.then=c.then.bind(c),i.catch=c.then.bind(c,void 0),i}(this._delegate,e),i=r.then(c=>new po(this.database,c));t&&i.then(()=>t(null),c=>t(c));const a=new po(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return Ko("Reference.onDisconnect",this._delegate._path),new YG(new RF(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class O0{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:kG,forceLongPolling:OG}}useEmulator(e,t,r={}){!function $F(n,e,t,r={}){(n=(0,N.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Pu("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Pu('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new h0(h0.OWNER);else if(r.mockUserToken){const c="string"==typeof r.mockUserToken?r.mockUserToken:(0,N.Sg)(r.mockUserToken,n.app.options.projectId);a=new h0(c)}!function RG(n,e,t,r){n.repoInfo_=new mM(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,N.Dv)("database.ref",0,1,arguments.length),e instanceof po){const t=MF(this._delegate,e.toString());return new po(this,t)}{const t=xF(this._delegate,e);return new po(this,t)}}refFromURL(e){(0,N.Dv)("database.refFromURL",1,1,arguments.length);const r=MF(this._delegate,e);return new po(this,r)}goOffline(){return(0,N.Dv)("database.goOffline",0,0,arguments.length),function LG(n){(n=(0,N.m9)(n))._checkNotDeleted("goOffline"),IF(n._repo)}(this._delegate)}goOnline(){return(0,N.Dv)("database.goOnline",0,0,arguments.length),function FG(n){(n=(0,N.m9)(n))._checkNotDeleted("goOnline"),function KH(n){n.persistentConnection_&&n.persistentConnection_.resume(_F)}(n._repo)}(this._delegate)}}O0.ServerValue={TIMESTAMP:function jG(){return BG}(),increment:n=>function $G(n){return{".sv":{increment:n}}}(n)};var JG=Object.freeze({__proto__:null,initStandalone:function XG({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){U1(t);const c=new no.zt("auth-internal",new no.H0("database-standalone"));return c.setComponent(new no.wA("auth-internal",()=>r,"PRIVATE")),{instance:new O0(BF(n,c,void 0,e,a),n),namespace:i}}});const ez=O0.ServerValue;function GF(n){return null==n}function zF(n){return"function"==typeof n.set}function WF(n,e){return zF(e)?e:n.ref(e)}function qF(n,e){if(function nz(n){return"string"==typeof n}(n))return e.stringCase();if(zF(n))return e.firebaseCase();if(function rz(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function L0(n,e,t="on",r=cf.z){return new Oi.y(i=>{let a=null;return a=n[t](e,(c,h)=>{r.schedule(()=>{i.next({snapshot:c,prevKey:h})}),"once"===t&&r.schedule(()=>i.complete())},c=>{r.schedule(()=>i.error(c))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,Ct.U)(i=>{const{snapshot:a,prevKey:c}=i;let h=null;return a.exists()&&(h=a.key),{type:e,payload:a,prevKey:c,key:h}}),(0,GD.B)())}function KF(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function oz(n,e){const{payload:t,prevKey:r,key:i}=e,a=KF(n,i),c=function sz(n,e){if(GF(e))return 0;{const t=KF(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let h=null;e.payload.forEach(m=>{const w={payload:m,type:"value",prevKey:h,key:m.key};return h=m.key,n=[...n,w],!1})}return n;case"child_added":if(a>-1){const h=n[a-1];(h&&h.key||null)!==r&&(n=n.filter(m=>m.payload.key!==t.key)).splice(c,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(c,0,e)}return n;case"child_removed":return n.filter(h=>h.payload.key!==t.key);case"child_changed":return n.map(h=>h.payload.key===i?e:h);case"child_moved":if(a>-1){const h=n.splice(a,1)[0];return(n=n.slice()).splice(c,0,h),n}return n;default:return n}}function ZF(n){return(GF(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function YF(n,e,t){return function iz(n,e,t){return L0(n,"value","once",t).pipe(zn(r=>{const i=[ot(r)];return e.forEach(a=>i.push(L0(n,a,"on",t))),(0,Ly.T)(...i).pipe(No(oz,[]))}),Wg())}(n,e=ZF(e),t)}function QF(n,e,t){const r=(e=ZF(e)).map(i=>L0(n,i,"on",t));return(0,Ly.T)(...r)}function XF(n,e){return function(r,i){return qF(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function lz(n){return function(t){return t?qF(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function JF(n,e){return function(){return L0(n,"value","on",e)}}!function tz(n){n.INTERNAL.registerComponent(new no.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new O0(i,r)},"PUBLIC").setServiceProps({Reference:po,Query:zi,Database:O0,DataSnapshot:Gd,enableLogging:UG,INTERNAL:JG,ServerValue:ez}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.3.4")}(lf.Z);const fz=new _.OlP("angularfire2.realtimeDatabaseURL"),pz=new _.OlP("angularfire2.database.use-emulator");let gz=(()=>{class n{constructor(t,r,i,a,c,h,m,w,T,D,x,F,$,ee,se){this.schedulers=h;const ht=m,vt=(0,cr.on)(t,c,r);w&&rv(vt,c,T,x,F,$,D,ee),this.database=(0,cr.cc)(`${vt.name}.database.${i}`,"AngularFireDatabase",vt.name,()=>{const dt=c.runOutsideAngular(()=>vt.database(i||void 0));return ht&&dt.useEmulator(...ht),dt},[ht])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>WF(this.database,t));let a=i;return r&&(a=r(i)),function dz(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:XF(r,"update"),set:XF(r,"set"),push:i=>r.push(i),remove:lz(r),snapshotChanges:i=>YF(n,i,t).pipe(un.iC),stateChanges:i=>QF(n,i,t).pipe(un.iC),auditTrail:i=>function az(n,e,t){return function cz(n,e,t){return function uz(n,e){return L0(n,"value","on",e).pipe((0,Ct.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function oj(...n){const e=(0,xo.jO)(n);return(0,wr.e)((t,r)=>{const i=n.length,a=new Array(i);let c=n.map(()=>!1),h=!1;for(let m=0;m<i;m++)(0,_a.Xf)(n[m]).subscribe((0,Un.x)(r,w=>{a[m]=w,!h&&!c[m]&&(c[m]=!0,(h=c.every(Ji.y))&&(c=null))},sj.Z));t.subscribe((0,Un.x)(r,m=>{if(h){const w=[m,...a];r.next(e?e(...w):w)}}))})}(e),(0,Ct.U)(([i,a])=>{const c=i.lastKeyToLoad,h=a.map(m=>m.key);return{actions:a,lastKeyToLoad:c,loadedKeys:h}}),function aj(n){return(0,wr.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,Un.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,Ct.U)(i=>i.actions))}(n,QF(n,e).pipe(No((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(un.iC),valueChanges:(i,a)=>YF(n,i,t).pipe((0,Ct.U)(h=>h.map(m=>a&&a.idField?Object.assign(Object.assign({},m.payload.val()),{[a.idField]:m.key}):m.payload.val())),un.iC)}}(a,this)}object(t){return function hz(n,e){return{query:n,snapshotChanges:()=>JF(n,e.schedulers.outsideAngular)().pipe(un.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>JF(n,e.schedulers.outsideAngular)().pipe(un.iC,(0,Ct.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>WF(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(cr.Dh),_.LFG(cr.xv,8),_.LFG(fz,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(un.HU),_.LFG(pz,8),_.LFG(bc,8),_.LFG(Ag,8),_.LFG(Rg,8),_.LFG(xg,8),_.LFG(rd,8),_.LFG(Vo,8),_.LFG(nv,8),_.LFG(nd,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),mz=(()=>{class n{constructor(){Iu.Z.registerVersion("angularfire",un.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[gz]}),n})();var eU=P(655),_z=P(5132);const nU="firebase_screen_id",wN="outlet",F0="screen_class",rU="screen_name";let xz=Math.floor(Math.random()*(Math.pow(2,32)-1))-Math.pow(2,31);const EN={},Mz=n=>{const e=[n[F0],n[wN]].join("#");if(EN.hasOwnProperty(e))return EN[e];{const t=xz++;return EN[e]=t,t}},Fz=new _.OlP("angularfire2.analytics.analyticsCollectionEnabled"),Uz=new _.OlP("angularfire2.analytics.appVersion"),Vz=new _.OlP("angularfire2.analytics.appName"),Bz=new _.OlP("angularfire2.analytics.debugMode"),jz=new _.OlP("angularfire2.analytics.config"),qC="dataLayer";let U0=(()=>{class n{constructor(t,r,i,a,c,h,m,w,T){if(this.analyticsInitialized=new Promise(()=>{}),function el(n){return n===ia}(m)){window[qC]=window[qC]||[];const x=(...ee)=>"config"===ee[0]&&"firebase"===ee[2].origin&&(this.measurementId=ee[1],!0),F=ee=>{window.gtag=(...se)=>{ee&&ee(...se),"event"===se[0]&&se[2].send_to===this.measurementId&&(a&&(se[2].app_name=a),i&&(se[2].app_version=i)),c&&typeof console<"u"&&console.info(...se),function(...ht){window[qC].push(arguments)}(...se)}};window[qC].some(x)?(this.analyticsInitialized=Promise.resolve(),F()):this.analyticsInitialized=new Promise(ee=>{F((...se)=>{x(...se)&&ee()})}),h&&this.updateConfig(h),c&&this.updateConfig({debug_mode:1})}else this.analyticsInitialized=Promise.resolve();const D=ot(void 0).pipe((0,li.Q)(T.outsideAngular),zn(_z.Gb),zn(x=>x?w.runOutsideAngular(()=>P.e(814).then(P.bind(P,3814))):fs.E),(0,Ct.U)(()=>(0,cr.cc)("analytics","AngularFireAnalytics",t.name,()=>{const x=t.analytics();return!1===r&&x.setAnalyticsCollectionEnabled(!1),x},[t,r,h,c])),Xh({bufferSize:1,refCount:!1}));return(0,cr.pX)(this,D,w)}updateConfig(t){return(0,eU.mG)(this,void 0,void 0,function*(){yield this.analyticsInitialized,window.gtag("config",this.measurementId,Object.assign(Object.assign({},t),{update:!0}))})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(cr.Ot),_.LFG(Fz,8),_.LFG(Uz,8),_.LFG(Vz,8),_.LFG(Bz,8),_.LFG(jz,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(un.HU))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),sU=(()=>{class n{constructor(t,r,i,a){if(this.disposables=[],Iu.Z.registerVersion("angularfire",un.q4.full,"compat-user-tracking"),sa(r))this.initialized=Promise.resolve();else{let c;this.initialized=a.runOutsideAngular(()=>new Promise(h=>c=h)),this.disposables=[i.authState.subscribe(h=>{t.setUserId(h?.uid),c()}),i.credential.subscribe(h=>{if(h){const m=h.user.isAnonymous?"anonymous":h.additionalUserInfo.providerId;h.additionalUserInfo.isNewUser&&t.logEvent("sign_up",{method:m}),t.logEvent("login",{method:m})}})]}}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(U0),_.LFG(_.Lbi),_.LFG(bc),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Kz=(()=>{class n{constructor(t,r,i,a,c,h){if(Iu.Z.registerVersion("angularfire",un.q4.full,"compat-screen-tracking"),!r||!t)return this;c.runOutsideAngular(()=>{this.disposable=((n,e,t)=>n.events.pipe(Li(i=>i instanceof Ll)).pipe(zn(i=>{var a;const h=(null===(a=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,F=>F.replace("://",":///"))).root.children[i.snapshot.outlet])||void 0===a?void 0:a.toString())||"",m=n.routerState.root.children.map(F=>F).find(F=>F.outlet===i.snapshot.outlet);if(!m)return ot(null);let w=m;for(;w.firstChild;)w=w.firstChild;const T=w.pathFromRoot.map(F=>{var $;return null===($=F.routeConfig)||void 0===$?void 0:$.path}).filter(F=>F).join("/")||"/",D={[rU]:T,page_path:`/${h}`,firebase_event_origin:"auto",firebase_screen:T,[wN]:i.snapshot.outlet};e&&(D.page_title=e.getTitle());let x=m.component;if(x){if(x===tg){let F=i.snapshot;for(;F.firstChild;)F=F.firstChild;x=F.component}}else x=i.snapshot.component;if("string"==typeof x)return ot(Object.assign(Object.assign({},D),{[F0]:x}));if(x){const F=t.resolveComponentFactory(x);return ot(Object.assign(Object.assign({},D),{[F0]:F.selector}))}return ot(null)}),Li(i=>!!i),(0,Ct.U)(i=>Object.assign({firebase_screen_class:i[F0],[nU]:Mz(i)},i)),function yz(n,e,t,r){return(0,wr.e)((i,a)=>{let c;e&&"function"!=typeof e?({duration:t,element:c,connector:r}=e):c=e;const h=new Map,m=$=>{h.forEach($),$(a)},w=$=>m(ee=>ee.error($));let T=0,D=!1;const x=new Un.Q(a,$=>{try{const ee=n($);let se=h.get(ee);if(!se){h.set(ee,se=r?r():new Mo.x);const ht=function F($,ee){const se=new Oi.y(ht=>{T++;const vt=ee.subscribe(ht);return()=>{vt.unsubscribe(),0==--T&&D&&x.unsubscribe()}});return se.key=$,se}(ee,se);if(a.next(ht),t){const vt=(0,Un.x)(se,()=>{se.complete(),vt?.unsubscribe()},void 0,void 0,()=>h.delete(ee));x.add((0,_a.Xf)(t(ht)).subscribe(vt))}}se.next(c?c($):$)}catch(ee){w(ee)}},()=>m($=>$.complete()),w,()=>h.clear(),()=>(D=!0,0===T));i.subscribe(x)})}(i=>i[wN]),(0,Sr.z)(i=>i.pipe(Wg((a,c)=>JSON.stringify(a)===JSON.stringify(c)),rc(void 0),zg(),(0,Ct.U)(([a,c])=>a?Object.assign({firebase_previous_class:a[F0],firebase_previous_screen:a[rU],firebase_previous_id:a[nU]},c):c)))))(r,i,a).pipe(zn(m=>(0,eU.mG)(this,void 0,void 0,function*(){return h&&(yield h.initialized),yield t.logEvent("screen_view",m)}))).subscribe()})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(U0),_.LFG(Ti,8),_.LFG(Ao,8),_.LFG(_._Vd),_.LFG(_.R0b),_.LFG(sU,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Zz=(()=>{class n{constructor(t,r,i){Iu.Z.registerVersion("angularfire",un.q4.full,"analytics-compat"),t.app.then(()=>{})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(U0),_.LFG(Kz,8),_.LFG(sU,8))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[U0]}),n})();const oU_firebaseConfig={apiKey:"AIzaSyDp-n3JPvXmCB1RRaXBrODB11YauEjeZ4Y",authDomain:"opacscc-a73c7.firebaseapp.com",databaseURL:"https://opacscc-a73c7-default-rtdb.firebaseio.com",projectId:"opacscc-a73c7",storageBucket:"opacscc-a73c7.appspot.com",messagingSenderId:"514399829505",appId:"1:514399829505:web:63cae12e2f15759e694a00",measurementId:"G-BPS0HTXKS3"};let Yz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n,bootstrap:[KE]}),n.\u0275inj=_.cJS({imports:[Xa,FE.forRoot([]),BD,cr.hO.initializeApp(oU_firebaseConfig),Zz,Cc,ij,mA,mz]}),n})();Zu().bootstrapModule(Yz).catch(n=>console.error(n))},9751:(mt,De,P)=>{P.d(De,{y:()=>ge});var _=P(930),X=P(727),V=P(8822),te=P(9635),ae=P(2416),ne=P(576),de=P(2806);let ge=(()=>{class Y{constructor(ve){ve&&(this._subscribe=ve)}lift(ve){const Ze=new Y;return Ze.source=this,Ze.operator=ve,Ze}subscribe(ve,Ze,rt){const pe=function W(Y){return Y&&Y instanceof _.Lv||function G(Y){return Y&&(0,ne.m)(Y.next)&&(0,ne.m)(Y.error)&&(0,ne.m)(Y.complete)}(Y)&&(0,X.Nn)(Y)}(ve)?ve:new _.Hp(ve,Ze,rt);return(0,de.x)(()=>{const{operator:be,source:Ne}=this;pe.add(be?be.call(pe,Ne):Ne?this._subscribe(pe):this._trySubscribe(pe))}),pe}_trySubscribe(ve){try{return this._subscribe(ve)}catch(Ze){ve.error(Ze)}}forEach(ve,Ze){return new(Ze=ue(Ze))((rt,pe)=>{const be=new _.Hp({next:Ne=>{try{ve(Ne)}catch(Ue){pe(Ue),be.unsubscribe()}},error:pe,complete:rt});this.subscribe(be)})}_subscribe(ve){var Ze;return null===(Ze=this.source)||void 0===Ze?void 0:Ze.subscribe(ve)}[V.L](){return this}pipe(...ve){return(0,te.U)(ve)(this)}toPromise(ve){return new(ve=ue(ve))((Ze,rt)=>{let pe;this.subscribe(be=>pe=be,be=>rt(be),()=>Ze(pe))})}}return Y.create=ke=>new Y(ke),Y})();function ue(Y){var ke;return null!==(ke=Y??ae.v.Promise)&&void 0!==ke?ke:Promise}},7579:(mt,De,P)=>{P.d(De,{x:()=>de});var _=P(9751),X=P(727);const te=(0,P(3888).d)(ue=>function(){ue(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ae=P(8737),ne=P(2806);let de=(()=>{class ue extends _.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(W){const Y=new ge(this,this);return Y.operator=W,Y}_throwIfClosed(){if(this.closed)throw new te}next(W){(0,ne.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Y of this.currentObservers)Y.next(W)}})}error(W){(0,ne.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=W;const{observers:Y}=this;for(;Y.length;)Y.shift().error(W)}})}complete(){(0,ne.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:W}=this;for(;W.length;)W.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var W;return(null===(W=this.observers)||void 0===W?void 0:W.length)>0}_trySubscribe(W){return this._throwIfClosed(),super._trySubscribe(W)}_subscribe(W){return this._throwIfClosed(),this._checkFinalizedStatuses(W),this._innerSubscribe(W)}_innerSubscribe(W){const{hasError:Y,isStopped:ke,observers:ve}=this;return Y||ke?X.Lc:(this.currentObservers=null,ve.push(W),new X.w0(()=>{this.currentObservers=null,(0,ae.P)(ve,W)}))}_checkFinalizedStatuses(W){const{hasError:Y,thrownError:ke,isStopped:ve}=this;Y?W.error(ke):ve&&W.complete()}asObservable(){const W=new _.y;return W.source=this,W}}return ue.create=(G,W)=>new ge(G,W),ue})();class ge extends de{constructor(G,W){super(),this.destination=G,this.source=W}next(G){var W,Y;null===(Y=null===(W=this.destination)||void 0===W?void 0:W.next)||void 0===Y||Y.call(W,G)}error(G){var W,Y;null===(Y=null===(W=this.destination)||void 0===W?void 0:W.error)||void 0===Y||Y.call(W,G)}complete(){var G,W;null===(W=null===(G=this.destination)||void 0===G?void 0:G.complete)||void 0===W||W.call(G)}_subscribe(G){var W,Y;return null!==(Y=null===(W=this.source)||void 0===W?void 0:W.subscribe(G))&&void 0!==Y?Y:X.Lc}}},930:(mt,De,P)=>{P.d(De,{Hp:()=>rt,Lv:()=>Y});var _=P(576),X=P(727),V=P(2416),te=P(7849),ae=P(5032);const ne=ue("C",void 0,void 0);function ue(Ae,Ie,Re){return{kind:Ae,value:Ie,error:Re}}var G=P(3410),W=P(2806);class Y extends X.w0{constructor(Ie){super(),this.isStopped=!1,Ie?(this.destination=Ie,(0,X.Nn)(Ie)&&Ie.add(this)):this.destination=Ue}static create(Ie,Re,Ge){return new rt(Ie,Re,Ge)}next(Ie){this.isStopped?Ne(function ge(Ae){return ue("N",Ae,void 0)}(Ie),this):this._next(Ie)}error(Ie){this.isStopped?Ne(function de(Ae){return ue("E",void 0,Ae)}(Ie),this):(this.isStopped=!0,this._error(Ie))}complete(){this.isStopped?Ne(ne,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ie){this.destination.next(Ie)}_error(Ie){try{this.destination.error(Ie)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ke=Function.prototype.bind;function ve(Ae,Ie){return ke.call(Ae,Ie)}class Ze{constructor(Ie){this.partialObserver=Ie}next(Ie){const{partialObserver:Re}=this;if(Re.next)try{Re.next(Ie)}catch(Ge){pe(Ge)}}error(Ie){const{partialObserver:Re}=this;if(Re.error)try{Re.error(Ie)}catch(Ge){pe(Ge)}else pe(Ie)}complete(){const{partialObserver:Ie}=this;if(Ie.complete)try{Ie.complete()}catch(Re){pe(Re)}}}class rt extends Y{constructor(Ie,Re,Ge){let Se;if(super(),(0,_.m)(Ie)||!Ie)Se={next:Ie??void 0,error:Re??void 0,complete:Ge??void 0};else{let j;this&&V.v.useDeprecatedNextContext?(j=Object.create(Ie),j.unsubscribe=()=>this.unsubscribe(),Se={next:Ie.next&&ve(Ie.next,j),error:Ie.error&&ve(Ie.error,j),complete:Ie.complete&&ve(Ie.complete,j)}):Se=Ie}this.destination=new Ze(Se)}}function pe(Ae){V.v.useDeprecatedSynchronousErrorHandling?(0,W.O)(Ae):(0,te.h)(Ae)}function Ne(Ae,Ie){const{onStoppedNotification:Re}=V.v;Re&&G.z.setTimeout(()=>Re(Ae,Ie))}const Ue={closed:!0,next:ae.Z,error:function be(Ae){throw Ae},complete:ae.Z}},727:(mt,De,P)=>{P.d(De,{Lc:()=>ne,w0:()=>ae,Nn:()=>de});var _=P(576);const V=(0,P(3888).d)(ue=>function(W){ue(this),this.message=W?`${W.length} errors occurred during unsubscription:\n${W.map((Y,ke)=>`${ke+1}) ${Y.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=W});var te=P(8737);class ae{constructor(G){this.initialTeardown=G,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let G;if(!this.closed){this.closed=!0;const{_parentage:W}=this;if(W)if(this._parentage=null,Array.isArray(W))for(const ve of W)ve.remove(this);else W.remove(this);const{initialTeardown:Y}=this;if((0,_.m)(Y))try{Y()}catch(ve){G=ve instanceof V?ve.errors:[ve]}const{_finalizers:ke}=this;if(ke){this._finalizers=null;for(const ve of ke)try{ge(ve)}catch(Ze){G=G??[],Ze instanceof V?G=[...G,...Ze.errors]:G.push(Ze)}}if(G)throw new V(G)}}add(G){var W;if(G&&G!==this)if(this.closed)ge(G);else{if(G instanceof ae){if(G.closed||G._hasParent(this))return;G._addParent(this)}(this._finalizers=null!==(W=this._finalizers)&&void 0!==W?W:[]).push(G)}}_hasParent(G){const{_parentage:W}=this;return W===G||Array.isArray(W)&&W.includes(G)}_addParent(G){const{_parentage:W}=this;this._parentage=Array.isArray(W)?(W.push(G),W):W?[W,G]:G}_removeParent(G){const{_parentage:W}=this;W===G?this._parentage=null:Array.isArray(W)&&(0,te.P)(W,G)}remove(G){const{_finalizers:W}=this;W&&(0,te.P)(W,G),G instanceof ae&&G._removeParent(this)}}ae.EMPTY=(()=>{const ue=new ae;return ue.closed=!0,ue})();const ne=ae.EMPTY;function de(ue){return ue instanceof ae||ue&&"closed"in ue&&(0,_.m)(ue.remove)&&(0,_.m)(ue.add)&&(0,_.m)(ue.unsubscribe)}function ge(ue){(0,_.m)(ue)?ue():ue.unsubscribe()}},2416:(mt,De,P)=>{P.d(De,{v:()=>_});const _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(mt,De,P)=>{P.d(De,{E:()=>X});const X=new(P(9751).y)(ae=>ae.complete())},8996:(mt,De,P)=>{P.d(De,{D:()=>Ie});var _=P(8421),X=P(5363),V=P(9468),ne=P(9751),ge=P(2202),ue=P(576),G=P(9672);function Y(Re,Ge){if(!Re)throw new Error("Iterable cannot be null");return new ne.y(Se=>{(0,G.f)(Se,Ge,()=>{const j=Re[Symbol.asyncIterator]();(0,G.f)(Se,Ge,()=>{j.next().then(we=>{we.done?Se.complete():Se.next(we.value)})},0,!0)})})}var ke=P(3670),ve=P(8239),Ze=P(1144),rt=P(6495),pe=P(2206),be=P(4532),Ne=P(3260);function Ie(Re,Ge){return Ge?function Ae(Re,Ge){if(null!=Re){if((0,ke.c)(Re))return function te(Re,Ge){return(0,_.Xf)(Re).pipe((0,V.R)(Ge),(0,X.Q)(Ge))}(Re,Ge);if((0,Ze.z)(Re))return function de(Re,Ge){return new ne.y(Se=>{let j=0;return Ge.schedule(function(){j===Re.length?Se.complete():(Se.next(Re[j++]),Se.closed||this.schedule())})})}(Re,Ge);if((0,ve.t)(Re))return function ae(Re,Ge){return(0,_.Xf)(Re).pipe((0,V.R)(Ge),(0,X.Q)(Ge))}(Re,Ge);if((0,pe.D)(Re))return Y(Re,Ge);if((0,rt.T)(Re))return function W(Re,Ge){return new ne.y(Se=>{let j;return(0,G.f)(Se,Ge,()=>{j=Re[ge.h](),(0,G.f)(Se,Ge,()=>{let we,We;try{({value:we,done:We}=j.next())}catch(Ye){return void Se.error(Ye)}We?Se.complete():Se.next(we)},0,!0)}),()=>(0,ue.m)(j?.return)&&j.return()})}(Re,Ge);if((0,Ne.L)(Re))return function Ue(Re,Ge){return Y((0,Ne.Q)(Re),Ge)}(Re,Ge)}throw(0,be.z)(Re)}(Re,Ge):(0,_.Xf)(Re)}},8421:(mt,De,P)=>{P.d(De,{Xf:()=>ke});var _=P(655),X=P(1144),V=P(8239),te=P(9751),ae=P(3670),ne=P(2206),de=P(4532),ge=P(6495),ue=P(3260),G=P(576),W=P(7849),Y=P(8822);function ke(Ae){if(Ae instanceof te.y)return Ae;if(null!=Ae){if((0,ae.c)(Ae))return function ve(Ae){return new te.y(Ie=>{const Re=Ae[Y.L]();if((0,G.m)(Re.subscribe))return Re.subscribe(Ie);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ae);if((0,X.z)(Ae))return function Ze(Ae){return new te.y(Ie=>{for(let Re=0;Re<Ae.length&&!Ie.closed;Re++)Ie.next(Ae[Re]);Ie.complete()})}(Ae);if((0,V.t)(Ae))return function rt(Ae){return new te.y(Ie=>{Ae.then(Re=>{Ie.closed||(Ie.next(Re),Ie.complete())},Re=>Ie.error(Re)).then(null,W.h)})}(Ae);if((0,ne.D)(Ae))return be(Ae);if((0,ge.T)(Ae))return function pe(Ae){return new te.y(Ie=>{for(const Re of Ae)if(Ie.next(Re),Ie.closed)return;Ie.complete()})}(Ae);if((0,ue.L)(Ae))return function Ne(Ae){return be((0,ue.Q)(Ae))}(Ae)}throw(0,de.z)(Ae)}function be(Ae){return new te.y(Ie=>{(function Ue(Ae,Ie){var Re,Ge,Se,j;return(0,_.mG)(this,void 0,void 0,function*(){try{for(Re=(0,_.KL)(Ae);!(Ge=yield Re.next()).done;)if(Ie.next(Ge.value),Ie.closed)return}catch(we){Se={error:we}}finally{try{Ge&&!Ge.done&&(j=Re.return)&&(yield j.call(Re))}finally{if(Se)throw Se.error}}Ie.complete()})})(Ae,Ie).catch(Re=>Ie.error(Re))})}},6451:(mt,De,P)=>{P.d(De,{T:()=>ne});var _=P(8189),X=P(8421),V=P(515),te=P(7669),ae=P(8996);function ne(...de){const ge=(0,te.yG)(de),ue=(0,te._6)(de,1/0),G=de;return G.length?1===G.length?(0,X.Xf)(G[0]):(0,_.J)(ue)((0,ae.D)(G,ge)):V.E}},5403:(mt,De,P)=>{P.d(De,{Q:()=>V,x:()=>X});var _=P(930);function X(te,ae,ne,de,ge){return new V(te,ae,ne,de,ge)}class V extends _.Lv{constructor(ae,ne,de,ge,ue,G){super(ae),this.onFinalize=ue,this.shouldUnsubscribe=G,this._next=ne?function(W){try{ne(W)}catch(Y){ae.error(Y)}}:super._next,this._error=ge?function(W){try{ge(W)}catch(Y){ae.error(Y)}finally{this.unsubscribe()}}:super._error,this._complete=de?function(){try{de()}catch(W){ae.error(W)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ae;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ne}=this;super.unsubscribe(),!ne&&(null===(ae=this.onFinalize)||void 0===ae||ae.call(this))}}}},4004:(mt,De,P)=>{P.d(De,{U:()=>V});var _=P(4482),X=P(5403);function V(te,ae){return(0,_.e)((ne,de)=>{let ge=0;ne.subscribe((0,X.x)(de,ue=>{de.next(te.call(ae,ue,ge++))}))})}},8189:(mt,De,P)=>{P.d(De,{J:()=>V});var _=P(5577),X=P(4671);function V(te=1/0){return(0,_.z)(X.y,te)}},5577:(mt,De,P)=>{P.d(De,{z:()=>ge});var _=P(4004),X=P(8421),V=P(4482),te=P(9672),ae=P(5403),de=P(576);function ge(ue,G,W=1/0){return(0,de.m)(G)?ge((Y,ke)=>(0,_.U)((ve,Ze)=>G(Y,ve,ke,Ze))((0,X.Xf)(ue(Y,ke))),W):("number"==typeof G&&(W=G),(0,V.e)((Y,ke)=>function ne(ue,G,W,Y,ke,ve,Ze,rt){const pe=[];let be=0,Ne=0,Ue=!1;const Ae=()=>{Ue&&!pe.length&&!be&&G.complete()},Ie=Ge=>be<Y?Re(Ge):pe.push(Ge),Re=Ge=>{ve&&G.next(Ge),be++;let Se=!1;(0,X.Xf)(W(Ge,Ne++)).subscribe((0,ae.x)(G,j=>{ke?.(j),ve?Ie(j):G.next(j)},()=>{Se=!0},void 0,()=>{if(Se)try{for(be--;pe.length&&be<Y;){const j=pe.shift();Ze?(0,te.f)(G,Ze,()=>Re(j)):Re(j)}Ae()}catch(j){G.error(j)}}))};return ue.subscribe((0,ae.x)(G,Ie,()=>{Ue=!0,Ae()})),()=>{rt?.()}}(Y,ke,ue,W)))}},5363:(mt,De,P)=>{P.d(De,{Q:()=>te});var _=P(9672),X=P(4482),V=P(5403);function te(ae,ne=0){return(0,X.e)((de,ge)=>{de.subscribe((0,V.x)(ge,ue=>(0,_.f)(ge,ae,()=>ge.next(ue),ne),()=>(0,_.f)(ge,ae,()=>ge.complete(),ne),ue=>(0,_.f)(ge,ae,()=>ge.error(ue),ne)))})}},3099:(mt,De,P)=>{P.d(De,{B:()=>ae});var _=P(8421),X=P(7579),V=P(930),te=P(4482);function ae(de={}){const{connector:ge=(()=>new X.x),resetOnError:ue=!0,resetOnComplete:G=!0,resetOnRefCountZero:W=!0}=de;return Y=>{let ke,ve,Ze,rt=0,pe=!1,be=!1;const Ne=()=>{ve?.unsubscribe(),ve=void 0},Ue=()=>{Ne(),ke=Ze=void 0,pe=be=!1},Ae=()=>{const Ie=ke;Ue(),Ie?.unsubscribe()};return(0,te.e)((Ie,Re)=>{rt++,!be&&!pe&&Ne();const Ge=Ze=Ze??ge();Re.add(()=>{rt--,0===rt&&!be&&!pe&&(ve=ne(Ae,W))}),Ge.subscribe(Re),!ke&&rt>0&&(ke=new V.Hp({next:Se=>Ge.next(Se),error:Se=>{be=!0,Ne(),ve=ne(Ue,ue,Se),Ge.error(Se)},complete:()=>{pe=!0,Ne(),ve=ne(Ue,G),Ge.complete()}}),(0,_.Xf)(Ie).subscribe(ke))})(Y)}}function ne(de,ge,...ue){if(!0===ge)return void de();if(!1===ge)return;const G=new V.Hp({next:()=>{G.unsubscribe(),de()}});return(0,_.Xf)(ge(...ue)).subscribe(G)}},9468:(mt,De,P)=>{P.d(De,{R:()=>X});var _=P(4482);function X(V,te=0){return(0,_.e)((ae,ne)=>{ne.add(V.schedule(()=>ae.subscribe(ne),te))})}},8505:(mt,De,P)=>{P.d(De,{b:()=>ae});var _=P(576),X=P(4482),V=P(5403),te=P(4671);function ae(ne,de,ge){const ue=(0,_.m)(ne)||de||ge?{next:ne,error:de,complete:ge}:ne;return ue?(0,X.e)((G,W)=>{var Y;null===(Y=ue.subscribe)||void 0===Y||Y.call(ue);let ke=!0;G.subscribe((0,V.x)(W,ve=>{var Ze;null===(Ze=ue.next)||void 0===Ze||Ze.call(ue,ve),W.next(ve)},()=>{var ve;ke=!1,null===(ve=ue.complete)||void 0===ve||ve.call(ue),W.complete()},ve=>{var Ze;ke=!1,null===(Ze=ue.error)||void 0===Ze||Ze.call(ue,ve),W.error(ve)},()=>{var ve,Ze;ke&&(null===(ve=ue.unsubscribe)||void 0===ve||ve.call(ue)),null===(Ze=ue.finalize)||void 0===Ze||Ze.call(ue)}))}):te.y}},4408:(mt,De,P)=>{P.d(De,{o:()=>ae});var _=P(727);class X extends _.w0{constructor(de,ge){super()}schedule(de,ge=0){return this}}const V={setInterval(ne,de,...ge){const{delegate:ue}=V;return ue?.setInterval?ue.setInterval(ne,de,...ge):setInterval(ne,de,...ge)},clearInterval(ne){const{delegate:de}=V;return(de?.clearInterval||clearInterval)(ne)},delegate:void 0};var te=P(8737);class ae extends X{constructor(de,ge){super(de,ge),this.scheduler=de,this.work=ge,this.pending=!1}schedule(de,ge=0){var ue;if(this.closed)return this;this.state=de;const G=this.id,W=this.scheduler;return null!=G&&(this.id=this.recycleAsyncId(W,G,ge)),this.pending=!0,this.delay=ge,this.id=null!==(ue=this.id)&&void 0!==ue?ue:this.requestAsyncId(W,this.id,ge),this}requestAsyncId(de,ge,ue=0){return V.setInterval(de.flush.bind(de,this),ue)}recycleAsyncId(de,ge,ue=0){if(null!=ue&&this.delay===ue&&!1===this.pending)return ge;null!=ge&&V.clearInterval(ge)}execute(de,ge){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ue=this._execute(de,ge);if(ue)return ue;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(de,ge){let G,ue=!1;try{this.work(de)}catch(W){ue=!0,G=W||new Error("Scheduled action threw falsy error")}if(ue)return this.unsubscribe(),G}unsubscribe(){if(!this.closed){const{id:de,scheduler:ge}=this,{actions:ue}=ge;this.work=this.state=this.scheduler=null,this.pending=!1,(0,te.P)(ue,this),null!=de&&(this.id=this.recycleAsyncId(ge,de,null)),this.delay=null,super.unsubscribe()}}}},7565:(mt,De,P)=>{P.d(De,{v:()=>V});var _=P(6063);class X{constructor(ae,ne=X.now){this.schedulerActionCtor=ae,this.now=ne}schedule(ae,ne=0,de){return new this.schedulerActionCtor(this,ae).schedule(de,ne)}}X.now=_.l.now;class V extends X{constructor(ae,ne=X.now){super(ae,ne),this.actions=[],this._active=!1}flush(ae){const{actions:ne}=this;if(this._active)return void ne.push(ae);let de;this._active=!0;do{if(de=ae.execute(ae.state,ae.delay))break}while(ae=ne.shift());if(this._active=!1,de){for(;ae=ne.shift();)ae.unsubscribe();throw de}}}},4986:(mt,De,P)=>{P.d(De,{z:()=>V});var _=P(4408);const V=new(P(7565).v)(_.o)},6063:(mt,De,P)=>{P.d(De,{l:()=>_});const _={now:()=>(_.delegate||Date).now(),delegate:void 0}},3410:(mt,De,P)=>{P.d(De,{z:()=>_});const _={setTimeout(X,V,...te){const{delegate:ae}=_;return ae?.setTimeout?ae.setTimeout(X,V,...te):setTimeout(X,V,...te)},clearTimeout(X){const{delegate:V}=_;return(V?.clearTimeout||clearTimeout)(X)},delegate:void 0}},2202:(mt,De,P)=>{P.d(De,{h:()=>X});const X=function _(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(mt,De,P)=>{P.d(De,{L:()=>_});const _="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(mt,De,P)=>{P.d(De,{_6:()=>ne,jO:()=>te,yG:()=>ae});var _=P(576);function V(de){return de[de.length-1]}function te(de){return(0,_.m)(V(de))?de.pop():void 0}function ae(de){return function X(de){return de&&(0,_.m)(de.schedule)}(V(de))?de.pop():void 0}function ne(de,ge){return"number"==typeof V(de)?de.pop():ge}},8737:(mt,De,P)=>{function _(X,V){if(X){const te=X.indexOf(V);0<=te&&X.splice(te,1)}}P.d(De,{P:()=>_})},3888:(mt,De,P)=>{function _(X){const te=X(ae=>{Error.call(ae),ae.stack=(new Error).stack});return te.prototype=Object.create(Error.prototype),te.prototype.constructor=te,te}P.d(De,{d:()=>_})},2806:(mt,De,P)=>{P.d(De,{O:()=>te,x:()=>V});var _=P(2416);let X=null;function V(ae){if(_.v.useDeprecatedSynchronousErrorHandling){const ne=!X;if(ne&&(X={errorThrown:!1,error:null}),ae(),ne){const{errorThrown:de,error:ge}=X;if(X=null,de)throw ge}}else ae()}function te(ae){_.v.useDeprecatedSynchronousErrorHandling&&X&&(X.errorThrown=!0,X.error=ae)}},9672:(mt,De,P)=>{function _(X,V,te,ae=0,ne=!1){const de=V.schedule(function(){te(),ne?X.add(this.schedule(null,ae)):this.unsubscribe()},ae);if(X.add(de),!ne)return de}P.d(De,{f:()=>_})},4671:(mt,De,P)=>{function _(X){return X}P.d(De,{y:()=>_})},1144:(mt,De,P)=>{P.d(De,{z:()=>_});const _=X=>X&&"number"==typeof X.length&&"function"!=typeof X},2206:(mt,De,P)=>{P.d(De,{D:()=>X});var _=P(576);function X(V){return Symbol.asyncIterator&&(0,_.m)(V?.[Symbol.asyncIterator])}},576:(mt,De,P)=>{function _(X){return"function"==typeof X}P.d(De,{m:()=>_})},3670:(mt,De,P)=>{P.d(De,{c:()=>V});var _=P(8822),X=P(576);function V(te){return(0,X.m)(te[_.L])}},6495:(mt,De,P)=>{P.d(De,{T:()=>V});var _=P(2202),X=P(576);function V(te){return(0,X.m)(te?.[_.h])}},8239:(mt,De,P)=>{P.d(De,{t:()=>X});var _=P(576);function X(V){return(0,_.m)(V?.then)}},3260:(mt,De,P)=>{P.d(De,{L:()=>te,Q:()=>V});var _=P(655),X=P(576);function V(ae){return(0,_.FC)(this,arguments,function*(){const de=ae.getReader();try{for(;;){const{value:ge,done:ue}=yield(0,_.qq)(de.read());if(ue)return yield(0,_.qq)(void 0);yield yield(0,_.qq)(ge)}}finally{de.releaseLock()}})}function te(ae){return(0,X.m)(ae?.getReader)}},4482:(mt,De,P)=>{P.d(De,{A:()=>X,e:()=>V});var _=P(576);function X(te){return(0,_.m)(te?.lift)}function V(te){return ae=>{if(X(ae))return ae.lift(function(ne){try{return te(ne,this)}catch(de){this.error(de)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(mt,De,P)=>{function _(){}P.d(De,{Z:()=>_})},9635:(mt,De,P)=>{P.d(De,{U:()=>V,z:()=>X});var _=P(4671);function X(...te){return V(te)}function V(te){return 0===te.length?_.y:1===te.length?te[0]:function(ne){return te.reduce((de,ge)=>ge(de),ne)}}},7849:(mt,De,P)=>{P.d(De,{h:()=>V});var _=P(2416),X=P(3410);function V(te){X.z.setTimeout(()=>{const{onUnhandledError:ae}=_.v;if(!ae)throw te;ae(te)})}},4532:(mt,De,P)=>{function _(X){return new TypeError(`You provided ${null!==X&&"object"==typeof X?"an invalid object":`'${X}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}P.d(De,{z:()=>_})},655:(mt,De,P)=>{function te(re,he){var _e={};for(var xe in re)Object.prototype.hasOwnProperty.call(re,xe)&&he.indexOf(xe)<0&&(_e[xe]=re[xe]);if(null!=re&&"function"==typeof Object.getOwnPropertySymbols){var Fe=0;for(xe=Object.getOwnPropertySymbols(re);Fe<xe.length;Fe++)he.indexOf(xe[Fe])<0&&Object.prototype.propertyIsEnumerable.call(re,xe[Fe])&&(_e[xe[Fe]]=re[xe[Fe]])}return _e}function Y(re,he,_e,xe){return new(_e||(_e=Promise))(function($e,et){function st(rn){try{Tt(xe.next(rn))}catch(Qe){et(Qe)}}function vn(rn){try{Tt(xe.throw(rn))}catch(Qe){et(Qe)}}function Tt(rn){rn.done?$e(rn.value):function Fe($e){return $e instanceof _e?$e:new _e(function(et){et($e)})}(rn.value).then(st,vn)}Tt((xe=xe.apply(re,he||[])).next())})}function Ae(re){return this instanceof Ae?(this.v=re,this):new Ae(re)}function Ie(re,he,_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Fe,xe=_e.apply(re,he||[]),$e=[];return Fe={},et("next"),et("throw"),et("return"),Fe[Symbol.asyncIterator]=function(){return this},Fe;function et(wt){xe[wt]&&(Fe[wt]=function(kn){return new Promise(function(Dn,Sn){$e.push([wt,kn,Dn,Sn])>1||st(wt,kn)})})}function st(wt,kn){try{!function vn(wt){wt.value instanceof Ae?Promise.resolve(wt.value.v).then(Tt,rn):Qe($e[0][2],wt)}(xe[wt](kn))}catch(Dn){Qe($e[0][3],Dn)}}function Tt(wt){st("next",wt)}function rn(wt){st("throw",wt)}function Qe(wt,kn){wt(kn),$e.shift(),$e.length&&st($e[0][0],$e[0][1])}}function Ge(re){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _e,he=re[Symbol.asyncIterator];return he?he.call(re):(re=function rt(re){var he="function"==typeof Symbol&&Symbol.iterator,_e=he&&re[he],xe=0;if(_e)return _e.call(re);if(re&&"number"==typeof re.length)return{next:function(){return re&&xe>=re.length&&(re=void 0),{value:re&&re[xe++],done:!re}}};throw new TypeError(he?"Object is not iterable.":"Symbol.iterator is not defined.")}(re),_e={},xe("next"),xe("throw"),xe("return"),_e[Symbol.asyncIterator]=function(){return this},_e);function xe($e){_e[$e]=re[$e]&&function(et){return new Promise(function(st,vn){!function Fe($e,et,st,vn){Promise.resolve(vn).then(function(Tt){$e({value:Tt,done:st})},et)}(st,vn,(et=re[$e](et)).done,et.value)})}}}P.d(De,{FC:()=>Ie,KL:()=>Ge,_T:()=>te,mG:()=>Y,qq:()=>Ae})},4650:(mt,De,P)=>{P.d(De,{$8M:()=>hl,$WT:()=>Zn,$Z:()=>UE,AFp:()=>qT,AaK:()=>ge,CRH:()=>Zv,CZH:()=>vm,CqO:()=>nd,D6c:()=>_b,EJc:()=>jA,F4k:()=>Dg,FYo:()=>vE,FiY:()=>Ji,G48:()=>lb,GfV:()=>wE,JOm:()=>wi,LFG:()=>He,Lbi:()=>aw,Lck:()=>wA,MMx:()=>Cv,NdJ:()=>yI,OlP:()=>Mn,P3R:()=>hy,PXZ:()=>ib,Q6J:()=>Ig,QGY:()=>Cg,Qsj:()=>cD,R0b:()=>ws,RDi:()=>fc,Rgc:()=>cd,SBq:()=>Ca,Sil:()=>lw,Suo:()=>dd,TTD:()=>aa,TgZ:()=>bg,X6Q:()=>KA,XFs:()=>_t,Xpm:()=>ar,Xts:()=>vu,Y36:()=>Gl,YKP:()=>IT,YNc:()=>Qy,Yjl:()=>Ve,Yz7:()=>Qe,Z0I:()=>Sn,ZZ4:()=>Fa,_UZ:()=>mI,_Vd:()=>Eu,_c5:()=>Ew,_uU:()=>OI,aQg:()=>ww,c2e:()=>ZT,cJS:()=>kn,cg1:()=>Fg,dDg:()=>tb,dqk:()=>Rt,eFA:()=>gw,eJc:()=>om,eoX:()=>Of,f3M:()=>at,g9A:()=>ow,h0i:()=>od,hGG:()=>mb,iGM:()=>Kv,ifc:()=>B,ip1:()=>kc,jDz:()=>Yg,kL8:()=>pv,lG2:()=>ye,lqb:()=>_c,lri:()=>Rm,n5z:()=>sh,oAB:()=>mo,q4F:()=>Ey,qLn:()=>Wh,qZA:()=>Xy,rWj:()=>kf,sBO:()=>mw,s_b:()=>xr,soG:()=>Em,tb:()=>Mm,tp0:()=>Ju,uIk:()=>wg,vHH:()=>pe,vpe:()=>co,wAp:()=>Ut,xp6:()=>RE,z2F:()=>Om,zSh:()=>my,zs3:()=>jl});var _=P(7579),X=P(727),V=P(9751),te=P(6451),ae=P(3099);function ne(s){for(let o in s)if(s[o]===ne)return o;throw Error("Could not find renamed property on target object.")}function ge(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(ge).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function ue(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const G=ne({__forward_ref__:ne});function W(s){return s.__forward_ref__=W,s.toString=function(){return ge(this())},s}function Y(s){return ke(s)?s():s}function ke(s){return"function"==typeof s&&s.hasOwnProperty(G)&&s.__forward_ref__===W}function ve(s){return s&&!!s.\u0275providers}const rt="https://g.co/ng/security#xss";class pe extends Error{constructor(o,u){super(be(o,u)),this.code=o}}function be(s,o){return`NG0${Math.abs(s)}${o?": "+o.trim():""}`}function Ne(s){return"string"==typeof s?s:null==s?"":String(s)}function Ge(s,o){throw new pe(-201,!1)}function et(s,o){null==s&&function st(s,o,u,l){throw new Error(`ASSERTION ERROR: ${s}`+(null==l?"":` [Expected=> ${u} ${l} ${o} <=Actual]`))}(o,s,null,"!=")}function Qe(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function kn(s){return{providers:s.providers||[],imports:s.imports||[]}}function Dn(s){return hn(s,Kn)||hn(s,Tn)}function Sn(s){return null!==Dn(s)}function hn(s,o){return s.hasOwnProperty(o)?s[o]:null}function Yr(s){return s&&(s.hasOwnProperty(ii)||s.hasOwnProperty(On))?s[ii]:null}const Kn=ne({\u0275prov:ne}),ii=ne({\u0275inj:ne}),Tn=ne({ngInjectableDef:ne}),On=ne({ngInjectorDef:ne});var _t=(()=>((_t=_t||{})[_t.Default=0]="Default",_t[_t.Host=1]="Host",_t[_t.Self=2]="Self",_t[_t.SkipSelf=4]="SkipSelf",_t[_t.Optional=8]="Optional",_t))();let Qr;function _n(s){const o=Qr;return Qr=s,o}function or(s,o,u){const l=Dn(s);return l&&"root"==l.providedIn?void 0===l.value?l.value=l.factory():l.value:u&_t.Optional?null:void 0!==o?o:void Ge(ge(s))}const Rt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),tn={},Hn="__NG_DI_FLAG__",Jn="ngTempTokenPath",er="ngTokenPath",Wi=/\n/gm,ln="\u0275",Pr="__source";let Yt;function yr(s){const o=Yt;return Yt=s,o}function si(s,o=_t.Default){if(void 0===Yt)throw new pe(-203,!1);return null===Yt?or(s,void 0,o):Yt.get(s,o&_t.Optional?null:void 0,o)}function He(s,o=_t.Default){return(function Xr(){return Qr}()||si)(Y(s),o)}function at(s,o=_t.Default){return He(s,Dt(o))}function Dt(s){return typeof s>"u"||"number"==typeof s?s:0|(s.optional&&8)|(s.host&&1)|(s.self&&2)|(s.skipSelf&&4)}function Lt(s){const o=[];for(let u=0;u<s.length;u++){const l=Y(s[u]);if(Array.isArray(l)){if(0===l.length)throw new pe(900,!1);let d,g=_t.Default;for(let v=0;v<l.length;v++){const I=l[v],b=Gn(I);"number"==typeof b?-1===b?d=I.token:g|=b:d=I}o.push(He(d,g))}else o.push(He(l))}return o}function Bt(s,o){return s[Hn]=o,s.prototype[Hn]=o,s}function Gn(s){return s[Hn]}function L(s){return{toString:s}.toString()}var q=(()=>((q=q||{})[q.OnPush=0]="OnPush",q[q.Default=1]="Default",q))(),B=(()=>{return(s=B||(B={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",B;var s})();const le={},Te=[],lt=ne({\u0275cmp:ne}),Pt=ne({\u0275dir:ne}),kt=ne({\u0275pipe:ne}),nn=ne({\u0275mod:ne}),bt=ne({\u0275fac:ne}),An=ne({__NG_ELEMENT_ID__:ne});let Tr=0;function ar(s){return L(()=>{const o=qi(s),u={...o,decls:s.decls,vars:s.vars,template:s.template,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,onPush:s.changeDetection===q.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&s.dependencies||null,getStandaloneInjector:null,data:s.data||{},encapsulation:s.encapsulation||B.Emulated,id:"c"+Tr++,styles:s.styles||Te,_:null,schemas:s.schemas||null,tView:null};kr(u);const l=s.dependencies;return u.directiveDefs=cs(l,!1),u.pipeDefs=cs(l,!0),u})}function Qo(s){return qe(s)||Qt(s)}function go(s){return null!==s}function mo(s){return L(()=>({type:s.type,bootstrap:s.bootstrap||Te,declarations:s.declarations||Te,imports:s.imports||Te,exports:s.exports||Te,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null}))}function Z(s,o){if(null==s)return le;const u={};for(const l in s)if(s.hasOwnProperty(l)){let d=s[l],g=d;Array.isArray(d)&&(g=d[1],d=d[0]),u[d]=l,o&&(o[d]=g)}return u}function ye(s){return L(()=>{const o=qi(s);return kr(o),o})}function Ve(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,standalone:!0===s.standalone,onDestroy:s.type.prototype.ngOnDestroy||null}}function qe(s){return s[lt]||null}function Qt(s){return s[Pt]||null}function $t(s){return s[kt]||null}function Zn(s){const o=qe(s)||Qt(s)||$t(s);return null!==o&&o.standalone}function fn(s,o){const u=s[nn]||null;if(!u&&!0===o)throw new Error(`Type ${ge(s)} does not have '\u0275mod' property.`);return u}function qi(s){const o={};return{type:s.type,providersResolver:null,factory:null,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:o,exportAs:s.exportAs||null,standalone:!0===s.standalone,selectors:s.selectors||Te,viewQuery:s.viewQuery||null,features:s.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Z(s.inputs,o),outputs:Z(s.outputs)}}function kr(s){s.features?.forEach(o=>o(s))}function cs(s,o){if(!s)return null;const u=o?$t:Qo;return()=>("function"==typeof s?s():s).map(l=>u(l)).filter(go)}const pi=0,ct=1,Ht=2,Ln=3,Jr=4,Pi=5,tr=6,zs=7,Fn=8,Jo=9,Ss=10,Kt=11,ls=12,Ws=13,_o=14,yo=15,br=16,As=17,Rs=18,ei=19,gi=20,Lu=21,dn=22,ea=1,$a=2,vo=7,wo=8,ta=9,Or=10;function mi(s){return Array.isArray(s)&&"object"==typeof s[ea]}function _i(s){return Array.isArray(s)&&!0===s[ea]}function ds(s){return 0!=(4&s.flags)}function na(s){return s.componentOffset>-1}function Ha(s){return 1==(1&s.flags)}function Hr(s){return!!s.template}function vp(s){return 0!=(256&s[Ht])}function Ms(s,o){return s.hasOwnProperty(bt)?s[bt]:null}class wp{constructor(o,u,l){this.previousValue=o,this.currentValue=u,this.firstChange=l}isFirstChange(){return this.firstChange}}function aa(){return Yi}function Yi(s){return s.type.prototype.ngOnChanges&&(s.setInput=Qi),Wa}function Wa(){const s=tl(this),o=s?.current;if(o){const u=s.previous;if(u===le)s.previous=o;else for(let l in o)u[l]=o[l];s.current=null,this.ngOnChanges(o)}}function Qi(s,o,u,l){const d=this.declaredInputs[u],g=tl(s)||function Bu(s,o){return s[Vu]=o}(s,{previous:le,current:null}),v=g.current||(g.current={}),I=g.previous,b=I[d];v[d]=new wp(b&&b.currentValue,o,I===le),s[l]=o}aa.ngInherit=!0;const Vu="__ngSimpleChanges__";function tl(s){return s[Vu]||null}const ti=function(s,o,u){};function z(s){for(;Array.isArray(s);)s=s[pi];return s}function Be(s,o){return z(o[s.index])}function jn(s,o){return s.data[o]}function sn(s,o){const u=o[s];return mi(u)?u:u[pi]}function Gt(s){return 64==(64&s[Ht])}function Cr(s,o){return null==o?null:s[o]}function ua(s){s[Rs]=0}function qs(s,o){s[Pi]+=o;let u=s,l=s[Ln];for(;null!==l&&(1===o&&1===u[Pi]||-1===o&&0===u[Pi]);)l[Pi]+=o,u=l,l=l[Ln]}const Ft={lFrame:P_(null),bindingsEnabled:!0};function S_(){return Ft.bindingsEnabled}function Pe(){return Ft.lFrame.lView}function pn(){return Ft.lFrame.tView}function Lr(){let s=A_();for(;null!==s&&64===s.type;)s=s.parent;return s}function A_(){return Ft.lFrame.currentTNode}function Ks(s,o){const u=Ft.lFrame;u.currentTNode=s,u.isParent=o}function rl(){return Ft.lFrame.isParent}function la(){return Ft.lFrame.bindingIndex++}function bp(s,o){const u=Ft.lFrame;u.bindingIndex=u.bindingRootIndex=s,Zs(o)}function Zs(s){Ft.lFrame.currentDirectiveIndex=s}function M_(){return Ft.lFrame.currentQueryIndex}function Cp(s){Ft.lFrame.currentQueryIndex=s}function $0(s){const o=s[ct];return 2===o.type?o.declTNode:1===o.type?s[tr]:null}function N_(s,o,u){if(u&_t.SkipSelf){let d=o,g=s;for(;!(d=d.parent,null!==d||u&_t.Host||(d=$0(g),null===d||(g=g[yo],10&d.type))););if(null===d)return!1;o=d,s=g}const l=Ft.lFrame=H0();return l.currentTNode=o,l.lView=s,!0}function Dp(s){const o=H0(),u=s[ct];Ft.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function H0(){const s=Ft.lFrame,o=null===s?null:s.child;return null===o?P_(s):o}function P_(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function k_(){const s=Ft.lFrame;return Ft.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const G0=k_;function Sp(){const s=k_();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function yi(){return Ft.lFrame.selectedIndex}function bo(s){Ft.lFrame.selectedIndex=s}function xn(){const s=Ft.lFrame;return jn(s.tView,s.selectedIndex)}function ju(s,o){for(let u=o.directiveStart,l=o.directiveEnd;u<l;u++){const g=s.data[u].type.prototype,{ngAfterContentInit:v,ngAfterContentChecked:I,ngAfterViewInit:b,ngAfterViewChecked:S,ngOnDestroy:R}=g;v&&(s.contentHooks||(s.contentHooks=[])).push(-u,v),I&&((s.contentHooks||(s.contentHooks=[])).push(u,I),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(u,I)),b&&(s.viewHooks||(s.viewHooks=[])).push(-u,b),S&&((s.viewHooks||(s.viewHooks=[])).push(u,S),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(u,S)),null!=R&&(s.destroyHooks||(s.destroyHooks=[])).push(u,R)}}function Yd(s,o,u){Za(s,o,3,u)}function da(s,o,u,l){(3&s[Ht])===u&&Za(s,o,u,l)}function Ka(s,o){let u=s[Ht];(3&u)===o&&(u&=2047,u+=1,s[Ht]=u)}function Za(s,o,u,l){const g=l??-1,v=o.length-1;let I=0;for(let b=void 0!==l?65535&s[Rs]:0;b<v;b++)if("number"==typeof o[b+1]){if(I=o[b],null!=l&&I>=l)break}else o[b]<0&&(s[Rs]+=65536),(I<g||-1==g)&&(O_(s,u,o,b),s[Rs]=(4294901760&s[Rs])+b+2),b++}function O_(s,o,u,l){const d=u[l]<0,g=u[l+1],I=s[d?-u[l]:u[l]];if(d){if(s[Ht]>>11<s[Rs]>>16&&(3&s[Ht])===o){s[Ht]+=2048,ti(4,I,g);try{g.call(I)}finally{ti(5,I,g)}}}else{ti(4,I,g);try{g.call(I)}finally{ti(5,I,g)}}}const Ys=-1;class ol{constructor(o,u,l){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=l}}function al(s,o,u){let l=0;for(;l<u.length;){const d=u[l];if("number"==typeof d){if(0!==d)break;l++;const g=u[l++],v=u[l++],I=u[l++];s.setAttribute(o,v,I,g)}else{const g=d,v=u[++l];ul(g)?s.setProperty(o,g,v):s.setAttribute(o,g,v),l++}}return l}function Do(s){return 3===s||4===s||6===s}function ul(s){return 64===s.charCodeAt(0)}function Qs(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let l=0;l<o.length;l++){const d=o[l];"number"==typeof d?u=d:0===u||Xd(s,u,d,null,-1===u||2===u?o[++l]:null)}}return s}function Xd(s,o,u,l,d){let g=0,v=s.length;if(-1===o)v=-1;else for(;g<s.length;){const I=s[g++];if("number"==typeof I){if(I===o){v=-1;break}if(I>o){v=g-1;break}}}for(;g<s.length;){const I=s[g];if("number"==typeof I)break;if(I===u){if(null===l)return void(null!==d&&(s[g+1]=d));if(l===s[g+1])return void(s[g+2]=d)}g++,null!==l&&g++,null!==d&&g++}-1!==v&&(s.splice(v,0,o),g=v+1),s.splice(g++,0,u),null!==l&&s.splice(g++,0,l),null!==d&&s.splice(g++,0,d)}function Jd(s){return s!==Ys}function Hu(s){return 32767&s}function ha(s,o){let u=function F_(s){return s>>16}(s),l=o;for(;u>0;)l=l[yo],u--;return l}let Gu=!0;function So(s){const o=Gu;return Gu=s,o}const th=255,zu=5;let cl=0;const vi={};function fa(s,o){const u=xp(s,o);if(-1!==u)return u;const l=o[ct];l.firstCreatePass&&(s.injectorIndex=o.length,Wu(l.data,s),Wu(o,null),Wu(l.blueprint,null));const d=qu(s,o),g=s.injectorIndex;if(Jd(d)){const v=Hu(d),I=ha(d,o),b=I[ct].data;for(let S=0;S<8;S++)o[g+S]=I[v+S]|b[v+S]}return o[g+8]=d,g}function Wu(s,o){s.push(0,0,0,0,0,0,0,0,o)}function xp(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function qu(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,l=null,d=o;for(;null!==d;){if(l=oh(d),null===l)return Ys;if(u++,d=d[yo],-1!==l.injectorIndex)return l.injectorIndex|u<<16}return Ys}function nh(s,o,u){!function U_(s,o,u){let l;"string"==typeof u?l=u.charCodeAt(0)||0:u.hasOwnProperty(An)&&(l=u[An]),null==l&&(l=u[An]=cl++);const d=l&th;o.data[s+(d>>zu)]|=1<<d}(s,o,u)}function rh(s,o,u){if(u&_t.Optional||void 0!==s)return s;Ge()}function Mp(s,o,u,l){if(u&_t.Optional&&void 0===l&&(l=null),!(u&(_t.Self|_t.Host))){const d=s[Jo],g=_n(void 0);try{return d?d.get(o,l,u&_t.Optional):or(o,l,u&_t.Optional)}finally{_n(g)}}return rh(l,0,u)}function Np(s,o,u,l=_t.Default,d){if(null!==s){if(1024&o[Ht]){const v=function kp(s,o,u,l,d){let g=s,v=o;for(;null!==g&&null!==v&&1024&v[Ht]&&!(256&v[Ht]);){const I=ll(g,v,u,l|_t.Self,vi);if(I!==vi)return I;let b=g.parent;if(!b){const S=v[Lu];if(S){const R=S.get(u,vi,l);if(R!==vi)return R}b=oh(v),v=v[yo]}g=b}return d}(s,o,u,l,vi);if(v!==vi)return v}const g=ll(s,o,u,l,vi);if(g!==vi)return g}return Mp(o,u,l,d)}function ll(s,o,u,l,d){const g=function Pp(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(An)?s[An]:void 0;return"number"==typeof o?o>=0?o&th:B_:o}(u);if("function"==typeof g){if(!N_(o,s,l))return l&_t.Host?rh(d,0,l):Mp(o,u,l,d);try{const v=g(l);if(null!=v||l&_t.Optional)return v;Ge()}finally{G0()}}else if("number"==typeof g){let v=null,I=xp(s,o),b=Ys,S=l&_t.Host?o[br][tr]:null;for((-1===I||l&_t.SkipSelf)&&(b=-1===I?qu(s,o):o[I+8],b!==Ys&&Ku(l,!1)?(v=o[ct],I=Hu(b),o=ha(b,o)):I=-1);-1!==I;){const R=o[ct];if(V_(g,I,R.data)){const U=ih(I,o,u,v,l,S);if(U!==vi)return U}b=o[I+8],b!==Ys&&Ku(l,o[ct].data[I+8]===S)&&V_(g,I,o)?(v=R,I=Hu(b),o=ha(b,o)):I=-1}}return d}function ih(s,o,u,l,d,g){const v=o[ct],I=v.data[s+8],R=dl(I,v,u,null==l?na(I)&&Gu:l!=v&&0!=(3&I.type),d&_t.Host&&g===I);return null!==R?pa(o,v,R,I):vi}function dl(s,o,u,l,d){const g=s.providerIndexes,v=o.data,I=1048575&g,b=s.directiveStart,R=g>>20,K=d?I+R:s.directiveEnd;for(let J=l?I:I+R;J<K;J++){const Ee=v[J];if(J<b&&u===Ee||J>=b&&Ee.type===u)return J}if(d){const J=v[b];if(J&&Hr(J)&&J.type===u)return b}return null}function pa(s,o,u,l){let d=s[u];const g=o.data;if(function $u(s){return s instanceof ol}(d)){const v=d;v.resolving&&function Ae(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new pe(-200,`Circular dependency in DI detected for ${s}${u}`)}(function Ue(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():Ne(s)}(g[u]));const I=So(v.canSeeViewProviders);v.resolving=!0;const b=v.injectImpl?_n(v.injectImpl):null;N_(s,l,_t.Default);try{d=s[u]=v.factory(void 0,g,s,l),o.firstCreatePass&&u>=l.directiveStart&&function Rp(s,o,u){const{ngOnChanges:l,ngOnInit:d,ngDoCheck:g}=o.type.prototype;if(l){const v=Yi(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(s,v),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,v)}d&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-s,d),g&&((u.preOrderHooks||(u.preOrderHooks=[])).push(s,g),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,g))}(u,g[u],o)}finally{null!==b&&_n(b),So(I),v.resolving=!1,G0()}}return d}function V_(s,o,u){return!!(u[o+(s>>zu)]&1<<s)}function Ku(s,o){return!(s&_t.Self||s&_t.Host&&o)}class Qa{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,l){return Np(this._tNode,this._lView,o,Dt(l),u)}}function B_(){return new Qa(Lr(),Pe())}function sh(s){return L(()=>{const o=s.prototype.constructor,u=o[bt]||Zu(o),l=Object.prototype;let d=Object.getPrototypeOf(s.prototype).constructor;for(;d&&d!==l;){const g=d[bt]||Zu(d);if(g&&g!==u)return g;d=Object.getPrototypeOf(d)}return g=>new g})}function Zu(s){return ke(s)?()=>{const o=Zu(Y(s));return o&&o()}:Ms(s)}function oh(s){const o=s[ct],u=o.type;return 2===u?o.declTNode:1===u?s[tr]:null}function hl(s){return function Ya(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const l=u.length;let d=0;for(;d<l;){const g=u[d];if(Do(g))break;if(0===g)d+=2;else if("number"==typeof g)for(d++;d<l&&"string"==typeof u[d];)d++;else{if(g===o)return u[d+1];d+=2}}}return null}(Lr(),s)}const Yu="__parameters__";function Ao(s,o,u){return L(()=>{const l=function ah(s){return function(...u){if(s){const l=s(...u);for(const d in l)this[d]=l[d]}}}(o);function d(...g){if(this instanceof d)return l.apply(this,g),this;const v=new d(...g);return I.annotation=v,I;function I(b,S,R){const U=b.hasOwnProperty(Yu)?b[Yu]:Object.defineProperty(b,Yu,{value:[]})[Yu];for(;U.length<=R;)U.push(null);return(U[R]=U[R]||[]).push(v),b}}return u&&(d.prototype=Object.create(u.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}class Mn{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=Qe({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function ma(s,o){s.forEach(u=>Array.isArray(u)?ma(u,o):o(u))}function z_(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function lh(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}const Ji=Bt(Ao("Optional"),8),Ju=Bt(Ao("SkipSelf"),4);var wi=(()=>((wi=wi||{})[wi.Important=1]="Important",wi[wi.DashCase=2]="DashCase",wi))();const es=new Map;let wl=0;const Il="__ngContext__";function ni(s,o){mi(o)?(s[Il]=o[gi],function Ih(s){es.set(s[gi],s)}(o)):s[Il]=o}let wa;function sc(s,o){return wa(s,o)}function ko(s){const o=s[Ln];return _i(o)?o[Ln]:o}function uu(s){return Sl(s[Ws])}function Dh(s){return Sl(s[Jr])}function Sl(s){for(;null!==s&&!_i(s);)s=s[Jr];return s}function Js(s,o,u,l,d){if(null!=l){let g,v=!1;_i(l)?g=l:mi(l)&&(v=!0,l=l[pi]);const I=z(l);0===s&&null!==u?null==d?Wp(o,u,I):ts(o,u,I,d||null,!0):1===s&&null!==u?ts(o,u,I,d||null,!0):2===s?function hu(s,o,u){const l=dc(s,o);l&&function cc(s,o,u,l){s.removeChild(o,u,l)}(s,l,o,u)}(o,I,v):3===s&&o.destroyNode(I),null!=g&&function gs(s,o,u,l,d){const g=u[vo];g!==z(u)&&Js(o,s,l,g,d);for(let I=Or;I<u.length;I++){const b=u[I];Oo(b[ct],b,s,o,l,g)}}(o,s,g,u,d)}}function Ah(s,o,u){return s.createElement(o,u)}function zp(s,o){const u=s[ta],l=u.indexOf(o),d=o[Ln];512&o[Ht]&&(o[Ht]&=-513,qs(d,-1)),u.splice(l,1)}function ac(s,o){if(s.length<=Or)return;const u=Or+o,l=s[u];if(l){const d=l[As];null!==d&&d!==s&&zp(d,l),o>0&&(s[u-1][Jr]=l[Jr]);const g=lh(s,Or+o);!function ty(s,o){Oo(s,o,o[Kt],2,null,null),o[pi]=null,o[tr]=null}(l[ct],l);const v=g[ei];null!==v&&v.detachView(g[ct]),l[Ln]=null,l[Jr]=null,l[Ht]&=-65}return l}function uc(s,o){if(!(128&o[Ht])){const u=o[Kt];u.destroyNode&&Oo(s,o,u,3,null,null),function ny(s){let o=s[Ws];if(!o)return Ml(s[ct],s);for(;o;){let u=null;if(mi(o))u=o[Ws];else{const l=o[Or];l&&(u=l)}if(!u){for(;o&&!o[Jr]&&o!==s;)mi(o)&&Ml(o[ct],o),o=o[Ln];null===o&&(o=s),mi(o)&&Ml(o[ct],o),u=o&&o[Jr]}o=u}}(o)}}function Ml(s,o){if(!(128&o[Ht])){o[Ht]&=-65,o[Ht]|=128,function xh(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let l=0;l<u.length;l+=2){const d=o[u[l]];if(!(d instanceof ol)){const g=u[l+1];if(Array.isArray(g))for(let v=0;v<g.length;v+=2){const I=d[g[v]],b=g[v+1];ti(4,I,b);try{b.call(I)}finally{ti(5,I,b)}}else{ti(4,d,g);try{g.call(d)}finally{ti(5,d,g)}}}}}(s,o),function Ea(s,o){const u=s.cleanup,l=o[zs];let d=-1;if(null!==u)for(let g=0;g<u.length-1;g+=2)if("string"==typeof u[g]){const v=u[g+3];v>=0?l[d=v]():l[d=-v].unsubscribe(),g+=2}else{const v=l[d=u[g+1]];u[g].call(v)}if(null!==l){for(let g=d+1;g<l.length;g++)(0,l[g])();o[zs]=null}}(s,o),1===o[ct].type&&o[Kt].destroy();const u=o[As];if(null!==u&&_i(o[Ln])){u!==o[Ln]&&zp(u,o);const l=o[ei];null!==l&&l.detachView(s)}!function Ar(s){es.delete(s[gi])}(o)}}function iy(s,o,u){return function Mh(s,o,u){let l=o;for(;null!==l&&40&l.type;)l=(o=l).parent;if(null===l)return u[pi];{const{componentOffset:d}=l;if(d>-1){const{encapsulation:g}=s.data[l.directiveStart+d];if(g===B.None||g===B.Emulated)return null}return Be(l,u)}}(s,o.parent,u)}function ts(s,o,u,l,d){s.insertBefore(o,u,l,d)}function Wp(s,o,u){s.appendChild(o,u)}function Ia(s,o,u,l,d){null!==l?ts(s,o,u,l,d):Wp(s,o,u)}function dc(s,o){return s.parentNode(o)}let kl,ms,pc,Pl=function eo(s,o,u){return 40&s.type?Be(s,u):null};function lu(s,o,u,l){const d=iy(s,l,o),g=o[Kt],I=function Nl(s,o,u){return Pl(s,o,u)}(l.parent||o[tr],l,o);if(null!=d)if(Array.isArray(u))for(let b=0;b<u.length;b++)Ia(g,d,u[b],I,!1);else Ia(g,d,u,I,!1);void 0!==kl&&kl(g,l,o,u,d)}function du(s,o){if(null!==o){const u=o.type;if(3&u)return Be(o,s);if(4&u)return Ta(-1,s[o.index]);if(8&u){const l=o.child;if(null!==l)return du(s,l);{const d=s[o.index];return _i(d)?Ta(-1,d):z(d)}}if(32&u)return sc(o,s)()||z(s[o.index]);{const l=Rr(s,o);return null!==l?Array.isArray(l)?l[0]:du(ko(s[br]),l):du(s,o.next)}}return null}function Rr(s,o){return null!==o?s[br][tr].projection[o.projection]:null}function Ta(s,o){const u=Or+s+1;if(u<o.length){const l=o[u],d=l[ct].firstChild;if(null!==d)return du(l,d)}return o[vo]}function Ph(s,o,u,l,d,g,v){for(;null!=u;){const I=l[u.index],b=u.type;if(v&&0===o&&(I&&ni(z(I),l),u.flags|=2),32!=(32&u.flags))if(8&b)Ph(s,o,u.child,l,d,g,!1),Js(o,s,d,I,g);else if(32&b){const S=sc(u,l);let R;for(;R=S();)Js(o,s,d,R,g);Js(o,s,d,I,g)}else 16&b?fu(s,o,l,u,d,g):Js(o,s,d,I,g);u=v?u.projectionNext:u.next}}function Oo(s,o,u,l,d,g){Ph(u,l,s.firstChild,o,d,g,!1)}function fu(s,o,u,l,d,g){const v=u[br],b=v[tr].projection[l.projection];if(Array.isArray(b))for(let S=0;S<b.length;S++)Js(o,s,d,b[S],g);else Ph(s,o,b,v[Ln],d,g,!0)}function pu(s,o,u){""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u)}function hc(s,o,u){const{mergedAttrs:l,classes:d,styles:g}=u;null!==l&&al(s,o,l),null!==d&&pu(s,o,d),null!==g&&function ci(s,o,u){s.setAttribute(o,"style",u)}(s,o,g)}function fc(s){ms=s}function Yp(s){return function Ll(){if(void 0===pc&&(pc=null,Rt.trustedTypes))try{pc=Rt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:s=>s,createScript:s=>s,createScriptURL:s=>s})}catch{}return pc}()?.createScriptURL(s)||s}class Qp{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${rt})`}}function C(s){return s instanceof Qp?s.changingThisBreaksApplicationSecurity:s}function M(s,o){const u=function Q(s){return s instanceof Qp&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see ${rt})`)}return u===o}const mc=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var Ur=(()=>((Ur=Ur||{})[Ur.NONE=0]="NONE",Ur[Ur.HTML=1]="HTML",Ur[Ur.STYLE=2]="STYLE",Ur[Ur.SCRIPT=3]="SCRIPT",Ur[Ur.URL=4]="URL",Ur[Ur.RESOURCE_URL=5]="RESOURCE_URL",Ur))();function ng(s){const o=Hh();return o?o.sanitize(Ur.URL,s)||"":M(s,"URL")?C(s):function _u(s){return(s=String(s)).match(mc)?s:"unsafe:"+s}(Ne(s))}function ys(s){const o=Hh();if(o)return Yp(o.sanitize(Ur.RESOURCE_URL,s)||"");if(M(s,"ResourceURL"))return Yp(C(s));throw new pe(904,!1)}function hy(s,o,u){return function nD(s,o){return"src"===o&&("embed"===s||"frame"===s||"iframe"===s||"media"===s||"script"===s)||"href"===o&&("base"===s||"link"===s)?ys:ng}(o,u)(s)}function Hh(){const s=Pe();return s&&s[ls]}const vu=new Mn("ENVIRONMENT_INITIALIZER"),Ul=new Mn("INJECTOR",-1),oE=new Mn("INJECTOR_DEF_TYPES");class aE{get(o,u=tn){if(u===tn){const l=new Error(`NullInjectorError: No provider for ${ge(o)}!`);throw l.name="NullInjectorError",l}return u}}function Gh(...s){return{\u0275providers:uE(0,s),\u0275fromNgModule:!0}}function uE(s,...o){const u=[],l=new Set;let d;return ma(o,g=>{const v=g;py(v,u,[],l)&&(d||(d=[]),d.push(v))}),void 0!==d&&cE(d,u),u}function cE(s,o){for(let u=0;u<s.length;u++){const{providers:d}=s[u];gy(d,g=>{o.push(g)})}}function py(s,o,u,l){if(!(s=Y(s)))return!1;let d=null,g=Yr(s);const v=!g&&qe(s);if(g||v){if(v&&!v.standalone)return!1;d=s}else{const b=s.ngModule;if(g=Yr(b),!g)return!1;d=b}const I=l.has(d);if(v){if(I)return!1;if(l.add(d),v.dependencies){const b="function"==typeof v.dependencies?v.dependencies():v.dependencies;for(const S of b)py(S,o,u,l)}}else{if(!g)return!1;{if(null!=g.imports&&!I){let S;l.add(d);try{ma(g.imports,R=>{py(R,o,u,l)&&(S||(S=[]),S.push(R))})}finally{}void 0!==S&&cE(S,o)}if(!I){const S=Ms(d)||(()=>new d);o.push({provide:d,useFactory:S,deps:Te},{provide:oE,useValue:d,multi:!0},{provide:vu,useValue:()=>He(d),multi:!0})}const b=g.providers;null==b||I||gy(b,R=>{o.push(R)})}}return d!==s&&void 0!==s.providers}function gy(s,o){for(let u of s)ve(u)&&(u=u.\u0275providers),Array.isArray(u)?gy(u,o):o(u)}const rD=ne({provide:String,useValue:ne});function lE(s){return null!==s&&"object"==typeof s&&rD in s}function Lo(s){return"function"==typeof s}const my=new Mn("Set Injector scope."),sg={},iD={};let _y;function og(){return void 0===_y&&(_y=new aE),_y}class _c{}class hE extends _c{get destroyed(){return this._destroyed}constructor(o,u,l,d){super(),this.parent=u,this.source=l,this.scopes=d,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,wy(o,v=>this.processProvider(v)),this.records.set(Ul,wu(void 0,this)),d.has("environment")&&this.records.set(_c,wu(void 0,this));const g=this.records.get(my);null!=g&&"string"==typeof g.value&&this.scopes.add(g.value),this.injectorDefTypes=new Set(this.get(oE.multi,Te,_t.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const u=yr(this),l=_n(void 0);try{return o()}finally{yr(u),_n(l)}}get(o,u=tn,l=_t.Default){this.assertNotDestroyed(),l=Dt(l);const d=yr(this),g=_n(void 0);try{if(!(l&_t.SkipSelf)){let I=this.records.get(o);if(void 0===I){const b=function ag(s){return"function"==typeof s||"object"==typeof s&&s instanceof Mn}(o)&&Dn(o);I=b&&this.injectableDefInScope(b)?wu(yy(o),sg):null,this.records.set(o,I)}if(null!=I)return this.hydrate(o,I)}return(l&_t.Self?og():this.parent).get(o,u=l&_t.Optional&&u===tn?null:u)}catch(v){if("NullInjectorError"===v.name){if((v[Jn]=v[Jn]||[]).unshift(ge(o)),d)throw v;return function H(s,o,u,l){const d=s[Jn];throw o[Pr]&&d.unshift(o[Pr]),s.message=function A(s,o,u,l=null){s=s&&"\n"===s.charAt(0)&&s.charAt(1)==ln?s.slice(2):s;let d=ge(o);if(Array.isArray(o))d=o.map(ge).join(" -> ");else if("object"==typeof o){let g=[];for(let v in o)if(o.hasOwnProperty(v)){let I=o[v];g.push(v+":"+("string"==typeof I?JSON.stringify(I):ge(I)))}d=`{${g.join(", ")}}`}return`${u}${l?"("+l+")":""}[${d}]: ${s.replace(Wi,"\n  ")}`}("\n"+s.message,d,u,l),s[er]=d,s[Jn]=null,s}(v,o,"R3InjectorError",this.source)}throw v}finally{_n(g),yr(d)}}resolveInjectorInitializers(){const o=yr(this),u=_n(void 0);try{const l=this.get(vu.multi,Te,_t.Self);for(const d of l)d()}finally{yr(o),_n(u)}}toString(){const o=[],u=this.records;for(const l of u.keys())o.push(ge(l));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new pe(205,!1)}processProvider(o){let u=Lo(o=Y(o))?o:Y(o&&o.provide);const l=function fE(s){return lE(s)?wu(void 0,s.useValue):wu(function pE(s,o,u){let l;if(Lo(s)){const d=Y(s);return Ms(d)||yy(d)}if(lE(s))l=()=>Y(s.useValue);else if(function ig(s){return!(!s||!s.useFactory)}(s))l=()=>s.useFactory(...Lt(s.deps||[]));else if(function dE(s){return!(!s||!s.useExisting)}(s))l=()=>He(Y(s.useExisting));else{const d=Y(s&&(s.useClass||s.provide));if(!function gE(s){return!!s.deps}(s))return Ms(d)||yy(d);l=()=>new d(...Lt(s.deps))}return l}(s),sg)}(o);if(Lo(o)||!0!==o.multi)this.records.get(u);else{let d=this.records.get(u);d||(d=wu(void 0,sg,!0),d.factory=()=>Lt(d.multi),this.records.set(u,d)),u=o,d.multi.push(o)}this.records.set(u,l)}hydrate(o,u){return u.value===sg&&(u.value=iD,u.value=u.factory()),"object"==typeof u.value&&u.value&&function vy(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=Y(o.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function yy(s){const o=Dn(s),u=null!==o?o.factory:Ms(s);if(null!==u)return u;if(s instanceof Mn)throw new pe(204,!1);if(s instanceof Function)return function sD(s){const o=s.length;if(o>0)throw function eu(s,o){const u=[];for(let l=0;l<s;l++)u.push(o);return u}(o,"?"),new pe(204,!1);const u=function sr(s){const o=s&&(s[Kn]||s[Tn]);return o?(function Nr(s){if(s.hasOwnProperty("name"))return s.name;(""+s).match(/^function\s*([^\s(]+)/)}(s),o):null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new pe(204,!1)}function wu(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function wy(s,o){for(const u of s)Array.isArray(u)?wy(u,o):u&&ve(u)?wy(u.\u0275providers,o):o(u)}class oD{}class mE{}class _E{resolveComponentFactory(o){throw function aD(s){const o=Error(`No component factory found for ${ge(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let Eu=(()=>{class s{}return s.NULL=new _E,s})();function ug(){return yc(Lr(),Pe())}function yc(s,o){return new Ca(Be(s,o))}let Ca=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=ug,s})();function yE(s){return s instanceof Ca?s.nativeElement:s}class vE{}let cD=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function lD(){const s=Pe(),u=sn(Lr().index,s);return(mi(u)?u:s)[Kt]}(),s})(),dD=(()=>{class s{}return s.\u0275prov=Qe({token:s,providedIn:"root",factory:()=>null}),s})();class wE{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Ey=new wE("15.2.3"),Iy={},Ty="ngOriginalError";function by(s){return s[Ty]}class Wh{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o);this._console.error("ERROR",o),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&by(o);for(;u&&by(u);)u=by(u);return u||null}}function Fo(s){return s instanceof Function?s():s}function Cy(s,o,u){let l=s.length;for(;;){const d=s.indexOf(o,u);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const g=o.length;if(d+g===l||s.charCodeAt(d+g)<=32)return d}u=d+1}}const cg="ng-template";function yD(s,o,u){let l=0;for(;l<s.length;){let d=s[l++];if(u&&"class"===d){if(d=s[l],-1!==Cy(d.toLowerCase(),o,0))return!0}else if(1===d){for(;l<s.length&&"string"==typeof(d=s[l++]);)if(d.toLowerCase()===o)return!0;return!1}}return!1}function Dy(s){return 4===s.type&&s.value!==cg}function Bl(s,o,u){return o===(4!==s.type||u?s.value:cg)}function Sy(s,o,u){let l=4;const d=s.attrs||[],g=function DE(s){for(let o=0;o<s.length;o++)if(Do(s[o]))return o;return s.length}(d);let v=!1;for(let I=0;I<o.length;I++){const b=o[I];if("number"!=typeof b){if(!v)if(4&l){if(l=2|1&l,""!==b&&!Bl(s,b,u)||""===b&&1===o.length){if(to(l))return!1;v=!0}}else{const S=8&l?b:o[++I];if(8&l&&null!==s.attrs){if(!yD(s.attrs,S,u)){if(to(l))return!1;v=!0}continue}const U=CE(8&l?"class":b,d,Dy(s),u);if(-1===U){if(to(l))return!1;v=!0;continue}if(""!==S){let K;K=U>g?"":d[U+1].toLowerCase();const J=8&l?K:null;if(J&&-1!==Cy(J,S,0)||2&l&&S!==K){if(to(l))return!1;v=!0}}}}else{if(!v&&!to(l)&&!to(b))return!1;if(v&&to(b))continue;v=!1,l=b|1&l}}return to(l)||v}function to(s){return 0==(1&s)}function CE(s,o,u,l){if(null===o)return-1;let d=0;if(l||!u){let g=!1;for(;d<o.length;){const v=o[d];if(v===s)return d;if(3===v||6===v)g=!0;else{if(1===v||2===v){let I=o[++d];for(;"string"==typeof I;)I=o[++d];continue}if(4===v)break;if(0===v){d+=4;continue}}d+=g?1:2}return-1}return function SE(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const l=s[u];if("number"==typeof l)return-1;if(l===o)return u;u++}return-1}(o,s)}function qh(s,o,u=!1){for(let l=0;l<o.length;l++)if(Sy(s,o[l],u))return!0;return!1}function AE(s,o){return s?":not("+o.trim()+")":o}function wD(s){let o=s[0],u=1,l=2,d="",g=!1;for(;u<s.length;){let v=s[u];if("string"==typeof v)if(2&l){const I=s[++u];d+="["+v+(I.length>0?'="'+I+'"':"")+"]"}else 8&l?d+="."+v:4&l&&(d+=" "+v);else""!==d&&!to(v)&&(o+=AE(g,d),d=""),l=v,g=g||!to(l);u++}return""!==d&&(o+=AE(g,d)),o}const Wt={};function RE(s){xE(pn(),Pe(),yi()+s,!1)}function xE(s,o,u,l){if(!l)if(3==(3&o[Ht])){const g=s.preOrderCheckHooks;null!==g&&Yd(o,g,u)}else{const g=s.preOrderHooks;null!==g&&da(o,g,0,u)}bo(u)}function NE(s,o=null,u=null,l){const d=Ry(s,o,u,l);return d.resolveInjectorInitializers(),d}function Ry(s,o=null,u=null,l,d=new Set){const g=[u||Te,Gh(s)];return l=l||("object"==typeof s?void 0:ge(s)),new hE(g,o||og(),l||null,d)}let jl=(()=>{class s{static create(u,l){if(Array.isArray(u))return NE({name:""},l,u,"");{const d=u.name??"";return NE({name:d},u.parent,u.providers,d)}}}return s.THROW_IF_NOT_FOUND=tn,s.NULL=new aE,s.\u0275prov=Qe({token:s,providedIn:"any",factory:()=>He(Ul)}),s.__NG_ELEMENT_ID__=-1,s})();function Gl(s,o=_t.Default){const u=Pe();return null===u?He(s,o):Np(Lr(),u,Y(s),o)}function UE(){throw new Error("invalid")}function VE(s,o){const u=s.contentQueries;if(null!==u)for(let l=0;l<u.length;l+=2){const g=u[l+1];if(-1!==g){const v=s.data[g];Cp(u[l]),v.contentQueries(2,o[g],g)}}}function fg(s,o,u,l,d,g,v,I,b,S,R){const U=o.blueprint.slice();return U[pi]=d,U[Ht]=76|l,(null!==R||s&&1024&s[Ht])&&(U[Ht]|=1024),ua(U),U[Ln]=U[yo]=s,U[Fn]=u,U[Ss]=v||s&&s[Ss],U[Kt]=I||s&&s[Kt],U[ls]=b||s&&s[ls]||null,U[Jo]=S||s&&s[Jo]||null,U[tr]=g,U[gi]=function $p(){return wl++}(),U[Lu]=R,U[br]=2==o.type?s[br]:U,U}function Qh(s,o,u,l,d){let g=s.data[o];if(null===g)g=function jE(s,o,u,l,d){const g=A_(),v=rl(),b=s.data[o]=function $D(s,o,u,l,d,g){return{type:u,index:l,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:g,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,v?g:g&&g.parent,u,o,l,d);return null===s.firstChild&&(s.firstChild=b),null!==g&&(v?null==g.child&&null!==b.parent&&(g.child=b):null===g.next&&(g.next=b,b.prev=g)),b}(s,o,u,l,d),function Ip(){return Ft.lFrame.inI18n}()&&(g.flags|=32);else if(64&g.type){g.type=u,g.value=l,g.attrs=d;const v=function ca(){const s=Ft.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();g.injectorIndex=null===v?-1:v.injectorIndex}return Ks(g,!0),g}function pg(s,o,u,l){if(0===u)return-1;const d=o.length;for(let g=0;g<u;g++)o.push(l),s.blueprint.push(l),s.data.push(null);return d}function $E(s,o,u){Dp(o);try{const l=s.viewQuery;null!==l&&jy(1,l,u);const d=s.template;null!==d&&UD(s,o,d,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&VE(s,o),s.staticViewQueries&&jy(2,s.viewQuery,u);const g=s.components;null!==g&&function BE(s,o){for(let u=0;u<o.length;u++)Fi(s,o[u])}(o,g)}catch(l){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),l}finally{o[Ht]&=-5,Sp()}}function ky(s,o,u,l){const d=o[Ht];if(128!=(128&d)){Dp(o);try{ua(o),function R_(s){return Ft.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&UD(s,o,u,2,l);const v=3==(3&d);if(v){const S=s.preOrderCheckHooks;null!==S&&Yd(o,S,null)}else{const S=s.preOrderHooks;null!==S&&da(o,S,0,null),Ka(o,0)}if(function HN(s){for(let o=uu(s);null!==o;o=Dh(o)){if(!o[$a])continue;const u=o[ta];for(let l=0;l<u.length;l++){const d=u[l];512&d[Ht]||qs(d[Ln],1),d[Ht]|=512}}}(o),function $N(s){for(let o=uu(s);null!==o;o=Dh(o))for(let u=Or;u<o.length;u++){const l=o[u],d=l[ct];Gt(l)&&ky(d,l,d.template,l[Fn])}}(o),null!==s.contentQueries&&VE(s,o),v){const S=s.contentCheckHooks;null!==S&&Yd(o,S)}else{const S=s.contentHooks;null!==S&&da(o,S,1),Ka(o,1)}!function LD(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let l=0;l<u.length;l++){const d=u[l];if(d<0)bo(~d);else{const g=d,v=u[++l],I=u[++l];bp(v,g),I(2,o[g])}}}finally{bo(-1)}}(s,o);const I=s.components;null!==I&&function FD(s,o){for(let u=0;u<o.length;u++)GN(s,o[u])}(o,I);const b=s.viewQuery;if(null!==b&&jy(2,b,l),v){const S=s.viewCheckHooks;null!==S&&Yd(o,S)}else{const S=s.viewHooks;null!==S&&da(o,S,2),Ka(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[Ht]&=-41,512&o[Ht]&&(o[Ht]&=-513,qs(o[Ln],-1))}finally{Sp()}}}function UD(s,o,u,l,d){const g=yi(),v=2&l;try{bo(-1),v&&o.length>dn&&xE(s,o,dn,!1),ti(v?2:0,d),u(l,d)}finally{bo(g),ti(v?3:1,d)}}function HE(s,o,u){if(ds(o)){const d=o.directiveEnd;for(let g=o.directiveStart;g<d;g++){const v=s.data[g];v.contentQueries&&v.contentQueries(1,u[g],g)}}}function GE(s,o,u){S_()&&(function YE(s,o,u,l){const d=u.directiveStart,g=u.directiveEnd;na(u)&&function qD(s,o,u){const l=Be(o,s),d=VD(u),g=s[Ss],v=N(s,fg(s,d,null,u.onPush?32:16,l,o,g,g.createRenderer(l,u),null,null,null));s[o.index]=v}(o,u,s.data[d+u.componentOffset]),s.firstCreatePass||fa(u,o),ni(l,o);const v=u.initialInputs;for(let I=d;I<g;I++){const b=s.data[I],S=pa(o,s,I,u);ni(S,o),null!==v&&BN(0,I-d,S,b,0,v),Hr(b)&&(sn(u.index,o)[Fn]=pa(o,s,I,u))}}(s,o,u,Be(u,o)),64==(64&u.flags)&&zl(s,o,u))}function zE(s,o,u=Be){const l=o.localNames;if(null!==l){let d=o.index+1;for(let g=0;g<l.length;g+=2){const v=l[g+1],I=-1===v?u(o,s):s[v];s[d++]=I}}}function VD(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=Oy(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function Oy(s,o,u,l,d,g,v,I,b,S){const R=dn+l,U=R+d,K=function BD(s,o){const u=[];for(let l=0;l<o;l++)u.push(l<s?null:Wt);return u}(R,U),J="function"==typeof S?S():S;return K[ct]={type:s,blueprint:K,template:u,queries:null,viewQuery:I,declTNode:o,data:K.slice().fill(null,R),bindingStartIndex:R,expandoStartIndex:U,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof g?g():g,pipeRegistry:"function"==typeof v?v():v,firstChild:null,schemas:b,consts:J,incompleteFirstPass:!1}}function WE(s,o,u,l){const d=XE(o);null===u?d.push(l):(d.push(u),s.firstCreatePass&&Jh(s).push(l,d.length-1))}function qE(s,o,u,l){for(let d in s)if(s.hasOwnProperty(d)){u=null===u?{}:u;const g=s[d];null===l?KE(u,o,d,g):l.hasOwnProperty(d)&&KE(u,o,l[d],g)}return u}function KE(s,o,u,l){s.hasOwnProperty(u)?s[u].push(o,l):s[u]=[o,l]}function ZE(s,o){const u=sn(o,s);16&u[Ht]||(u[Ht]|=32)}function Xh(s,o,u,l){if(S_()){const d=null===l?null:{"":-1},g=function FN(s,o){const u=s.directiveRegistry;let l=null,d=null;if(u)for(let g=0;g<u.length;g++){const v=u[g];if(qh(o,v.selectors,!1))if(l||(l=[]),Hr(v))if(null!==v.findHostDirectiveDefs){const I=[];d=d||new Map,v.findHostDirectiveDefs(v,I,d),l.unshift(...I,v),Vy(s,o,I.length)}else l.unshift(v),Vy(s,o,0);else d=d||new Map,v.findHostDirectiveDefs?.(v,l,d),l.push(v)}return null===l?null:[l,d]}(s,u);let v,I;null===g?v=I=null:[v,I]=g,null!==v&&Fy(s,o,u,v,d,I),d&&function By(s,o,u){if(o){const l=s.localNames=[];for(let d=0;d<o.length;d+=2){const g=u[o[d+1]];if(null==g)throw new pe(-301,!1);l.push(o[d],g)}}}(u,l,d)}u.mergedAttrs=Qs(u.mergedAttrs,u.attrs)}function Fy(s,o,u,l,d,g){for(let S=0;S<l.length;S++)nh(fa(u,o),s,l[S].type);!function VN(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}(u,s.data.length,l.length);for(let S=0;S<l.length;S++){const R=l[S];R.providersResolver&&R.providersResolver(R)}let v=!1,I=!1,b=pg(s,o,l.length,null);for(let S=0;S<l.length;S++){const R=l[S];u.mergedAttrs=Qs(u.mergedAttrs,R.hostAttrs),WD(s,u,o,b,R),UN(b,R,d),null!==R.contentQueries&&(u.flags|=4),(null!==R.hostBindings||null!==R.hostAttrs||0!==R.hostVars)&&(u.flags|=64);const U=R.type.prototype;!v&&(U.ngOnChanges||U.ngOnInit||U.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(u.index),v=!0),!I&&(U.ngOnChanges||U.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(u.index),I=!0),b++}!function cr(s,o,u){const d=o.directiveEnd,g=s.data,v=o.attrs,I=[];let b=null,S=null;for(let R=o.directiveStart;R<d;R++){const U=g[R],K=u?u.get(U):null,Ee=K?K.outputs:null;b=qE(U.inputs,R,b,K?K.inputs:null),S=qE(U.outputs,R,S,Ee);const ze=null===b||null===v||Dy(o)?null:jN(b,R,v);I.push(ze)}null!==b&&(b.hasOwnProperty("class")&&(o.flags|=8),b.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=I,o.inputs=b,o.outputs=S}(s,u,g)}function zl(s,o,u){const l=u.directiveStart,d=u.directiveEnd,g=u.index,v=function x_(){return Ft.lFrame.currentDirectiveIndex}();try{bo(g);for(let I=l;I<d;I++){const b=s.data[I],S=o[I];Zs(I),(null!==b.hostBindings||0!==b.hostVars||null!==b.hostAttrs)&&zD(b,S)}}finally{bo(-1),Zs(v)}}function zD(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function Vy(s,o,u){o.componentOffset=u,(s.components||(s.components=[])).push(o.index)}function UN(s,o,u){if(u){if(o.exportAs)for(let l=0;l<o.exportAs.length;l++)u[o.exportAs[l]]=s;Hr(o)&&(u[""]=s)}}function WD(s,o,u,l,d){s.data[l]=d;const g=d.factory||(d.factory=Ms(d.type)),v=new ol(g,Hr(d),Gl);s.blueprint[l]=v,u[l]=v,function Uy(s,o,u,l,d){const g=d.hostBindings;if(g){let v=s.hostBindingOpCodes;null===v&&(v=s.hostBindingOpCodes=[]);const I=~o.index;(function un(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(v)!=I&&v.push(I),v.push(u,l,g)}}(s,o,l,pg(s,u,d.hostVars,Wt),d)}function Da(s,o,u,l,d,g){const v=Be(s,o);!function QE(s,o,u,l,d,g,v){if(null==g)s.removeAttribute(o,d,u);else{const I=null==v?Ne(g):v(g,l||"",d);s.setAttribute(o,d,I,u)}}(o[Kt],v,g,s.value,u,l,d)}function BN(s,o,u,l,d,g){const v=g[o];if(null!==v){const I=l.setInput;for(let b=0;b<v.length;){const S=v[b++],R=v[b++],U=v[b++];null!==I?l.setInput(u,U,S,R):u[R]=U}}}function jN(s,o,u){let l=null,d=0;for(;d<u.length;){const g=u[d];if(0!==g)if(5!==g){if("number"==typeof g)break;if(s.hasOwnProperty(g)){null===l&&(l=[]);const v=s[g];for(let I=0;I<v.length;I+=2)if(v[I]===o){l.push(g,v[I+1],u[d+1]);break}}d+=2}else d+=2;else d+=4}return l}function KD(s,o,u,l){return[s,!0,!1,o,null,0,l,u,null,null]}function GN(s,o){const u=sn(o,s);if(Gt(u)){const l=u[ct];48&u[Ht]?ky(l,u,l.template,u[Fn]):u[Pi]>0&&me(u)}}function me(s){for(let l=uu(s);null!==l;l=Dh(l))for(let d=Or;d<l.length;d++){const g=l[d];if(Gt(g))if(512&g[Ht]){const v=g[ct];ky(v,g,v.template,g[Fn])}else g[Pi]>0&&me(g)}const u=s[ct].components;if(null!==u)for(let l=0;l<u.length;l++){const d=sn(u[l],s);Gt(d)&&d[Pi]>0&&me(d)}}function Fi(s,o){const u=sn(o,s),l=u[ct];(function no(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(l,u),$E(l,u,u[Fn])}function N(s,o){return s[Ws]?s[_o][Jr]=o:s[Ws]=o,s[_o]=o,o}function vs(s){for(;s;){s[Ht]|=32;const o=ko(s);if(vp(s)&&!o)return s;s=o}return null}function Wl(s,o,u,l=!0){const d=o[Ss];d.begin&&d.begin();try{ky(s,o,s.template,u)}catch(v){throw l&&JE(o,v),v}finally{d.end&&d.end()}}function jy(s,o,u){Cp(0),o(s,u)}function XE(s){return s[zs]||(s[zs]=[])}function Jh(s){return s.cleanup||(s.cleanup=[])}function JE(s,o){const u=s[Jo],l=u?u.get(Wh,null):null;l&&l.handleError(o)}function $y(s,o,u,l,d){for(let g=0;g<u.length;){const v=u[g++],I=u[g++],b=o[v],S=s.data[v];null!==S.setInput?S.setInput(b,d,l,I):b[I]=d}}function ef(s,o,u){let l=u?s.styles:null,d=u?s.classes:null,g=0;if(null!==o)for(let v=0;v<o.length;v++){const I=o[v];"number"==typeof I?g=I:1==g?d=ue(d,I):2==g&&(l=ue(l,I+": "+o[++v]+";"))}u?s.styles=l:s.stylesWithoutHost=l,u?s.classes=d:s.classesWithoutHost=d}function mg(s,o,u,l,d=!1){for(;null!==u;){const g=o[u.index];if(null!==g&&l.push(z(g)),_i(g))for(let I=Or;I<g.length;I++){const b=g[I],S=b[ct].firstChild;null!==S&&mg(b[ct],b,S,l)}const v=u.type;if(8&v)mg(s,o,u.child,l);else if(32&v){const I=sc(u,o);let b;for(;b=I();)l.push(b)}else if(16&v){const I=Rr(o,u);if(Array.isArray(I))l.push(...I);else{const b=ko(o[br]);mg(b[ct],b,I,l,!0)}}u=d?u.projectionNext:u.next}return l}class tf{get rootNodes(){const o=this._lView,u=o[ct];return mg(u,o,u.firstChild,[])}constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Fn]}set context(o){this._lView[Fn]=o}get destroyed(){return 128==(128&this._lView[Ht])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[Ln];if(_i(o)){const u=o[wo],l=u?u.indexOf(this):-1;l>-1&&(ac(o,l),lh(u,l))}this._attachedToViewContainer=!1}uc(this._lView[ct],this._lView)}onDestroy(o){WE(this._lView[ct],this._lView,null,o)}markForCheck(){vs(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ht]&=-65}reattach(){this._lView[Ht]|=64}detectChanges(){Wl(this._lView[ct],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new pe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Rh(s,o){Oo(s,o,o[Kt],2,null,null)}(this._lView[ct],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new pe(902,!1);this._appRef=o}}class YD extends tf{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Wl(o[ct],o,o[Fn],!1)}checkNoChanges(){}get context(){return null}}class eI extends Eu{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=qe(o);return new Ec(u,this.ngModule)}}function Ci(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class tI{constructor(o,u){this.injector=o,this.parentInjector=u}get(o,u,l){l=Dt(l);const d=this.injector.get(o,Iy,l);return d!==Iy||u===Iy?d:this.parentInjector.get(o,u,l)}}class Ec extends mE{get inputs(){return Ci(this.componentDef.inputs)}get outputs(){return Ci(this.componentDef.outputs)}constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function ED(s){return s.map(wD).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}create(o,u,l,d){let g=(d=d||this.ngModule)instanceof _c?d:d?.injector;g&&null!==this.componentDef.getStandaloneInjector&&(g=this.componentDef.getStandaloneInjector(g)||g);const v=g?new tI(o,g):o,I=v.get(vE,null);if(null===I)throw new pe(407,!1);const b=v.get(dD,null),S=I.createRenderer(null,this.componentDef),R=this.componentDef.selectors[0][0]||"div",U=l?function jD(s,o,u){return s.selectRootElement(o,u===B.ShadowDom)}(S,l,this.componentDef.encapsulation):Ah(S,R,function _g(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(R)),K=this.componentDef.onPush?288:272,J=Oy(0,null,null,1,0,null,null,null,null,null),Ee=fg(null,J,null,K,null,null,I,S,b,v,null);let ze,it;Dp(Ee);try{const Xe=this.componentDef;let jt,Me=null;Xe.findHostDirectiveDefs?(jt=[],Me=new Map,Xe.findHostDirectiveDefs(Xe,jt,Me),jt.push(Xe)):jt=[Xe];const pt=function Hy(s,o){const u=s[ct],l=dn;return s[l]=o,Qh(u,l,2,"#host",null)}(Ee,U),Nn=function QD(s,o,u,l,d,g,v,I){const b=d[ct];!function XD(s,o,u,l){for(const d of s)o.mergedAttrs=Qs(o.mergedAttrs,d.hostAttrs);null!==o.mergedAttrs&&(ef(o,o.mergedAttrs,!0),null!==u&&hc(l,u,o))}(l,s,o,v);const S=g.createRenderer(o,u),R=fg(d,VD(u),null,u.onPush?32:16,d[s.index],s,g,S,I||null,null,null);return b.firstCreatePass&&Vy(b,s,l.length-1),N(d,R),d[s.index]=R}(pt,U,Xe,jt,Ee,I,S);it=jn(J,dn),U&&function eS(s,o,u,l){if(l)al(s,u,["ng-version",Ey.full]);else{const{attrs:d,classes:g}=function ID(s){const o=[],u=[];let l=1,d=2;for(;l<s.length;){let g=s[l];if("string"==typeof g)2===d?""!==g&&o.push(g,s[++l]):8===d&&u.push(g);else{if(!to(d))break;d=g}l++}return{attrs:o,classes:u}}(o.selectors[0]);d&&al(s,u,d),g&&g.length>0&&pu(s,u,g.join(" "))}}(S,Xe,U,l),void 0!==u&&function tS(s,o,u){const l=s.projection=[];for(let d=0;d<o.length;d++){const g=u[d];l.push(null!=g?Array.from(g):null)}}(it,this.ngContentSelectors,u),ze=function JD(s,o,u,l,d,g){const v=Lr(),I=d[ct],b=Be(v,d);Fy(I,d,v,u,null,l);for(let R=0;R<u.length;R++)ni(pa(d,I,v.directiveStart+R,v),d);zl(I,d,v),b&&ni(b,d);const S=pa(d,I,v.directiveStart+v.componentOffset,v);if(s[Fn]=d[Fn]=S,null!==g)for(const R of g)R(S,o);return HE(I,v,s),S}(Nn,Xe,jt,Me,Ee,[nf]),$E(J,Ee,null)}finally{Sp()}return new yg(this.componentType,ze,yc(it,Ee),Ee,it)}}class yg extends oD{constructor(o,u,l,d,g){super(),this.location=l,this._rootLView=d,this._tNode=g,this.instance=u,this.hostView=this.changeDetectorRef=new YD(d),this.componentType=o}setInput(o,u){const l=this._tNode.inputs;let d;if(null!==l&&(d=l[o])){const g=this._rootLView;$y(g[ct],g,d,o,u),ZE(g,this._tNode.index)}}get injector(){return new Qa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function nf(){const s=Lr();ju(Pe()[ct],s)}function Kl(s){return!!sf(s)&&(Array.isArray(s)||!(s instanceof Map)&&Symbol.iterator in s)}function sf(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function zr(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function wg(s,o,u,l){const d=Pe();return zr(d,la(),o)&&(pn(),Da(xn(),d,s,o,u,l)),wg}function Qy(s,o,u,l,d,g,v,I){const b=Pe(),S=pn(),R=s+dn,U=S.firstCreatePass?function uS(s,o,u,l,d,g,v,I,b){const S=o.consts,R=Qh(o,s,4,v||null,Cr(S,I));Xh(o,u,R,Cr(S,b)),ju(o,R);const U=R.tView=Oy(2,R,l,d,g,o.directiveRegistry,o.pipeRegistry,null,o.schemas,S);return null!==o.queries&&(o.queries.template(o,R),U.queries=o.queries.embeddedTView(R)),R}(R,S,b,o,u,l,d,g,v):S.data[R];Ks(U,!1);const K=b[Kt].createComment("");lu(S,b,K,U),ni(K,b),N(b,b[R]=KD(K,b,K,U)),Ha(U)&&GE(S,b,U),null!=v&&zE(b,U,I)}function Ig(s,o,u){const l=Pe();return zr(l,la(),o)&&function li(s,o,u,l,d,g,v,I){const b=Be(o,u);let R,S=o.inputs;!I&&null!=S&&(R=S[l])?($y(s,u,R,l,d),na(o)&&ZE(u,o.index)):3&o.type&&(l=function Ly(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(l),d=null!=v?v(d,o.value||"",l):d,g.setProperty(b,l,d))}(pn(),xn(),l,s,o,l[Kt],u,!1),Ig}function Tg(s,o,u,l,d){const v=d?"class":"style";$y(s,u,o.inputs[v],v,l)}function bg(s,o,u,l){const d=Pe(),g=pn(),v=dn+s,I=d[Kt],b=g.firstCreatePass?function WN(s,o,u,l,d,g){const v=o.consts,b=Qh(o,s,2,l,Cr(v,d));return Xh(o,u,b,Cr(v,g)),null!==b.attrs&&ef(b,b.attrs,!1),null!==b.mergedAttrs&&ef(b,b.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,b),b}(v,g,d,o,u,l):g.data[v],S=d[v]=Ah(I,o,function Z0(){return Ft.lFrame.currentNamespace}()),R=Ha(b);return Ks(b,!0),hc(I,S,b),32!=(32&b.flags)&&lu(g,d,S,b),0===function qa(){return Ft.lFrame.elementDepthCount}()&&ni(S,d),function D_(){Ft.lFrame.elementDepthCount++}(),R&&(GE(g,d,b),HE(g,b,d)),null!==l&&zE(d,b),bg}function Xy(){let s=Lr();rl()?function Ep(){Ft.lFrame.isParent=!1}():(s=s.parent,Ks(s,!1));const o=s;!function qd(){Ft.lFrame.elementDepthCount--}();const u=pn();return u.firstCreatePass&&(ju(u,s),ds(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function L_(s){return 0!=(8&s.flags)}(o)&&Tg(u,o,Pe(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function Co(s){return 0!=(16&s.flags)}(o)&&Tg(u,o,Pe(),o.stylesWithoutHost,!1),Xy}function mI(s,o,u,l){return bg(s,o,u,l),Xy(),mI}function Cg(s){return!!s&&"function"==typeof s.then}function Dg(s){return!!s&&"function"==typeof s.subscribe}const nd=Dg;function yI(s,o,u,l){const d=Pe(),g=pn(),v=Lr();return function vI(s,o,u,l,d,g,v){const I=Ha(l),S=s.firstCreatePass&&Jh(s),R=o[Fn],U=XE(o);let K=!0;if(3&l.type||v){const ze=Be(l,o),it=v?v(ze):ze,Xe=U.length,jt=v?pt=>v(z(pt[l.index])):l.index;let Me=null;if(!v&&I&&(Me=function qN(s,o,u,l){const d=s.cleanup;if(null!=d)for(let g=0;g<d.length-1;g+=2){const v=d[g];if(v===u&&d[g+1]===l){const I=o[zs],b=d[g+2];return I.length>b?I[b]:null}"string"==typeof v&&(g+=2)}return null}(s,o,d,l.index)),null!==Me)(Me.__ngLastListenerFn__||Me).__ngNextListenerFn__=g,Me.__ngLastListenerFn__=g,K=!1;else{g=wI(l,o,R,g,!1);const pt=u.listen(it,d,g);U.push(g,pt),S&&S.push(d,jt,Xe,Xe+1)}}else g=wI(l,o,R,g,!1);const J=l.outputs;let Ee;if(K&&null!==J&&(Ee=J[d])){const ze=Ee.length;if(ze)for(let it=0;it<ze;it+=2){const Nn=o[Ee[it]][Ee[it+1]].subscribe(g),pr=U.length;U.push(g,Nn),S&&S.push(d,l.index,pr,-(pr+1))}}}(g,d,d[Kt],v,s,o,l),yI}function lS(s,o,u,l){try{return ti(6,o,u),!1!==u(l)}catch(d){return JE(s,d),!1}finally{ti(7,o,u)}}function wI(s,o,u,l,d){return function g(v){if(v===Function)return l;vs(s.componentOffset>-1?sn(s.index,o):o);let b=lS(o,u,l,v),S=g.__ngNextListenerFn__;for(;S;)b=lS(o,u,S,v)&&b,S=S.__ngNextListenerFn__;return d&&!1===b&&(v.preventDefault(),v.returnValue=!1),b}}function OI(s,o=""){const u=Pe(),l=pn(),d=s+dn,g=l.firstCreatePass?Qh(l,d,1,o,null):l.data[d],v=u[d]=function Al(s,o){return s.createText(o)}(u[Kt],o);lu(l,u,v,g),Ks(g,!1)}const jo=void 0;var BS=["en",[["a","p"],["AM","PM"],jo],[["AM","PM"],jo,jo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],jo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],jo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",jo,"{1} 'at' {0}",jo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function VS(s){const u=Math.floor(Math.abs(s)),l=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===l?1:5}];let oo={};function Fg(s){const o=function jS(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=XI(o);if(u)return u;const l=o.split("-")[0];if(u=XI(l),u)return u;if("en"===l)return BS;throw new pe(701,!1)}function pv(s){return Fg(s)[Ut.PluralCase]}function XI(s){return s in oo||(oo[s]=Rt.ng&&Rt.ng.common&&Rt.ng.common.locales&&Rt.ng.common.locales[s]),oo[s]}var Ut=(()=>((Ut=Ut||{})[Ut.LocaleId=0]="LocaleId",Ut[Ut.DayPeriodsFormat=1]="DayPeriodsFormat",Ut[Ut.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ut[Ut.DaysFormat=3]="DaysFormat",Ut[Ut.DaysStandalone=4]="DaysStandalone",Ut[Ut.MonthsFormat=5]="MonthsFormat",Ut[Ut.MonthsStandalone=6]="MonthsStandalone",Ut[Ut.Eras=7]="Eras",Ut[Ut.FirstDayOfWeek=8]="FirstDayOfWeek",Ut[Ut.WeekendRange=9]="WeekendRange",Ut[Ut.DateFormat=10]="DateFormat",Ut[Ut.TimeFormat=11]="TimeFormat",Ut[Ut.DateTimeFormat=12]="DateTimeFormat",Ut[Ut.NumberSymbols=13]="NumberSymbols",Ut[Ut.NumberFormats=14]="NumberFormats",Ut[Ut.CurrencyCode=15]="CurrencyCode",Ut[Ut.CurrencySymbol=16]="CurrencySymbol",Ut[Ut.CurrencyName=17]="CurrencyName",Ut[Ut.Currencies=18]="Currencies",Ut[Ut.Directionality=19]="Directionality",Ut[Ut.PluralCase=20]="PluralCase",Ut[Ut.ExtraData=21]="ExtraData",Ut))();const Ma="en-US";let tT=Ma;class od{}class IT{}function wA(s,o){return new vf(s,o??null)}class vf extends od{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new eI(this);const l=fn(o);this._bootstrapComponents=Fo(l.bootstrap),this._r3Injector=Ry(o,u,[{provide:od,useValue:this},{provide:Eu,useValue:this.componentFactoryResolver}],ge(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class Wr extends IT{constructor(o){super(),this.moduleType=o}create(o){return new vf(this.moduleType,o)}}class Tu extends od{constructor(o,u,l){super(),this.componentFactoryResolver=new eI(this),this.instance=null;const d=new hE([...o,{provide:od,useValue:this},{provide:Eu,useValue:this.componentFactoryResolver}],u||og(),l,new Set(["environment"]));this.injector=d,d.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function Cv(s,o,u=null){return new Tu(s,o,u).injector}let TT=(()=>{class s{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u.id)){const l=uE(0,u.type),d=l.length>0?Cv([l],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u.id,d)}return this.cachedInjectors.get(u.id)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return s.\u0275prov=Qe({token:s,providedIn:"environment",factory:()=>new s(He(_c))}),s})();function Yg(s){s.getStandaloneInjector=o=>o.get(TT).getOrCreateStandaloneInjector(s)}function Uv(s){return o=>{setTimeout(s,void 0,o)}}const co=class PT extends _.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,l){let d=o,g=u||(()=>null),v=l;if(o&&"object"==typeof o){const b=o;d=b.next?.bind(b),g=b.error?.bind(b),v=b.complete?.bind(b)}this.__isAsync&&(g=Uv(g),d&&(d=Uv(d)),v&&(v=Uv(v)));const I=super.subscribe({next:d,error:g,complete:v});return o instanceof X.w0&&o.add(I),I}};function kT(){return this._results[Symbol.iterator]()}class bf{get changes(){return this._changes||(this._changes=new co)}constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=bf.prototype;u[Symbol.iterator]||(u[Symbol.iterator]=kT)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const l=this;l.dirty=!1;const d=function ki(s){return s.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function J0(s,o,u){if(s.length!==o.length)return!1;for(let l=0;l<s.length;l++){let d=s[l],g=o[l];if(u&&(d=u(d),g=u(g)),g!==d)return!1}return!0}(l._results,d,u))&&(l._results=d,l.length=d.length,l.last=d[this.length-1],l.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let cd=(()=>{class s{}return s.__NG_ELEMENT_ID__=Bv,s})();const SA=cd,Vv=class extends SA{constructor(o,u,l){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=l}createEmbeddedView(o,u){const l=this._declarationTContainer.tView,d=fg(this._declarationLView,l,o,16,null,l.declTNode,null,null,null,null,u||null);d[As]=this._declarationLView[this._declarationTContainer.index];const v=this._declarationLView[ei];return null!==v&&(d[ei]=v.createEmbeddedView(l)),$E(l,d,o),new tf(d)}};function Bv(){return ld(Lr(),Pe())}function ld(s,o){return 4&s.type?new Vv(o,s,yc(s,o)):null}let xr=(()=>{class s{}return s.__NG_ELEMENT_ID__=hi,s})();function hi(){return $v(Lr(),Pe())}const nm=xr,rm=class extends nm{constructor(o,u,l){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=l}get element(){return yc(this._hostTNode,this._hostLView)}get injector(){return new Qa(this._hostTNode,this._hostLView)}get parentInjector(){const o=qu(this._hostTNode,this._hostLView);if(Jd(o)){const u=ha(o,this._hostLView),l=Hu(o);return new Qa(u[ct].data[l+8],u)}return new Qa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=OT(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-Or}createEmbeddedView(o,u,l){let d,g;"number"==typeof l?d=l:null!=l&&(d=l.index,g=l.injector);const v=o.createEmbeddedView(u||{},g);return this.insert(v,d),v}createComponent(o,u,l,d,g){const v=o&&!function Xu(s){return"function"==typeof s}(o);let I;if(v)I=u;else{const U=u||{};I=U.index,l=U.injector,d=U.projectableNodes,g=U.environmentInjector||U.ngModuleRef}const b=v?o:new Ec(qe(o)),S=l||this.parentInjector;if(!g&&null==b.ngModule){const K=(v?S:this.parentInjector).get(_c,null);K&&(g=K)}const R=b.create(S,d,void 0,g);return this.insert(R.hostView,I),R}insert(o,u){const l=o._lView,d=l[ct];if(function To(s){return _i(s[Ln])}(l)){const R=this.indexOf(o);if(-1!==R)this.detach(R);else{const U=l[Ln],K=new rm(U,U[tr],U[Ln]);K.detach(K.indexOf(o))}}const g=this._adjustIndex(u),v=this._lContainer;!function ry(s,o,u,l){const d=Or+l,g=u.length;l>0&&(u[d-1][Jr]=o),l<g-Or?(o[Jr]=u[d],z_(u,Or+l,o)):(u.push(o),o[Jr]=null),o[Ln]=u;const v=o[As];null!==v&&u!==v&&function xl(s,o){const u=s[ta];o[br]!==o[Ln][Ln][br]&&(s[$a]=!0),null===u?s[ta]=[o]:u.push(o)}(v,o);const I=o[ei];null!==I&&I.insertView(s),o[Ht]|=64}(d,l,v,g);const I=Ta(g,v),b=l[Kt],S=dc(b,v[vo]);return null!==S&&function cu(s,o,u,l,d,g){l[pi]=d,l[tr]=o,Oo(s,l,u,1,d,g)}(d,v[tr],b,l,S,I),o.attachToViewContainerRef(),z_(jv(v),g,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=OT(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),l=ac(this._lContainer,u);l&&(lh(jv(this._lContainer),u),uc(l[ct],l))}detach(o){const u=this._adjustIndex(o,-1),l=ac(this._lContainer,u);return l&&null!=lh(jv(this._lContainer),u)?new tf(l):null}_adjustIndex(o,u=0){return o??this.length+u}};function OT(s){return s[wo]}function jv(s){return s[wo]||(s[wo]=[])}function $v(s,o){let u;const l=o[s.index];if(_i(l))u=l;else{let d;if(8&s.type)d=z(l);else{const g=o[Kt];d=g.createComment("");const v=Be(s,o);ts(g,dc(g,v),d,function qp(s,o){return s.nextSibling(o)}(g,v),!1)}o[s.index]=u=KD(l,o,d,s),N(o,u)}return new rm(u,s,o)}class Hv{constructor(o){this.queryList=o,this.matches=null}clone(){return new Hv(this.queryList)}setDirty(){this.queryList.setDirty()}}class Gv{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const l=null!==o.contentQueries?o.contentQueries[0]:u.length,d=[];for(let g=0;g<l;g++){const v=u.getByIndex(g);d.push(this.queries[v.indexInDeclarationView].clone())}return new Gv(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==UT(o,u).matches&&this.queries[u].setDirty()}}class zv{constructor(o,u,l=null){this.predicate=o,this.flags=u,this.read=l}}class Cf{constructor(o=[]){this.queries=o}elementStart(o,u){for(let l=0;l<this.queries.length;l++)this.queries[l].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let l=0;l<this.length;l++){const d=null!==u?u.length:0,g=this.getByIndex(l).embeddedTView(o,d);g&&(g.indexInDeclarationView=l,null!==u?u.push(g):u=[g])}return null!==u?new Cf(u):null}template(o,u){for(let l=0;l<this.queries.length;l++)this.queries[l].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Wv{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new Wv(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let l=o.parent;for(;null!==l&&8&l.type&&l.index!==u;)l=l.parent;return u===(null!==l?l.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const l=this.metadata.predicate;if(Array.isArray(l))for(let d=0;d<l.length;d++){const g=l[d];this.matchTNodeWithReadOption(o,u,qv(u,g)),this.matchTNodeWithReadOption(o,u,dl(u,o,g,!1,!1))}else l===cd?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,dl(u,o,l,!1,!1))}matchTNodeWithReadOption(o,u,l){if(null!==l){const d=this.metadata.read;if(null!==d)if(d===Ca||d===xr||d===cd&&4&u.type)this.addMatch(u.index,-2);else{const g=dl(u,o,d,!1,!1);null!==g&&this.addMatch(u.index,g)}else this.addMatch(u.index,l)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function qv(s,o){const u=s.localNames;if(null!==u)for(let l=0;l<u.length;l+=2)if(u[l]===o)return u[l+1];return null}function AA(s,o,u,l){return-1===u?function LT(s,o){return 11&s.type?yc(s,o):4&s.type?ld(s,o):null}(o,s):-2===u?function im(s,o,u){return u===Ca?yc(o,s):u===cd?ld(o,s):u===xr?$v(o,s):void 0}(s,o,l):pa(s,s[ct],u,o)}function sm(s,o,u,l){const d=o[ei].queries[l];if(null===d.matches){const g=s.data,v=u.matches,I=[];for(let b=0;b<v.length;b+=2){const S=v[b];I.push(S<0?null:AA(o,g[S],v[b+1],u.metadata.read))}d.matches=I}return d.matches}function Df(s,o,u,l){const d=s.queries.getByIndex(u),g=d.matches;if(null!==g){const v=sm(s,o,d,u);for(let I=0;I<g.length;I+=2){const b=g[I];if(b>0)l.push(v[I/2]);else{const S=g[I+1],R=o[-b];for(let U=Or;U<R.length;U++){const K=R[U];K[As]===K[Ln]&&Df(K[ct],K,S,l)}if(null!==R[ta]){const U=R[ta];for(let K=0;K<U.length;K++){const J=U[K];Df(J[ct],J,S,l)}}}}}return l}function Kv(s){const o=Pe(),u=pn(),l=M_();Cp(l+1);const d=UT(u,l);if(s.dirty&&function Rn(s){return 4==(4&s[Ht])}(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const g=d.crossesNgTemplate?Df(u,o,l,[]):sm(u,o,d,l);s.reset(g,yE),s.notifyOnChanges()}return!0}return!1}function dd(s,o,u,l){const d=pn();if(d.firstCreatePass){const g=Lr();(function Sf(s,o,u){null===s.queries&&(s.queries=new Cf),s.queries.track(new Wv(o,u))})(d,new zv(o,u,l),g.index),function xA(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(d,s),2==(2&u)&&(d.staticContentQueries=!0)}!function Yv(s,o,u){const l=new bf(4==(4&u));WE(s,o,l,l.destroy),null===o[ei]&&(o[ei]=new Gv),o[ei].queries.push(new Hv(l))}(d,Pe(),u)}function Zv(){return function FT(s,o){return s[ei].queries[o].queryList}(Pe(),M_())}function UT(s,o){return s.queries.getByIndex(o)}function om(s){return!!fn(s)}function Nf(...s){}const kc=new Mn("Application Initializer");let vm=(()=>{class s{constructor(u){this.appInits=u,this.resolve=Nf,this.reject=Nf,this.initialized=!1,this.done=!1,this.donePromise=new Promise((l,d)=>{this.resolve=l,this.reject=d})}runInitializers(){if(this.initialized)return;const u=[],l=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const g=this.appInits[d]();if(Cg(g))u.push(g);else if(nd(g)){const v=new Promise((I,b)=>{g.subscribe({complete:I,error:b})});u.push(v)}}Promise.all(u).then(()=>{l()}).catch(d=>{this.reject(d)}),0===u.length&&l(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)(He(kc,8))},s.\u0275prov=Qe({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const qT=new Mn("AppId",{providedIn:"root",factory:function sw(){return`${wm()}${wm()}${wm()}`}});function wm(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ow=new Mn("Platform Initializer"),aw=new Mn("Platform ID",{providedIn:"platform",factory:()=>"unknown"});let ZT=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Qe({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const Em=new Mn("LocaleId",{providedIn:"root",factory:()=>at(Em,_t.Optional|_t.SkipSelf)||function uw(){return typeof $localize<"u"&&$localize.locale||Ma}()}),jA=new Mn("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Tm{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let lw=(()=>{class s{compileModuleSync(u){return new Wr(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const l=this.compileModuleSync(u),g=Fo(fn(u).declarations).reduce((v,I)=>{const b=qe(I);return b&&v.push(new Ec(b)),v},[]);return new Tm(l,g)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Qe({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const HA=(()=>Promise.resolve(0))();function dw(s){typeof Zone>"u"?HA.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class ws{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:l=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new co(!1),this.onMicrotaskEmpty=new co(!1),this.onStable=new co(!1),this.onError=new co(!1),typeof Zone>"u")throw new pe(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!l&&u,d.shouldCoalesceRunChangeDetection=l,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function XT(){let s=Rt.requestAnimationFrame,o=Rt.cancelAnimationFrame;if(typeof Zone<"u"&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const l=o[Zone.__symbol__("OriginalDelegate")];l&&(o=l)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function JT(s){const o=()=>{!function ka(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(Rt,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,Sm(s),s.isCheckStableRunning=!0,Dm(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),Sm(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,l,d,g,v,I)=>{try{return Am(s),u.invokeTask(d,g,v,I)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===g.type||s.shouldCoalesceRunChangeDetection)&&o(),_d(s)}},onInvoke:(u,l,d,g,v,I,b)=>{try{return Am(s),u.invoke(d,g,v,I,b)}finally{s.shouldCoalesceRunChangeDetection&&o(),_d(s)}},onHasTask:(u,l,d,g)=>{u.hasTask(d,g),l===d&&("microTask"==g.change?(s._hasPendingMicrotasks=g.microTask,Sm(s),Dm(s)):"macroTask"==g.change&&(s.hasPendingMacrotasks=g.macroTask))},onHandleError:(u,l,d,g)=>(u.handleError(d,g),s.runOutsideAngular(()=>s.onError.emit(g)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ws.isInAngularZone())throw new pe(909,!1)}static assertNotInAngularZone(){if(ws.isInAngularZone())throw new pe(909,!1)}run(o,u,l){return this._inner.run(o,u,l)}runTask(o,u,l,d){const g=this._inner,v=g.scheduleEventTask("NgZoneEvent: "+d,o,Cm,Nf,Nf);try{return g.runTask(v,u,l)}finally{g.cancelTask(v)}}runGuarded(o,u,l){return this._inner.runGuarded(o,u,l)}runOutsideAngular(o){return this._outer.run(o)}}const Cm={};function Dm(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function Sm(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function Am(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function _d(s){s._nesting--,Dm(s)}class eb{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new co,this.onMicrotaskEmpty=new co,this.onStable=new co,this.onError=new co}run(o,u,l){return o.apply(u,l)}runGuarded(o,u,l){return o.apply(u,l)}runOutsideAngular(o){return o()}runTask(o,u,l,d){return o.apply(u,l)}}const Rm=new Mn(""),kf=new Mn("");let xm,tb=(()=>{class s{constructor(u,l,d){this._ngZone=u,this.registry=l,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,xm||(function zA(s){xm=s}(d),d.addToWindow(l)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ws.assertNotInAngularZone(),dw(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())dw(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(l=>!l.updateCb||!l.updateCb(u)||(clearTimeout(l.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,l,d){let g=-1;l&&l>0&&(g=setTimeout(()=>{this._callbacks=this._callbacks.filter(v=>v.timeoutId!==g),u(this._didWork,this.getPendingTasks())},l)),this._callbacks.push({doneCb:u,timeoutId:g,updateCb:d})}whenStable(u,l,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,l,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,l,d){return[]}}return s.\u0275fac=function(u){return new(u||s)(He(ws),He(Of),He(kf))},s.\u0275prov=Qe({token:s,factory:s.\u0275fac}),s})(),Of=(()=>{class s{constructor(){this._applications=new Map}registerApplication(u,l){this._applications.set(u,l)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,l=!0){return xm?.findTestabilityInTree(this,u,l)??null}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Qe({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const Es=!1;let Oa=null;const hw=new Mn("AllowMultipleToken"),Lf=new Mn("PlatformDestroyListeners"),Mm=new Mn("appBootstrapListener");class ib{constructor(o,u){this.name=o,this.token=u}}function gw(s,o,u=[]){const l=`Platform: ${o}`,d=new Mn(l);return(g=[])=>{let v=Pm();if(!v||v.injector.get(hw,!1)){const I=[...u,...g,{provide:d,useValue:!0}];s?s(I):function Oc(s){if(Oa&&!Oa.get(hw,!1))throw new pe(400,!1);Oa=s;const o=s.get(Lc);(function pw(s){const o=s.get(ow,null);o&&o.forEach(u=>u())})(s)}(function os(s=[],o){return jl.create({name:o,providers:[{provide:my,useValue:"platform"},{provide:Lf,useValue:new Set([()=>Oa=null])},...s]})}(I,l))}return function Nm(s){const o=Pm();if(!o)throw new pe(401,!1);return o}()}}function Pm(){return Oa?.get(Lc)??null}let Lc=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,l){const d=function ab(s,o){let u;return u="noop"===s?new eb:("zone.js"===s?void 0:s)||new ws(o),u}(l?.ngZone,function ob(s){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!s||!s.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!s||!s.ngZoneRunCoalescing)||!1}}(l)),g=[{provide:ws,useValue:d}];return d.run(()=>{const v=jl.create({providers:g,parent:this.injector,name:u.moduleType.name}),I=u.create(v),b=I.injector.get(Wh,null);if(!b)throw new pe(402,!1);return d.runOutsideAngular(()=>{const S=d.onError.subscribe({next:R=>{b.handleError(R)}});I.onDestroy(()=>{Ff(this._modules,I),S.unsubscribe()})}),function km(s,o,u){try{const l=u();return Cg(l)?l.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):l}catch(l){throw o.runOutsideAngular(()=>s.handleError(l)),l}}(b,d,()=>{const S=I.injector.get(vm);return S.runInitializers(),S.donePromise.then(()=>(function Di(s){et(s,"Expected localeId to be defined"),"string"==typeof s&&(tT=s.toLowerCase().replace(/_/g,"-"))}(I.injector.get(Em,Ma)||Ma),this._moduleDoBootstrap(I),I))})})}bootstrapModule(u,l=[]){const d=ub({},l);return function nb(s,o,u){const l=new Wr(u);return Promise.resolve(l)}(0,0,u).then(g=>this.bootstrapModuleFactory(g,d))}_moduleDoBootstrap(u){const l=u.injector.get(Om);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(d=>l.bootstrap(d));else{if(!u.instance.ngDoBootstrap)throw new pe(-403,!1);u.instance.ngDoBootstrap(l)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new pe(404,!1);this._modules.slice().forEach(l=>l.destroy()),this._destroyListeners.forEach(l=>l());const u=this._injector.get(Lf,null);u&&(u.forEach(l=>l()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(He(jl))},s.\u0275prov=Qe({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function ub(s,o){return Array.isArray(o)?o.reduce(ub,s):{...s,...o}}let Om=(()=>{class s{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(u,l,d){this._zone=u,this._injector=l,this._exceptionHandler=d,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const g=new V.y(I=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{I.next(this._stable),I.complete()})}),v=new V.y(I=>{let b;this._zone.runOutsideAngular(()=>{b=this._zone.onStable.subscribe(()=>{ws.assertNotInAngularZone(),dw(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,I.next(!0))})})});const S=this._zone.onUnstable.subscribe(()=>{ws.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{I.next(!1)}))});return()=>{b.unsubscribe(),S.unsubscribe()}});this.isStable=(0,te.T)(g,v.pipe((0,ae.B)()))}bootstrap(u,l){const d=u instanceof mE;if(!this._injector.get(vm).done){!d&&Zn(u);throw new pe(405,Es)}let v;v=d?u:this._injector.get(Eu).resolveComponentFactory(u),this.componentTypes.push(v.componentType);const I=function rb(s){return s.isBoundToModule}(v)?void 0:this._injector.get(od),S=v.create(jl.NULL,[],l||v.selector,I),R=S.location.nativeElement,U=S.injector.get(Rm,null);return U?.registerApplication(R),S.onDestroy(()=>{this.detachView(S.hostView),Ff(this.components,S),U?.unregisterApplication(R)}),this._loadComponent(S),S}tick(){if(this._runningTick)throw new pe(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const l=u;this._views.push(l),l.attachToAppRef(this)}detachView(u){const l=u;Ff(this._views,l),l.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u);const l=this._injector.get(Mm,[]);l.push(...this._bootstrapListeners),l.forEach(d=>d(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>Ff(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new pe(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return s.\u0275fac=function(u){return new(u||s)(He(ws),He(_c),He(Wh))},s.\u0275prov=Qe({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function Ff(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}function KA(){return!1}function lb(){}let mw=(()=>{class s{}return s.__NG_ELEMENT_ID__=ZA,s})();function ZA(s){return function je(s,o,u){if(na(s)&&!u){const l=sn(s.index,o);return new tf(l,l)}return 47&s.type?new tf(o[br],o):null}(Lr(),Pe(),16==(16&s))}class Fc{constructor(){}supports(o){return Kl(o)}create(o){return new nr(o)}}const fb=(s,o)=>o;class nr{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||fb}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,l=this._removalsHead,d=0,g=null;for(;u||l;){const v=!l||u&&u.currentIndex<pb(l,d,g)?u:l,I=pb(v,d,g),b=v.currentIndex;if(v===l)d--,l=l._nextRemoved;else if(u=u._next,null==v.previousIndex)d++;else{g||(g=[]);const S=I-d,R=b-d;if(S!=R){for(let K=0;K<S;K++){const J=K<g.length?g[K]:g[K]=0,Ee=J+K;R<=Ee&&Ee<S&&(g[K]=J+1)}g[v.previousIndex]=R-S}}I!==b&&o(v,I,b)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!Kl(o))throw new pe(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,g,v,u=this._itHead,l=!1;if(Array.isArray(o)){this.length=o.length;for(let I=0;I<this.length;I++)g=o[I],v=this._trackByFn(I,g),null!==u&&Object.is(u.trackById,v)?(l&&(u=this._verifyReinsertion(u,g,v,I)),Object.is(u.item,g)||this._addIdentityChange(u,g)):(u=this._mismatch(u,g,v,I),l=!0),u=u._next}else d=0,function uI(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[Symbol.iterator]();let l;for(;!(l=u.next()).done;)o(l.value)}}(o,I=>{v=this._trackByFn(d,I),null!==u&&Object.is(u.trackById,v)?(l&&(u=this._verifyReinsertion(u,I,v,d)),Object.is(u.item,I)||this._addIdentityChange(u,I)):(u=this._mismatch(u,I,v,d),l=!0),u=u._next,d++}),this.length=d;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,l,d){let g;return null===o?g=this._itTail:(g=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,g,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(l,d))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,g,d)):o=this._addAfter(new Mt(u,l),g,d),o}_verifyReinsertion(o,u,l,d){let g=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null);return null!==g?o=this._reinsertAfter(g,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,l){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,g=o._nextRemoved;return null===d?this._removalsHead=g:d._nextRemoved=g,null===g?this._removalsTail=d:g._prevRemoved=d,this._insertAfter(o,u,l),this._addToMoves(o,l),o}_moveAfter(o,u,l){return this._unlink(o),this._insertAfter(o,u,l),this._addToMoves(o,l),o}_addAfter(o,u,l){return this._insertAfter(o,u,l),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,l){const d=null===u?this._itHead:u._next;return o._next=d,o._prev=u,null===d?this._itTail=o:d._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new wn),this._linkedRecords.put(o),o.currentIndex=l,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,l=o._next;return null===u?this._itHead=l:u._next=l,null===l?this._itTail=u:l._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new wn),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class Mt{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Vf{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let l;for(l=this._head;null!==l;l=l._nextDup)if((null===u||u<=l.currentIndex)&&Object.is(l.trackById,o))return l;return null}remove(o){const u=o._prevDup,l=o._nextDup;return null===u?this._head=l:u._nextDup=l,null===l?this._tail=u:l._prevDup=u,null===this._head}}class wn{constructor(){this.map=new Map}put(o){const u=o.trackById;let l=this.map.get(u);l||(l=new Vf,this.map.set(u,l)),l.add(o)}get(o,u){const d=this.map.get(o);return d?d.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function pb(s,o,u){const l=s.previousIndex;if(null===l)return l;let d=0;return u&&l<u.length&&(d=u[l]),l+o+d}class fr{constructor(){}supports(o){return o instanceof Map||sf(o)}create(){return new nt}}class nt{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||sf(o)))throw new pe(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(l,d)=>{if(u&&u.key===d)this._maybeAddToChanges(u,l),this._appendAfter=u,u=u._next;else{const g=this._getOrCreateRecordForKey(d,l);u=this._insertBeforeOrAppend(u,g)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let l=u;null!==l;l=l._nextRemoved)l===this._mapHead&&(this._mapHead=null),this._records.delete(l.key),l._nextRemoved=l._next,l.previousValue=l.currentValue,l.currentValue=null,l._prev=null,l._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const l=o._prev;return u._next=o,u._prev=l,o._prev=u,l&&(l._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,u);const g=d._prev,v=d._next;return g&&(g._next=v),v&&(v._prev=g),d._next=null,d._prev=null,d}const l=new Vm(o);return this._records.set(o,l),l.currentValue=u,this._addToAdditions(l),l}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(l=>u(o[l],l))}}class Vm{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Bm(){return new Fa([new Fc])}let Fa=(()=>{class s{constructor(u){this.factories=u}static create(u,l){if(null!=l){const d=l.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:l=>s.create(u,l||Bm()),deps:[[s,new Ju,new Ji]]}}find(u){const l=this.factories.find(d=>d.supports(u));if(null!=l)return l;throw new pe(901,!1)}}return s.\u0275prov=Qe({token:s,providedIn:"root",factory:Bm}),s})();function Bf(){return new ww([new fr])}let ww=(()=>{class s{constructor(u){this.factories=u}static create(u,l){if(l){const d=l.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:l=>s.create(u,l||Bf()),deps:[[s,new Ju,new Ji]]}}find(u){const l=this.factories.find(d=>d.supports(u));if(l)return l;throw new pe(901,!1)}}return s.\u0275prov=Qe({token:s,providedIn:"root",factory:Bf}),s})();const Ew=gw(null,"core",[]);let mb=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(He(Om))},s.\u0275mod=mo({type:s}),s.\u0275inj=kn({}),s})();function _b(s){return"boolean"==typeof s?s:null!=s&&"false"!==s}},579:(mt,De,P)=>{P.d(De,{EI:()=>Ce,Gb:()=>Pr,Iv:()=>si,Kz:()=>Dt,Xd:()=>Hn,lT:()=>yr,xP:()=>He});var _=P(5861),X=P(9681),V=P(1877),te=P(2090),ae=P(4859);P(2833);const de="analytics",ge="firebase_id",ue="origin",G=6e4,W="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Y="https://www.googletagmanager.com/gtag/js",ke=new V.Yd("@firebase/analytics");function ve(A){return Promise.all(A.map(L=>L.catch(q=>q)))}function be(){return(be=(0,_.Z)(function*(A,L,q,B,le,Te){const lt=B[le];try{if(lt)yield L[lt];else{const kt=(yield ve(q)).find(nn=>nn.measurementId===le);kt&&(yield L[kt.appId])}}catch(Pt){ke.error(Pt)}A("config",le,Te)})).apply(this,arguments)}function Ue(){return(Ue=(0,_.Z)(function*(A,L,q,B,le){try{let Te=[];if(le&&le.send_to){let lt=le.send_to;Array.isArray(lt)||(lt=[lt]);const Pt=yield ve(q);for(const kt of lt){const nn=Pt.find(An=>An.measurementId===kt),bt=nn&&L[nn.appId];if(!bt){Te=[];break}Te.push(bt)}}0===Te.length&&(Te=Object.values(L)),yield Promise.all(Te),A("event",B,le||{})}catch(Te){ke.error(Te)}})).apply(this,arguments)}const Se=new te.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),j=30,Ye=new class We{constructor(L={},q=1e3){this.throttleMetadata=L,this.intervalMillis=q}getThrottleMetadata(L){return this.throttleMetadata[L]}setThrottleMetadata(L,q){this.throttleMetadata[L]=q}deleteThrottleMetadata(L){delete this.throttleMetadata[L]}};function gt(A){return new Headers({Accept:"application/json","x-goog-api-key":A})}function re(){return(re=(0,_.Z)(function*(A){var L;const{appId:q,apiKey:B}=A,le={method:"GET",headers:gt(B)},Te=W.replace("{app-id}",q),lt=yield fetch(Te,le);if(200!==lt.status&&304!==lt.status){let Pt="";try{const kt=yield lt.json();null!==(L=kt.error)&&void 0!==L&&L.message&&(Pt=kt.error.message)}catch{}throw Se.create("config-fetch-failed",{httpStatus:lt.status,responseMessage:Pt})}return lt.json()})).apply(this,arguments)}function _e(){return(_e=(0,_.Z)(function*(A,L=Ye,q){const{appId:B,apiKey:le,measurementId:Te}=A.options;if(!B)throw Se.create("no-app-id");if(!le){if(Te)return{measurementId:Te,appId:B};throw Se.create("no-api-key")}const lt=L.getThrottleMetadata(B)||{backoffCount:0,throttleEndTimeMillis:Date.now()},Pt=new st;return setTimeout((0,_.Z)(function*(){Pt.abort()}),void 0!==q?q:G),xe({appId:B,apiKey:le,measurementId:Te},lt,Pt,L)})).apply(this,arguments)}function xe(A,L,q){return Fe.apply(this,arguments)}function Fe(){return Fe=(0,_.Z)(function*(A,{throttleEndTimeMillis:L,backoffCount:q},B,le=Ye){var Te;const{appId:lt,measurementId:Pt}=A;try{yield function $e(A,L){return new Promise((q,B)=>{const le=Math.max(L-Date.now(),0),Te=setTimeout(q,le);A.addEventListener(()=>{clearTimeout(Te),B(Se.create("fetch-throttle",{throttleEndTimeMillis:L}))})})}(B,L)}catch(kt){if(Pt)return ke.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Pt} provided in the "measurementId" field in the local Firebase config. [${kt?.message}]`),{appId:lt,measurementId:Pt};throw kt}try{const kt=yield function Je(A){return re.apply(this,arguments)}(A);return le.deleteThrottleMetadata(lt),kt}catch(kt){const nn=kt;if(!function et(A){if(!(A instanceof te.ZR&&A.customData))return!1;const L=Number(A.customData.httpStatus);return 429===L||500===L||503===L||504===L}(nn)){if(le.deleteThrottleMetadata(lt),Pt)return ke.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Pt} provided in the "measurementId" field in the local Firebase config. [${nn?.message}]`),{appId:lt,measurementId:Pt};throw kt}const bt=503===Number(null===(Te=nn?.customData)||void 0===Te?void 0:Te.httpStatus)?(0,te.$s)(q,le.intervalMillis,j):(0,te.$s)(q,le.intervalMillis),An={throttleEndTimeMillis:Date.now()+bt,backoffCount:q+1};return le.setThrottleMetadata(lt,An),ke.debug(`Calling attemptFetch again in ${bt} millis`),xe(A,An,B,le)}}),Fe.apply(this,arguments)}class st{constructor(){this.listeners=[]}addEventListener(L){this.listeners.push(L)}abort(){this.listeners.forEach(L=>L())}}let vn,Yr;function rn(){return(rn=(0,_.Z)(function*(A,L,q,B,le){if(le&&le.global)A("event",q,B);else{const Te=yield L;A("event",q,Object.assign(Object.assign({},B),{send_to:Te}))}})).apply(this,arguments)}function wt(){return(wt=(0,_.Z)(function*(A,L,q,B){if(B&&B.global)return A("set",{screen_name:q}),Promise.resolve();A("config",yield L,{update:!0,screen_name:q})})).apply(this,arguments)}function Dn(){return(Dn=(0,_.Z)(function*(A,L,q,B){if(B&&B.global)return A("set",{user_id:q}),Promise.resolve();A("config",yield L,{update:!0,user_id:q})})).apply(this,arguments)}function hn(){return(hn=(0,_.Z)(function*(A,L,q,B){if(B&&B.global){const le={};for(const Te of Object.keys(q))le[`user_properties.${Te}`]=q[Te];return A("set",le),Promise.resolve()}A("config",yield L,{update:!0,user_properties:q})})).apply(this,arguments)}function Nr(){return(Nr=(0,_.Z)(function*(A,L){const q=yield A;window[`ga-disable-${q}`]=!L})).apply(this,arguments)}function On(){return(On=(0,_.Z)(function*(){if(!(0,te.hl)())return ke.warn(Se.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,te.eu)()}catch(A){return ke.warn(Se.create("indexeddb-unavailable",{errorInfo:A?.toString()}).message),!1}return!0})).apply(this,arguments)}function Qr(){return Qr=(0,_.Z)(function*(A,L,q,B,le,Te,lt){var Pt;const kt=function he(A){return _e.apply(this,arguments)}(A);kt.then(ar=>{q[ar.measurementId]=ar.appId,A.options.measurementId&&ar.measurementId!==A.options.measurementId&&ke.warn(`The measurement ID in the local Firebase config (${A.options.measurementId}) does not match the measurement ID fetched from the server (${ar.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(ar=>ke.error(ar)),L.push(kt);const nn=function Tn(){return On.apply(this,arguments)}().then(ar=>{if(ar)return B.getId()}),[bt,An]=yield Promise.all([kt,nn]);(function Re(A){const L=window.document.getElementsByTagName("script");for(const q of Object.values(L))if(q.src&&q.src.includes(Y)&&q.src.includes(A))return q;return null})(Te)||function Ze(A,L){const q=document.createElement("script");q.src=`${Y}?l=${A}&id=${L}`,q.async=!0,document.head.appendChild(q)}(Te,bt.measurementId),Yr&&(le("consent","default",Yr),function Kn(A){Yr=A}(void 0)),le("js",new Date);const Tr=null!==(Pt=lt?.config)&&void 0!==Pt?Pt:{};return Tr[ue]="firebase",Tr.update=!0,null!=An&&(Tr[ge]=An),le("config",bt.measurementId,Tr),vn&&(le("set",vn),function ii(A){vn=A}(void 0)),bt.measurementId}),Qr.apply(this,arguments)}class Xr{constructor(L){this.app=L}_delete(){return delete _n[this.app.options.appId],Promise.resolve()}}let _n={},or=[];const Ni={};let At,Bn,Rt="dataLayer",yt="gtag",tn=!1;function Hn(A){if(tn)throw Se.create("already-initialized");A.dataLayerName&&(Rt=A.dataLayerName),A.gtagName&&(yt=A.gtagName)}function er(A,L,q){!function Jn(){const A=[];if((0,te.ru)()&&A.push("This is a browser extension environment."),(0,te.zI)()||A.push("Cookies are not available."),A.length>0){const L=A.map((B,le)=>`(${le+1}) ${B}`).join(" "),q=Se.create("invalid-analytics-context",{errorInfo:L});ke.warn(q.message)}}();const B=A.options.appId;if(!B)throw Se.create("no-app-id");if(!A.options.apiKey){if(!A.options.measurementId)throw Se.create("no-api-key");ke.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${A.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=_n[B])throw Se.create("already-exists",{id:B});if(!tn){!function rt(A){let L=[];Array.isArray(window[A])?L=window[A]:window[A]=L}(Rt);const{wrappedGtag:Te,gtagCore:lt}=function Ie(A,L,q,B,le){let Te=function(...lt){window[B].push(arguments)};return window[le]&&"function"==typeof window[le]&&(Te=window[le]),window[le]=function Ae(A,L,q,B){function Te(){return Te=(0,_.Z)(function*(lt,Pt,kt){try{"event"===lt?yield function Ne(A,L,q,B,le){return Ue.apply(this,arguments)}(A,L,q,Pt,kt):"config"===lt?yield function pe(A,L,q,B,le,Te){return be.apply(this,arguments)}(A,L,q,B,Pt,kt):"consent"===lt?A("consent","update",kt):A("set",Pt)}catch(nn){ke.error(nn)}}),Te.apply(this,arguments)}return function le(lt,Pt,kt){return Te.apply(this,arguments)}}(Te,A,L,q),{gtagCore:Te,wrappedGtag:window[le]}}(_n,or,Ni,Rt,yt);Bn=Te,At=lt,tn=!0}return _n[B]=function _t(A,L,q,B,le,Te,lt){return Qr.apply(this,arguments)}(A,or,Ni,L,At,Rt,q),new Xr(A)}function Pr(){return Yt.apply(this,arguments)}function Yt(){return(Yt=(0,_.Z)(function*(){if((0,te.ru)()||!(0,te.zI)()||!(0,te.hl)())return!1;try{return yield(0,te.eu)()}catch{return!1}})).apply(this,arguments)}function yr(A,L,q){A=(0,te.m9)(A),function Qe(A,L,q,B){return wt.apply(this,arguments)}(Bn,_n[A.app.options.appId],L,q).catch(B=>ke.error(B))}function si(A,L,q){A=(0,te.m9)(A),function kn(A,L,q,B){return Dn.apply(this,arguments)}(Bn,_n[A.app.options.appId],L,q).catch(B=>ke.error(B))}function He(A,L,q){A=(0,te.m9)(A),function Sn(A,L,q,B){return hn.apply(this,arguments)}(Bn,_n[A.app.options.appId],L,q).catch(B=>ke.error(B))}function Ce(A,L){A=(0,te.m9)(A),function sr(A,L){return Nr.apply(this,arguments)}(_n[A.app.options.appId],L).catch(q=>ke.error(q))}function Dt(A,L,q,B){A=(0,te.m9)(A),function Tt(A,L,q,B,le){return rn.apply(this,arguments)}(Bn,_n[A.app.options.appId],L,q,B).catch(le=>ke.error(le))}const Bt="@firebase/analytics";!function H(){(0,X._registerComponent)(new ae.wA(de,(L,{options:q})=>er(L.getProvider("app").getImmediate(),L.getProvider("installations-internal").getImmediate(),q),"PUBLIC")),(0,X._registerComponent)(new ae.wA("analytics-internal",function A(L){try{const q=L.getProvider(de).getImmediate();return{logEvent:(B,le,Te)=>Dt(q,B,le,Te)}}catch(q){throw Se.create("interop-component-reg-failed",{reason:q})}},"PRIVATE")),(0,X.registerVersion)(Bt,"0.9.4"),(0,X.registerVersion)(Bt,"0.9.4","esm2017")}()},3942:(mt,De,P)=>{P.d(De,{Z:()=>Ze});var _=P(2090),X=P(4859),V=P(9681),te=P(1877);class ae{constructor(pe,be){this._delegate=pe,this.firebase=be,(0,V._addComponent)(pe,new X.wA("app-compat",()=>this,"PUBLIC")),this.container=pe.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(pe){this._delegate.automaticDataCollectionEnabled=pe}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(pe=>{this._delegate.checkDestroyed(),pe()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,V.deleteApp)(this._delegate)))}_getService(pe,be=V._DEFAULT_ENTRY_NAME){var Ne;this._delegate.checkDestroyed();const Ue=this._delegate.container.getProvider(pe);return!Ue.isInitialized()&&"EXPLICIT"===(null===(Ne=Ue.getComponent())||void 0===Ne?void 0:Ne.instantiationMode)&&Ue.initialize(),Ue.getImmediate({identifier:be})}_removeServiceInstance(pe,be=V._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(pe).clearInstance(be)}_addComponent(pe){(0,V._addComponent)(this._delegate,pe)}_addOrOverwriteComponent(pe){(0,V._addOrOverwriteComponent)(this._delegate,pe)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const de=new _.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),G=function ue(){const rt=function ge(rt){const pe={},be={__esModule:!0,initializeApp:function Ae(Se,j={}){const we=V.initializeApp(Se,j);if((0,_.r3)(pe,we.name))return pe[we.name];const We=new rt(we,be);return pe[we.name]=We,We},app:Ue,registerVersion:V.registerVersion,setLogLevel:V.setLogLevel,onLog:V.onLog,apps:null,SDK_VERSION:V.SDK_VERSION,INTERNAL:{registerComponent:function Re(Se){const j=Se.name,we=j.replace("-compat","");if(V._registerComponent(Se)&&"PUBLIC"===Se.type){const We=(Ye=Ue())=>{if("function"!=typeof Ye[we])throw de.create("invalid-app-argument",{appName:j});return Ye[we]()};void 0!==Se.serviceProps&&(0,_.ZB)(We,Se.serviceProps),be[we]=We,rt.prototype[we]=function(...Ye){return this._getService.bind(this,j).apply(this,Se.multipleInstances?Ye:[])}}return"PUBLIC"===Se.type?be[we]:null},removeApp:function Ne(Se){delete pe[Se]},useAsService:function Ge(Se,j){return"serverAuth"===j?null:j},modularAPIs:V}};function Ue(Se){if(!(0,_.r3)(pe,Se=Se||V._DEFAULT_ENTRY_NAME))throw de.create("no-app",{appName:Se});return pe[Se]}return be.default=be,Object.defineProperty(be,"apps",{get:function Ie(){return Object.keys(pe).map(Se=>pe[Se])}}),Ue.App=rt,be}(ae);return rt.INTERNAL=Object.assign(Object.assign({},rt.INTERNAL),{createFirebaseNamespace:ue,extendNamespace:function pe(be){(0,_.ZB)(rt,be)},createSubscribe:_.ne,ErrorFactory:_.LL,deepExtend:_.ZB}),rt}(),W=new te.Yd("@firebase/app-compat");if((0,_.jU)()&&void 0!==self.firebase){W.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const rt=self.firebase.SDK_VERSION;rt&&rt.indexOf("LITE")>=0&&W.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Ze=G;!function ve(rt){(0,V.registerVersion)("@firebase/app-compat","0.2.5",rt)}()},9681:(mt,De,P)=>{P.r(De),P.d(De,{FirebaseError:()=>te.ZR,SDK_VERSION:()=>sr,_DEFAULT_ENTRY_NAME:()=>Fe,_addComponent:()=>vn,_addOrOverwriteComponent:()=>Tt,_apps:()=>et,_clearComponents:()=>kn,_components:()=>st,_getProvider:()=>Qe,_registerComponent:()=>rn,_removeServiceInstance:()=>wt,deleteApp:()=>ii,getApp:()=>Yr,getApps:()=>Kn,initializeApp:()=>Nr,onLog:()=>_t,registerVersion:()=>On,setLogLevel:()=>Qr});var _=P(5861),X=P(4859),V=P(1877),te=P(2090),ae=P(8766);class ne{constructor(Ce){this.container=Ce}getPlatformInfoString(){return this.container.getProviders().map(at=>{if(function de(He){return"VERSION"===He.getComponent()?.type}(at)){const Dt=at.getImmediate();return`${Dt.library}/${Dt.version}`}return null}).filter(at=>at).join(" ")}}const ge="@firebase/app",G=new V.Yd("@firebase/app"),Fe="[DEFAULT]",$e={[ge]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},et=new Map,st=new Map;function vn(He,Ce){try{He.container.addComponent(Ce)}catch(at){G.debug(`Component ${Ce.name} failed to register with FirebaseApp ${He.name}`,at)}}function Tt(He,Ce){He.container.addOrOverwriteComponent(Ce)}function rn(He){const Ce=He.name;if(st.has(Ce))return G.debug(`There were multiple attempts to register component ${Ce}.`),!1;st.set(Ce,He);for(const at of et.values())vn(at,He);return!0}function Qe(He,Ce){const at=He.container.getProvider("heartbeat").getImmediate({optional:!0});return at&&at.triggerHeartbeat(),He.container.getProvider(Ce)}function wt(He,Ce,at=Fe){Qe(He,Ce).clearInstance(at)}function kn(){st.clear()}const Sn=new te.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class hn{constructor(Ce,at,Dt){this._isDeleted=!1,this._options=Object.assign({},Ce),this._config=Object.assign({},at),this._name=at.name,this._automaticDataCollectionEnabled=at.automaticDataCollectionEnabled,this._container=Dt,this.container.addComponent(new X.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ce){this.checkDestroyed(),this._automaticDataCollectionEnabled=Ce}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Ce){this._isDeleted=Ce}checkDestroyed(){if(this.isDeleted)throw Sn.create("app-deleted",{appName:this._name})}}const sr="9.18.0";function Nr(He,Ce={}){let at=He;"object"!=typeof Ce&&(Ce={name:Ce});const Dt=Object.assign({name:Fe,automaticDataCollectionEnabled:!1},Ce),Lt=Dt.name;if("string"!=typeof Lt||!Lt)throw Sn.create("bad-app-name",{appName:String(Lt)});if(at||(at=(0,te.aH)()),!at)throw Sn.create("no-options");const Bt=et.get(Lt);if(Bt){if((0,te.vZ)(at,Bt.options)&&(0,te.vZ)(Dt,Bt.config))return Bt;throw Sn.create("duplicate-app",{appName:Lt})}const Gn=new X.H0(Lt);for(const A of st.values())Gn.addComponent(A);const H=new hn(at,Dt,Gn);return et.set(Lt,H),H}function Yr(He=Fe){const Ce=et.get(He);if(!Ce&&He===Fe)return Nr();if(!Ce)throw Sn.create("no-app",{appName:He});return Ce}function Kn(){return Array.from(et.values())}function ii(He){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,_.Z)(function*(He){const Ce=He.name;et.has(Ce)&&(et.delete(Ce),yield Promise.all(He.container.getProviders().map(at=>at.delete())),He.isDeleted=!0)})).apply(this,arguments)}function On(He,Ce,at){var Dt;let Lt=null!==(Dt=$e[He])&&void 0!==Dt?Dt:He;at&&(Lt+=`-${at}`);const Bt=Lt.match(/\s|\//),Gn=Ce.match(/\s|\//);if(Bt||Gn){const H=[`Unable to register library "${Lt}" with version "${Ce}":`];return Bt&&H.push(`library name "${Lt}" contains illegal characters (whitespace or "/")`),Bt&&Gn&&H.push("and"),Gn&&H.push(`version name "${Ce}" contains illegal characters (whitespace or "/")`),void G.warn(H.join(" "))}rn(new X.wA(`${Lt}-version`,()=>({library:Lt,version:Ce}),"VERSION"))}function _t(He,Ce){if(null!==He&&"function"!=typeof He)throw Sn.create("invalid-log-argument");(0,V.Am)(He,Ce)}function Qr(He){(0,V.Ub)(He)}const Xr="firebase-heartbeat-database",_n=1,or="firebase-heartbeat-store";let Ni=null;function Rt(){return Ni||(Ni=(0,ae.X3)(Xr,_n,{upgrade:(He,Ce)=>{0===Ce&&He.createObjectStore(or)}}).catch(He=>{throw Sn.create("idb-open",{originalErrorMessage:He.message})})),Ni}function At(){return(At=(0,_.Z)(function*(He){try{return(yield Rt()).transaction(or).objectStore(or).get(Hn(He))}catch(Ce){if(Ce instanceof te.ZR)G.warn(Ce.message);else{const at=Sn.create("idb-get",{originalErrorMessage:Ce?.message});G.warn(at.message)}}})).apply(this,arguments)}function Bn(He,Ce){return tn.apply(this,arguments)}function tn(){return(tn=(0,_.Z)(function*(He,Ce){try{const Dt=(yield Rt()).transaction(or,"readwrite");return yield Dt.objectStore(or).put(Ce,Hn(He)),Dt.done}catch(at){if(at instanceof te.ZR)G.warn(at.message);else{const Dt=Sn.create("idb-set",{originalErrorMessage:at?.message});G.warn(Dt.message)}}})).apply(this,arguments)}function Hn(He){return`${He.name}!${He.options.appId}`}class Wi{constructor(Ce){this.container=Ce,this._heartbeatsCache=null;const at=this.container.getProvider("app").getImmediate();this._storage=new Yt(at),this._heartbeatsCachePromise=this._storage.read().then(Dt=>(this._heartbeatsCache=Dt,Dt))}triggerHeartbeat(){var Ce=this;return(0,_.Z)(function*(){const Dt=Ce.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Lt=ln();if(null===Ce._heartbeatsCache&&(Ce._heartbeatsCache=yield Ce._heartbeatsCachePromise),Ce._heartbeatsCache.lastSentHeartbeatDate!==Lt&&!Ce._heartbeatsCache.heartbeats.some(Bt=>Bt.date===Lt))return Ce._heartbeatsCache.heartbeats.push({date:Lt,agent:Dt}),Ce._heartbeatsCache.heartbeats=Ce._heartbeatsCache.heartbeats.filter(Bt=>{const Gn=new Date(Bt.date).valueOf();return Date.now()-Gn<=2592e6}),Ce._storage.overwrite(Ce._heartbeatsCache)})()}getHeartbeatsHeader(){var Ce=this;return(0,_.Z)(function*(){if(null===Ce._heartbeatsCache&&(yield Ce._heartbeatsCachePromise),null===Ce._heartbeatsCache||0===Ce._heartbeatsCache.heartbeats.length)return"";const at=ln(),{heartbeatsToSend:Dt,unsentEntries:Lt}=function Pr(He,Ce=1024){const at=[];let Dt=He.slice();for(const Lt of He){const Bt=at.find(Gn=>Gn.agent===Lt.agent);if(Bt){if(Bt.dates.push(Lt.date),yr(at)>Ce){Bt.dates.pop();break}}else if(at.push({agent:Lt.agent,dates:[Lt.date]}),yr(at)>Ce){at.pop();break}Dt=Dt.slice(1)}return{heartbeatsToSend:at,unsentEntries:Dt}}(Ce._heartbeatsCache.heartbeats),Bt=(0,te.L)(JSON.stringify({version:2,heartbeats:Dt}));return Ce._heartbeatsCache.lastSentHeartbeatDate=at,Lt.length>0?(Ce._heartbeatsCache.heartbeats=Lt,yield Ce._storage.overwrite(Ce._heartbeatsCache)):(Ce._heartbeatsCache.heartbeats=[],Ce._storage.overwrite(Ce._heartbeatsCache)),Bt})()}}function ln(){return(new Date).toISOString().substring(0,10)}class Yt{constructor(Ce){this.app=Ce,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,_.Z)(function*(){return!!(0,te.hl)()&&(0,te.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Ce=this;return(0,_.Z)(function*(){return(yield Ce._canUseIndexedDBPromise)&&(yield function yt(He){return At.apply(this,arguments)}(Ce.app))||{heartbeats:[]}})()}overwrite(Ce){var at=this;return(0,_.Z)(function*(){var Dt;if(yield at._canUseIndexedDBPromise){const Bt=yield at.read();return Bn(at.app,{lastSentHeartbeatDate:null!==(Dt=Ce.lastSentHeartbeatDate)&&void 0!==Dt?Dt:Bt.lastSentHeartbeatDate,heartbeats:Ce.heartbeats})}})()}add(Ce){var at=this;return(0,_.Z)(function*(){var Dt;if(yield at._canUseIndexedDBPromise){const Bt=yield at.read();return Bn(at.app,{lastSentHeartbeatDate:null!==(Dt=Ce.lastSentHeartbeatDate)&&void 0!==Dt?Dt:Bt.lastSentHeartbeatDate,heartbeats:[...Bt.heartbeats,...Ce.heartbeats]})}})()}}function yr(He){return(0,te.L)(JSON.stringify({version:2,heartbeats:He})).length}!function si(He){rn(new X.wA("platform-logger",Ce=>new ne(Ce),"PRIVATE")),rn(new X.wA("heartbeat",Ce=>new Wi(Ce),"PRIVATE")),On(ge,"0.9.5",He),On(ge,"0.9.5","esm2017"),On("fire-js","")}("")},4859:(mt,De,P)=>{P.d(De,{H0:()=>ge,wA:()=>V,zt:()=>ae});var _=P(5861),X=P(2090);class V{constructor(G,W,Y){this.name=G,this.instanceFactory=W,this.type=Y,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(G){return this.instantiationMode=G,this}setMultipleInstances(G){return this.multipleInstances=G,this}setServiceProps(G){return this.serviceProps=G,this}setInstanceCreatedCallback(G){return this.onInstanceCreated=G,this}}const te="[DEFAULT]";class ae{constructor(G,W){this.name=G,this.container=W,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(G){const W=this.normalizeInstanceIdentifier(G);if(!this.instancesDeferred.has(W)){const Y=new X.BH;if(this.instancesDeferred.set(W,Y),this.isInitialized(W)||this.shouldAutoInitialize())try{const ke=this.getOrInitializeService({instanceIdentifier:W});ke&&Y.resolve(ke)}catch{}}return this.instancesDeferred.get(W).promise}getImmediate(G){var W;const Y=this.normalizeInstanceIdentifier(G?.identifier),ke=null!==(W=G?.optional)&&void 0!==W&&W;if(!this.isInitialized(Y)&&!this.shouldAutoInitialize()){if(ke)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Y})}catch(ve){if(ke)return null;throw ve}}getComponent(){return this.component}setComponent(G){if(G.name!==this.name)throw Error(`Mismatching Component ${G.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=G,this.shouldAutoInitialize()){if(function de(ue){return"EAGER"===ue.instantiationMode}(G))try{this.getOrInitializeService({instanceIdentifier:te})}catch{}for(const[W,Y]of this.instancesDeferred.entries()){const ke=this.normalizeInstanceIdentifier(W);try{const ve=this.getOrInitializeService({instanceIdentifier:ke});Y.resolve(ve)}catch{}}}}clearInstance(G=te){this.instancesDeferred.delete(G),this.instancesOptions.delete(G),this.instances.delete(G)}delete(){var G=this;return(0,_.Z)(function*(){const W=Array.from(G.instances.values());yield Promise.all([...W.filter(Y=>"INTERNAL"in Y).map(Y=>Y.INTERNAL.delete()),...W.filter(Y=>"_delete"in Y).map(Y=>Y._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(G=te){return this.instances.has(G)}getOptions(G=te){return this.instancesOptions.get(G)||{}}initialize(G={}){const{options:W={}}=G,Y=this.normalizeInstanceIdentifier(G.instanceIdentifier);if(this.isInitialized(Y))throw Error(`${this.name}(${Y}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const ke=this.getOrInitializeService({instanceIdentifier:Y,options:W});for(const[ve,Ze]of this.instancesDeferred.entries())Y===this.normalizeInstanceIdentifier(ve)&&Ze.resolve(ke);return ke}onInit(G,W){var Y;const ke=this.normalizeInstanceIdentifier(W),ve=null!==(Y=this.onInitCallbacks.get(ke))&&void 0!==Y?Y:new Set;ve.add(G),this.onInitCallbacks.set(ke,ve);const Ze=this.instances.get(ke);return Ze&&G(Ze,ke),()=>{ve.delete(G)}}invokeOnInitCallbacks(G,W){const Y=this.onInitCallbacks.get(W);if(Y)for(const ke of Y)try{ke(G,W)}catch{}}getOrInitializeService({instanceIdentifier:G,options:W={}}){let Y=this.instances.get(G);if(!Y&&this.component&&(Y=this.component.instanceFactory(this.container,{instanceIdentifier:(ue=G,ue===te?void 0:ue),options:W}),this.instances.set(G,Y),this.instancesOptions.set(G,W),this.invokeOnInitCallbacks(Y,G),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,G,Y)}catch{}var ue;return Y||null}normalizeInstanceIdentifier(G=te){return this.component?this.component.multipleInstances?G:te:G}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ge{constructor(G){this.name=G,this.providers=new Map}addComponent(G){const W=this.getProvider(G.name);if(W.isComponentSet())throw new Error(`Component ${G.name} has already been registered with ${this.name}`);W.setComponent(G)}addOrOverwriteComponent(G){this.getProvider(G.name).isComponentSet()&&this.providers.delete(G.name),this.addComponent(G)}getProvider(G){if(this.providers.has(G))return this.providers.get(G);const W=new ae(G,this);return this.providers.set(G,W),W}getProviders(){return Array.from(this.providers.values())}}},2833:(mt,De,P)=>{var _=P(5861),X=P(9681),V=P(4859),te=P(2090),ae=P(8766);const ne="@firebase/installations",de="0.6.4",ge=1e4,ue=`w:${de}`,G="FIS_v2",W="https://firebaseinstallations.googleapis.com/v1",Y=36e5,rt=new te.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function pe(Z){return Z instanceof te.ZR&&Z.code.includes("request-failed")}function be({projectId:Z}){return`${W}/projects/${Z}/installations`}function Ne(Z){return{token:Z.token,requestStatus:2,expiresIn:j(Z.expiresIn),creationTime:Date.now()}}function Ue(Z,ye){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,_.Z)(function*(Z,ye){const qe=(yield ye.json()).error;return rt.create("request-failed",{requestName:Z,serverCode:qe.code,serverMessage:qe.message,serverStatus:qe.status})})).apply(this,arguments)}function Ie({apiKey:Z}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":Z})}function Ge(Z){return Se.apply(this,arguments)}function Se(){return(Se=(0,_.Z)(function*(Z){const ye=yield Z();return ye.status>=500&&ye.status<600?Z():ye})).apply(this,arguments)}function j(Z){return Number(Z.replace("s","000"))}function Ye(){return(Ye=(0,_.Z)(function*({appConfig:Z,heartbeatServiceProvider:ye},{fid:Ve}){const qe=be(Z),Qt=Ie(Z),$t=ye.getImmediate({optional:!0});if($t){const kr=yield $t.getHeartbeatsHeader();kr&&Qt.append("x-firebase-client",kr)}const fn={method:"POST",headers:Qt,body:JSON.stringify({fid:Ve,authVersion:G,appId:Z.appId,sdkVersion:ue})},qi=yield Ge(()=>fetch(qe,fn));if(qi.ok){const kr=yield qi.json();return{fid:kr.fid||Ve,registrationStatus:2,refreshToken:kr.refreshToken,authToken:Ne(kr.authToken)}}throw yield Ue("Create Installation",qi)})).apply(this,arguments)}function gt(Z){return new Promise(ye=>{setTimeout(ye,Z)})}const re=/^[cdef][\w-]{21}$/,he="";function _e(){try{const Z=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(Z),Z[0]=112+Z[0]%16;const Ve=function xe(Z){return function Je(Z){return btoa(String.fromCharCode(...Z)).replace(/\+/g,"-").replace(/\//g,"_")}(Z).substr(0,22)}(Z);return re.test(Ve)?Ve:he}catch{return he}}function Fe(Z){return`${Z.appName}!${Z.appId}`}const $e=new Map;function et(Z,ye){const Ve=Fe(Z);Tt(Ve,ye),function rn(Z,ye){const Ve=function wt(){return!Qe&&"BroadcastChannel"in self&&(Qe=new BroadcastChannel("[Firebase] FID Change"),Qe.onmessage=Z=>{Tt(Z.data.key,Z.data.fid)}),Qe}();Ve&&Ve.postMessage({key:Z,fid:ye}),function kn(){0===$e.size&&Qe&&(Qe.close(),Qe=null)}()}(Ve,ye)}function Tt(Z,ye){const Ve=$e.get(Z);if(Ve)for(const qe of Ve)qe(ye)}let Qe=null;const Dn="firebase-installations-database",Sn=1,hn="firebase-installations-store";let sr=null;function Nr(){return sr||(sr=(0,ae.X3)(Dn,Sn,{upgrade:(Z,ye)=>{0===ye&&Z.createObjectStore(hn)}})),sr}function Yr(Z,ye){return Kn.apply(this,arguments)}function Kn(){return(Kn=(0,_.Z)(function*(Z,ye){const Ve=Fe(Z),Qt=(yield Nr()).transaction(hn,"readwrite"),$t=Qt.objectStore(hn),Zn=yield $t.get(Ve);return yield $t.put(ye,Ve),yield Qt.done,(!Zn||Zn.fid!==ye.fid)&&et(Z,ye.fid),ye})).apply(this,arguments)}function ii(Z){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,_.Z)(function*(Z){const ye=Fe(Z),qe=(yield Nr()).transaction(hn,"readwrite");yield qe.objectStore(hn).delete(ye),yield qe.done})).apply(this,arguments)}function On(Z,ye){return _t.apply(this,arguments)}function _t(){return(_t=(0,_.Z)(function*(Z,ye){const Ve=Fe(Z),Qt=(yield Nr()).transaction(hn,"readwrite"),$t=Qt.objectStore(hn),Zn=yield $t.get(Ve),fn=ye(Zn);return void 0===fn?yield $t.delete(Ve):yield $t.put(fn,Ve),yield Qt.done,fn&&(!Zn||Zn.fid!==fn.fid)&&et(Z,fn.fid),fn})).apply(this,arguments)}function Qr(Z){return Xr.apply(this,arguments)}function Xr(){return Xr=(0,_.Z)(function*(Z){let ye;const Ve=yield On(Z.appConfig,qe=>{const Qt=function _n(Z){return tn(Z||{fid:_e(),registrationStatus:0})}(qe),$t=function or(Z,ye){if(0===ye.registrationStatus){if(!navigator.onLine)return{installationEntry:ye,registrationPromise:Promise.reject(rt.create("app-offline"))};const Ve={fid:ye.fid,registrationStatus:1,registrationTime:Date.now()},qe=function Ni(Z,ye){return Rt.apply(this,arguments)}(Z,Ve);return{installationEntry:Ve,registrationPromise:qe}}return 1===ye.registrationStatus?{installationEntry:ye,registrationPromise:yt(Z)}:{installationEntry:ye}}(Z,Qt);return ye=$t.registrationPromise,$t.installationEntry});return Ve.fid===he?{installationEntry:yield ye}:{installationEntry:Ve,registrationPromise:ye}}),Xr.apply(this,arguments)}function Rt(){return Rt=(0,_.Z)(function*(Z,ye){try{const Ve=yield function We(Z,ye){return Ye.apply(this,arguments)}(Z,ye);return Yr(Z.appConfig,Ve)}catch(Ve){throw pe(Ve)&&409===Ve.customData.serverCode?yield ii(Z.appConfig):yield Yr(Z.appConfig,{fid:ye.fid,registrationStatus:0}),Ve}}),Rt.apply(this,arguments)}function yt(Z){return At.apply(this,arguments)}function At(){return(At=(0,_.Z)(function*(Z){let ye=yield Bn(Z.appConfig);for(;1===ye.registrationStatus;)yield gt(100),ye=yield Bn(Z.appConfig);if(0===ye.registrationStatus){const{installationEntry:Ve,registrationPromise:qe}=yield Qr(Z);return qe||Ve}return ye})).apply(this,arguments)}function Bn(Z){return On(Z,ye=>{if(!ye)throw rt.create("installation-not-found");return tn(ye)})}function tn(Z){return function Hn(Z){return 1===Z.registrationStatus&&Z.registrationTime+ge<Date.now()}(Z)?{fid:Z.fid,registrationStatus:0}:Z}function er(){return(er=(0,_.Z)(function*({appConfig:Z,heartbeatServiceProvider:ye},Ve){const qe=function Wi(Z,{fid:ye}){return`${be(Z)}/${ye}/authTokens:generate`}(Z,Ve),Qt=function Re(Z,{refreshToken:ye}){const Ve=Ie(Z);return Ve.append("Authorization",function we(Z){return`${G} ${Z}`}(ye)),Ve}(Z,Ve),$t=ye.getImmediate({optional:!0});if($t){const kr=yield $t.getHeartbeatsHeader();kr&&Qt.append("x-firebase-client",kr)}const fn={method:"POST",headers:Qt,body:JSON.stringify({installation:{sdkVersion:ue,appId:Z.appId}})},qi=yield Ge(()=>fetch(qe,fn));if(qi.ok)return Ne(yield qi.json());throw yield Ue("Generate Auth Token",qi)})).apply(this,arguments)}function ln(Z){return Pr.apply(this,arguments)}function Pr(){return Pr=(0,_.Z)(function*(Z,ye=!1){let Ve;const qe=yield On(Z.appConfig,$t=>{if(!at($t))throw rt.create("not-registered");const Zn=$t.authToken;if(!ye&&function Dt(Z){return 2===Z.requestStatus&&!function Lt(Z){const ye=Date.now();return ye<Z.creationTime||Z.creationTime+Z.expiresIn<ye+Y}(Z)}(Zn))return $t;if(1===Zn.requestStatus)return Ve=function Yt(Z,ye){return yr.apply(this,arguments)}(Z,ye),$t;{if(!navigator.onLine)throw rt.create("app-offline");const fn=function Bt(Z){const ye={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},Z),{authToken:ye})}($t);return Ve=function He(Z,ye){return Ce.apply(this,arguments)}(Z,fn),fn}});return Ve?yield Ve:qe.authToken}),Pr.apply(this,arguments)}function yr(){return(yr=(0,_.Z)(function*(Z,ye){let Ve=yield si(Z.appConfig);for(;1===Ve.authToken.requestStatus;)yield gt(100),Ve=yield si(Z.appConfig);const qe=Ve.authToken;return 0===qe.requestStatus?ln(Z,ye):qe})).apply(this,arguments)}function si(Z){return On(Z,ye=>{if(!at(ye))throw rt.create("not-registered");return function Gn(Z){return 1===Z.requestStatus&&Z.requestTime+ge<Date.now()}(ye.authToken)?Object.assign(Object.assign({},ye),{authToken:{requestStatus:0}}):ye})}function Ce(){return Ce=(0,_.Z)(function*(Z,ye){try{const Ve=yield function Jn(Z,ye){return er.apply(this,arguments)}(Z,ye),qe=Object.assign(Object.assign({},ye),{authToken:Ve});return yield Yr(Z.appConfig,qe),Ve}catch(Ve){if(!pe(Ve)||401!==Ve.customData.serverCode&&404!==Ve.customData.serverCode){const qe=Object.assign(Object.assign({},ye),{authToken:{requestStatus:0}});yield Yr(Z.appConfig,qe)}else yield ii(Z.appConfig);throw Ve}}),Ce.apply(this,arguments)}function at(Z){return void 0!==Z&&2===Z.registrationStatus}function A(){return(A=(0,_.Z)(function*(Z){const ye=Z,{installationEntry:Ve,registrationPromise:qe}=yield Qr(ye);return qe?qe.catch(console.error):ln(ye).catch(console.error),Ve.fid})).apply(this,arguments)}function q(){return q=(0,_.Z)(function*(Z,ye=!1){const Ve=Z;return yield function B(Z){return le.apply(this,arguments)}(Ve),(yield ln(Ve,ye)).token}),q.apply(this,arguments)}function le(){return(le=(0,_.Z)(function*(Z){const{registrationPromise:ye}=yield Qr(Z);ye&&(yield ye)})).apply(this,arguments)}function ar(Z){return rt.create("missing-app-config-values",{valueName:Z})}const Yo="installations",go=Z=>{const ye=Z.getProvider("app").getImmediate(),Ve=function Tr(Z){if(!Z||!Z.options)throw ar("App Configuration");if(!Z.name)throw ar("App Name");const ye=["projectId","apiKey","appId"];for(const Ve of ye)if(!Z.options[Ve])throw ar(Ve);return{appName:Z.name,projectId:Z.options.projectId,apiKey:Z.options.apiKey,appId:Z.options.appId}}(ye);return{app:ye,appConfig:Ve,heartbeatServiceProvider:(0,X._getProvider)(ye,"heartbeat"),_delete:()=>Promise.resolve()}},mo=Z=>{const ye=Z.getProvider("app").getImmediate(),Ve=(0,X._getProvider)(ye,Yo).getImmediate();return{getId:()=>function H(Z){return A.apply(this,arguments)}(Ve),getToken:Qt=>function L(Z){return q.apply(this,arguments)}(Ve,Qt)}};(function Xo(){(0,X._registerComponent)(new V.wA(Yo,go,"PUBLIC")),(0,X._registerComponent)(new V.wA("installations-internal",mo,"PRIVATE"))})(),(0,X.registerVersion)(ne,de),(0,X.registerVersion)(ne,de,"esm2017")},1877:(mt,De,P)=>{P.d(De,{Am:()=>ue,Ub:()=>ge,Yd:()=>de,in:()=>X});const _=[];var X=(()=>{return(G=X||(X={}))[G.DEBUG=0]="DEBUG",G[G.VERBOSE=1]="VERBOSE",G[G.INFO=2]="INFO",G[G.WARN=3]="WARN",G[G.ERROR=4]="ERROR",G[G.SILENT=5]="SILENT",X;var G})();const V={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},te=X.INFO,ae={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},ne=(G,W,...Y)=>{if(W<G.logLevel)return;const ke=(new Date).toISOString(),ve=ae[W];if(!ve)throw new Error(`Attempted to log a message with an invalid logType (value: ${W})`);console[ve](`[${ke}]  ${G.name}:`,...Y)};class de{constructor(W){this.name=W,this._logLevel=te,this._logHandler=ne,this._userLogHandler=null,_.push(this)}get logLevel(){return this._logLevel}set logLevel(W){if(!(W in X))throw new TypeError(`Invalid value "${W}" assigned to \`logLevel\``);this._logLevel=W}setLogLevel(W){this._logLevel="string"==typeof W?V[W]:W}get logHandler(){return this._logHandler}set logHandler(W){if("function"!=typeof W)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=W}get userLogHandler(){return this._userLogHandler}set userLogHandler(W){this._userLogHandler=W}debug(...W){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...W),this._logHandler(this,X.DEBUG,...W)}log(...W){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...W),this._logHandler(this,X.VERBOSE,...W)}info(...W){this._userLogHandler&&this._userLogHandler(this,X.INFO,...W),this._logHandler(this,X.INFO,...W)}warn(...W){this._userLogHandler&&this._userLogHandler(this,X.WARN,...W),this._logHandler(this,X.WARN,...W)}error(...W){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...W),this._logHandler(this,X.ERROR,...W)}}function ge(G){_.forEach(W=>{W.setLogLevel(G)})}function ue(G,W){for(const Y of _){let ke=null;W&&W.level&&(ke=V[W.level]),Y.userLogHandler=null===G?null:(ve,Ze,...rt)=>{const pe=rt.map(be=>{if(null==be)return null;if("string"==typeof be)return be;if("number"==typeof be||"boolean"==typeof be)return be.toString();if(be instanceof Error)return be.message;try{return JSON.stringify(be)}catch{return null}}).filter(be=>be).join(" ");Ze>=(ke??ve.logLevel)&&G({level:X[Ze].toLowerCase(),message:pe,args:rt,type:ve.name})}}}},5132:(mt,De,P)=>{P.d(De,{Gb:()=>_.Gb});var _=P(579)},259:(mt,De,P)=>{P.d(De,{C6:()=>_.getApps,Mq:()=>_.getApp});var _=P(9681);(0,_.registerVersion)("firebase","9.18.0","app")},9260:(mt,De,P)=>{P.d(De,{Z:()=>_.Z});var _=P(3942);_.Z.registerVersion("firebase","9.18.0","app-compat")},8971:(mt,De,P)=>{P.r(De);var _=P(5861),X=P(3942),V=P(2090),te=P(9681),ae=P(1877),ne=P(655),de=P(4859);const ue={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Y_EMAIL_SIGNIN="EMAIL_SIGNIN",Y_PASSWORD_RESET="PASSWORD_RESET",Y_RECOVER_EMAIL="RECOVER_EMAIL",Y_REVERT_SECOND_FACTOR_ADDITION="REVERT_SECOND_FACTOR_ADDITION",Y_VERIFY_AND_CHANGE_EMAIL="VERIFY_AND_CHANGE_EMAIL",Y_VERIFY_EMAIL="VERIFY_EMAIL";const Ze=function ke(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},rt=function ve(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},pe=new V.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ne=new ae.Yd("@firebase/auth");function Ue(y,...f){Ne.logLevel<=ae.in.ERROR&&Ne.error(`Auth (${te.SDK_VERSION}): ${y}`,...f)}function Ae(y,...f){throw Se(y,...f)}function Ie(y,...f){return Se(y,...f)}function Re(y,f,p){const E=Object.assign(Object.assign({},rt()),{[f]:p});return new V.LL("auth","Firebase",E).create(f,{appName:y.name})}function Ge(y,f,p){if(!(f instanceof p))throw p.name!==f.constructor.name&&Ae(y,"argument-error"),Re(y,"argument-error",`Type of ${f.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Se(y,...f){if("string"!=typeof y){const p=f[0],E=[...f.slice(1)];return E[0]&&(E[0].appName=y.name),y._errorFactory.create(p,...E)}return pe.create(y,...f)}function j(y,f,...p){if(!y)throw Se(f,...p)}function we(y){const f="INTERNAL ASSERTION FAILED: "+y;throw Ue(f),new Error(f)}function We(y,f){y||we(f)}const Ye=new Map;function gt(y){We(y instanceof Function,"Expected a class definition");let f=Ye.get(y);return f?(We(f instanceof y,"Instance stored in cache mismatched with class"),f):(f=new y,Ye.set(y,f),f)}function he(){var y;return typeof self<"u"&&(null===(y=self.location)||void 0===y?void 0:y.href)||""}function _e(){return"http:"===xe()||"https:"===xe()}function xe(){var y;return typeof self<"u"&&(null===(y=self.location)||void 0===y?void 0:y.protocol)||null}class et{constructor(f,p){this.shortDelay=f,this.longDelay=p,We(p>f,"Short delay should be less than long delay!"),this.isMobile=(0,V.uI)()||(0,V.b$)()}get(){return function Fe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(_e()||(0,V.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function st(y,f){We(y.emulator,"Emulator should always be set here");const{url:p}=y.emulator;return f?`${p}${f.startsWith("/")?f.slice(1):f}`:p}class vn{static initialize(f,p,E){this.fetchImpl=f,p&&(this.headersImpl=p),E&&(this.responseImpl=E)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void we("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void we("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void we("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Tt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},rn=new et(3e4,6e4);function Qe(y,f){return y.tenantId&&!f.tenantId?Object.assign(Object.assign({},f),{tenantId:y.tenantId}):f}function wt(y,f,p,E){return kn.apply(this,arguments)}function kn(){return(kn=(0,_.Z)(function*(y,f,p,E,C={}){return Dn(y,C,(0,_.Z)(function*(){let M={},Q={};E&&("GET"===f?Q=E:M={body:JSON.stringify(E)});const fe=(0,V.xO)(Object.assign({key:y.config.apiKey},Q)).slice(1),Ke=yield y._getAdditionalHeaders();return Ke["Content-Type"]="application/json",y.languageCode&&(Ke["X-Firebase-Locale"]=y.languageCode),vn.fetch()(Nr(y,y.config.apiHost,p,fe),Object.assign({method:f,headers:Ke,referrerPolicy:"no-referrer"},M))}))})).apply(this,arguments)}function Dn(y,f,p){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,_.Z)(function*(y,f,p){y._canInitEmulator=!1;const E=Object.assign(Object.assign({},Tt),f);try{const C=new Yr(y),M=yield Promise.race([p(),C.promise]);C.clearNetworkTimeout();const Q=yield M.json();if("needConfirmation"in Q)throw Kn(y,"account-exists-with-different-credential",Q);if(M.ok&&!("errorMessage"in Q))return Q;{const fe=M.ok?Q.errorMessage:Q.error.message,[Ke,ut]=fe.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Ke)throw Kn(y,"credential-already-in-use",Q);if("EMAIL_EXISTS"===Ke)throw Kn(y,"email-already-in-use",Q);if("USER_DISABLED"===Ke)throw Kn(y,"user-disabled",Q);const Ot=E[Ke]||Ke.toLowerCase().replace(/[_\s]+/g,"-");if(ut)throw Re(y,Ot,ut);Ae(y,Ot)}}catch(C){if(C instanceof V.ZR)throw C;Ae(y,"internal-error",{message:String(C)})}})).apply(this,arguments)}function hn(y,f,p,E){return sr.apply(this,arguments)}function sr(){return(sr=(0,_.Z)(function*(y,f,p,E,C={}){const M=yield wt(y,f,p,E,C);return"mfaPendingCredential"in M&&Ae(y,"multi-factor-auth-required",{_serverResponse:M}),M})).apply(this,arguments)}function Nr(y,f,p,E){const C=`${f}${p}?${E}`;return y.config.emulator?st(y.config,C):`${y.config.apiScheme}://${C}`}class Yr{constructor(f){this.auth=f,this.timer=null,this.promise=new Promise((p,E)=>{this.timer=setTimeout(()=>E(Ie(this.auth,"network-request-failed")),rn.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Kn(y,f,p){const E={appName:y.name};p.email&&(E.email=p.email),p.phoneNumber&&(E.phoneNumber=p.phoneNumber);const C=Ie(y,f,E);return C.customData._tokenResponse=p,C}function Tn(){return(Tn=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:delete",f)})).apply(this,arguments)}function _t(){return(_t=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function Xr(){return(Xr=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:lookup",f)})).apply(this,arguments)}function _n(y){if(y)try{const f=new Date(Number(y));if(!isNaN(f.getTime()))return f.toUTCString()}catch{}}function Rt(){return(Rt=(0,_.Z)(function*(y,f=!1){const p=(0,V.m9)(y),E=yield p.getIdToken(f),C=At(E);j(C&&C.exp&&C.auth_time&&C.iat,p.auth,"internal-error");const M="object"==typeof C.firebase?C.firebase:void 0,Q=M?.sign_in_provider;return{claims:C,token:E,authTime:_n(yt(C.auth_time)),issuedAtTime:_n(yt(C.iat)),expirationTime:_n(yt(C.exp)),signInProvider:Q||null,signInSecondFactor:M?.sign_in_second_factor||null}})).apply(this,arguments)}function yt(y){return 1e3*Number(y)}function At(y){const[f,p,E]=y.split(".");if(void 0===f||void 0===p||void 0===E)return Ue("JWT malformed, contained fewer than 3 sections"),null;try{const C=(0,V.tV)(p);return C?JSON.parse(C):(Ue("Failed to decode base64 JWT payload"),null)}catch(C){return Ue("Caught error parsing JWT payload as JSON",C?.toString()),null}}function tn(y,f){return Hn.apply(this,arguments)}function Hn(){return(Hn=(0,_.Z)(function*(y,f,p=!1){if(p)return f;try{return yield f}catch(E){throw E instanceof V.ZR&&function Jn({code:y}){return"auth/user-disabled"===y||"auth/user-token-expired"===y}(E)&&y.auth.currentUser===y&&(yield y.auth.signOut()),E}})).apply(this,arguments)}class er{constructor(f){this.user=f,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(f){var p;if(f){const E=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),E}{this.errorBackoff=3e4;const C=(null!==(p=this.user.stsTokenManager.expirationTime)&&void 0!==p?p:0)-Date.now()-3e5;return Math.max(0,C)}}schedule(f=!1){var p=this;if(!this.isRunning)return;const E=this.getInterval(f);this.timerId=setTimeout((0,_.Z)(function*(){yield p.iteration()}),E)}iteration(){var f=this;return(0,_.Z)(function*(){try{yield f.user.getIdToken(!0)}catch(p){return void("auth/network-request-failed"===p?.code&&f.schedule(!0))}f.schedule()})()}}class Wi{constructor(f,p){this.createdAt=f,this.lastLoginAt=p,this._initializeTime()}_initializeTime(){this.lastSignInTime=_n(this.lastLoginAt),this.creationTime=_n(this.createdAt)}_copy(f){this.createdAt=f.createdAt,this.lastLoginAt=f.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function ln(y){return Pr.apply(this,arguments)}function Pr(){return Pr=(0,_.Z)(function*(y){var f;const p=y.auth,E=yield y.getIdToken(),C=yield tn(y,function Qr(y,f){return Xr.apply(this,arguments)}(p,{idToken:E}));j(C?.users.length,p,"internal-error");const M=C.users[0];y._notifyReloadListener(M);const Q=null!==(f=M.providerUserInfo)&&void 0!==f&&f.length?function He(y){return y.map(f=>{var{providerId:p}=f,E=(0,ne._T)(f,["providerId"]);return{providerId:p,uid:E.rawId||"",displayName:E.displayName||null,email:E.email||null,phoneNumber:E.phoneNumber||null,photoURL:E.photoUrl||null}})}(M.providerUserInfo):[],fe=function si(y,f){return[...y.filter(E=>!f.some(C=>C.providerId===E.providerId)),...f]}(y.providerData,Q),Ot=!!y.isAnonymous&&!(y.email&&M.passwordHash||fe?.length),Nt={uid:M.localId,displayName:M.displayName||null,photoURL:M.photoUrl||null,email:M.email||null,emailVerified:M.emailVerified||!1,phoneNumber:M.phoneNumber||null,tenantId:M.tenantId||null,providerData:fe,metadata:new Wi(M.createdAt,M.lastLoginAt),isAnonymous:Ot};Object.assign(y,Nt)}),Pr.apply(this,arguments)}function yr(){return(yr=(0,_.Z)(function*(y){const f=(0,V.m9)(y);yield ln(f),yield f.auth._persistUserIfCurrent(f),f.auth._notifyListenersIfCurrent(f)})).apply(this,arguments)}function at(){return(at=(0,_.Z)(function*(y,f){const p=yield Dn(y,{},(0,_.Z)(function*(){const E=(0,V.xO)({grant_type:"refresh_token",refresh_token:f}).slice(1),{tokenApiHost:C,apiKey:M}=y.config,Q=Nr(y,C,"/v1/token",`key=${M}`),fe=yield y._getAdditionalHeaders();return fe["Content-Type"]="application/x-www-form-urlencoded",vn.fetch()(Q,{method:"POST",headers:fe,body:E})}));return{accessToken:p.access_token,expiresIn:p.expires_in,refreshToken:p.refresh_token}})).apply(this,arguments)}class Dt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(f){j(f.idToken,"internal-error"),j(typeof f.idToken<"u","internal-error"),j(typeof f.refreshToken<"u","internal-error");const p="expiresIn"in f&&typeof f.expiresIn<"u"?Number(f.expiresIn):function Bn(y){const f=At(y);return j(f,"internal-error"),j(typeof f.exp<"u","internal-error"),j(typeof f.iat<"u","internal-error"),Number(f.exp)-Number(f.iat)}(f.idToken);this.updateTokensAndExpiration(f.idToken,f.refreshToken,p)}getToken(f,p=!1){var E=this;return(0,_.Z)(function*(){return j(!E.accessToken||E.refreshToken,f,"user-token-expired"),p||!E.accessToken||E.isExpired?E.refreshToken?(yield E.refresh(f,E.refreshToken),E.accessToken):null:E.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(f,p){var E=this;return(0,_.Z)(function*(){const{accessToken:C,refreshToken:M,expiresIn:Q}=yield function Ce(y,f){return at.apply(this,arguments)}(f,p);E.updateTokensAndExpiration(C,M,Number(Q))})()}updateTokensAndExpiration(f,p,E){this.refreshToken=p||null,this.accessToken=f||null,this.expirationTime=Date.now()+1e3*E}static fromJSON(f,p){const{refreshToken:E,accessToken:C,expirationTime:M}=p,Q=new Dt;return E&&(j("string"==typeof E,"internal-error",{appName:f}),Q.refreshToken=E),C&&(j("string"==typeof C,"internal-error",{appName:f}),Q.accessToken=C),M&&(j("number"==typeof M,"internal-error",{appName:f}),Q.expirationTime=M),Q}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(f){this.accessToken=f.accessToken,this.refreshToken=f.refreshToken,this.expirationTime=f.expirationTime}_clone(){return Object.assign(new Dt,this.toJSON())}_performRefresh(){return we("not implemented")}}function Lt(y,f){j("string"==typeof y||typeof y>"u","internal-error",{appName:f})}class Bt{constructor(f){var{uid:p,auth:E,stsTokenManager:C}=f,M=(0,ne._T)(f,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new er(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=p,this.auth=E,this.stsTokenManager=C,this.accessToken=C.accessToken,this.displayName=M.displayName||null,this.email=M.email||null,this.emailVerified=M.emailVerified||!1,this.phoneNumber=M.phoneNumber||null,this.photoURL=M.photoURL||null,this.isAnonymous=M.isAnonymous||!1,this.tenantId=M.tenantId||null,this.providerData=M.providerData?[...M.providerData]:[],this.metadata=new Wi(M.createdAt||void 0,M.lastLoginAt||void 0)}getIdToken(f){var p=this;return(0,_.Z)(function*(){const E=yield tn(p,p.stsTokenManager.getToken(p.auth,f));return j(E,p.auth,"internal-error"),p.accessToken!==E&&(p.accessToken=E,yield p.auth._persistUserIfCurrent(p),p.auth._notifyListenersIfCurrent(p)),E})()}getIdTokenResult(f){return function Ni(y){return Rt.apply(this,arguments)}(this,f)}reload(){return function Yt(y){return yr.apply(this,arguments)}(this)}_assign(f){this!==f&&(j(this.uid===f.uid,this.auth,"internal-error"),this.displayName=f.displayName,this.photoURL=f.photoURL,this.email=f.email,this.emailVerified=f.emailVerified,this.phoneNumber=f.phoneNumber,this.isAnonymous=f.isAnonymous,this.tenantId=f.tenantId,this.providerData=f.providerData.map(p=>Object.assign({},p)),this.metadata._copy(f.metadata),this.stsTokenManager._assign(f.stsTokenManager))}_clone(f){const p=new Bt(Object.assign(Object.assign({},this),{auth:f,stsTokenManager:this.stsTokenManager._clone()}));return p.metadata._copy(this.metadata),p}_onReload(f){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=f,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(f){this.reloadListener?this.reloadListener(f):this.reloadUserInfo=f}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(f,p=!1){var E=this;return(0,_.Z)(function*(){let C=!1;f.idToken&&f.idToken!==E.stsTokenManager.accessToken&&(E.stsTokenManager.updateFromServerResponse(f),C=!0),p&&(yield ln(E)),yield E.auth._persistUserIfCurrent(E),C&&E.auth._notifyListenersIfCurrent(E)})()}delete(){var f=this;return(0,_.Z)(function*(){const p=yield f.getIdToken();return yield tn(f,function ii(y,f){return Tn.apply(this,arguments)}(f.auth,{idToken:p})),f.stsTokenManager.clearRefreshToken(),f.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(f=>Object.assign({},f)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(f,p){var E,C,M,Q,fe,Ke,ut,Ot;const Nt=null!==(E=p.displayName)&&void 0!==E?E:void 0,Yn=null!==(C=p.email)&&void 0!==C?C:void 0,ns=null!==(M=p.phoneNumber)&&void 0!==M?M:void 0,mu=null!==(Q=p.photoURL)&&void 0!==Q?Q:void 0,Uh=null!==(fe=p.tenantId)&&void 0!==fe?fe:void 0,mc=null!==(Ke=p._redirectEventId)&&void 0!==Ke?Ke:void 0,_u=null!==(ut=p.createdAt)&&void 0!==ut?ut:void 0,Ls=null!==(Ot=p.lastLoginAt)&&void 0!==Ot?Ot:void 0,{uid:_s,emailVerified:Vh,isAnonymous:Bh,providerData:yu,stsTokenManager:Xp}=p;j(_s&&Xp,f,"internal-error");const ay=Dt.fromJSON(this.name,Xp);j("string"==typeof _s,f,"internal-error"),Lt(Nt,f.name),Lt(Yn,f.name),j("boolean"==typeof Vh,f,"internal-error"),j("boolean"==typeof Bh,f,"internal-error"),Lt(ns,f.name),Lt(mu,f.name),Lt(Uh,f.name),Lt(mc,f.name),Lt(_u,f.name),Lt(Ls,f.name);const jh=new Bt({uid:_s,auth:f,email:Yn,emailVerified:Vh,displayName:Nt,isAnonymous:Bh,photoURL:mu,phoneNumber:ns,tenantId:Uh,stsTokenManager:ay,createdAt:_u,lastLoginAt:Ls});return yu&&Array.isArray(yu)&&(jh.providerData=yu.map(Fl=>Object.assign({},Fl))),mc&&(jh._redirectEventId=mc),jh}static _fromIdTokenResponse(f,p,E=!1){return(0,_.Z)(function*(){const C=new Dt;C.updateFromServerResponse(p);const M=new Bt({uid:p.localId,auth:f,stsTokenManager:C,isAnonymous:E});return yield ln(M),M})()}}const H=(()=>{class y{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,_.Z)(function*(){return!0})()}_set(p,E){var C=this;return(0,_.Z)(function*(){C.storage[p]=E})()}_get(p){var E=this;return(0,_.Z)(function*(){const C=E.storage[p];return void 0===C?null:C})()}_remove(p){var E=this;return(0,_.Z)(function*(){delete E.storage[p]})()}_addListener(p,E){}_removeListener(p,E){}}return y.type="NONE",y})();function A(y,f,p){return`firebase:${y}:${f}:${p}`}class L{constructor(f,p,E){this.persistence=f,this.auth=p,this.userKey=E;const{config:C,name:M}=this.auth;this.fullUserKey=A(this.userKey,C.apiKey,M),this.fullPersistenceKey=A("persistence",C.apiKey,M),this.boundEventHandler=p._onStorageEvent.bind(p),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(f){return this.persistence._set(this.fullUserKey,f.toJSON())}getCurrentUser(){var f=this;return(0,_.Z)(function*(){const p=yield f.persistence._get(f.fullUserKey);return p?Bt._fromJSON(f.auth,p):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(f){var p=this;return(0,_.Z)(function*(){if(p.persistence===f)return;const E=yield p.getCurrentUser();return yield p.removeCurrentUser(),p.persistence=f,E?p.setCurrentUser(E):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(f,p,E="authUser"){return(0,_.Z)(function*(){if(!p.length)return new L(gt(H),f,E);const C=(yield Promise.all(p.map(function(){var ut=(0,_.Z)(function*(Ot){if(yield Ot._isAvailable())return Ot});return function(Ot){return ut.apply(this,arguments)}}()))).filter(ut=>ut);let M=C[0]||gt(H);const Q=A(E,f.config.apiKey,f.name);let fe=null;for(const ut of p)try{const Ot=yield ut._get(Q);if(Ot){const Nt=Bt._fromJSON(f,Ot);ut!==M&&(fe=Nt),M=ut;break}}catch{}const Ke=C.filter(ut=>ut._shouldAllowMigration);return M._shouldAllowMigration&&Ke.length?(M=Ke[0],fe&&(yield M._set(Q,fe.toJSON())),yield Promise.all(p.map(function(){var ut=(0,_.Z)(function*(Ot){if(Ot!==M)try{yield Ot._remove(Q)}catch{}});return function(Ot){return ut.apply(this,arguments)}}())),new L(M,f,E)):new L(M,f,E)})()}}function q(y){const f=y.toLowerCase();if(f.includes("opera/")||f.includes("opr/")||f.includes("opios/"))return"Opera";if(lt(f))return"IEMobile";if(f.includes("msie")||f.includes("trident/"))return"IE";if(f.includes("edge/"))return"Edge";if(B(f))return"Firefox";if(f.includes("silk/"))return"Silk";if(kt(f))return"Blackberry";if(nn(f))return"Webos";if(le(f))return"Safari";if((f.includes("chrome/")||Te(f))&&!f.includes("edge/"))return"Chrome";if(Pt(f))return"Android";{const E=y.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===E?.length)return E[1]}return"Other"}function B(y=(0,V.z$)()){return/firefox\//i.test(y)}function le(y=(0,V.z$)()){const f=y.toLowerCase();return f.includes("safari/")&&!f.includes("chrome/")&&!f.includes("crios/")&&!f.includes("android")}function Te(y=(0,V.z$)()){return/crios\//i.test(y)}function lt(y=(0,V.z$)()){return/iemobile/i.test(y)}function Pt(y=(0,V.z$)()){return/android/i.test(y)}function kt(y=(0,V.z$)()){return/blackberry/i.test(y)}function nn(y=(0,V.z$)()){return/webos/i.test(y)}function bt(y=(0,V.z$)()){return/iphone|ipad|ipod/i.test(y)||/macintosh/i.test(y)&&/mobile/i.test(y)}function Yo(y=(0,V.z$)()){return bt(y)||Pt(y)||nn(y)||kt(y)||/windows phone/i.test(y)||lt(y)}function go(y,f=[]){let p;switch(y){case"Browser":p=q((0,V.z$)());break;case"Worker":p=`${q((0,V.z$)())}-${y}`;break;default:p=y}const E=f.length?f.join(","):"FirebaseCore-web";return`${p}/JsCore/${te.SDK_VERSION}/${E}`}class mo{constructor(f){this.auth=f,this.queue=[]}pushCallback(f,p){const E=M=>new Promise((Q,fe)=>{try{Q(f(M))}catch(Ke){fe(Ke)}});E.onAbort=p,this.queue.push(E);const C=this.queue.length-1;return()=>{this.queue[C]=()=>Promise.resolve()}}runMiddleware(f){var p=this;return(0,_.Z)(function*(){if(p.auth.currentUser===f)return;const E=[];try{for(const C of p.queue)yield C(f),C.onAbort&&E.push(C.onAbort)}catch(C){E.reverse();for(const M of E)try{M()}catch{}throw p.auth._errorFactory.create("login-blocked",{originalMessage:C?.message})}})()}}class Xo{constructor(f,p,E){this.app=f,this.heartbeatServiceProvider=p,this.config=E,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ye(this),this.idTokenSubscription=new ye(this),this.beforeStateQueue=new mo(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pe,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=f.name,this.clientVersion=E.sdkClientVersion}_initializeWithPersistence(f,p){var E=this;return p&&(this._popupRedirectResolver=gt(p)),this._initializationPromise=this.queue((0,_.Z)(function*(){var C,M;if(!E._deleted&&(E.persistenceManager=yield L.create(E,f),!E._deleted)){if(null!==(C=E._popupRedirectResolver)&&void 0!==C&&C._shouldInitProactively)try{yield E._popupRedirectResolver._initialize(E)}catch{}yield E.initializeCurrentUser(p),E.lastNotifiedUid=(null===(M=E.currentUser)||void 0===M?void 0:M.uid)||null,!E._deleted&&(E._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var f=this;return(0,_.Z)(function*(){if(f._deleted)return;const p=yield f.assertedPersistence.getCurrentUser();if(f.currentUser||p){if(f.currentUser&&p&&f.currentUser.uid===p.uid)return f._currentUser._assign(p),void(yield f.currentUser.getIdToken());yield f._updateCurrentUser(p,!0)}})()}initializeCurrentUser(f){var p=this;return(0,_.Z)(function*(){var E;const C=yield p.assertedPersistence.getCurrentUser();let M=C,Q=!1;if(f&&p.config.authDomain){yield p.getOrInitRedirectPersistenceManager();const fe=null===(E=p.redirectUser)||void 0===E?void 0:E._redirectEventId,Ke=M?._redirectEventId,ut=yield p.tryRedirectSignIn(f);(!fe||fe===Ke)&&ut?.user&&(M=ut.user,Q=!0)}if(!M)return p.directlySetCurrentUser(null);if(!M._redirectEventId){if(Q)try{yield p.beforeStateQueue.runMiddleware(M)}catch(fe){M=C,p._popupRedirectResolver._overrideRedirectResult(p,()=>Promise.reject(fe))}return M?p.reloadAndSetCurrentUserOrClear(M):p.directlySetCurrentUser(null)}return j(p._popupRedirectResolver,p,"argument-error"),yield p.getOrInitRedirectPersistenceManager(),p.redirectUser&&p.redirectUser._redirectEventId===M._redirectEventId?p.directlySetCurrentUser(M):p.reloadAndSetCurrentUserOrClear(M)})()}tryRedirectSignIn(f){var p=this;return(0,_.Z)(function*(){let E=null;try{E=yield p._popupRedirectResolver._completeRedirectFn(p,f,!0)}catch{yield p._setRedirectUser(null)}return E})()}reloadAndSetCurrentUserOrClear(f){var p=this;return(0,_.Z)(function*(){try{yield ln(f)}catch(E){if("auth/network-request-failed"!==E?.code)return p.directlySetCurrentUser(null)}return p.directlySetCurrentUser(f)})()}useDeviceLanguage(){this.languageCode=function $e(){if(typeof navigator>"u")return null;const y=navigator;return y.languages&&y.languages[0]||y.language||null}()}_delete(){var f=this;return(0,_.Z)(function*(){f._deleted=!0})()}updateCurrentUser(f){var p=this;return(0,_.Z)(function*(){const E=f?(0,V.m9)(f):null;return E&&j(E.auth.config.apiKey===p.config.apiKey,p,"invalid-user-token"),p._updateCurrentUser(E&&E._clone(p))})()}_updateCurrentUser(f,p=!1){var E=this;return(0,_.Z)(function*(){if(!E._deleted)return f&&j(E.tenantId===f.tenantId,E,"tenant-id-mismatch"),p||(yield E.beforeStateQueue.runMiddleware(f)),E.queue((0,_.Z)(function*(){yield E.directlySetCurrentUser(f),E.notifyAuthListeners()}))})()}signOut(){var f=this;return(0,_.Z)(function*(){return yield f.beforeStateQueue.runMiddleware(null),(f.redirectPersistenceManager||f._popupRedirectResolver)&&(yield f._setRedirectUser(null)),f._updateCurrentUser(null,!0)})()}setPersistence(f){var p=this;return this.queue((0,_.Z)(function*(){yield p.assertedPersistence.setPersistence(gt(f))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(f){this._errorFactory=new V.LL("auth","Firebase",f())}onAuthStateChanged(f,p,E){return this.registerStateListener(this.authStateSubscription,f,p,E)}beforeAuthStateChanged(f,p){return this.beforeStateQueue.pushCallback(f,p)}onIdTokenChanged(f,p,E){return this.registerStateListener(this.idTokenSubscription,f,p,E)}toJSON(){var f;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(f=this._currentUser)||void 0===f?void 0:f.toJSON()}}_setRedirectUser(f,p){var E=this;return(0,_.Z)(function*(){const C=yield E.getOrInitRedirectPersistenceManager(p);return null===f?C.removeCurrentUser():C.setCurrentUser(f)})()}getOrInitRedirectPersistenceManager(f){var p=this;return(0,_.Z)(function*(){if(!p.redirectPersistenceManager){const E=f&&gt(f)||p._popupRedirectResolver;j(E,p,"argument-error"),p.redirectPersistenceManager=yield L.create(p,[gt(E._redirectPersistence)],"redirectUser"),p.redirectUser=yield p.redirectPersistenceManager.getCurrentUser()}return p.redirectPersistenceManager})()}_redirectUserForId(f){var p=this;return(0,_.Z)(function*(){var E,C;return p._isInitialized&&(yield p.queue((0,_.Z)(function*(){}))),(null===(E=p._currentUser)||void 0===E?void 0:E._redirectEventId)===f?p._currentUser:(null===(C=p.redirectUser)||void 0===C?void 0:C._redirectEventId)===f?p.redirectUser:null})()}_persistUserIfCurrent(f){var p=this;return(0,_.Z)(function*(){if(f===p.currentUser)return p.queue((0,_.Z)(function*(){return p.directlySetCurrentUser(f)}))})()}_notifyListenersIfCurrent(f){f===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var f,p;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const E=null!==(p=null===(f=this.currentUser)||void 0===f?void 0:f.uid)&&void 0!==p?p:null;this.lastNotifiedUid!==E&&(this.lastNotifiedUid=E,this.authStateSubscription.next(this.currentUser))}registerStateListener(f,p,E,C){if(this._deleted)return()=>{};const M="function"==typeof p?p:p.next.bind(p),Q=this._isInitialized?Promise.resolve():this._initializationPromise;return j(Q,this,"internal-error"),Q.then(()=>M(this.currentUser)),"function"==typeof p?f.addObserver(p,E,C):f.addObserver(p)}directlySetCurrentUser(f){var p=this;return(0,_.Z)(function*(){p.currentUser&&p.currentUser!==f&&p._currentUser._stopProactiveRefresh(),f&&p.isProactiveRefreshEnabled&&f._startProactiveRefresh(),p.currentUser=f,f?yield p.assertedPersistence.setCurrentUser(f):yield p.assertedPersistence.removeCurrentUser()})()}queue(f){return this.operations=this.operations.then(f,f),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(f){!f||this.frameworks.includes(f)||(this.frameworks.push(f),this.frameworks.sort(),this.clientVersion=go(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var f=this;return(0,_.Z)(function*(){var p;const E={"X-Client-Version":f.clientVersion};f.app.options.appId&&(E["X-Firebase-gmpid"]=f.app.options.appId);const C=yield null===(p=f.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===p?void 0:p.getHeartbeatsHeader();return C&&(E["X-Firebase-Client"]=C),E})()}}function Z(y){return(0,V.m9)(y)}class ye{constructor(f){this.auth=f,this.observer=null,this.addObserver=(0,V.ne)(p=>this.observer=p)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function qe(y){const f=y.indexOf(":");return f<0?"":y.substr(0,f+1)}function $t(y){if(!y)return null;const f=Number(y);return isNaN(f)?null:f}class fn{constructor(f,p){this.providerId=f,this.signInMethod=p}toJSON(){return we("not implemented")}_getIdTokenResponse(f){return we("not implemented")}_linkToIdToken(f,p){return we("not implemented")}_getReauthenticationResolver(f){return we("not implemented")}}function qi(y,f){return kr.apply(this,arguments)}function kr(){return(kr=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:resetPassword",Qe(y,f))})).apply(this,arguments)}function cs(y,f){return pi.apply(this,arguments)}function pi(){return(pi=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function Ht(){return(Ht=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:update",Qe(y,f))})).apply(this,arguments)}function Jr(){return(Jr=(0,_.Z)(function*(y,f){return hn(y,"POST","/v1/accounts:signInWithPassword",Qe(y,f))})).apply(this,arguments)}function Pi(y,f){return tr.apply(this,arguments)}function tr(){return(tr=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:sendOobCode",Qe(y,f))})).apply(this,arguments)}function Fn(){return(Fn=(0,_.Z)(function*(y,f){return Pi(y,f)})).apply(this,arguments)}function Ss(){return(Ss=(0,_.Z)(function*(y,f){return Pi(y,f)})).apply(this,arguments)}function ls(){return(ls=(0,_.Z)(function*(y,f){return Pi(y,f)})).apply(this,arguments)}function _o(){return(_o=(0,_.Z)(function*(y,f){return Pi(y,f)})).apply(this,arguments)}function br(){return(br=(0,_.Z)(function*(y,f){return hn(y,"POST","/v1/accounts:signInWithEmailLink",Qe(y,f))})).apply(this,arguments)}function Rs(){return(Rs=(0,_.Z)(function*(y,f){return hn(y,"POST","/v1/accounts:signInWithEmailLink",Qe(y,f))})).apply(this,arguments)}class ei extends fn{constructor(f,p,E,C=null){super("password",E),this._email=f,this._password=p,this._tenantId=C}static _fromEmailAndPassword(f,p){return new ei(f,p,"password")}static _fromEmailAndCode(f,p,E=null){return new ei(f,p,"emailLink",E)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(f){const p="string"==typeof f?JSON.parse(f):f;if(p?.email&&p?.password){if("password"===p.signInMethod)return this._fromEmailAndPassword(p.email,p.password);if("emailLink"===p.signInMethod)return this._fromEmailAndCode(p.email,p.password,p.tenantId)}return null}_getIdTokenResponse(f){var p=this;return(0,_.Z)(function*(){switch(p.signInMethod){case"password":return function Ln(y,f){return Jr.apply(this,arguments)}(f,{returnSecureToken:!0,email:p._email,password:p._password});case"emailLink":return function yo(y,f){return br.apply(this,arguments)}(f,{email:p._email,oobCode:p._password});default:Ae(f,"internal-error")}})()}_linkToIdToken(f,p){var E=this;return(0,_.Z)(function*(){switch(E.signInMethod){case"password":return cs(f,{idToken:p,returnSecureToken:!0,email:E._email,password:E._password});case"emailLink":return function As(y,f){return Rs.apply(this,arguments)}(f,{idToken:p,email:E._email,oobCode:E._password});default:Ae(f,"internal-error")}})()}_getReauthenticationResolver(f){return this._getIdTokenResponse(f)}}function gi(y,f){return Lu.apply(this,arguments)}function Lu(){return(Lu=(0,_.Z)(function*(y,f){return hn(y,"POST","/v1/accounts:signInWithIdp",Qe(y,f))})).apply(this,arguments)}class Ki extends fn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(f){const p=new Ki(f.providerId,f.signInMethod);return f.idToken||f.accessToken?(f.idToken&&(p.idToken=f.idToken),f.accessToken&&(p.accessToken=f.accessToken),f.nonce&&!f.pendingToken&&(p.nonce=f.nonce),f.pendingToken&&(p.pendingToken=f.pendingToken)):f.oauthToken&&f.oauthTokenSecret?(p.accessToken=f.oauthToken,p.secret=f.oauthTokenSecret):Ae("argument-error"),p}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(f){const p="string"==typeof f?JSON.parse(f):f,{providerId:E,signInMethod:C}=p,M=(0,ne._T)(p,["providerId","signInMethod"]);if(!E||!C)return null;const Q=new Ki(E,C);return Q.idToken=M.idToken||void 0,Q.accessToken=M.accessToken||void 0,Q.secret=M.secret,Q.nonce=M.nonce,Q.pendingToken=M.pendingToken||null,Q}_getIdTokenResponse(f){return gi(f,this.buildRequest())}_linkToIdToken(f,p){const E=this.buildRequest();return E.idToken=p,gi(f,E)}_getReauthenticationResolver(f){const p=this.buildRequest();return p.autoCreate=!1,gi(f,p)}buildRequest(){const f={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)f.pendingToken=this.pendingToken;else{const p={};this.idToken&&(p.id_token=this.idToken),this.accessToken&&(p.access_token=this.accessToken),this.secret&&(p.oauth_token_secret=this.secret),p.providerId=this.providerId,this.nonce&&!this.pendingToken&&(p.nonce=this.nonce),f.postBody=(0,V.xO)(p)}return f}}function $a(){return($a=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:sendVerificationCode",Qe(y,f))})).apply(this,arguments)}function wo(){return(wo=(0,_.Z)(function*(y,f){return hn(y,"POST","/v1/accounts:signInWithPhoneNumber",Qe(y,f))})).apply(this,arguments)}function Or(){return(Or=(0,_.Z)(function*(y,f){const p=yield hn(y,"POST","/v1/accounts:signInWithPhoneNumber",Qe(y,f));if(p.temporaryProof)throw Kn(y,"account-exists-with-different-credential",p);return p})).apply(this,arguments)}const Kc={USER_NOT_FOUND:"user-not-found"};function _i(){return(_i=(0,_.Z)(function*(y,f){return hn(y,"POST","/v1/accounts:signInWithPhoneNumber",Qe(y,Object.assign(Object.assign({},f),{operation:"REAUTH"})),Kc)})).apply(this,arguments)}class ds extends fn{constructor(f){super("phone","phone"),this.params=f}static _fromVerification(f,p){return new ds({verificationId:f,verificationCode:p})}static _fromTokenResponse(f,p){return new ds({phoneNumber:f,temporaryProof:p})}_getIdTokenResponse(f){return function vo(y,f){return wo.apply(this,arguments)}(f,this._makeVerificationRequest())}_linkToIdToken(f,p){return function ta(y,f){return Or.apply(this,arguments)}(f,Object.assign({idToken:p},this._makeVerificationRequest()))}_getReauthenticationResolver(f){return function mi(y,f){return _i.apply(this,arguments)}(f,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:f,phoneNumber:p,verificationId:E,verificationCode:C}=this.params;return f&&p?{temporaryProof:f,phoneNumber:p}:{sessionInfo:E,code:C}}toJSON(){const f={providerId:this.providerId};return this.params.phoneNumber&&(f.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(f.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(f.verificationCode=this.params.verificationCode),this.params.verificationId&&(f.verificationId=this.params.verificationId),f}static fromJSON(f){"string"==typeof f&&(f=JSON.parse(f));const{verificationId:p,verificationCode:E,phoneNumber:C,temporaryProof:M}=f;return E||p||C||M?new ds({verificationId:p,verificationCode:E,phoneNumber:C,temporaryProof:M}):null}}class Hr{constructor(f){var p,E,C,M,Q,fe;const Ke=(0,V.zd)((0,V.pd)(f)),ut=null!==(p=Ke.apiKey)&&void 0!==p?p:null,Ot=null!==(E=Ke.oobCode)&&void 0!==E?E:null,Nt=function na(y){switch(y){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(C=Ke.mode)&&void 0!==C?C:null);j(ut&&Ot&&Nt,"argument-error"),this.apiKey=ut,this.operation=Nt,this.code=Ot,this.continueUrl=null!==(M=Ke.continueUrl)&&void 0!==M?M:null,this.languageCode=null!==(Q=Ke.languageCode)&&void 0!==Q?Q:null,this.tenantId=null!==(fe=Ke.tenantId)&&void 0!==fe?fe:null}static parseLink(f){const p=function Ha(y){const f=(0,V.zd)((0,V.pd)(y)).link,p=f?(0,V.zd)((0,V.pd)(f)).deep_link_id:null,E=(0,V.zd)((0,V.pd)(y)).deep_link_id;return(E?(0,V.zd)((0,V.pd)(E)).link:null)||E||p||f||y}(f);try{return new Hr(p)}catch{return null}}}let Zc=(()=>{class y{constructor(){this.providerId=y.PROVIDER_ID}static credential(p,E){return ei._fromEmailAndPassword(p,E)}static credentialWithLink(p,E){const C=Hr.parseLink(E);return j(C,"argument-error"),ei._fromEmailAndCode(p,C.code,C.tenantId)}}return y.PROVIDER_ID="password",y.EMAIL_PASSWORD_SIGN_IN_METHOD="password",y.EMAIL_LINK_SIGN_IN_METHOD="emailLink",y})();class xs{constructor(f){this.providerId=f,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(f){this.defaultLanguageCode=f}setCustomParameters(f){return this.customParameters=f,this}getCustomParameters(){return this.customParameters}}class Eo extends xs{constructor(){super(...arguments),this.scopes=[]}addScope(f){return this.scopes.includes(f)||this.scopes.push(f),this}getScopes(){return[...this.scopes]}}class ra extends Eo{static credentialFromJSON(f){const p="string"==typeof f?JSON.parse(f):f;return j("providerId"in p&&"signInMethod"in p,"argument-error"),Ki._fromParams(p)}credential(f){return this._credential(Object.assign(Object.assign({},f),{nonce:f.rawNonce}))}_credential(f){return j(f.idToken||f.accessToken,"argument-error"),Ki._fromParams(Object.assign(Object.assign({},f),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(f){return ra.oauthCredentialFromTaggedObject(f)}static credentialFromError(f){return ra.oauthCredentialFromTaggedObject(f.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{oauthIdToken:p,oauthAccessToken:E,oauthTokenSecret:C,pendingToken:M,nonce:Q,providerId:fe}=f;if(!E&&!C&&!p&&!M||!fe)return null;try{return new ra(fe)._credential({idToken:p,accessToken:E,nonce:Q,pendingToken:M})}catch{return null}}}let Fu=(()=>{class y extends Eo{constructor(){super("facebook.com")}static credential(p){return Ki._fromParams({providerId:y.PROVIDER_ID,signInMethod:y.FACEBOOK_SIGN_IN_METHOD,accessToken:p})}static credentialFromResult(p){return y.credentialFromTaggedObject(p)}static credentialFromError(p){return y.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p||!("oauthAccessToken"in p)||!p.oauthAccessToken)return null;try{return y.credential(p.oauthAccessToken)}catch{return null}}}return y.FACEBOOK_SIGN_IN_METHOD="facebook.com",y.PROVIDER_ID="facebook.com",y})(),zd=(()=>{class y extends Eo{constructor(){super("google.com"),this.addScope("profile")}static credential(p,E){return Ki._fromParams({providerId:y.PROVIDER_ID,signInMethod:y.GOOGLE_SIGN_IN_METHOD,idToken:p,accessToken:E})}static credentialFromResult(p){return y.credentialFromTaggedObject(p)}static credentialFromError(p){return y.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthIdToken:E,oauthAccessToken:C}=p;if(!E&&!C)return null;try{return y.credential(E,C)}catch{return null}}}return y.GOOGLE_SIGN_IN_METHOD="google.com",y.PROVIDER_ID="google.com",y})(),Wd=(()=>{class y extends Eo{constructor(){super("github.com")}static credential(p){return Ki._fromParams({providerId:y.PROVIDER_ID,signInMethod:y.GITHUB_SIGN_IN_METHOD,accessToken:p})}static credentialFromResult(p){return y.credentialFromTaggedObject(p)}static credentialFromError(p){return y.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p||!("oauthAccessToken"in p)||!p.oauthAccessToken)return null;try{return y.credential(p.oauthAccessToken)}catch{return null}}}return y.GITHUB_SIGN_IN_METHOD="github.com",y.PROVIDER_ID="github.com",y})();class hs extends fn{constructor(f,p){super(f,f),this.pendingToken=p}_getIdTokenResponse(f){return gi(f,this.buildRequest())}_linkToIdToken(f,p){const E=this.buildRequest();return E.idToken=p,gi(f,E)}_getReauthenticationResolver(f){const p=this.buildRequest();return p.autoCreate=!1,gi(f,p)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(f){const p="string"==typeof f?JSON.parse(f):f,{providerId:E,signInMethod:C,pendingToken:M}=p;return E&&C&&M&&E===C?new hs(E,M):null}static _create(f,p){return new hs(f,p)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class za extends xs{constructor(f){j(f.startsWith("saml."),"argument-error"),super(f)}static credentialFromResult(f){return za.samlCredentialFromTaggedObject(f)}static credentialFromError(f){return za.samlCredentialFromTaggedObject(f.customData||{})}static credentialFromJSON(f){const p=hs.fromJSON(f);return j(p,"argument-error"),p}static samlCredentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{pendingToken:p,providerId:E}=f;if(!p||!E)return null;try{return hs._create(E,p)}catch{return null}}}let Qc=(()=>{class y extends Eo{constructor(){super("twitter.com")}static credential(p,E){return Ki._fromParams({providerId:y.PROVIDER_ID,signInMethod:y.TWITTER_SIGN_IN_METHOD,oauthToken:p,oauthTokenSecret:E})}static credentialFromResult(p){return y.credentialFromTaggedObject(p)}static credentialFromError(p){return y.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthAccessToken:E,oauthTokenSecret:C}=p;if(!E||!C)return null;try{return y.credential(E,C)}catch{return null}}}return y.TWITTER_SIGN_IN_METHOD="twitter.com",y.PROVIDER_ID="twitter.com",y})();function Uu(y,f){return ia.apply(this,arguments)}function ia(){return(ia=(0,_.Z)(function*(y,f){return hn(y,"POST","/v1/accounts:signUp",Qe(y,f))})).apply(this,arguments)}class Zi{constructor(f){this.user=f.user,this.providerId=f.providerId,this._tokenResponse=f._tokenResponse,this.operationType=f.operationType}static _fromIdTokenResponse(f,p,E,C=!1){return(0,_.Z)(function*(){const M=yield Bt._fromIdTokenResponse(f,E,C),Q=Xc(E);return new Zi({user:M,providerId:Q,_tokenResponse:E,operationType:p})})()}static _forOperation(f,p,E){return(0,_.Z)(function*(){yield f._updateTokensIfNecessary(E,!0);const C=Xc(E);return new Zi({user:f,providerId:C,_tokenResponse:E,operationType:p})})()}}function Xc(y){return y.providerId?y.providerId:"phoneNumber"in y?"phone":null}function el(){return(el=(0,_.Z)(function*(y){var f;const p=Z(y);if(yield p._initializationPromise,null!==(f=p.currentUser)&&void 0!==f&&f.isAnonymous)return new Zi({user:p.currentUser,providerId:null,operationType:"signIn"});const E=yield Uu(p,{returnSecureToken:!0}),C=yield Zi._fromIdTokenResponse(p,"signIn",E,!0);return yield p._updateCurrentUser(C.user),C})).apply(this,arguments)}class sa extends V.ZR{constructor(f,p,E,C){var M;super(p.code,p.message),this.operationType=E,this.user=C,Object.setPrototypeOf(this,sa.prototype),this.customData={appName:f.name,tenantId:null!==(M=f.tenantId)&&void 0!==M?M:void 0,_serverResponse:p.customData._serverResponse,operationType:E}}static _fromErrorAndOperation(f,p,E,C){return new sa(f,p,E,C)}}function oa(y,f,p,E){return("reauthenticate"===f?p._getReauthenticationResolver(y):p._getIdTokenResponse(y)).catch(M=>{throw"auth/multi-factor-auth-required"===M.code?sa._fromErrorAndOperation(y,M,f,E):M})}function Ms(y){return new Set(y.map(({providerId:f})=>f).filter(f=>!!f))}function aa(){return aa=(0,_.Z)(function*(y,f){const p=(0,V.m9)(y);yield Qi(!0,p,f);const{providerUserInfo:E}=yield function On(y,f){return _t.apply(this,arguments)}(p.auth,{idToken:yield p.getIdToken(),deleteProvider:[f]}),C=Ms(E||[]);return p.providerData=p.providerData.filter(M=>C.has(M.providerId)),C.has("phone")||(p.phoneNumber=null),yield p.auth._persistUserIfCurrent(p),p}),aa.apply(this,arguments)}function Yi(y,f){return Wa.apply(this,arguments)}function Wa(){return(Wa=(0,_.Z)(function*(y,f,p=!1){const E=yield tn(y,f._linkToIdToken(y.auth,yield y.getIdToken()),p);return Zi._forOperation(y,"link",E)})).apply(this,arguments)}function Qi(y,f,p){return Vu.apply(this,arguments)}function Vu(){return(Vu=(0,_.Z)(function*(y,f,p){yield ln(f);const C=!1===y?"provider-already-linked":"no-such-provider";j(Ms(f.providerData).has(p)===y,f.auth,C)})).apply(this,arguments)}function tl(y,f){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,_.Z)(function*(y,f,p=!1){const{auth:E}=y,C="reauthenticate";try{const M=yield tn(y,oa(E,C,f,y),p);j(M.idToken,E,"internal-error");const Q=At(M.idToken);j(Q,E,"internal-error");const{sub:fe}=Q;return j(y.uid===fe,E,"user-mismatch"),Zi._forOperation(y,C,M)}catch(M){throw"auth/user-not-found"===M?.code&&Ae(E,"user-mismatch"),M}})).apply(this,arguments)}function Io(y,f){return nl.apply(this,arguments)}function nl(){return(nl=(0,_.Z)(function*(y,f,p=!1){const E="signIn",C=yield oa(y,E,f),M=yield Zi._fromIdTokenResponse(y,E,C);return p||(yield y._updateCurrentUser(M.user)),M})).apply(this,arguments)}function ti(y,f){return O.apply(this,arguments)}function O(){return(O=(0,_.Z)(function*(y,f){return Io(Z(y),f)})).apply(this,arguments)}function k(y,f){return z.apply(this,arguments)}function z(){return(z=(0,_.Z)(function*(y,f){const p=(0,V.m9)(y);return yield Qi(!1,p,f.providerId),Yi(p,f)})).apply(this,arguments)}function oe(y,f){return Oe.apply(this,arguments)}function Oe(){return(Oe=(0,_.Z)(function*(y,f){return tl((0,V.m9)(y),f)})).apply(this,arguments)}function xt(){return(xt=(0,_.Z)(function*(y,f){return hn(y,"POST","/v1/accounts:signInWithCustomToken",Qe(y,f))})).apply(this,arguments)}function Cn(){return Cn=(0,_.Z)(function*(y,f){const p=Z(y),E=yield function Be(y,f){return xt.apply(this,arguments)}(p,{token:f,returnSecureToken:!0}),C=yield Zi._fromIdTokenResponse(p,"signIn",E);return yield p._updateCurrentUser(C.user),C}),Cn.apply(this,arguments)}class sn{constructor(f,p){this.factorId=f,this.uid=p.mfaEnrollmentId,this.enrollmentTime=new Date(p.enrolledAt).toUTCString(),this.displayName=p.displayName}static _fromServerResponse(f,p){return"phoneInfo"in p?Rn._fromServerResponse(f,p):Ae(f,"internal-error")}}class Rn extends sn{constructor(f){super("phone",f),this.phoneNumber=f.phoneInfo}static _fromServerResponse(f,p){return new Rn(p)}}function Gt(y,f,p){var E;j((null===(E=p.url)||void 0===E?void 0:E.length)>0,y,"invalid-continue-uri"),j(typeof p.dynamicLinkDomain>"u"||p.dynamicLinkDomain.length>0,y,"invalid-dynamic-link-domain"),f.continueUrl=p.url,f.dynamicLinkDomain=p.dynamicLinkDomain,f.canHandleCodeInApp=p.handleCodeInApp,p.iOS&&(j(p.iOS.bundleId.length>0,y,"missing-ios-bundle-id"),f.iOSBundleId=p.iOS.bundleId),p.android&&(j(p.android.packageName.length>0,y,"missing-android-pkg-name"),f.androidInstallApp=p.android.installApp,f.androidMinimumVersionCode=p.android.minimumVersion,f.androidPackageName=p.android.packageName)}function Cr(){return Cr=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y),C={requestType:"PASSWORD_RESET",email:f};p&&Gt(E,C,p),yield function Jo(y,f){return Ss.apply(this,arguments)}(E,C)}),Cr.apply(this,arguments)}function qs(){return(qs=(0,_.Z)(function*(y,f,p){yield qi((0,V.m9)(y),{oobCode:f,newPassword:p})})).apply(this,arguments)}function oi(){return oi=(0,_.Z)(function*(y,f){yield function ct(y,f){return Ht.apply(this,arguments)}((0,V.m9)(y),{oobCode:f})}),oi.apply(this,arguments)}function Ns(y,f){return qa.apply(this,arguments)}function qa(){return(qa=(0,_.Z)(function*(y,f){const p=(0,V.m9)(y),E=yield qi(p,{oobCode:f}),C=E.requestType;switch(j(C,p,"internal-error"),C){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":j(E.newEmail,p,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":j(E.mfaInfo,p,"internal-error");default:j(E.email,p,"internal-error")}let M=null;return E.mfaInfo&&(M=sn._fromServerResponse(Z(p),E.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===E.requestType?E.newEmail:E.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===E.requestType?E.email:E.newEmail)||null,multiFactorInfo:M},operation:C}})).apply(this,arguments)}function qd(){return(qd=(0,_.Z)(function*(y,f){const{data:p}=yield Ns((0,V.m9)(y),f);return p.email})).apply(this,arguments)}function Kd(){return(Kd=(0,_.Z)(function*(y,f,p){const E=Z(y),C=yield Uu(E,{returnSecureToken:!0,email:f,password:p}),M=yield Zi._fromIdTokenResponse(E,"signIn",C);return yield E._updateCurrentUser(M.user),M})).apply(this,arguments)}function pn(){return pn=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y),C={requestType:"EMAIL_SIGNIN",email:f};j(p.handleCodeInApp,E,"argument-error"),p&&Gt(E,C,p),yield function Kt(y,f){return ls.apply(this,arguments)}(E,C)}),pn.apply(this,arguments)}function Lr(){return(Lr=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y),C=Zc.credentialWithLink(f,p||he());return j(C._tenantId===(E.tenantId||null),E,"tenant-id-mismatch"),ti(E,C)})).apply(this,arguments)}function ca(){return(ca=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:createAuthUri",Qe(y,f))})).apply(this,arguments)}function rl(){return rl=(0,_.Z)(function*(y,f){const E={identifier:f,continueUri:_e()?he():"http://localhost"},{signinMethods:C}=yield function A_(y,f){return ca.apply(this,arguments)}((0,V.m9)(y),E);return C||[]}),rl.apply(this,arguments)}function il(){return il=(0,_.Z)(function*(y,f){const p=(0,V.m9)(y),C={requestType:"VERIFY_EMAIL",idToken:yield y.getIdToken()};f&&Gt(p.auth,C,f);const{email:M}=yield function zs(y,f){return Fn.apply(this,arguments)}(p.auth,C);M!==y.email&&(yield y.reload())}),il.apply(this,arguments)}function sl(){return sl=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y),M={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield y.getIdToken(),newEmail:f};p&&Gt(E.auth,M,p);const{email:Q}=yield function Ws(y,f){return _o.apply(this,arguments)}(E.auth,M);Q!==y.email&&(yield y.reload())}),sl.apply(this,arguments)}function ai(){return(ai=(0,_.Z)(function*(y,f){return wt(y,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function la(){return la=(0,_.Z)(function*(y,{displayName:f,photoURL:p}){if(void 0===f&&void 0===p)return;const E=(0,V.m9)(y),M={idToken:yield E.getIdToken(),displayName:f,photoUrl:p,returnSecureToken:!0},Q=yield tn(E,function Gr(y,f){return ai.apply(this,arguments)}(E.auth,M));E.displayName=Q.displayName||null,E.photoURL=Q.photoUrl||null;const fe=E.providerData.find(({providerId:Ke})=>"password"===Ke);fe&&(fe.displayName=E.displayName,fe.photoURL=E.photoURL),yield E._updateTokensIfNecessary(Q)}),la.apply(this,arguments)}function Tp(y,f,p){return bp.apply(this,arguments)}function bp(){return(bp=(0,_.Z)(function*(y,f,p){const{auth:E}=y,M={idToken:yield y.getIdToken(),returnSecureToken:!0};f&&(M.email=f),p&&(M.password=p);const Q=yield tn(y,cs(E,M));yield y._updateTokensIfNecessary(Q,!0)})).apply(this,arguments)}class Zs{constructor(f,p,E={}){this.isNewUser=f,this.providerId=p,this.profile=E}}class Zd extends Zs{constructor(f,p,E,C){super(f,p,E),this.username=C}}class M_ extends Zs{constructor(f,p){super(f,"facebook.com",p)}}class Cp extends Zd{constructor(f,p){super(f,"github.com",p,"string"==typeof p?.login?p?.login:null)}}class $0 extends Zs{constructor(f,p){super(f,"google.com",p)}}class N_ extends Zd{constructor(f,p,E){super(f,"twitter.com",p,E)}}function Dp(y){const{user:f,_tokenResponse:p}=y;return f.isAnonymous&&!p?{providerId:null,isNewUser:!1,profile:null}:function x_(y){var f,p;if(!y)return null;const{providerId:E}=y,C=y.rawUserInfo?JSON.parse(y.rawUserInfo):{},M=y.isNewUser||"identitytoolkit#SignupNewUserResponse"===y.kind;if(!E&&y?.idToken){const Q=null===(p=null===(f=At(y.idToken))||void 0===f?void 0:f.firebase)||void 0===p?void 0:p.sign_in_provider;if(Q)return new Zs(M,"anonymous"!==Q&&"custom"!==Q?Q:null)}if(!E)return null;switch(E){case"facebook.com":return new M_(M,C);case"github.com":return new Cp(M,C);case"google.com":return new $0(M,C);case"twitter.com":return new N_(M,C,y.screenName||null);case"custom":case"anonymous":return new Zs(M,null);default:return new Zs(M,E,C)}}(p)}class xn{constructor(f,p,E){this.type=f,this.credential=p,this.auth=E}static _fromIdtoken(f,p){return new xn("enroll",f,p)}static _fromMfaPendingCredential(f){return new xn("signin",f)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(f){var p,E;if(f?.multiFactorSession){if(null!==(p=f.multiFactorSession)&&void 0!==p&&p.pendingCredential)return xn._fromMfaPendingCredential(f.multiFactorSession.pendingCredential);if(null!==(E=f.multiFactorSession)&&void 0!==E&&E.idToken)return xn._fromIdtoken(f.multiFactorSession.idToken)}return null}}class Ap{constructor(f,p,E){this.session=f,this.hints=p,this.signInResolver=E}static _fromError(f,p){const E=Z(f),C=p.customData._serverResponse,M=(C.mfaInfo||[]).map(fe=>sn._fromServerResponse(E,fe));j(C.mfaPendingCredential,E,"internal-error");const Q=xn._fromMfaPendingCredential(C.mfaPendingCredential);return new Ap(Q,M,function(){var fe=(0,_.Z)(function*(Ke){const ut=yield Ke._process(E,Q);delete C.mfaInfo,delete C.mfaPendingCredential;const Ot=Object.assign(Object.assign({},C),{idToken:ut.idToken,refreshToken:ut.refreshToken});switch(p.operationType){case"signIn":const Nt=yield Zi._fromIdTokenResponse(E,p.operationType,Ot);return yield E._updateCurrentUser(Nt.user),Nt;case"reauthenticate":return j(p.user,E,"internal-error"),Zi._forOperation(p.user,p.operationType,Ot);default:Ae(E,"internal-error")}});return function(Ke){return fe.apply(this,arguments)}}())}resolveSignIn(f){var p=this;return(0,_.Z)(function*(){return p.signInResolver(f)})()}}class Rp{constructor(f){this.user=f,this.enrolledFactors=[],f._onReload(p=>{p.mfaInfo&&(this.enrolledFactors=p.mfaInfo.map(E=>sn._fromServerResponse(f.auth,E)))})}static _fromUser(f){return new Rp(f)}getSession(){var f=this;return(0,_.Z)(function*(){return xn._fromIdtoken(yield f.user.getIdToken(),f.user.auth)})()}enroll(f,p){var E=this;return(0,_.Z)(function*(){const C=f,M=yield E.getSession(),Q=yield tn(E.user,C._process(E.user.auth,M,p));return yield E.user._updateTokensIfNecessary(Q),E.user.reload()})()}unenroll(f){var p=this;return(0,_.Z)(function*(){const E="string"==typeof f?f:f.uid,C=yield p.user.getIdToken();try{const M=yield tn(p.user,function Z0(y,f){return wt(y,"POST","/v2/accounts/mfaEnrollment:withdraw",Qe(y,f))}(p.user.auth,{idToken:C,mfaEnrollmentId:E}));p.enrolledFactors=p.enrolledFactors.filter(({uid:Q})=>Q!==E),yield p.user._updateTokensIfNecessary(M),yield p.user.reload()}catch(M){throw M}})()}}const ju=new WeakMap,da="__sak";class Ka{constructor(f,p){this.storageRetriever=f,this.type=p}_isAvailable(){try{return this.storage?(this.storage.setItem(da,"1"),this.storage.removeItem(da),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(f,p){return this.storage.setItem(f,JSON.stringify(p)),Promise.resolve()}_get(f){const p=this.storage.getItem(f);return Promise.resolve(p?JSON.parse(p):null)}_remove(f){return this.storage.removeItem(f),Promise.resolve()}get storage(){return this.storageRetriever()}}const $u=(()=>{class y extends Ka{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(p,E)=>this.onStorageEvent(p,E),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Za(){const y=(0,V.z$)();return le(y)||bt(y)}()&&function Qo(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Yo(),this._shouldAllowMigration=!0}forAllChangedKeys(p){for(const E of Object.keys(this.listeners)){const C=this.storage.getItem(E),M=this.localCache[E];C!==M&&p(E,M,C)}}onStorageEvent(p,E=!1){if(!p.key)return void this.forAllChangedKeys((fe,Ke,ut)=>{this.notifyListeners(fe,ut)});const C=p.key;if(E?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const fe=this.storage.getItem(C);if(p.newValue!==fe)null!==p.newValue?this.storage.setItem(C,p.newValue):this.storage.removeItem(C);else if(this.localCache[C]===p.newValue&&!E)return}const M=()=>{const fe=this.storage.getItem(C);!E&&this.localCache[C]===fe||this.notifyListeners(C,fe)},Q=this.storage.getItem(C);!function ar(){return(0,V.w1)()&&10===document.documentMode}()||Q===p.newValue||p.newValue===p.oldValue?M():setTimeout(M,10)}notifyListeners(p,E){this.localCache[p]=E;const C=this.listeners[p];if(C)for(const M of Array.from(C))M(E&&JSON.parse(E))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((p,E,C)=>{this.onStorageEvent(new StorageEvent("storage",{key:p,oldValue:E,newValue:C}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(p,E){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[p]||(this.listeners[p]=new Set,this.localCache[p]=this.storage.getItem(p)),this.listeners[p].add(E)}_removeListener(p,E){this.listeners[p]&&(this.listeners[p].delete(E),0===this.listeners[p].size&&delete this.listeners[p]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(p,E){var C=()=>super._set,M=this;return(0,_.Z)(function*(){yield C().call(M,p,E),M.localCache[p]=JSON.stringify(E)})()}_get(p){var E=()=>super._get,C=this;return(0,_.Z)(function*(){const M=yield E().call(C,p);return C.localCache[p]=JSON.stringify(M),M})()}_remove(p){var E=()=>super._remove,C=this;return(0,_.Z)(function*(){yield E().call(C,p),delete C.localCache[p]})()}}return y.type="LOCAL",y})(),ks=(()=>{class y extends Ka{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(p,E){}_removeListener(p,E){}}return y.type="SESSION",y})();let L_=(()=>{class y{constructor(p){this.eventTarget=p,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(p){const E=this.receivers.find(M=>M.isListeningto(p));if(E)return E;const C=new y(p);return this.receivers.push(C),C}isListeningto(p){return this.eventTarget===p}handleEvent(p){var E=this;return(0,_.Z)(function*(){const C=p,{eventId:M,eventType:Q,data:fe}=C.data,Ke=E.handlersMap[Q];if(!Ke?.size)return;C.ports[0].postMessage({status:"ack",eventId:M,eventType:Q});const ut=Array.from(Ke).map(function(){var Nt=(0,_.Z)(function*(Yn){return Yn(C.origin,fe)});return function(Yn){return Nt.apply(this,arguments)}}()),Ot=yield function Y0(y){return Promise.all(y.map(function(){var f=(0,_.Z)(function*(p){try{return{fulfilled:!0,value:yield p}}catch(E){return{fulfilled:!1,reason:E}}});return function(p){return f.apply(this,arguments)}}()))}(ut);C.ports[0].postMessage({status:"done",eventId:M,eventType:Q,response:Ot})})()}_subscribe(p,E){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[p]||(this.handlersMap[p]=new Set),this.handlersMap[p].add(E)}_unsubscribe(p,E){this.handlersMap[p]&&E&&this.handlersMap[p].delete(E),(!E||0===this.handlersMap[p].size)&&delete this.handlersMap[p],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return y.receivers=[],y})();function Co(y="",f=10){let p="";for(let E=0;E<f;E++)p+=Math.floor(10*Math.random());return y+p}class Qd{constructor(f){this.target=f,this.handlers=new Set}removeMessageHandler(f){f.messageChannel&&(f.messageChannel.port1.removeEventListener("message",f.onMessage),f.messageChannel.port1.close()),this.handlers.delete(f)}_send(f,p,E=50){var C=this;return(0,_.Z)(function*(){const M=typeof MessageChannel<"u"?new MessageChannel:null;if(!M)throw new Error("connection_unavailable");let Q,fe;return new Promise((Ke,ut)=>{const Ot=Co("",20);M.port1.start();const Nt=setTimeout(()=>{ut(new Error("unsupported_event"))},E);fe={messageChannel:M,onMessage(Yn){const ns=Yn;if(ns.data.eventId===Ot)switch(ns.data.status){case"ack":clearTimeout(Nt),Q=setTimeout(()=>{ut(new Error("timeout"))},3e3);break;case"done":clearTimeout(Q),Ke(ns.data.response);break;default:clearTimeout(Nt),clearTimeout(Q),ut(new Error("invalid_response"))}}},C.handlers.add(fe),M.port1.addEventListener("message",fe.onMessage),C.target.postMessage({eventType:f,eventId:Ot,data:p},[M.port2])}).finally(()=>{fe&&C.removeMessageHandler(fe)})})()}}function Dr(){return window}function Do(){return typeof Dr().WorkerGlobalScope<"u"&&"function"==typeof Dr().importScripts}function Qs(){return(Qs=(0,_.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Hu="firebaseLocalStorageDb",F_=1,ha="firebaseLocalStorage",Gu="fbase_key";class So{constructor(f){this.request=f}toPromise(){return new Promise((f,p)=>{this.request.addEventListener("success",()=>{f(this.request.result)}),this.request.addEventListener("error",()=>{p(this.request.error)})})}}function eh(y,f){return y.transaction([ha],f?"readwrite":"readonly").objectStore(ha)}function zu(){const y=indexedDB.open(Hu,F_);return new Promise((f,p)=>{y.addEventListener("error",()=>{p(y.error)}),y.addEventListener("upgradeneeded",()=>{const E=y.result;try{E.createObjectStore(ha,{keyPath:Gu})}catch(C){p(C)}}),y.addEventListener("success",(0,_.Z)(function*(){const E=y.result;E.objectStoreNames.contains(ha)?f(E):(E.close(),yield function th(){const y=indexedDB.deleteDatabase(Hu);return new So(y).toPromise()}(),f(yield zu()))}))})}function cl(y,f,p){return vi.apply(this,arguments)}function vi(){return(vi=(0,_.Z)(function*(y,f,p){const E=eh(y,!0).put({[Gu]:f,value:p});return new So(E).toPromise()})).apply(this,arguments)}function fa(){return(fa=(0,_.Z)(function*(y,f){const p=eh(y,!1).get(f),E=yield new So(p).toPromise();return void 0===E?null:E.value})).apply(this,arguments)}function Wu(y,f){const p=eh(y,!0).delete(f);return new So(p).toPromise()}const Ya=(()=>{class y{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var p=this;return(0,_.Z)(function*(){return p.db||(p.db=yield zu()),p.db})()}_withRetries(p){var E=this;return(0,_.Z)(function*(){let C=0;for(;;)try{const M=yield E._openDb();return yield p(M)}catch(M){if(C++>3)throw M;E.db&&(E.db.close(),E.db=void 0)}})()}initializeServiceWorkerMessaging(){var p=this;return(0,_.Z)(function*(){return Do()?p.initializeReceiver():p.initializeSender()})()}initializeReceiver(){var p=this;return(0,_.Z)(function*(){p.receiver=L_._getInstance(function Jd(){return Do()?self:null}()),p.receiver._subscribe("keyChanged",function(){var E=(0,_.Z)(function*(C,M){return{keyProcessed:(yield p._poll()).includes(M.key)}});return function(C,M){return E.apply(this,arguments)}}()),p.receiver._subscribe("ping",function(){var E=(0,_.Z)(function*(C,M){return["keyChanged"]});return function(C,M){return E.apply(this,arguments)}}())})()}initializeSender(){var p=this;return(0,_.Z)(function*(){var E,C;if(p.activeServiceWorker=yield function ul(){return Qs.apply(this,arguments)}(),!p.activeServiceWorker)return;p.sender=new Qd(p.activeServiceWorker);const M=yield p.sender._send("ping",{},800);M&&null!==(E=M[0])&&void 0!==E&&E.fulfilled&&null!==(C=M[0])&&void 0!==C&&C.value.includes("keyChanged")&&(p.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(p){var E=this;return(0,_.Z)(function*(){if(E.sender&&E.activeServiceWorker&&function Xd(){var y;return(null===(y=navigator?.serviceWorker)||void 0===y?void 0:y.controller)||null}()===E.activeServiceWorker)try{yield E.sender._send("keyChanged",{key:p},E.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,_.Z)(function*(){try{if(!indexedDB)return!1;const p=yield zu();return yield cl(p,da,"1"),yield Wu(p,da),!0}catch{}return!1})()}_withPendingWrite(p){var E=this;return(0,_.Z)(function*(){E.pendingWrites++;try{yield p()}finally{E.pendingWrites--}})()}_set(p,E){var C=this;return(0,_.Z)(function*(){return C._withPendingWrite((0,_.Z)(function*(){return yield C._withRetries(M=>cl(M,p,E)),C.localCache[p]=E,C.notifyServiceWorker(p)}))})()}_get(p){var E=this;return(0,_.Z)(function*(){const C=yield E._withRetries(M=>function U_(y,f){return fa.apply(this,arguments)}(M,p));return E.localCache[p]=C,C})()}_remove(p){var E=this;return(0,_.Z)(function*(){return E._withPendingWrite((0,_.Z)(function*(){return yield E._withRetries(C=>Wu(C,p)),delete E.localCache[p],E.notifyServiceWorker(p)}))})()}_poll(){var p=this;return(0,_.Z)(function*(){const E=yield p._withRetries(Q=>{const fe=eh(Q,!1).getAll();return new So(fe).toPromise()});if(!E)return[];if(0!==p.pendingWrites)return[];const C=[],M=new Set;for(const{fbase_key:Q,value:fe}of E)M.add(Q),JSON.stringify(p.localCache[Q])!==JSON.stringify(fe)&&(p.notifyListeners(Q,fe),C.push(Q));for(const Q of Object.keys(p.localCache))p.localCache[Q]&&!M.has(Q)&&(p.notifyListeners(Q,null),C.push(Q));return C})()}notifyListeners(p,E){this.localCache[p]=E;const C=this.listeners[p];if(C)for(const M of Array.from(C))M(E)}startPolling(){var p=this;this.stopPolling(),this.pollTimer=setInterval((0,_.Z)(function*(){return p._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(p,E){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[p]||(this.listeners[p]=new Set,this._get(p)),this.listeners[p].add(E)}_removeListener(p,E){this.listeners[p]&&(this.listeners[p].delete(E),0===this.listeners[p].size&&delete this.listeners[p]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return y.type="LOCAL",y})();function ll(){return(ll=(0,_.Z)(function*(y){return(yield wt(y,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function dl(y){return new Promise((f,p)=>{const E=document.createElement("script");E.setAttribute("src",y),E.onload=f,E.onerror=C=>{const M=Ie("internal-error");M.customData=C,p(M)},E.type="text/javascript",E.charset="UTF-8",function ih(){var y,f;return null!==(f=null===(y=document.getElementsByTagName("head"))||void 0===y?void 0:y[0])&&void 0!==f?f:document}().appendChild(E)})}function pa(y){return`__${y}${Math.floor(1e6*Math.random())}`}const Ku=1e12;class Qa{constructor(f){this.auth=f,this.counter=Ku,this._widgets=new Map}render(f,p){const E=this.counter;return this._widgets.set(E,new B_(f,this.auth.name,p||{})),this.counter++,E}reset(f){var p;const E=f||Ku;null===(p=this._widgets.get(E))||void 0===p||p.delete(),this._widgets.delete(E)}getResponse(f){var p;return(null===(p=this._widgets.get(f||Ku))||void 0===p?void 0:p.getResponse())||""}execute(f){var p=this;return(0,_.Z)(function*(){var E;return null===(E=p._widgets.get(f||Ku))||void 0===E||E.execute(),""})()}}class B_{constructor(f,p,E){this.params=E,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const C="string"==typeof f?document.getElementById(f):f;j(C,"argument-error",{appName:p}),this.container=C,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function sh(y){const f=[],p="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let E=0;E<y;E++)f.push(p.charAt(Math.floor(Math.random()*p.length)));return f.join("")}(50);const{callback:f,"expired-callback":p}=this.params;if(f)try{f(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,p)try{p()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Zu=pa("rcb"),kp=new et(3e4,6e4);class hl{constructor(){var f;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(f=Dr().grecaptcha)||void 0===f||!f.render)}load(f,p=""){return j(function Xa(y){return y.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(y)}(p),f,"argument-error"),this.shouldResolveImmediately(p)?Promise.resolve(Dr().grecaptcha):new Promise((E,C)=>{const M=Dr().setTimeout(()=>{C(Ie(f,"network-request-failed"))},kp.get());Dr()[Zu]=()=>{Dr().clearTimeout(M),delete Dr()[Zu];const fe=Dr().grecaptcha;if(!fe)return void C(Ie(f,"internal-error"));const Ke=fe.render;fe.render=(ut,Ot)=>{const Nt=Ke(ut,Ot);return this.counter++,Nt},this.hostLanguage=p,E(fe)},dl(`https://www.google.com/recaptcha/api.js??${(0,V.xO)({onload:Zu,render:"explicit",hl:p})}`).catch(()=>{clearTimeout(M),C(Ie(f,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(f){var p;return!(null===(p=Dr().grecaptcha)||void 0===p||!p.render)&&(f===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Yu{load(f){return(0,_.Z)(function*(){return new Qa(f)})()}clearedOneInstance(){}}const ga="recaptcha",j_={theme:"light",type:"image"};class ah{constructor(f,p=Object.assign({},j_),E){this.parameters=p,this.type=ga,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Z(E),this.isInvisible="invisible"===this.parameters.size,j(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const C="string"==typeof f?document.getElementById(f):f;j(C,this.auth,"argument-error"),this.container=C,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Yu:new hl,this.validateStartingState()}verify(){var f=this;return(0,_.Z)(function*(){f.assertNotDestroyed();const p=yield f.render(),E=f.getAssertedRecaptcha();return E.getResponse(p)||new Promise(M=>{const Q=fe=>{fe&&(f.tokenChangeListeners.delete(Q),M(fe))};f.tokenChangeListeners.add(Q),f.isInvisible&&E.execute(p)})})()}render(){try{this.assertNotDestroyed()}catch(f){return Promise.reject(f)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(f=>{throw this.renderPromise=null,f})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(f=>{this.container.removeChild(f)})}validateStartingState(){j(!this.parameters.sitekey,this.auth,"argument-error"),j(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),j(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(f){return p=>{if(this.tokenChangeListeners.forEach(E=>E(p)),"function"==typeof f)f(p);else if("string"==typeof f){const E=Dr()[f];"function"==typeof E&&E(p)}}}assertNotDestroyed(){j(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var f=this;return(0,_.Z)(function*(){if(yield f.init(),!f.widgetId){let p=f.container;if(!f.isInvisible){const E=document.createElement("div");p.appendChild(E),p=E}f.widgetId=f.getAssertedRecaptcha().render(p,f.parameters)}return f.widgetId})()}init(){var f=this;return(0,_.Z)(function*(){j(_e()&&!Do(),f.auth,"internal-error"),yield function Ao(){let y=null;return new Promise(f=>{"complete"!==document.readyState?(y=()=>f(),window.addEventListener("load",y)):f()}).catch(f=>{throw y&&window.removeEventListener("load",y),f})}(),f.recaptcha=yield f._recaptchaLoader.load(f.auth,f.auth.languageCode||void 0);const p=yield function Np(y){return ll.apply(this,arguments)}(f.auth);j(p,f.auth,"internal-error"),f.parameters.sitekey=p})()}getAssertedRecaptcha(){return j(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class uh{constructor(f,p){this.verificationId=f,this.onConfirmation=p}confirm(f){const p=ds._fromVerification(this.verificationId,f);return this.onConfirmation(p)}}function Mn(){return(Mn=(0,_.Z)(function*(y,f,p){const E=Z(y),C=yield Op(E,f,(0,V.m9)(p));return new uh(C,M=>ti(E,M))})).apply(this,arguments)}function fl(){return(fl=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y);yield Qi(!1,E,"phone");const C=yield Op(E.auth,f,(0,V.m9)(p));return new uh(C,M=>k(E,M))})).apply(this,arguments)}function H_(){return(H_=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y),C=yield Op(E.auth,f,(0,V.m9)(p));return new uh(C,M=>oe(E,M))})).apply(this,arguments)}function Op(y,f,p){return G_.apply(this,arguments)}function G_(){return G_=(0,_.Z)(function*(y,f,p){var E;const C=yield p.verify();try{let M;if(j("string"==typeof C,y,"argument-error"),j(p.type===ga,y,"argument-error"),M="string"==typeof f?{phoneNumber:f}:f,"session"in M){const Q=M.session;if("phoneNumber"in M)return j("enroll"===Q.type,y,"internal-error"),(yield function q0(y,f){return wt(y,"POST","/v2/accounts/mfaEnrollment:start",Qe(y,f))}(y,{idToken:Q.credential,phoneEnrollmentInfo:{phoneNumber:M.phoneNumber,recaptchaToken:C}})).phoneSessionInfo.sessionInfo;{j("signin"===Q.type,y,"internal-error");const fe=(null===(E=M.multiFactorHint)||void 0===E?void 0:E.uid)||M.multiFactorUid;return j(fe,y,"missing-multi-factor-info"),(yield function rh(y,f){return wt(y,"POST","/v2/accounts/mfaSignIn:start",Qe(y,f))}(y,{mfaPendingCredential:Q.credential,mfaEnrollmentId:fe,phoneSignInInfo:{recaptchaToken:C}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Q}=yield function ea(y,f){return $a.apply(this,arguments)}(y,{phoneNumber:M.phoneNumber,recaptchaToken:C});return Q}}finally{p._reset()}}),G_.apply(this,arguments)}function Ja(){return(Ja=(0,_.Z)(function*(y,f){yield Yi((0,V.m9)(y),f)})).apply(this,arguments)}let ch=(()=>{class y{constructor(p){this.providerId=y.PROVIDER_ID,this.auth=Z(p)}verifyPhoneNumber(p,E){return Op(this.auth,p,(0,V.m9)(E))}static credential(p,E){return ds._fromVerification(p,E)}static credentialFromResult(p){return y.credentialFromTaggedObject(p)}static credentialFromError(p){return y.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{phoneNumber:E,temporaryProof:C}=p;return E&&C?ds._fromTokenResponse(E,C):null}}return y.PROVIDER_ID="phone",y.PHONE_SIGN_IN_METHOD="phone",y})();function Qu(y,f){return f?gt(f):(j(y._popupRedirectResolver,y,"argument-error"),y._popupRedirectResolver)}class vr extends fn{constructor(f){super("custom","custom"),this.params=f}_getIdTokenResponse(f){return gi(f,this._buildIdpRequest())}_linkToIdToken(f,p){return gi(f,this._buildIdpRequest(p))}_getReauthenticationResolver(f){return gi(f,this._buildIdpRequest())}_buildIdpRequest(f){const p={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return f&&(p.idToken=f),p}}function Lp(y){return Io(y.auth,new vr(y),y.bypassAuthState)}function Xu(y){const{auth:f,user:p}=y;return j(p,f,"internal-error"),tl(p,new vr(y),y.bypassAuthState)}function J0(y){return ki.apply(this,arguments)}function ki(){return(ki=(0,_.Z)(function*(y){const{auth:f,user:p}=y;return j(p,f,"internal-error"),Yi(p,new vr(y),y.bypassAuthState)})).apply(this,arguments)}class ma{constructor(f,p,E,C,M=!1){this.auth=f,this.resolver=E,this.user=C,this.bypassAuthState=M,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(p)?p:[p]}execute(){var f=this;return new Promise(function(){var p=(0,_.Z)(function*(E,C){f.pendingPromise={resolve:E,reject:C};try{f.eventManager=yield f.resolver._initialize(f.auth),yield f.onExecution(),f.eventManager.registerConsumer(f)}catch(M){f.reject(M)}});return function(E,C){return p.apply(this,arguments)}}())}onAuthEvent(f){var p=this;return(0,_.Z)(function*(){const{urlResponse:E,sessionId:C,postBody:M,tenantId:Q,error:fe,type:Ke}=f;if(fe)return void p.reject(fe);const ut={auth:p.auth,requestUri:E,sessionId:C,tenantId:Q||void 0,postBody:M||void 0,user:p.user,bypassAuthState:p.bypassAuthState};try{p.resolve(yield p.getIdpTask(Ke)(ut))}catch(Ot){p.reject(Ot)}})()}onError(f){this.reject(f)}getIdpTask(f){switch(f){case"signInViaPopup":case"signInViaRedirect":return Lp;case"linkViaPopup":case"linkViaRedirect":return J0;case"reauthViaPopup":case"reauthViaRedirect":return Xu;default:Ae(this.auth,"internal-error")}}resolve(f){We(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(f),this.unregisterAndCleanUp()}reject(f){We(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(f),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const z_=new et(2e3,1e4);function eu(){return(eu=(0,_.Z)(function*(y,f,p){const E=Z(y);Ge(y,f,xs);const C=Qu(E,p);return new Xt(E,"signInViaPopup",f,C).executeNotNull()})).apply(this,arguments)}function W_(){return(W_=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y);Ge(E.auth,f,xs);const C=Qu(E.auth,p);return new Xt(E.auth,"reauthViaPopup",f,C,E).executeNotNull()})).apply(this,arguments)}function K_(){return(K_=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y);Ge(E.auth,f,xs);const C=Qu(E.auth,p);return new Xt(E.auth,"linkViaPopup",f,C,E).executeNotNull()})).apply(this,arguments)}let Xt=(()=>{class y extends ma{constructor(p,E,C,M,Q){super(p,E,M,Q),this.provider=C,this.authWindow=null,this.pollId=null,y.currentPopupAction&&y.currentPopupAction.cancel(),y.currentPopupAction=this}executeNotNull(){var p=this;return(0,_.Z)(function*(){const E=yield p.execute();return j(E,p.auth,"internal-error"),E})()}onExecution(){var p=this;return(0,_.Z)(function*(){We(1===p.filter.length,"Popup operations only handle one event");const E=Co();p.authWindow=yield p.resolver._openPopup(p.auth,p.provider,p.filter[0],E),p.authWindow.associatedEvent=E,p.resolver._originValidation(p.auth).catch(C=>{p.reject(C)}),p.resolver._isIframeWebStorageSupported(p.auth,C=>{C||p.reject(Ie(p.auth,"web-storage-unsupported"))}),p.pollUserCancellation()})()}get eventId(){var p;return(null===(p=this.authWindow)||void 0===p?void 0:p.associatedEvent)||null}cancel(){this.reject(Ie(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,y.currentPopupAction=null}pollUserCancellation(){const p=()=>{var E,C;this.pollId=null!==(C=null===(E=this.authWindow)||void 0===E?void 0:E.window)&&void 0!==C&&C.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ie(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(p,z_.get())};p()}}return y.currentPopupAction=null,y})();const xo="pendingRedirect",ot=new Map;class Mo extends ma{constructor(f,p,E=!1){super(f,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],p,void 0,E),this.eventId=null}execute(){var f=()=>super.execute,p=this;return(0,_.Z)(function*(){let E=ot.get(p.auth._key());if(!E){try{const M=(yield function Xi(y,f){return dh.apply(this,arguments)}(p.resolver,p.auth))?yield f().call(p):null;E=()=>Promise.resolve(M)}catch(C){E=()=>Promise.reject(C)}ot.set(p.auth._key(),E)}return p.bypassAuthState||ot.set(p.auth._key(),()=>Promise.resolve(null)),E()})()}onAuthEvent(f){var p=()=>super.onAuthEvent,E=this;return(0,_.Z)(function*(){if("signInViaRedirect"===f.type)return p().call(E,f);if("unknown"!==f.type){if(f.eventId){const C=yield E.auth._redirectUserForId(f.eventId);if(C)return E.user=C,p().call(E,f);E.resolve(null)}}else E.resolve(null)})()}onExecution(){return(0,_.Z)(function*(){})()}cleanUp(){}}function dh(){return(dh=(0,_.Z)(function*(y,f){const p=pl(f),E=Fp(y);if(!(yield E._isAvailable()))return!1;const C="true"===(yield E._get(p));return yield E._remove(p),C})).apply(this,arguments)}function tu(y,f){return Oi.apply(this,arguments)}function Oi(){return(Oi=(0,_.Z)(function*(y,f){return Fp(y)._set(pl(f),"true")})).apply(this,arguments)}function hh(y,f){ot.set(y._key(),f)}function Fp(y){return gt(y._redirectPersistence)}function pl(y){return A(xo,y.config.apiKey,y.name)}function gl(y,f,p){return function fh(y,f,p){return Ji.apply(this,arguments)}(y,f,p)}function Ji(){return(Ji=(0,_.Z)(function*(y,f,p){const E=Z(y);Ge(y,f,xs),yield E._initializationPromise;const C=Qu(E,p);return yield tu(C,E),C._openRedirect(E,f,"signInViaRedirect")})).apply(this,arguments)}function Ct(y,f,p){return function Ju(y,f,p){return ph.apply(this,arguments)}(y,f,p)}function ph(){return(ph=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y);Ge(E.auth,f,xs),yield E.auth._initializationPromise;const C=Qu(E.auth,p);yield tu(C,E.auth);const M=yield Os(E);return C._openRedirect(E.auth,f,"reauthViaRedirect",M)})).apply(this,arguments)}function Up(y,f,p){return function ec(y,f,p){return Un.apply(this,arguments)}(y,f,p)}function Un(){return(Un=(0,_.Z)(function*(y,f,p){const E=(0,V.m9)(y);Ge(E.auth,f,xs),yield E.auth._initializationPromise;const C=Qu(E.auth,p);yield Qi(!1,E,f.providerId),yield tu(C,E.auth);const M=yield Os(E);return C._openRedirect(E.auth,f,"linkViaRedirect",M)})).apply(this,arguments)}function ml(){return(ml=(0,_.Z)(function*(y,f){return yield Z(y)._initializationPromise,_l(y,f,!1)})).apply(this,arguments)}function _l(y,f){return Xs.apply(this,arguments)}function Xs(){return(Xs=(0,_.Z)(function*(y,f,p=!1){const E=Z(y),C=Qu(E,f),Q=yield new Mo(E,C,p).execute();return Q&&!p&&(delete Q.user._redirectEventId,yield E._persistUserIfCurrent(Q.user),yield E._setRedirectUser(null,f)),Q})).apply(this,arguments)}function Os(y){return gh.apply(this,arguments)}function gh(){return(gh=(0,_.Z)(function*(y){const f=Co(`${y.uid}:::`);return y._redirectEventId=f,yield y.auth._setRedirectUser(y),yield y.auth._persistUserIfCurrent(y),f})).apply(this,arguments)}class _a{constructor(f){this.auth=f,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(f){this.consumers.add(f),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,f)&&(this.sendToConsumer(this.queuedRedirectEvent,f),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(f){this.consumers.delete(f)}onEvent(f){if(this.hasEventBeenHandled(f))return!1;let p=!1;return this.consumers.forEach(E=>{this.isEventForConsumer(f,E)&&(p=!0,this.sendToConsumer(f,E),this.saveEventToCache(f))}),this.hasHandledPotentialRedirect||!function _h(y){switch(y.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Y_(y);default:return!1}}(f)||(this.hasHandledPotentialRedirect=!0,p||(this.queuedRedirectEvent=f,p=!0)),p}sendToConsumer(f,p){var E;if(f.error&&!Y_(f)){const C=(null===(E=f.error.code)||void 0===E?void 0:E.split("auth/")[1])||"internal-error";p.onError(Ie(this.auth,C))}else p.onAuthEvent(f)}isEventForConsumer(f,p){const E=null===p.eventId||!!f.eventId&&f.eventId===p.eventId;return p.filter.includes(f.type)&&E}hasEventBeenHandled(f){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(mh(f))}saveEventToCache(f){this.cachedEventUids.add(mh(f)),this.lastProcessedEventTime=Date.now()}}function mh(y){return[y.type,y.eventId,y.sessionId,y.tenantId].filter(f=>f).join("-")}function Y_({type:y,error:f}){return"unknown"===y&&"auth/no-auth-event"===f?.code}function nu(y){return fs.apply(this,arguments)}function fs(){return(fs=(0,_.Z)(function*(y,f={}){return wt(y,"GET","/v1/projects",f)})).apply(this,arguments)}const tc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wr=/^https?/;function nc(){return(nc=(0,_.Z)(function*(y){if(y.config.emulator)return;const{authorizedDomains:f}=yield nu(y);for(const p of f)try{if(zn(p))return}catch{}Ae(y,"unauthorized-domain")})).apply(this,arguments)}function zn(y){const f=he(),{protocol:p,hostname:E}=new URL(f);if(y.startsWith("chrome-extension://")){const Q=new URL(y);return""===Q.hostname&&""===E?"chrome-extension:"===p&&y.replace("chrome-extension://","")===f.replace("chrome-extension://",""):"chrome-extension:"===p&&Q.hostname===E}if(!wr.test(p))return!1;if(tc.test(y))return E===y;const C=y.replace(/\./g,"\\.");return new RegExp("^(.+\\."+C+"|"+C+")$","i").test(E)}const ru=new et(3e4,6e4);function rc(){const y=Dr().___jsl;if(y?.H)for(const f of Object.keys(y.H))if(y.H[f].r=y.H[f].r||[],y.H[f].L=y.H[f].L||[],y.H[f].r=[...y.H[f].L],y.CP)for(let p=0;p<y.CP.length;p++)y.CP[p]=null}let Sr=null;const Q_=new et(5e3,15e3),tE="__/auth/iframe",ps="emulator/auth/iframe",su={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ui=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ya(y){const f=y.config;j(f.authDomain,y,"auth-domain-config-required");const p=f.emulator?st(f,ps):`https://${y.config.authDomain}/${tE}`,E={apiKey:f.apiKey,appName:y.name,v:te.SDK_VERSION},C=ui.get(y.config.apiHost);C&&(E.eid=C);const M=y._getFrameworks();return M.length&&(E.fw=M.join(",")),`${p}?${(0,V.xO)(E).slice(1)}`}function No(){return No=(0,_.Z)(function*(y){const f=yield function iu(y){return Sr=Sr||function Li(y){return new Promise((f,p)=>{var E,C,M;function Q(){rc(),gapi.load("gapi.iframes",{callback:()=>{f(gapi.iframes.getContext())},ontimeout:()=>{rc(),p(Ie(y,"network-request-failed"))},timeout:ru.get()})}if(null!==(C=null===(E=Dr().gapi)||void 0===E?void 0:E.iframes)&&void 0!==C&&C.Iframe)f(gapi.iframes.getContext());else{if(null===(M=Dr().gapi)||void 0===M||!M.load){const fe=pa("iframefcb");return Dr()[fe]=()=>{gapi.load?Q():p(Ie(y,"network-request-failed"))},dl(`https://apis.google.com/js/api.js?onload=${fe}`).catch(Ke=>p(Ke))}Q()}}).catch(f=>{throw Sr=null,f})}(y),Sr}(y),p=Dr().gapi;return j(p,y,"internal-error"),f.open({where:document.body,url:ya(y),messageHandlersFilter:p.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:su,dontclear:!0},E=>new Promise(function(){var C=(0,_.Z)(function*(M,Q){yield E.restyle({setHideOnLeave:!1});const fe=Ie(y,"network-request-failed"),Ke=Dr().setTimeout(()=>{Q(fe)},Q_.get());function ut(){Dr().clearTimeout(Ke),M(E)}E.ping(ut).then(ut,()=>{Q(fe)})});return function(M,Q){return C.apply(this,arguments)}}()))}),No.apply(this,arguments)}const vh={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wh=500,Eh=600,jp="_blank",yl="http://localhost";class zt{constructor(f){this.window=f,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const ou="__/auth/handler",J_="emulator/auth/handler";function vl(y,f,p,E,C,M){j(y.config.authDomain,y,"auth-domain-config-required"),j(y.config.apiKey,y,"invalid-api-key");const Q={apiKey:y.config.apiKey,appName:y.name,authType:p,redirectUrl:E,v:te.SDK_VERSION,eventId:C};if(f instanceof xs){f.setDefaultLanguage(y.languageCode),Q.providerId=f.providerId||"",(0,V.xb)(f.getCustomParameters())||(Q.customParameters=JSON.stringify(f.getCustomParameters()));for(const[Ke,ut]of Object.entries(M||{}))Q[Ke]=ut}if(f instanceof Eo){const Ke=f.getScopes().filter(ut=>""!==ut);Ke.length>0&&(Q.scopes=Ke.join(","))}y.tenantId&&(Q.tid=y.tenantId);const fe=Q;for(const Ke of Object.keys(fe))void 0===fe[Ke]&&delete fe[Ke];return`${function es({config:y}){return y.emulator?st(y,J_):`https://${y.authDomain}/${ou}`}(y)}?${(0,V.xO)(fe).slice(1)}`}const wl="webStorageSupport",Ih=class $p{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ks,this._completeRedirectFn=_l,this._overrideRedirectResult=hh}_openPopup(f,p,E,C){var M=this;return(0,_.Z)(function*(){var Q;We(null===(Q=M.eventManagers[f._key()])||void 0===Q?void 0:Q.manager,"_initialize() not called before _openPopup()");const fe=vl(f,p,E,he(),C);return function wi(y,f,p,E=wh,C=Eh){const M=Math.max((window.screen.availHeight-C)/2,0).toString(),Q=Math.max((window.screen.availWidth-E)/2,0).toString();let fe="";const Ke=Object.assign(Object.assign({},vh),{width:E.toString(),height:C.toString(),top:M,left:Q}),ut=(0,V.z$)().toLowerCase();p&&(fe=Te(ut)?jp:p),B(ut)&&(f=f||yl,Ke.scrollbars="yes");const Ot=Object.entries(Ke).reduce((Yn,[ns,mu])=>`${Yn}${ns}=${mu},`,"");if(function Tr(y=(0,V.z$)()){var f;return bt(y)&&!(null===(f=window.navigator)||void 0===f||!f.standalone)}(ut)&&"_self"!==fe)return function X_(y,f){const p=document.createElement("a");p.href=y,p.target=f;const E=document.createEvent("MouseEvent");E.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),p.dispatchEvent(E)}(f||"",fe),new zt(null);const Nt=window.open(f||"",fe,Ot);j(Nt,y,"popup-blocked");try{Nt.focus()}catch{}return new zt(Nt)}(f,fe,Co())})()}_openRedirect(f,p,E,C){var M=this;return(0,_.Z)(function*(){return yield M._originValidation(f),function al(y){Dr().location.href=y}(vl(f,p,E,he(),C)),new Promise(()=>{})})()}_initialize(f){const p=f._key();if(this.eventManagers[p]){const{manager:C,promise:M}=this.eventManagers[p];return C?Promise.resolve(C):(We(M,"If manager is not set, promise should be"),M)}const E=this.initAndGetManager(f);return this.eventManagers[p]={promise:E},E.catch(()=>{delete this.eventManagers[p]}),E}initAndGetManager(f){var p=this;return(0,_.Z)(function*(){const E=yield function nE(y){return No.apply(this,arguments)}(f),C=new _a(f);return E.register("authEvent",M=>(j(M?.authEvent,f,"invalid-auth-event"),{status:C.onEvent(M.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),p.eventManagers[f._key()]={manager:C},p.iframes[f._key()]=E,C})()}_isIframeWebStorageSupported(f,p){this.iframes[f._key()].send(wl,{type:wl},C=>{var M;const Q=null===(M=C?.[0])||void 0===M?void 0:M[wl];void 0!==Q&&p(!!Q),Ae(f,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(f){const p=f._key();return this.originValidationPromises[p]||(this.originValidationPromises[p]=function yh(y){return nc.apply(this,arguments)}(f)),this.originValidationPromises[p]}get _shouldInitProactively(){return Yo()||le()||bt()}};class ey{constructor(f){this.factorId=f}_process(f,p,E){switch(p.type){case"enroll":return this._finalizeEnroll(f,p.credential,E);case"signin":return this._finalizeSignIn(f,p.credential);default:return we("unexpected MultiFactorSessionType")}}}class Ar extends ey{constructor(f){super("phone"),this.credential=f}static _fromCredential(f){return new Ar(f)}_finalizeEnroll(f,p,E){return function K0(y,f){return wt(y,"POST","/v2/accounts/mfaEnrollment:finalize",Qe(y,f))}(f,{idToken:p,displayName:E,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(f,p){return function Mp(y,f){return wt(y,"POST","/v2/accounts/mfaSignIn:finalize",Qe(y,f))}(f,{mfaPendingCredential:p,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Po=(()=>{class y{constructor(){}static assertion(p){return Ar._fromCredential(p)}}return y.FACTOR_ID="phone",y})();var Fr="@firebase/auth";class Th{constructor(f){this.auth=f,this.internalListeners=new Map}getUid(){var f;return this.assertAuthConfigured(),(null===(f=this.auth.currentUser)||void 0===f?void 0:f.uid)||null}getToken(f){var p=this;return(0,_.Z)(function*(){return p.assertAuthConfigured(),yield p.auth._initializationPromise,p.auth.currentUser?{accessToken:yield p.auth.currentUser.getIdToken(f)}:null})()}addAuthTokenListener(f){if(this.assertAuthConfigured(),this.internalListeners.has(f))return;const p=this.auth.onIdTokenChanged(E=>{f(E?.stsTokenManager.accessToken||null)});this.internalListeners.set(f,p),this.updateProactiveRefresh()}removeAuthTokenListener(f){this.assertAuthConfigured();const p=this.internalListeners.get(f);p&&(this.internalListeners.delete(f),p(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ei(){return window}(0,V.Pz)("authIdTokenMaxAge"),function ni(y){(0,te._registerComponent)(new de.wA("auth",(f,{options:p})=>{const E=f.getProvider("app").getImmediate(),C=f.getProvider("heartbeat"),{apiKey:M,authDomain:Q}=E.options;return((fe,Ke)=>{j(M&&!M.includes(":"),"invalid-api-key",{appName:fe.name}),j(!Q?.includes(":"),"argument-error",{appName:fe.name});const ut={apiKey:M,authDomain:Q,clientPlatform:y,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:go(y)},Ot=new Xo(fe,Ke,ut);return function re(y,f){const p=f?.persistence||[],E=(Array.isArray(p)?p:[p]).map(gt);f?.errorMap&&y._updateErrorMap(f.errorMap),y._initializeWithPersistence(E,f?.popupRedirectResolver)}(Ot,p),Ot})(E,C)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((f,p,E)=>{f.getProvider("auth-internal").initialize()})),(0,te._registerComponent)(new de.wA("auth-internal",f=>{const p=Z(f.getProvider("auth").getImmediate());return new Th(p)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,te.registerVersion)(Fr,"0.21.5",function Il(y){switch(y){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(y)),(0,te.registerVersion)(Fr,"0.21.5","esm2017")}("Browser");const on=2e3;function Cl(){return Cl=(0,_.Z)(function*(y,f,p){var E;const{BuildInfo:C}=Ei();We(f.sessionId,"AuthEvent did not contain a session ID");const M=yield function oc(y){return Dl.apply(this,arguments)}(f.sessionId),Q={};return bt()?Q.ibi=C.packageName:Pt()?Q.apn=C.packageName:Ae(y,"operation-not-supported-in-this-environment"),C.displayName&&(Q.appDisplayName=C.displayName),Q.sessionId=M,vl(y,p,f.type,void 0,null!==(E=f.eventId)&&void 0!==E?E:void 0,Q)}),Cl.apply(this,arguments)}function bh(){return(bh=(0,_.Z)(function*(y){const{BuildInfo:f}=Ei(),p={};bt()?p.iosBundleId=f.packageName:Pt()?p.androidPackageName=f.packageName:Ae(y,"operation-not-supported-in-this-environment"),yield nu(y,p)})).apply(this,arguments)}function Ch(){return(Ch=(0,_.Z)(function*(y,f,p){const{cordova:E}=Ei();let C=()=>{};try{yield new Promise((M,Q)=>{let fe=null;function Ke(){var Nt;M();const Yn=null===(Nt=E.plugins.browsertab)||void 0===Nt?void 0:Nt.close;"function"==typeof Yn&&Yn(),"function"==typeof p?.close&&p.close()}function ut(){fe||(fe=window.setTimeout(()=>{Q(Ie(y,"redirect-cancelled-by-user"))},on))}function Ot(){"visible"===document?.visibilityState&&ut()}f.addPassiveListener(Ke),document.addEventListener("resume",ut,!1),Pt()&&document.addEventListener("visibilitychange",Ot,!1),C=()=>{f.removePassiveListener(Ke),document.removeEventListener("resume",ut,!1),document.removeEventListener("visibilitychange",Ot,!1),fe&&window.clearTimeout(fe)}})}finally{C()}})).apply(this,arguments)}function Dl(){return(Dl=(0,_.Z)(function*(y){const f=function uu(y){if(We(/[0-9a-zA-Z]+/.test(y),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(y);const f=new ArrayBuffer(y.length),p=new Uint8Array(f);for(let E=0;E<y.length;E++)p[E]=y.charCodeAt(E);return p}(y),p=yield crypto.subtle.digest("SHA-256",f);return Array.from(new Uint8Array(p)).map(C=>C.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}const Dh=20;class Sl extends _a{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(f=>{this.resolveInialized=f})}addPassiveListener(f){this.passiveListeners.add(f)}removePassiveListener(f){this.passiveListeners.delete(f)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(f){return this.resolveInialized(),this.passiveListeners.forEach(p=>p(f)),super.onEvent(f)}initialized(){var f=this;return(0,_.Z)(function*(){yield f.initPromise})()}}function Rl(y){return Sh.apply(this,arguments)}function Sh(){return(Sh=(0,_.Z)(function*(y){const f=yield cu()._get(Rh(y));return f&&(yield cu()._remove(Rh(y))),f})).apply(this,arguments)}function ty(){const y=[],f="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let p=0;p<Dh;p++){const E=Math.floor(Math.random()*f.length);y.push(f.charAt(E))}return y.join("")}function cu(){return gt($u)}function Rh(y){return A("authEvent",y.config.apiKey,y.name)}function xl(y){if(!y?.includes("?"))return{};const[f,...p]=y.split("?");return(0,V.zd)(p.join("?"))}const uc=class ac{constructor(){this._redirectPersistence=ks,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=_l,this._overrideRedirectResult=hh}_initialize(f){var p=this;return(0,_.Z)(function*(){const E=f._key();let C=p.eventManagers.get(E);return C||(C=new Sl(f),p.eventManagers.set(E,C),p.attachCallbackListeners(f,C)),C})()}_openPopup(f){Ae(f,"operation-not-supported-in-this-environment")}_openRedirect(f,p,E,C){var M=this;return(0,_.Z)(function*(){!function ko(y){var f,p,E,C,M,Q,fe,Ke,ut,Ot;const Nt=Ei();j("function"==typeof(null===(f=Nt?.universalLinks)||void 0===f?void 0:f.subscribe),y,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),j(typeof(null===(p=Nt?.BuildInfo)||void 0===p?void 0:p.packageName)<"u",y,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),j("function"==typeof(null===(M=null===(C=null===(E=Nt?.cordova)||void 0===E?void 0:E.plugins)||void 0===C?void 0:C.browsertab)||void 0===M?void 0:M.openUrl),y,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),j("function"==typeof(null===(Ke=null===(fe=null===(Q=Nt?.cordova)||void 0===Q?void 0:Q.plugins)||void 0===fe?void 0:fe.browsertab)||void 0===Ke?void 0:Ke.isAvailable),y,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),j("function"==typeof(null===(Ot=null===(ut=Nt?.cordova)||void 0===ut?void 0:ut.InAppBrowser)||void 0===Ot?void 0:Ot.open),y,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(f);const Q=yield M._initialize(f);yield Q.initialized(),Q.resetRedirect(),function Z_(){ot.clear()}(),yield M._originValidation(f);const fe=function Js(y,f,p=null){return{type:f,eventId:p,urlResponse:null,sessionId:ty(),postBody:null,tenantId:y.tenantId,error:Ie(y,"no-auth-event")}}(f,E,C);yield function Al(y,f){return cu()._set(Rh(y),f)}(f,fe);const Ke=yield function ic(y,f,p){return Cl.apply(this,arguments)}(f,fe,p),ut=yield function wa(y){const{cordova:f}=Ei();return new Promise(p=>{f.plugins.browsertab.isAvailable(E=>{let C=null;E?f.plugins.browsertab.openUrl(y):C=f.InAppBrowser.open(y,function An(y=(0,V.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(y)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(y)}()?"_blank":"_system","location=yes"),p(C)})})}(Ke);return function sc(y,f,p){return Ch.apply(this,arguments)}(f,Q,ut)})()}_isIframeWebStorageSupported(f,p){throw new Error("Method not implemented.")}_originValidation(f){const p=f._key();return this.originValidationPromises[p]||(this.originValidationPromises[p]=function va(y){return bh.apply(this,arguments)}(f)),this.originValidationPromises[p]}attachCallbackListeners(f,p){const{universalLinks:E,handleOpenURL:C,BuildInfo:M}=Ei(),Q=setTimeout((0,_.Z)(function*(){yield Rl(f),p.onEvent(Ml())}),500),fe=function(){var Ot=(0,_.Z)(function*(Nt){clearTimeout(Q);const Yn=yield Rl(f);let ns=null;Yn&&Nt?.url&&(ns=function Ah(y,f){var p,E;const C=function ry(y){const f=xl(y),p=f.link?decodeURIComponent(f.link):void 0,E=xl(p).link,C=f.deep_link_id?decodeURIComponent(f.deep_link_id):void 0;return xl(C).link||C||E||p||y}(f);if(C.includes("/__/auth/callback")){const M=xl(C),Q=M.firebaseError?function ny(y){try{return JSON.parse(y)}catch{return null}}(decodeURIComponent(M.firebaseError)):null,fe=null===(E=null===(p=Q?.code)||void 0===p?void 0:p.split("auth/"))||void 0===E?void 0:E[1],Ke=fe?Ie(fe):null;return Ke?{type:y.type,eventId:y.eventId,tenantId:y.tenantId,error:Ke,urlResponse:null,sessionId:null,postBody:null}:{type:y.type,eventId:y.eventId,tenantId:y.tenantId,sessionId:y.sessionId,urlResponse:C,postBody:null}}return null}(Yn,Nt.url)),p.onEvent(ns||Ml())});return function(Yn){return Ot.apply(this,arguments)}}();typeof E<"u"&&"function"==typeof E.subscribe&&E.subscribe(null,fe);const Ke=C,ut=`${M.packageName.toLowerCase()}://`;Ei().handleOpenURL=function(){var Ot=(0,_.Z)(function*(Nt){if(Nt.toLowerCase().startsWith(ut)&&fe({url:Nt}),"function"==typeof Ke)try{Ke(Nt)}catch(Yn){console.error(Yn)}});return function(Nt){return Ot.apply(this,arguments)}}()}};function Ml(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ie("no-auth-event")}}const Mh=1e3;function ts(){var y;return(null===(y=self?.location)||void 0===y?void 0:y.protocol)||null}function Ia(y=(0,V.z$)()){return!("file:"!==ts()&&"ionic:"!==ts()&&"capacitor:"!==ts()||!y.toLowerCase().match(/iphone|ipad|ipod|android/))}function Nl(){try{const y=self.localStorage,f=Co();if(y)return y.setItem(f,"1"),y.removeItem(f),!function qp(y=(0,V.z$)()){return function lc(){return(0,V.w1)()&&11===document?.documentMode}()||function dc(y=(0,V.z$)()){return/Edge\/\d+/.test(y)}(y)}()||(0,V.hl)()}catch{return eo()&&(0,V.hl)()}return!1}function eo(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Pl(){return(function Wp(){return"http:"===ts()||"https:"===ts()}()||(0,V.ru)()||Ia())&&!function cc(){return(0,V.b$)()||(0,V.UG)()}()&&Nl()&&!eo()}function kl(){return Ia()&&typeof document<"u"}function lu(){return(lu=(0,_.Z)(function*(){return!!kl()&&new Promise(y=>{const f=setTimeout(()=>{y(!1)},Mh);document.addEventListener("deviceready",()=>{clearTimeout(f),y(!0)})})})).apply(this,arguments)}const Rr={LOCAL:"local",NONE:"none",SESSION:"session"},Ta=j,hu="persistence";function Oo(y){return Ol.apply(this,arguments)}function Ol(){return(Ol=(0,_.Z)(function*(y){yield y._initializationPromise;const f=gs(),p=A(hu,y.config.apiKey,y.name);f&&f.setItem(p,y._getPersistence())})).apply(this,arguments)}function gs(){var y;try{return(null===(y=function du(){return typeof window<"u"?window:null}())||void 0===y?void 0:y.sessionStorage)||null}catch{return null}}const kh=j;class ci{constructor(){this.browserResolver=gt(Ih),this.cordovaResolver=gt(uc),this.underlyingResolver=null,this._redirectPersistence=ks,this._completeRedirectFn=_l,this._overrideRedirectResult=hh}_initialize(f){var p=this;return(0,_.Z)(function*(){return yield p.selectUnderlyingResolver(),p.assertedUnderlyingResolver._initialize(f)})()}_openPopup(f,p,E,C){var M=this;return(0,_.Z)(function*(){return yield M.selectUnderlyingResolver(),M.assertedUnderlyingResolver._openPopup(f,p,E,C)})()}_openRedirect(f,p,E,C){var M=this;return(0,_.Z)(function*(){return yield M.selectUnderlyingResolver(),M.assertedUnderlyingResolver._openRedirect(f,p,E,C)})()}_isIframeWebStorageSupported(f,p){this.assertedUnderlyingResolver._isIframeWebStorageSupported(f,p)}_originValidation(f){return this.assertedUnderlyingResolver._originValidation(f)}get _shouldInitProactively(){return kl()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return kh(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var f=this;return(0,_.Z)(function*(){if(f.underlyingResolver)return;const p=yield function Nh(){return lu.apply(this,arguments)}();f.underlyingResolver=p?f.cordovaResolver:f.browserResolver})()}}function pu(y){return y.unwrap()}function gu(y){return ba(y)}function ba(y){const{_tokenResponse:f}=y instanceof V.ZR?y.customData:y;if(!f)return null;if(!(y instanceof V.ZR)&&"temporaryProof"in f&&"phoneNumber"in f)return ch.credentialFromResult(y);const p=f.providerId;if(!p||p===ue.PASSWORD)return null;let E;switch(p){case ue.GOOGLE:E=zd;break;case ue.FACEBOOK:E=Fu;break;case ue.GITHUB:E=Wd;break;case ue.TWITTER:E=Qc;break;default:const{oauthIdToken:C,oauthAccessToken:M,oauthTokenSecret:Q,pendingToken:fe,nonce:Ke}=f;return M||Q||C||fe?fe?p.startsWith("saml.")?hs._create(p,fe):Ki._fromParams({providerId:p,signInMethod:p,pendingToken:fe,idToken:C,accessToken:M}):new ra(p).credential({idToken:C,accessToken:M,rawNonce:Ke}):null}return y instanceof V.ZR?E.credentialFromError(y):E.credentialFromResult(y)}function Ii(y,f){return f.catch(p=>{throw p instanceof V.ZR&&function Oh(y,f){var p;const E=null===(p=f.customData)||void 0===p?void 0:p._tokenResponse;if("auth/multi-factor-auth-required"===f?.code)f.resolver=new sy(y,function W0(y,f){var p;const E=(0,V.m9)(y),C=f;return j(f.customData.operationType,E,"argument-error"),j(null===(p=C.customData._serverResponse)||void 0===p?void 0:p.mfaPendingCredential,E,"argument-error"),Ap._fromError(E,C)}(y,f));else if(E){const C=ba(f),M=f;C&&(M.credential=C,M.tenantId=E.tenantId||void 0,M.email=E.email||void 0,M.phoneNumber=E.phoneNumber||void 0)}}(y,p),p}).then(p=>{const C=p.user;return{operationType:p.operationType,credential:gu(p),additionalUserInfo:Dp(p),user:ms.getOrCreate(C)}})}function Lh(y,f){return Kp.apply(this,arguments)}function Kp(){return(Kp=(0,_.Z)(function*(y,f){const p=yield f;return{verificationId:p.verificationId,confirm:E=>Ii(y,p.confirm(E))}})).apply(this,arguments)}class sy{constructor(f,p){this.resolver=p,this.auth=function hc(y){return y.wrapped()}(f)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(f){return Ii(pu(this.auth),this.resolver.resolveSignIn(f))}}class ms{constructor(f){this._delegate=f,this.multiFactor=function Yd(y){const f=(0,V.m9)(y);return ju.has(f)||ju.set(f,Rp._fromUser(f)),ju.get(f)}(f)}static getOrCreate(f){return ms.USER_MAP.has(f)||ms.USER_MAP.set(f,new ms(f)),ms.USER_MAP.get(f)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(f){return this._delegate.getIdTokenResult(f)}getIdToken(f){return this._delegate.getIdToken(f)}linkAndRetrieveDataWithCredential(f){return this.linkWithCredential(f)}linkWithCredential(f){var p=this;return(0,_.Z)(function*(){return Ii(p.auth,k(p._delegate,f))})()}linkWithPhoneNumber(f,p){var E=this;return(0,_.Z)(function*(){return Lh(E.auth,function Q0(y,f,p){return fl.apply(this,arguments)}(E._delegate,f,p))})()}linkWithPopup(f){var p=this;return(0,_.Z)(function*(){return Ii(p.auth,function q_(y,f,p){return K_.apply(this,arguments)}(p._delegate,f,ci))})()}linkWithRedirect(f){var p=this;return(0,_.Z)(function*(){return yield Oo(Z(p.auth)),Up(p._delegate,f,ci)})()}reauthenticateAndRetrieveDataWithCredential(f){return this.reauthenticateWithCredential(f)}reauthenticateWithCredential(f){var p=this;return(0,_.Z)(function*(){return Ii(p.auth,oe(p._delegate,f))})()}reauthenticateWithPhoneNumber(f,p){return Lh(this.auth,function $_(y,f,p){return H_.apply(this,arguments)}(this._delegate,f,p))}reauthenticateWithPopup(f){return Ii(this.auth,function eE(y,f,p){return W_.apply(this,arguments)}(this._delegate,f,ci))}reauthenticateWithRedirect(f){var p=this;return(0,_.Z)(function*(){return yield Oo(Z(p.auth)),Ct(p._delegate,f,ci)})()}sendEmailVerification(f){return function Ep(y,f){return il.apply(this,arguments)}(this._delegate,f)}unlink(f){var p=this;return(0,_.Z)(function*(){return yield function wp(y,f){return aa.apply(this,arguments)}(p._delegate,f),p})()}updateEmail(f){return function Ps(y,f){return Tp((0,V.m9)(y),f,null)}(this._delegate,f)}updatePassword(f){return function Ip(y,f){return Tp((0,V.m9)(y),null,f)}(this._delegate,f)}updatePhoneNumber(f){return function X0(y,f){return Ja.apply(this,arguments)}(this._delegate,f)}updateProfile(f){return function R_(y,f){return la.apply(this,arguments)}(this._delegate,f)}verifyBeforeUpdateEmail(f,p){return function j0(y,f,p){return sl.apply(this,arguments)}(this._delegate,f,p)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}ms.USER_MAP=new WeakMap;const fc=j;let Fh=(()=>{class y{constructor(p,E){if(this.app=p,E.isInitialized())return this._delegate=E.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:C}=p.options;fc(C,"invalid-api-key",{appName:p.name}),fc(C,"invalid-api-key",{appName:p.name});const M=typeof window<"u"?ci:void 0;this._delegate=E.initialize({options:{persistence:Ll(C,p.name),popupRedirectResolver:M}}),this._delegate._updateErrorMap(Ze),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ms.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(p){this._delegate.languageCode=p}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(p){this._delegate.tenantId=p}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(p,E){!function Ve(y,f,p){const E=Z(y);j(E._canInitEmulator,E,"emulator-config-failed"),j(/^https?:\/\//.test(f),E,"invalid-emulator-scheme");const C=!!p?.disableWarnings,M=qe(f),{host:Q,port:fe}=function Qt(y){const f=qe(y),p=/(\/\/)?([^?#/]+)/.exec(y.substr(f.length));if(!p)return{host:"",port:null};const E=p[2].split("@").pop()||"",C=/^(\[[^\]]+\])(:|$)/.exec(E);if(C){const M=C[1];return{host:M,port:$t(E.substr(M.length+1))}}{const[M,Q]=E.split(":");return{host:M,port:$t(Q)}}}(f);E.config.emulator={url:`${M}//${Q}${null===fe?"":`:${fe}`}/`},E.settings.appVerificationDisabledForTesting=!0,E.emulatorConfig=Object.freeze({host:Q,port:fe,protocol:M.replace(":",""),options:Object.freeze({disableWarnings:C})}),C||function Zn(){function y(){const f=document.createElement("p"),p=f.style;f.innerText="Running in emulator mode. Do not use with production credentials.",p.position="fixed",p.width="100%",p.backgroundColor="#ffffff",p.border=".1em solid #000000",p.color="#b50000",p.bottom="0px",p.left="0px",p.margin="0px",p.zIndex="10000",p.textAlign="center",f.classList.add("firebase-emulator-warning"),document.body.appendChild(f)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",y):y())}()}(this._delegate,p,E)}applyActionCode(p){return function Ft(y,f){return oi.apply(this,arguments)}(this._delegate,p)}checkActionCode(p){return Ns(this._delegate,p)}confirmPasswordReset(p,E){return function ua(y,f,p){return qs.apply(this,arguments)}(this._delegate,p,E)}createUserWithEmailAndPassword(p,E){var C=this;return(0,_.Z)(function*(){return Ii(C._delegate,function S_(y,f,p){return Kd.apply(this,arguments)}(C._delegate,p,E))})()}fetchProvidersForEmail(p){return this.fetchSignInMethodsForEmail(p)}fetchSignInMethodsForEmail(p){return function Ks(y,f){return rl.apply(this,arguments)}(this._delegate,p)}isSignInWithEmailLink(p){return function V0(y,f){return"EMAIL_SIGNIN"===Hr.parseLink(f)?.operation}(0,p)}getRedirectResult(){var p=this;return(0,_.Z)(function*(){fc(Pl(),p._delegate,"operation-not-supported-in-this-environment");const E=yield function Vp(y,f){return ml.apply(this,arguments)}(p._delegate,ci);return E?Ii(p._delegate,Promise.resolve(E)):{credential:null,user:null}})()}addFrameworkForLogging(p){!function Ea(y,f){Z(y)._logFramework(f)}(this._delegate,p)}onAuthStateChanged(p,E,C){const{next:M,error:Q,complete:fe}=pc(p,E,C);return this._delegate.onAuthStateChanged(M,Q,fe)}onIdTokenChanged(p,E,C){const{next:M,error:Q,complete:fe}=pc(p,E,C);return this._delegate.onIdTokenChanged(M,Q,fe)}sendSignInLinkToEmail(p,E){return function Pe(y,f,p){return pn.apply(this,arguments)}(this._delegate,p,E)}sendPasswordResetEmail(p,E){return function To(y,f,p){return Cr.apply(this,arguments)}(this._delegate,p,E||void 0)}setPersistence(p){var E=this;return(0,_.Z)(function*(){let C;switch(function Ph(y,f){Ta(Object.values(Rr).includes(f),y,"invalid-persistence-type"),(0,V.b$)()?Ta(f!==Rr.SESSION,y,"unsupported-persistence-type"):(0,V.UG)()?Ta(f===Rr.NONE,y,"unsupported-persistence-type"):eo()?Ta(f===Rr.NONE||f===Rr.LOCAL&&(0,V.hl)(),y,"unsupported-persistence-type"):Ta(f===Rr.NONE||Nl(),y,"unsupported-persistence-type")}(E._delegate,p),p){case Rr.SESSION:C=ks;break;case Rr.LOCAL:C=(yield gt(Ya)._isAvailable())?Ya:$u;break;case Rr.NONE:C=H;break;default:return Ae("argument-error",{appName:E._delegate.name})}return E._delegate.setPersistence(C)})()}signInAndRetrieveDataWithCredential(p){return this.signInWithCredential(p)}signInAnonymously(){return Ii(this._delegate,function Jc(y){return el.apply(this,arguments)}(this._delegate))}signInWithCredential(p){return Ii(this._delegate,ti(this._delegate,p))}signInWithCustomToken(p){return Ii(this._delegate,function jn(y,f){return Cn.apply(this,arguments)}(this._delegate,p))}signInWithEmailAndPassword(p,E){return Ii(this._delegate,function ur(y,f,p){return ti((0,V.m9)(y),Zc.credential(f,p))}(this._delegate,p,E))}signInWithEmailLink(p,E){return Ii(this._delegate,function B0(y,f,p){return Lr.apply(this,arguments)}(this._delegate,p,E))}signInWithPhoneNumber(p,E){return Lh(this._delegate,function Ro(y,f,p){return Mn.apply(this,arguments)}(this._delegate,p,E))}signInWithPopup(p){var E=this;return(0,_.Z)(function*(){return fc(Pl(),E._delegate,"operation-not-supported-in-this-environment"),Ii(E._delegate,function lh(y,f,p){return eu.apply(this,arguments)}(E._delegate,p,ci))})()}signInWithRedirect(p){var E=this;return(0,_.Z)(function*(){return fc(Pl(),E._delegate,"operation-not-supported-in-this-environment"),yield Oo(E._delegate),gl(E._delegate,p,ci)})()}updateCurrentUser(p){return this._delegate.updateCurrentUser(p)}verifyPasswordResetCode(p){return function D_(y,f){return qd.apply(this,arguments)}(this._delegate,p)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return y.Persistence=Rr,y})();function pc(y,f,p){let E=y;"function"!=typeof y&&({next:E,error:f,complete:p}=y);const C=E;return{next:Q=>C(Q&&ms.getOrCreate(Q)),error:f,complete:p}}function Ll(y,f){const p=function fu(y,f){const p=gs();if(!p)return[];const E=A(hu,y,f);switch(p.getItem(E)){case Rr.NONE:return[H];case Rr.LOCAL:return[Ya,ks];case Rr.SESSION:return[ks];default:return[]}}(y,f);if(typeof self<"u"&&!p.includes(Ya)&&p.push(Ya),typeof window<"u")for(const E of[$u,ks])p.includes(E)||p.push(E);return p.includes(H)||p.push(H),p}class gc{constructor(){this.providerId="phone",this._delegate=new ch(pu(X.Z.auth()))}static credential(f,p){return ch.credential(f,p)}verifyPhoneNumber(f,p){return this._delegate.verifyPhoneNumber(f,p)}unwrap(){return this._delegate}}gc.PHONE_SIGN_IN_METHOD=ch.PHONE_SIGN_IN_METHOD,gc.PROVIDER_ID=ch.PROVIDER_ID;const Zp=j;class Yp{constructor(f,p,E=X.Z.app()){var C;Zp(null===(C=E.options)||void 0===C?void 0:C.apiKey,"invalid-api-key",{appName:E.name}),this._delegate=new ah(f,p,E.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function oy(y){y.INTERNAL.registerComponent(new de.wA("auth-compat",f=>{const p=f.getProvider("app-compat").getImmediate(),E=f.getProvider("auth");return new Fh(p,E)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Y_EMAIL_SIGNIN,PASSWORD_RESET:Y_PASSWORD_RESET,RECOVER_EMAIL:Y_RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Y_REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Y_VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Y_VERIFY_EMAIL}},EmailAuthProvider:Zc,FacebookAuthProvider:Fu,GithubAuthProvider:Wd,GoogleAuthProvider:zd,OAuthProvider:ra,SAMLAuthProvider:za,PhoneAuthProvider:gc,PhoneMultiFactorGenerator:Po,RecaptchaVerifier:Yp,TwitterAuthProvider:Qc,Auth:Fh,AuthCredential:fn,Error:V.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),y.registerVersion("@firebase/auth-compat","0.3.5")}(X.Z)},8766:(mt,De,P)=>{P.d(De,{Lj:()=>Ae,X3:()=>Ue});var _=P(5861);const X=(j,we)=>we.some(We=>j instanceof We);let V,te;const de=new WeakMap,ge=new WeakMap,ue=new WeakMap,G=new WeakMap,W=new WeakMap;let ve={get(j,we,We){if(j instanceof IDBTransaction){if("done"===we)return ge.get(j);if("objectStoreNames"===we)return j.objectStoreNames||ue.get(j);if("store"===we)return We.objectStoreNames[1]?void 0:We.objectStore(We.objectStoreNames[0])}return be(j[we])},set:(j,we,We)=>(j[we]=We,!0),has:(j,we)=>j instanceof IDBTransaction&&("done"===we||"store"===we)||we in j};function pe(j){return"function"==typeof j?function rt(j){return j!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ne(){return te||(te=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(j)?function(...we){return j.apply(Ne(this),we),be(de.get(this))}:function(...we){return be(j.apply(Ne(this),we))}:function(we,...We){const Ye=j.call(Ne(this),we,...We);return ue.set(Ye,we.sort?we.sort():[we]),be(Ye)}}(j):(j instanceof IDBTransaction&&function ke(j){if(ge.has(j))return;const we=new Promise((We,Ye)=>{const gt=()=>{j.removeEventListener("complete",Je),j.removeEventListener("error",re),j.removeEventListener("abort",re)},Je=()=>{We(),gt()},re=()=>{Ye(j.error||new DOMException("AbortError","AbortError")),gt()};j.addEventListener("complete",Je),j.addEventListener("error",re),j.addEventListener("abort",re)});ge.set(j,we)}(j),X(j,function ae(){return V||(V=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(j,ve):j)}function be(j){if(j instanceof IDBRequest)return function Y(j){const we=new Promise((We,Ye)=>{const gt=()=>{j.removeEventListener("success",Je),j.removeEventListener("error",re)},Je=()=>{We(be(j.result)),gt()},re=()=>{Ye(j.error),gt()};j.addEventListener("success",Je),j.addEventListener("error",re)});return we.then(We=>{We instanceof IDBCursor&&de.set(We,j)}).catch(()=>{}),W.set(we,j),we}(j);if(G.has(j))return G.get(j);const we=pe(j);return we!==j&&(G.set(j,we),W.set(we,j)),we}const Ne=j=>W.get(j);function Ue(j,we,{blocked:We,upgrade:Ye,blocking:gt,terminated:Je}={}){const re=indexedDB.open(j,we),he=be(re);return Ye&&re.addEventListener("upgradeneeded",_e=>{Ye(be(re.result),_e.oldVersion,_e.newVersion,be(re.transaction))}),We&&re.addEventListener("blocked",()=>We()),he.then(_e=>{Je&&_e.addEventListener("close",()=>Je()),gt&&_e.addEventListener("versionchange",()=>gt())}).catch(()=>{}),he}function Ae(j,{blocked:we}={}){const We=indexedDB.deleteDatabase(j);return we&&We.addEventListener("blocked",()=>we()),be(We).then(()=>{})}const Ie=["get","getKey","getAll","getAllKeys","count"],Re=["put","add","delete","clear"],Ge=new Map;function Se(j,we){if(!(j instanceof IDBDatabase)||we in j||"string"!=typeof we)return;if(Ge.get(we))return Ge.get(we);const We=we.replace(/FromIndex$/,""),Ye=we!==We,gt=Re.includes(We);if(!(We in(Ye?IDBIndex:IDBObjectStore).prototype)||!gt&&!Ie.includes(We))return;const Je=function(){var re=(0,_.Z)(function*(he,..._e){const xe=this.transaction(he,gt?"readwrite":"readonly");let Fe=xe.store;return Ye&&(Fe=Fe.index(_e.shift())),(yield Promise.all([Fe[We](..._e),gt&&xe.done]))[0]});return function(_e){return re.apply(this,arguments)}}();return Ge.set(we,Je),Je}!function Ze(j){ve=j(ve)}(j=>({...j,get:(we,We,Ye)=>Se(we,We)||j.get(we,We,Ye),has:(we,We)=>!!Se(we,We)||j.has(we,We)}))},5861:(mt,De,P)=>{function _(V,te,ae,ne,de,ge,ue){try{var G=V[ge](ue),W=G.value}catch(Y){return void ae(Y)}G.done?te(W):Promise.resolve(W).then(ne,de)}function X(V){return function(){var te=this,ae=arguments;return new Promise(function(ne,de){var ge=V.apply(te,ae);function ue(W){_(ge,ne,de,ue,G,"next",W)}function G(W){_(ge,ne,de,ue,G,"throw",W)}ue(void 0)})}}P.d(De,{Z:()=>X})}},mt=>{mt(mt.s=2218)}]);